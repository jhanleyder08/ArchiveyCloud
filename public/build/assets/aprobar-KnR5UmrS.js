import{r as l,j as e,u as ae,H as re,L as E}from"./app-DOeYTPnE.js";import{A as oe}from"./app-layout-CKT_ksyH.js";import{c as te,u as G,a as M,B as g}from"./button-BB3j1qH9.js";import{C as y,a as R,b as C,d as ce,c as A}from"./card-BEZSel9K.js";import{L as N}from"./label-BvABT9uR.js";import{k as L,R as ie,I as ne,G as B,T as de,z as le,M as me}from"./app-sidebar-layout-83PL_wom.js";import{u as xe,c as q,a as I,e as ue}from"./index-B5i9qy2Y.js";import{P as w}from"./index-C7D1JV-H.js";import{u as pe,F as D}from"./index-Cl_hWV--.js";import{u as he}from"./index-pqvegj4w.js";import{P as je}from"./index-BuQaqXjb.js";import{B as b}from"./badge-BDHWk-Qv.js";import{S as P}from"./separator-DEXPH2Xk.js";import{A as fe,a as ve}from"./alert-Dl-auDCw.js";import{T as ge,S as be}from"./triangle-alert-B7e9hRq_.js";import{C as _}from"./circle-check-big-BQYxJNiA.js";import{C as F}from"./circle-x-CwiZ-nCX.js";import{U as Ne,C as ye}from"./user-BiSWd6pJ.js";import{C as Re}from"./calendar-Ce3GlXt0.js";/* empty css            */import"./x-BHxLkKP3.js";import"./index-sj4qH-fg.js";import"./app-logo-icon-BTiqVlKS.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ae=te("Circle",Ce);var k="Radio",[_e,T]=q(k),[we,Se]=_e(k),V=l.forwardRef((s,i)=>{const{__scopeRadio:o,name:a,checked:t=!1,required:n,disabled:c,value:m="on",onCheck:p,form:h,...j}=s,[x,u]=l.useState(null),r=G(i,v=>u(v)),d=l.useRef(!1),f=x?h||!!x.closest("form"):!0;return e.jsxs(we,{scope:o,checked:t,disabled:c,children:[e.jsx(w.button,{type:"button",role:"radio","aria-checked":t,"data-state":H(t),"data-disabled":c?"":void 0,disabled:c,value:m,...j,ref:r,onClick:I(s.onClick,v=>{t||p?.(),f&&(d.current=v.isPropagationStopped(),d.current||v.stopPropagation())})}),f&&e.jsx(U,{control:x,bubbles:!d.current,name:a,value:m,checked:t,required:n,disabled:c,form:h,style:{transform:"translateX(-100%)"}})]})});V.displayName=k;var O="RadioIndicator",$=l.forwardRef((s,i)=>{const{__scopeRadio:o,forceMount:a,...t}=s,n=Se(O,o);return e.jsx(je,{present:a||n.checked,children:e.jsx(w.span,{"data-state":H(n.checked),"data-disabled":n.disabled?"":void 0,...t,ref:i})})});$.displayName=O;var Ee="RadioBubbleInput",U=l.forwardRef(({__scopeRadio:s,control:i,checked:o,bubbles:a=!0,...t},n)=>{const c=l.useRef(null),m=G(c,n),p=he(o),h=ue(i);return l.useEffect(()=>{const j=c.current;if(!j)return;const x=window.HTMLInputElement.prototype,r=Object.getOwnPropertyDescriptor(x,"checked").set;if(p!==o&&r){const d=new Event("click",{bubbles:a});r.call(j,o),j.dispatchEvent(d)}},[p,o,a]),e.jsx(w.input,{type:"radio","aria-hidden":!0,defaultChecked:o,...t,tabIndex:-1,ref:m,style:{...t.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});U.displayName=Ee;function H(s){return s?"checked":"unchecked"}var De=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],S="RadioGroup",[Pe,ts]=q(S,[L,T]),K=L(),W=T(),[Ie,ze]=Pe(S),X=l.forwardRef((s,i)=>{const{__scopeRadioGroup:o,name:a,defaultValue:t,value:n,required:c=!1,disabled:m=!1,orientation:p,dir:h,loop:j=!0,onValueChange:x,...u}=s,r=K(o),d=pe(h),[f,v]=xe({prop:n,defaultProp:t??null,onChange:x,caller:S});return e.jsx(Ie,{scope:o,name:a,required:c,disabled:m,value:f,onValueChange:v,children:e.jsx(ie,{asChild:!0,...r,orientation:p,dir:d,loop:j,children:e.jsx(w.div,{role:"radiogroup","aria-required":c,"aria-orientation":p,"data-disabled":m?"":void 0,dir:d,...u,ref:i})})})});X.displayName=S;var Y="RadioGroupItem",J=l.forwardRef((s,i)=>{const{__scopeRadioGroup:o,disabled:a,...t}=s,n=ze(Y,o),c=n.disabled||a,m=K(o),p=W(o),h=l.useRef(null),j=G(i,h),x=n.value===t.value,u=l.useRef(!1);return l.useEffect(()=>{const r=f=>{De.includes(f.key)&&(u.current=!0)},d=()=>u.current=!1;return document.addEventListener("keydown",r),document.addEventListener("keyup",d),()=>{document.removeEventListener("keydown",r),document.removeEventListener("keyup",d)}},[]),e.jsx(ne,{asChild:!0,...m,focusable:!c,active:x,children:e.jsx(V,{disabled:c,required:n.required,checked:x,...p,...t,name:n.name,ref:j,onCheck:()=>n.onValueChange(t.value),onKeyDown:I(r=>{r.key==="Enter"&&r.preventDefault()}),onFocus:I(t.onFocus,()=>{u.current&&h.current?.click()})})})});J.displayName=Y;var Ge="RadioGroupIndicator",Q=l.forwardRef((s,i)=>{const{__scopeRadioGroup:o,...a}=s,t=W(o);return e.jsx($,{...t,...a,ref:i})});Q.displayName=Ge;var Z=X,ee=J,ke=Q;const se=l.forwardRef(({className:s,...i},o)=>e.jsx(Z,{className:M("grid gap-2",s),...i,ref:o}));se.displayName=Z.displayName;const z=l.forwardRef(({className:s,...i},o)=>e.jsx(ee,{ref:o,className:M("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),...i,children:e.jsx(ke,{className:"flex items-center justify-center",children:e.jsx(Ae,{className:"h-2.5 w-2.5 fill-current text-current"})})}));z.displayName=ee.displayName;function cs({workflow:s}){const[i,o]=l.useState(!1),{data:a,setData:t,post:n,processing:c,errors:m}=ae({accion:"",comentarios:"",archivos_adjuntos:[]}),p=r=>{r.preventDefault(),a.accion&&(a.accion==="rechazado"&&!a.comentarios.trim()||o(!0))},h=()=>{n(`/admin/workflow/${s.id}/procesar`,{onSuccess:()=>{o(!1)},onError:()=>{o(!1)}})},j=r=>({Crítica:e.jsx(b,{variant:"destructive",children:"Crítica"}),Alta:e.jsx(b,{className:"bg-orange-100 text-orange-800",children:"Alta"}),Media:e.jsx(b,{variant:"outline",className:"text-blue-600",children:"Media"}),Baja:e.jsx(b,{variant:"outline",className:"text-gray-600",children:"Baja"})})[r]||e.jsx(b,{variant:"outline",children:r}),x=r=>new Date(r).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),u=new Date(s.fecha_vencimiento)<new Date;return e.jsxs(oe,{children:[e.jsx(re,{title:`Aprobar Workflow - ${s.documento.nombre}`}),e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(B,{className:"w-8 h-8 text-blue-600"}),"Aprobar Documento"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Revisa y toma una decisión sobre este documento"})]}),e.jsx(E,{href:`/admin/workflow/${s.id}`,children:e.jsx(g,{variant:"outline",children:"Volver a Detalles"})})]}),u&&e.jsxs(fe,{className:"mb-6 border-red-200 bg-red-50",children:[e.jsx(ge,{className:"h-4 w-4 text-red-600"}),e.jsxs(ve,{className:"text-red-800",children:[e.jsx("strong",{children:"¡Documento vencido!"})," Este workflow ha excedido su fecha límite de aprobación."]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(y,{children:[e.jsxs(R,{children:[e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-5 h-5 text-green-600"}),"Decisión de Aprobación"]}),e.jsx(ce,{children:"Selecciona tu decisión y proporciona comentarios sobre el documento"})]}),e.jsx(A,{children:e.jsxs("form",{onSubmit:p,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{className:"text-base font-medium",children:"¿Cuál es tu decisión? *"}),e.jsxs(se,{value:a.accion,onValueChange:r=>t("accion",r),className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 border rounded-lg p-4 hover:bg-green-50 hover:border-green-300 transition-colors",children:[e.jsx(z,{value:"aprobado",id:"aprobado"}),e.jsxs(N,{htmlFor:"aprobado",className:"flex items-center gap-2 cursor-pointer flex-1",children:[e.jsx(_,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-green-700",children:"Aprobar Documento"}),e.jsx("div",{className:"text-sm text-green-600",children:"El documento cumple con los requisitos"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 border rounded-lg p-4 hover:bg-red-50 hover:border-red-300 transition-colors",children:[e.jsx(z,{value:"rechazado",id:"rechazado"}),e.jsxs(N,{htmlFor:"rechazado",className:"flex items-center gap-2 cursor-pointer flex-1",children:[e.jsx(F,{className:"w-5 h-5 text-red-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-red-700",children:"Rechazar Documento"}),e.jsx("div",{className:"text-sm text-red-600",children:"El documento requiere correcciones"})]})]})]})]}),m.accion&&e.jsx("p",{className:"text-sm text-red-600",children:m.accion})]}),e.jsx(P,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(N,{htmlFor:"comentarios",className:"text-base font-medium",children:["Comentarios ",a.accion==="rechazado"&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(de,{id:"comentarios",placeholder:a.accion==="aprobado"?"Comentarios adicionales sobre la aprobación (opcional)...":a.accion==="rechazado"?"Explica los motivos del rechazo y qué correcciones son necesarias...":"Proporciona tu retroalimentación sobre el documento...",value:a.comentarios,onChange:r=>t("comentarios",r.target.value),rows:6,className:m.comentarios?"border-red-500":""}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-500",children:[e.jsx("span",{children:a.accion==="rechazado"?"Requerido para rechazos":"Opcional pero recomendado"}),e.jsxs("span",{children:[a.comentarios.length,"/1000"]})]})]}),m.comentarios&&e.jsx("p",{className:"text-sm text-red-600",children:m.comentarios})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{className:"text-base font-medium",children:"Archivos Adjuntos (Opcional)"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx(D,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Arrastra archivos aquí o haz clic para seleccionar"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Documentos de soporte, correcciones sugeridas, etc."}),e.jsx("input",{type:"file",multiple:!0,className:"hidden",onChange:r=>{const d=Array.from(r.target.files||[]);t("archivos_adjuntos",d)}})]}),a.archivos_adjuntos.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Archivos seleccionados:"}),a.archivos_adjuntos.map((r,d)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(D,{className:"w-4 h-4"}),e.jsx("span",{children:r.name}),e.jsxs("span",{className:"text-gray-500",children:["(",(r.size/1024/1024).toFixed(2)," MB)"]})]},d))]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsxs(g,{type:"submit",disabled:!a.accion||a.accion==="rechazado"&&!a.comentarios.trim()||c,className:a.accion==="aprobado"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700",children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),c?"Procesando...":a.accion==="aprobado"?"Aprobar Documento":"Rechazar Documento"]}),e.jsx(E,{href:`/admin/workflow/${s.id}`,children:e.jsx(g,{variant:"outline",children:"Cancelar"})})]})]})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(y,{children:[e.jsx(R,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5"}),"Documento"]})}),e.jsxs(A,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Nombre"}),e.jsx("p",{className:"font-medium",children:s.documento.nombre})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Código"}),e.jsx("p",{className:"font-medium",children:s.documento.codigo})]}),e.jsx(P,{}),e.jsx(E,{href:`/admin/documentos/${s.documento.id}`,children:e.jsx(g,{variant:"outline",size:"sm",className:"w-full",children:"Ver Documento Completo"})})]})]}),e.jsxs(y,{children:[e.jsx(R,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5"}),"Workflow"]})}),e.jsxs(A,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-1",children:[e.jsx(Ne,{className:"w-4 h-4"}),"Solicitante"]}),e.jsx("p",{className:"font-medium",children:s.solicitante})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-1",children:[e.jsx(be,{className:"w-4 h-4"}),"Prioridad"]}),j(s.prioridad)]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-1",children:[e.jsx(Re,{className:"w-4 h-4"}),"Solicitud"]}),e.jsx("p",{className:"font-medium",children:x(s.fecha_solicitud)})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-1",children:[e.jsx(ye,{className:"w-4 h-4"}),"Vencimiento"]}),e.jsx("p",{className:`font-medium ${u?"text-red-600":""}`,children:x(s.fecha_vencimiento)}),u&&e.jsx(b,{variant:"destructive",className:"mt-1 text-xs",children:"Vencido"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-1",children:[e.jsx(_,{className:"w-4 h-4"}),"Progreso"]}),e.jsxs("p",{className:"font-medium",children:["Nivel ",s.nivel_actual," de ",s.total_niveles]})]}),s.descripcion&&e.jsxs(e.Fragment,{children:[e.jsx(P,{}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2",children:[e.jsx(me,{className:"w-4 h-4"}),"Descripción"]}),e.jsx("div",{className:"bg-gray-50 p-3 rounded-lg",children:e.jsx("p",{className:"text-sm",children:s.descripcion})})]})]})]})]}),e.jsxs(y,{className:"border-blue-200 bg-blue-50",children:[e.jsx(R,{children:e.jsx(C,{className:"text-blue-800",children:"💡 Consejos"})}),e.jsxs(A,{className:"text-sm text-blue-700 space-y-2",children:[e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Aprobación:"})," El documento pasará al siguiente nivel o se completará el workflow."]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Rechazo:"})," El documento será devuelto al solicitante con tus comentarios."]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Comentarios:"})," Son obligatorios para rechazos y muy recomendados para aprobaciones."]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Archivos:"})," Puedes adjuntar documentos de soporte o correcciones sugeridas."]})]})]})]})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.accion==="aprobado"?e.jsx(_,{className:"w-8 h-8 text-green-600"}):e.jsx(F,{className:"w-8 h-8 text-red-600"}),e.jsxs("h3",{className:"text-lg font-medium",children:["Confirmar ",a.accion==="aprobado"?"Aprobación":"Rechazo"]})]}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["¿Estás seguro de que deseas ",a.accion==="aprobado"?"aprobar":"rechazar"," este documento?",a.accion==="aprobado"&&s.nivel_actual===s.total_niveles&&" Esta acción completará el workflow de aprobación."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(g,{onClick:h,disabled:c,className:a.accion==="aprobado"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700",children:c?"Procesando...":"Confirmar"}),e.jsx(g,{variant:"outline",onClick:()=>o(!1),disabled:c,children:"Cancelar"})]})]})})]})]})}export{cs as default};
