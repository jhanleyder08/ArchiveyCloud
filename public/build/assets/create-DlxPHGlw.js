import{r as h,u as ie,j as e,H as te,b as w}from"./app-CcKfyaCU.js";import{A as ne}from"./app-layout-C75vkcyi.js";import{c as oe,B as u}from"./button-CLk8mODa.js";import{I as g}from"./input-Bjf7NZ4L.js";import{L as n}from"./label-BJXeACpA.js";import{T as B,t as L,j as ce}from"./app-sidebar-layout-BXlSAu8N.js";import{S as f,a as b,b as N,c as C,d as j}from"./select-Cvw0huRE.js";import{C as l,c as d,a as m,b as p}from"./card-DB_ax1hF.js";import{A as O,a as G}from"./alert-B69v_qG3.js";import{P as le}from"./progress-CKSPUzcV.js";import{S as A}from"./switch-Dx6lqSzj.js";import{A as de}from"./arrow-left-DDD6_1-Y.js";import{I as H}from"./info-CJbTBael.js";import{X as U}from"./x-D64GJCvX.js";import{U as me}from"./upload-Czx2jiLj.js";import{M as q}from"./monitor-CoKX2GvS.js";import{S as pe}from"./save-YtOjp9bn.js";import{F as K}from"./Combination-CUlyt3Qj.js";import{I as xe}from"./image-BKRes-ef.js";import{V as he,H as ue}from"./video-DPigNj7b.js";/* empty css            */import"./index-BntgwZbj.js";import"./index-ll0PAeEe.js";import"./index-B0t8Wn8h.js";import"./index-dTY0tLa0.js";import"./app-logo-icon-C6dTzLrG.js";import"./user-BXzsLEON.js";import"./triangle-alert-VTzysZy9.js";import"./users-2HnGrV9k.js";import"./folder-31vdAhi2.js";import"./search-DJHS9xSC.js";import"./index-DD-KClF5.js";import"./check-kEA8sdve.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],ve=oe("FileUp",je);function Ye({opciones:v}){const[y,k]=h.useState(!1),[E,F]=h.useState(0),[X,D]=h.useState(!1),[x,M]=h.useState([]),[_,T]=h.useState(""),z=h.useRef(null),{data:a,setData:i,post:ge,processing:S,errors:o,reset:fe}=ie({nombre:"",descripcion:"",expediente_id:"",tipologia_id:"",tipo_documental:"",tipo_soporte:"electronico",estado:"borrador",confidencialidad:"interna",numero_folios:null,palabras_clave:[],ubicacion_fisica:"",observaciones:"",archivo:null,procesamiento:{ocr:!0,convertir:!0,generar_miniatura:!0}}),$=[{title:"Inicio",href:"/dashboard"},{title:"Administración",href:"/admin"},{title:"Documentos",href:"/admin/documentos"},{title:"Crear Documento",href:"/admin/documentos/create"}],J=s=>{s.preventDefault(),k(!0);const r=new FormData;Object.entries(a).forEach(([c,P])=>{c==="palabras_clave"?x.forEach((ae,re)=>{r.append(`palabras_clave[${re}]`,ae)}):P!=null&&r.append(c,P)});const t=setInterval(()=>{F(c=>c>=90?(clearInterval(t),90):c+10)},200);w.post("/admin/documentos",r,{onSuccess:()=>{F(100),L.success("Documento creado exitosamente"),setTimeout(()=>{clearInterval(t),w.visit("/admin/documentos")},1e3)},onError:c=>{clearInterval(t),F(0),L.error("Error al crear el documento. Revisa los campos marcados.")},onFinish:()=>{k(!1)}})},I=s=>{s.preventDefault(),s.stopPropagation(),s.type==="dragenter"||s.type==="dragover"?D(!0):s.type==="dragleave"&&D(!1)},Z=s=>{s.preventDefault(),s.stopPropagation(),D(!1),s.dataTransfer.files&&s.dataTransfer.files[0]&&V(s.dataTransfer.files[0])},V=s=>{i("archivo",s),a.nombre||i("nombre",s.name)},Q=s=>{s.target.files&&s.target.files[0]&&V(s.target.files[0])},R=()=>{if(_.trim()&&!x.includes(_.trim())){const s=[...x,_.trim()];M(s),i("palabras_clave",s),T("")}},W=s=>{const r=x.filter(t=>t!==s);M(r),i("palabras_clave",r)},Y=s=>{const r=s.split(".").pop()?.toLowerCase();return r?["jpg","jpeg","png","gif","bmp","svg","webp"].includes(r)?e.jsx(xe,{className:"h-8 w-8 text-blue-500"}):["mp4","avi","mov","wmv","flv","webm"].includes(r)?e.jsx(he,{className:"h-8 w-8 text-purple-500"}):["mp3","wav","ogg","flac","m4a"].includes(r)?e.jsx(ue,{className:"h-8 w-8 text-green-500"}):["zip","rar","7z","tar","gz"].includes(r)?e.jsx(ce,{className:"h-8 w-8 text-orange-500"}):["xls","xlsx","ppt","pptx"].includes(r)?e.jsx(q,{className:"h-8 w-8 text-indigo-500"}):e.jsx(K,{className:"h-8 w-8 text-gray-500"}):e.jsx(K,{className:"h-8 w-8"})},ee=s=>{if(s===0)return"0 Bytes";const r=1024,t=["Bytes","KB","MB","GB"],c=Math.floor(Math.log(s)/Math.log(r));return parseFloat((s/Math.pow(r,c)).toFixed(2))+" "+t[c]},se=s=>{const r=s.split(".").pop()?.toLowerCase(),t=[];return r?(["jpg","jpeg","png","gif","bmp","tiff","pdf"].includes(r)&&t.push("✓ OCR (Reconocimiento de texto)"),["jpg","jpeg","png","gif","bmp","tiff","mp4","avi","mov","wmv","pdf"].includes(r)&&t.push("✓ Generación de miniatura"),["pdf","doc","docx","jpg","jpeg","png","mp4","mp3"].includes(r)&&t.push("✓ Conversión automática"),t.push("✓ Extracción de metadatos"),t.push("✓ Verificación de integridad"),t.length>0?t.join(", "):"Procesamiento básico disponible"):"No se puede determinar el tipo de archivo"};return e.jsxs(ne,{breadcrumbs:$,children:[e.jsx(te,{title:"Crear Documento"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{className:"h-6 w-6 text-[#2a3d83]"}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Crear Documento"})]}),e.jsxs(u,{type:"button",variant:"outline",onClick:()=>w.visit("/admin/documentos"),className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),"Volver"]})]}),y&&e.jsx(l,{children:e.jsx(d,{className:"pt-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Subiendo documento..."}),e.jsxs("span",{children:[E,"%"]})]}),e.jsx(le,{value:E,className:"w-full"})]})})}),e.jsxs(O,{children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx(G,{children:"Sube documentos electrónicos al sistema siguiendo las políticas de formatos y tamaños establecidas para cada tipo de contenido."})]}),e.jsxs("form",{onSubmit:J,className:"space-y-6",children:[e.jsxs(l,{children:[e.jsx(m,{children:e.jsx(p,{children:"Archivo"})}),e.jsxs(d,{children:[e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${X?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:I,onDragLeave:I,onDragOver:I,onDrop:Z,children:[a.archivo?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center",children:Y(a.archivo.name)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.archivo.name}),e.jsx("p",{className:"text-sm text-gray-500",children:ee(a.archivo.size)})]}),e.jsxs(u,{type:"button",variant:"outline",size:"sm",onClick:()=>i("archivo",null),children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Remover"]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(me,{className:"h-12 w-12 text-gray-400 mx-auto"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"Arrastra tu archivo aquí o haz clic para seleccionar"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Formatos soportados: PDF, DOC, DOCX, JPG, PNG, MP4, MP3 y más"})]}),e.jsx(u,{type:"button",variant:"outline",onClick:()=>z.current?.click(),children:"Seleccionar archivo"})]}),e.jsx("input",{ref:z,type:"file",className:"hidden",onChange:Q,accept:"*/*"})]}),o.archivo&&e.jsx("p",{className:"text-sm text-red-600 mt-2",children:o.archivo})]})]}),e.jsxs(l,{children:[e.jsx(m,{children:e.jsx(p,{children:"Información Básica"})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"nombre",children:"Nombre del Documento *"}),e.jsx(g,{id:"nombre",type:"text",value:a.nombre,onChange:s=>i("nombre",s.target.value),className:o.nombre?"border-red-500":"",required:!0}),o.nombre&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:o.nombre})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"expediente_id",children:"Expediente *"}),e.jsxs(f,{value:a.expediente_id,onValueChange:s=>i("expediente_id",s),children:[e.jsx(b,{id:"expediente_id",className:o.expediente_id?"border-red-500":"",children:e.jsx(N,{placeholder:"Seleccionar expediente"})}),e.jsx(C,{children:v.expedientes.map(s=>e.jsxs(j,{value:s.id.toString(),children:[s.codigo," - ",s.nombre]},s.id))})]}),o.expediente_id&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:o.expediente_id})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"descripcion",children:"Descripción"}),e.jsx(B,{id:"descripcion",value:a.descripcion,onChange:s=>i("descripcion",s.target.value),placeholder:"Descripción detallada del documento",rows:3,className:o.descripcion?"border-red-500":""}),o.descripcion&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:o.descripcion})]})]})]}),e.jsxs(l,{children:[e.jsx(m,{children:e.jsx(p,{children:"Clasificación"})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"tipologia_id",children:"Tipología Documental"}),e.jsxs(f,{value:a.tipologia_id,onValueChange:s=>i("tipologia_id",s),children:[e.jsx(b,{id:"tipologia_id",children:e.jsx(N,{placeholder:"Seleccionar tipología"})}),e.jsxs(C,{children:[e.jsx(j,{value:"null",children:"Sin tipología"}),v.tipologias.map(s=>e.jsxs(j,{value:s.id.toString(),children:[s.nombre," (",s.categoria,")"]},s.id))]})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"tipo_documental",children:"Tipo Documental"}),e.jsx(g,{id:"tipo_documental",type:"text",value:a.tipo_documental,onChange:s=>i("tipo_documental",s.target.value),placeholder:"Ej: Contrato, Factura, Informe"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"tipo_soporte",children:"Tipo de Soporte *"}),e.jsxs(f,{value:a.tipo_soporte,onValueChange:s=>i("tipo_soporte",s),children:[e.jsx(b,{id:"tipo_soporte",children:e.jsx(N,{})}),e.jsx(C,{children:v.tipos_soporte.map(s=>e.jsx(j,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"numero_folios",children:"Número de Folios"}),e.jsx(g,{id:"numero_folios",type:"number",min:"1",value:a.numero_folios||"",onChange:s=>i("numero_folios",parseInt(s.target.value)||null)})]})]})]})]}),e.jsxs(l,{children:[e.jsx(m,{children:e.jsx(p,{children:"Estado y Confidencialidad"})}),e.jsx(d,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"estado",children:"Estado *"}),e.jsxs(f,{value:a.estado,onValueChange:s=>i("estado",s),children:[e.jsx(b,{id:"estado",children:e.jsx(N,{})}),e.jsx(C,{children:v.estados.map(s=>e.jsx(j,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"confidencialidad",children:"Confidencialidad *"}),e.jsxs(f,{value:a.confidencialidad,onValueChange:s=>i("confidencialidad",s),children:[e.jsx(b,{id:"confidencialidad",children:e.jsx(N,{})}),e.jsx(C,{children:v.confidencialidad.map(s=>e.jsx(j,{value:s.value,children:s.label},s.value))})]})]})]})})]}),e.jsxs(l,{children:[e.jsx(m,{children:e.jsx(p,{children:"Palabras Clave"})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{value:_,onChange:s=>T(s.target.value),placeholder:"Agregar palabra clave",onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),R())}),e.jsx(u,{type:"button",variant:"outline",onClick:R,children:"Agregar"})]}),x.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:x.map(s=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800",children:[s,e.jsx("button",{type:"button",onClick:()=>W(s),className:"hover:text-blue-600",children:e.jsx(U,{className:"h-3 w-3"})})]},s))})]})]}),e.jsxs(l,{children:[e.jsx(m,{children:e.jsx(p,{children:"Información Adicional"})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"ubicacion_fisica",children:"Ubicación Física"}),e.jsx(g,{id:"ubicacion_fisica",type:"text",value:a.ubicacion_fisica,onChange:s=>i("ubicacion_fisica",s.target.value),placeholder:"Ej: Archivo Central, Estante A-3, Caja 15"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"observaciones",children:"Observaciones"}),e.jsx(B,{id:"observaciones",value:a.observaciones,onChange:s=>i("observaciones",s.target.value),placeholder:"Observaciones adicionales",rows:3})]})]})]}),e.jsxs(l,{children:[e.jsx(m,{children:e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5"}),"Procesamiento Avanzado"]})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs(O,{children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx(G,{children:"Configura las opciones de procesamiento automático que se aplicarán al documento."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"flex items-center justify-between space-x-2 p-4 border rounded-lg",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(n,{htmlFor:"ocr",children:"Reconocimiento OCR"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Extraer texto de imágenes y documentos escaneados"})]}),e.jsx(A,{id:"ocr",checked:a.procesamiento.ocr,onCheckedChange:s=>i("procesamiento",{...a.procesamiento,ocr:s})})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 p-4 border rounded-lg",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(n,{htmlFor:"convertir",children:"Conversión Automática"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Convertir a formatos optimizados para archivo"})]}),e.jsx(A,{id:"convertir",checked:a.procesamiento.convertir,onCheckedChange:s=>i("procesamiento",{...a.procesamiento,convertir:s})})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 p-4 border rounded-lg",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(n,{htmlFor:"miniatura",children:"Generar Miniatura"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Crear vista previa para imágenes y videos"})]}),e.jsx(A,{id:"miniatura",checked:a.procesamiento.generar_miniatura,onCheckedChange:s=>i("procesamiento",{...a.procesamiento,generar_miniatura:s})})]})]}),a.archivo&&e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Procesamiento disponible para este archivo:"}),e.jsx("div",{className:"text-sm text-blue-700",children:se(a.archivo.name)})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-6",children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>w.visit("/admin/documentos"),disabled:S||y,children:"Cancelar"}),e.jsxs(u,{type:"submit",disabled:S||y,className:"bg-[#2a3d83] hover:bg-[#1e2b5f] flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),S||y?"Guardando...":"Crear Documento"]})]})]})]})]})}export{Ye as default};
