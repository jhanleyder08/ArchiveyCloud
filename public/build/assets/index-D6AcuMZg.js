import{r as E,u as Z,j as e,H as U,L as v,b as f}from"./app-91m9kwyU.js";import{A as G}from"./app-layout-DZp0sNzN.js";import{c as L,B as x}from"./button-CoFcodqQ.js";import{C as T,a as q,b as D,c as M,d as J}from"./card-3q9vKs-A.js";import{I as b}from"./input-JBRHZ7QZ.js";import{L as o}from"./label-BZUr6K3X.js";import{S as N,a as _,b as y,c as w,d as m,e as K}from"./select-Wrwv2RZt.js";import{B as c}from"./badge-Dw7CG6bs.js";import{S as Q}from"./separator-BRtBdpRZ.js";import{A as W,a as X}from"./alert-KwJoiGEv.js";import{h as C,C as Y,j as z,p as ee,q as se,s as ae,v as S}from"./app-sidebar-layout-CLv5ko0D.js";import{F as re}from"./filter-O_sy14q_.js";import{S as A}from"./star-DPqF1EhM.js";import{H as te}from"./hard-drive-DSNRbxKs.js";import{T as le}from"./triangle-alert-B8VDP-oe.js";import{S as B}from"./search-DaK7IuzH.js";import{R as ie}from"./rotate-ccw-AIBUeIhC.js";import{D as oe}from"./users-DKdb_1gz.js";import{F as I}from"./Combination-CDT0PLPo.js";import{R as ce}from"./refresh-cw-CuftxT1d.js";import{F as ne}from"./folder-open-Dmn08R-L.js";import{C as de}from"./folder-C92Ox93S.js";import{E as xe}from"./eye-xXNHm9-c.js";import{T as me}from"./trash-2-D_q2qeTI.js";/* empty css            */import"./index-Dt_6hCNO.js";import"./index-CGEZD_4Y.js";import"./index-CeBSh6Va.js";import"./check-Cn3I3pUy.js";import"./index-Dc4Xr8Yn.js";import"./x-CyP9uxNW.js";import"./index-Baz-24-5.js";import"./app-logo-icon-CUlPqTXW.js";import"./user-aQnMVpKS.js";import"./mail-CViPbZpD.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]],pe=L("FileImage",he);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],ue=L("FileSpreadsheet",je);function Xe({indices:i,estadisticas:n,filtros:r,opcionesFiltros:p}){const[F,H]=E.useState(!1),[d,j]=E.useState(null),{data:t,setData:l,get:k,processing:h}=Z({busqueda_texto:r.busqueda_texto||"",tipo_entidad:r.tipo_entidad||"",serie_documental:r.serie_documental||"",nivel_acceso:r.nivel_acceso||"",fecha_inicio:r.fecha_inicio||"",fecha_fin:r.fecha_fin||"",solo_vitales:r.solo_vitales||!1,solo_historicos:r.solo_historicos||!1,orden_por:r.orden_por||"fecha_indexacion",direccion:r.direccion||"desc"}),V=s=>{s.preventDefault(),k("/admin/indices",{preserveState:!0})},R=()=>{l({busqueda_texto:"",tipo_entidad:"",serie_documental:"",nivel_acceso:"",fecha_inicio:"",fecha_fin:"",solo_vitales:!1,solo_historicos:!1,orden_por:"fecha_indexacion",direccion:"desc"}),k("/admin/indices")},$=(s,a)=>{const g={publico:"bg-green-100 text-green-800",restringido:"bg-yellow-100 text-yellow-800",confidencial:"bg-orange-100 text-orange-800",secreto:"bg-red-100 text-red-800"};return e.jsx(c,{className:g[s]||"bg-gray-100 text-gray-800",children:a})},O=(s,a)=>{const g={excelente:"bg-green-100 text-green-800",bueno:"bg-blue-100 text-blue-800",regular:"bg-yellow-100 text-yellow-800",malo:"bg-orange-100 text-orange-800",critico:"bg-red-100 text-red-800"};return e.jsx(c,{className:g[s]||"bg-gray-100 text-gray-800",children:a})},u=async s=>{j(s);try{await f.post("/admin/indices/exportar",{formato:s,filtros:t},{preserveState:!0,onSuccess:()=>{},onError:a=>{console.error("Error al exportar:",a),alert("Error al exportar los índices. Por favor, inténtelo de nuevo.")},onFinish:()=>{j(null)}})}catch(a){console.error("Error al exportar:",a),alert("Error al exportar los índices. Por favor, inténtelo de nuevo."),j(null)}},P=()=>{f.post("/admin/indices/regenerar",{tipo:"todos",solo_faltantes:!1},{preserveState:!0,onSuccess:()=>{f.reload()}})};return e.jsxs(G,{breadcrumbs:[{title:"Dashboard",href:"/dashboard"},{title:"Administración",href:"#"},{title:"Índices Electrónicos",href:"/admin/indices"}],children:[e.jsx(U,{title:"Índices Electrónicos"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-6 w-6 text-[#2a3d83]"}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Índices Electrónicos"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(v,{href:"/admin/indices/estadisticas/dashboard",children:e.jsxs(x,{variant:"outline",children:[e.jsx(Y,{className:"w-4 h-4 mr-2 text-[#2a3d83]"}),"Estadísticas"]})}),e.jsxs(x,{onClick:()=>H(!F),variant:"outline",children:[e.jsx(re,{className:"w-4 h-4 mr-2 text-[#2a3d83]"}),"Filtros Avanzados"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Índices"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:n.total_indices.toLocaleString()})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(C,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Documentos Vitales"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:n.documentos_vitales.toLocaleString()})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(A,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Valor Histórico"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:n.documentos_historicos.toLocaleString()})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(z,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tamaño Total"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:n.tamaño_total})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(te,{className:"h-6 w-6 text-[#2a3d83]"})})]})})]}),n.indices_desactualizados>0&&e.jsxs(W,{className:"border-yellow-200 bg-yellow-50",children:[e.jsx(le,{className:"h-4 w-4 text-[#2a3d83]"}),e.jsxs(X,{className:"text-yellow-800",children:["Hay ",e.jsx("strong",{children:n.indices_desactualizados})," índices que necesitan actualización (más de 6 meses sin actualizar)."]})]}),e.jsxs(T,{className:"mb-6",children:[e.jsx(q,{children:e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5"}),"Búsqueda y Filtros"]})}),e.jsx(M,{children:e.jsxs("form",{onSubmit:V,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-3",children:[e.jsx(o,{htmlFor:"busqueda_texto",children:"Búsqueda de texto completo"}),e.jsx(b,{id:"busqueda_texto",type:"text",placeholder:"Buscar por título, descripción, palabras clave...",value:t.busqueda_texto,onChange:s=>l("busqueda_texto",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"tipo_entidad",children:"Tipo de entidad"}),e.jsxs(N,{value:t.tipo_entidad,onValueChange:s=>l("tipo_entidad",s),children:[e.jsx(_,{children:e.jsx(y,{placeholder:"Todos los tipos"})}),e.jsxs(w,{children:[e.jsx(m,{value:"all",children:"Todos los tipos"}),Object.entries(p.tipos_entidad).map(([s,a])=>e.jsx(m,{value:s,children:a},s))]})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"nivel_acceso",children:"Nivel de acceso"}),e.jsxs(N,{value:t.nivel_acceso,onValueChange:s=>l("nivel_acceso",s),children:[e.jsx(_,{children:e.jsx(y,{placeholder:"Todos los niveles"})}),e.jsxs(w,{children:[e.jsx(m,{value:"all",children:"Todos los niveles"}),Object.entries(p.niveles_acceso).map(([s,a])=>e.jsx(m,{value:s,children:a},s))]})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"serie_documental",children:"Serie documental"}),e.jsxs(N,{value:t.serie_documental,onValueChange:s=>l("serie_documental",s),children:[e.jsx(_,{children:e.jsx(y,{placeholder:"Todas las series"})}),e.jsxs(w,{children:[e.jsx(m,{value:"all",children:"Todas las series"}),p.series_documentales.map(s=>e.jsx(m,{value:s,children:s},s))]})]})]})]}),F&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"fecha_inicio",children:"Fecha inicio"}),e.jsx(b,{id:"fecha_inicio",type:"date",value:t.fecha_inicio,onChange:s=>l("fecha_inicio",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"fecha_fin",children:"Fecha fin"}),e.jsx(b,{id:"fecha_fin",type:"date",value:t.fecha_fin,onChange:s=>l("fecha_fin",s.target.value)})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-6",children:[e.jsx("input",{id:"solo_vitales",type:"checkbox",checked:t.solo_vitales,onChange:s=>l("solo_vitales",s.target.checked),className:"rounded border-gray-300"}),e.jsx(o,{htmlFor:"solo_vitales",children:"Solo información vital"})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-6",children:[e.jsx("input",{id:"solo_historicos",type:"checkbox",checked:t.solo_historicos,onChange:s=>l("solo_historicos",s.target.checked),className:"rounded border-gray-300"}),e.jsx(o,{htmlFor:"solo_historicos",children:"Solo valor histórico"})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(x,{type:"submit",disabled:h,children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),h?"Buscando...":"Buscar"]}),e.jsxs(x,{type:"button",variant:"outline",onClick:R,children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Limpiar"]})]})]})})]}),e.jsxs(T,{children:[e.jsx(q,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(D,{children:"Resultados de búsqueda"}),e.jsxs(J,{children:[i.total," índice(s) encontrado(s) - Mostrando ",i.from," a ",i.to]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(ee,{children:[e.jsx(se,{asChild:!0,children:e.jsxs(x,{variant:"outline",size:"sm",disabled:d!==null,children:[e.jsx(oe,{className:"w-4 h-4 mr-1"}),d?`Exportando ${d.toUpperCase()}...`:"Exportar",e.jsx(K,{className:"w-3 h-3 ml-1"})]})}),e.jsxs(ae,{align:"end",children:[e.jsxs(S,{onClick:()=>u("csv"),disabled:d!==null,children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Exportar CSV"]}),e.jsxs(S,{onClick:()=>u("excel"),disabled:d!==null,children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),"Exportar Excel"]}),e.jsxs(S,{onClick:()=>u("pdf"),disabled:d!==null,children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"Exportar PDF"]})]})]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:P,disabled:h,children:[e.jsx(ce,{className:`w-4 h-4 mr-1 ${h?"animate-spin":""}`}),h?"Regenerando...":"Regenerar"]})]})]})}),e.jsxs(M,{children:[i.data.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(C,{className:"w-16 h-16 mx-auto text-[#2a3d83] mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No se encontraron índices con los criterios especificados"})]}):e.jsx("div",{className:"space-y-4",children:i.data.map(s=>e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.tipo_entidad==="expediente"?e.jsx(ne,{className:"w-5 h-5 text-[#2a3d83]"}):e.jsx(I,{className:"w-5 h-5 text-[#2a3d83]"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:s.titulo}),s.es_reciente&&e.jsx(c,{variant:"outline",className:"text-green-600 border-green-300",children:"Nuevo"}),s.necesita_actualizacion&&e.jsxs(c,{variant:"outline",className:"text-orange-600 border-orange-300",children:[e.jsx(de,{className:"w-3 h-3 mr-1"}),"Desactualizado"]})]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("span",{className:"font-medium",children:"Código:"})," ",s.codigo_completo," |"," ",e.jsx("span",{className:"font-medium",children:"Serie:"})," ",s.serie_documental||"Sin clasificar"," |"," ",e.jsx("span",{className:"font-medium",children:"Folios:"})," ",s.cantidad_folios||"N/A"," |"," ",e.jsx("span",{className:"font-medium",children:"Tamaño:"})," ",s.tamaño_formateado]}),s.descripcion&&e.jsx("p",{className:"text-sm text-gray-700 mb-3 line-clamp-2",children:s.descripcion}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(c,{variant:"outline",className:"capitalize",children:s.tipo_entidad}),$(s.nivel_acceso,s.etiqueta_nivel_acceso),O(s.estado_conservacion,s.etiqueta_estado_conservacion),s.es_vital&&e.jsxs(c,{className:"bg-yellow-100 text-yellow-800",children:[e.jsx(A,{className:"w-3 h-3 mr-1"}),"Vital"]}),s.es_historico&&e.jsxs(c,{className:"bg-purple-100 text-purple-800",children:[e.jsx(z,{className:"w-3 h-3 mr-1"}),"Histórico"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{href:`/admin/indices/${s.id}`,children:e.jsx("button",{className:"p-2 rounded-md text-[#2a3d83] hover:text-[#1e2b5f] hover:bg-blue-50 transition-colors",children:e.jsx(xe,{className:"w-4 h-4"})})}),e.jsx("button",{className:"p-2 rounded-md text-red-600 hover:text-red-800 hover:bg-red-50 transition-colors",children:e.jsx(me,{className:"w-4 h-4"})})]})]})},s.id))}),i.last_page>1&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx("div",{className:"flex items-center space-x-2",children:Array.from({length:i.last_page},(s,a)=>a+1).map(s=>e.jsx(v,{href:`/admin/indices?page=${s}`,className:`px-3 py-1 rounded ${s===i.current_page?"bg-indigo-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:s},s))})})]})]})]})]})}export{Xe as default};
