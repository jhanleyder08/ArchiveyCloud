import{r as d,j as e,H as R,a as m}from"./app-5lvxmL5N.js";import{s as D,m as z,Z as k,n as H,a as j,q as L,o as B}from"./app-sidebar-layout-CKEzWS_J.js";import{C as i,a as r,b as l,c}from"./card-LPn6WdOe.js";import{B as x}from"./badge-CRhtFKKP.js";import{c as I,B as n}from"./app-logo-icon-DTg4XN8t.js";import{T as M,a as $,b as h,c as u}from"./tabs-Bk1Bznc8.js";import{A as G,b as U,a as V}from"./alert-xVXVWRMh.js";import{P as q}from"./progress-rSLFRKpH.js";import{R as K}from"./refresh-cw-DfjoHmep.js";import{S as X}from"./server-B0-iVACi.js";import{A as Z}from"./activity-Be_BLWOt.js";import{R as F,T as J}from"./CategoricalChart-CiGQqO66.js";import{P as Q,a as W}from"./PieChart-CKW1KXWo.js";import{C as f}from"./circle-check-big-BsqZqApd.js";import{M as Y}from"./memory-stick-Bm7bMz7a.js";import{H as ee}from"./hard-drive-i1NvzsoN.js";import{C as O}from"./circle-x-DHplErrM.js";/* empty css            */import"./index-DrDC_1PC.js";import"./label-BhumWj7F.js";import"./index-Cgyyrey8.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],ae=I("Play",se);function Se({systemStatus:T,optimizationHistory:N,cacheStatistics:_,healthStatus:E}){const[o,g]=d.useState(!1),[y,v]=d.useState(!1),[a,A]=d.useState({systemStatus:T,cacheStatistics:_,healthStatus:E});d.useEffect(()=>{const s=setInterval(()=>{b()},3e4);return()=>clearInterval(s)},[]);const b=async()=>{v(!0);try{const s=await fetch(route("admin.optimizacion.system-status"));if(s.ok){const t=await s.json();A({systemStatus:t.system_status,cacheStatistics:t.cache_stats,healthStatus:t.health_status})}}catch(s){console.error("Error refreshing system data:",s)}finally{v(!1)}},p=async(s={})=>{g(!0);try{const C=await(await fetch(route("admin.optimizacion.run-optimization"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify(s)})).json();C.success?(alert("Optimización ejecutada exitosamente"),m.reload()):alert("Error durante la optimización: "+C.message)}catch(t){console.error("Error running optimization:",t),alert("Error interno del servidor")}finally{g(!1)}},P=s=>{switch(s.toLowerCase()){case"healthy":case"ok":return"text-green-600";case"warning":return"text-yellow-600";case"error":case"failed":return"text-red-600";default:return"text-gray-600"}},w=s=>{switch(s.toLowerCase()){case"healthy":case"ok":return e.jsx(f,{className:"h-4 w-4 text-green-600"});case"warning":return e.jsx(j,{className:"h-4 w-4 text-yellow-600"});case"error":case"failed":return e.jsx(O,{className:"h-4 w-4 text-red-600"});default:return e.jsx(j,{className:"h-4 w-4 text-gray-600"})}};a.healthStatus.checks.map(s=>({name:s.name,value:s.status==="ok"?1:0,status:s.status}));const S={ok:"#10b981",error:"#ef4444"};return e.jsxs(D,{children:[e.jsx(R,{title:"Optimización del Sistema"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Sistema de Optimización y Monitoreo"}),e.jsxs(n,{onClick:b,variant:"outline",size:"sm",disabled:y,className:"flex items-center gap-2",children:[e.jsx(K,{className:`h-4 w-4 ${y?"animate-spin":""}`}),"Actualizar"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(i,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Estado del Sistema"}),e.jsx(X,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[w(a.healthStatus.status),e.jsx("div",{className:"text-2xl font-bold",children:a.healthStatus.status.toUpperCase()})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.systemStatus.environment," • PHP ",a.systemStatus.php_version]})]})]}),e.jsxs(i,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Caché"}),e.jsx(z,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:typeof a.cacheStatistics.hit_ratio=="number"?`${a.cacheStatistics.hit_ratio}%`:"N/A"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Hit Ratio • ",a.cacheStatistics.driver]})]})]}),e.jsxs(i,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Optimización"}),e.jsx(k,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:e.jsx(x,{variant:a.systemStatus.optimization_enabled?"default":"secondary",children:a.systemStatus.optimization_enabled?"Habilitada":"Deshabilitada"})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.systemStatus.opcache_enabled?"OPcache activo":"OPcache inactivo"})]})]}),e.jsxs(i,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Uptime"}),e.jsx(H,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.systemStatus.uptime!=="N/A"?a.systemStatus.uptime.replace("up ",""):"N/A"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Sistema activo"})]})]})]}),e.jsxs(M,{defaultValue:"dashboard",className:"space-y-6",children:[e.jsxs($,{className:"grid w-full grid-cols-4",children:[e.jsx(h,{value:"dashboard",children:"Dashboard"}),e.jsx(h,{value:"optimization",children:"Optimización"}),e.jsx(h,{value:"health",children:"Health Checks"}),e.jsx(h,{value:"history",children:"Historial"})]}),e.jsx(u,{value:"dashboard",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(i,{children:[e.jsx(r,{children:e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5"}),"Estado de Servicios"]})}),e.jsx(c,{children:e.jsx(F,{width:"100%",height:300,children:e.jsxs(Q,{children:[e.jsx(W,{data:[{name:"Saludables",value:a.healthStatus.checks.filter(s=>s.status==="ok").length,fill:S.ok},{name:"Con problemas",value:a.healthStatus.checks.filter(s=>s.status!=="ok").length,fill:S.error}],cx:"50%",cy:"50%",outerRadius:80,dataKey:"value",label:({name:s,value:t})=>`${s}: ${t}`}),e.jsx(J,{})]})})})]}),e.jsxs(i,{children:[e.jsx(r,{children:e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(f,{className:"h-5 w-5"}),"Verificaciones del Sistema"]})}),e.jsxs(c,{className:"space-y-3",children:[a.healthStatus.checks.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[w(s.status),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),s.message&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.message})]})]}),e.jsx(x,{variant:s.status==="ok"?"default":"destructive",children:s.status})]},t)),a.healthStatus.checks.length===0&&e.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No hay datos de health checks disponibles"})]})]})]})}),e.jsx(u,{value:"optimization",className:"space-y-4",children:e.jsxs(i,{children:[e.jsx(r,{children:e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5"}),"Ejecutar Optimización"]})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs(G,{children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx(U,{children:"Importante"}),e.jsx(V,{children:"La optimización mejorará el rendimiento del sistema pero puede tomar varios minutos. Se recomienda ejecutar durante períodos de bajo tráfico."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(n,{onClick:()=>p({dry_run:!0}),disabled:o,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),"Simular Optimización"]}),e.jsxs(n,{onClick:()=>p(),disabled:o,className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4"}),o?"Ejecutando...":"Optimización Completa"]}),e.jsxs(n,{onClick:()=>p({skip_cache:!0}),disabled:o,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4"}),"Sin Caché"]}),e.jsxs(n,{onClick:()=>m.visit(route("admin.optimizacion.cache")),variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),"Gestión de Caché"]})]}),o&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Ejecutando optimización..."}),e.jsx(q,{value:void 0,className:"w-full"})]})]})]})}),e.jsx(u,{value:"health",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(i,{children:[e.jsx(r,{children:e.jsx(l,{children:"Estado General"})}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Estado del Sistema:"}),e.jsx(x,{className:P(a.healthStatus.status),children:a.healthStatus.status})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Tiempo de Respuesta:"}),e.jsx("span",{className:"font-mono text-sm",children:a.healthStatus.response_time})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Servicios Verificados:"}),e.jsx("span",{className:"font-bold",children:a.healthStatus.checks.length})]})]})})]}),e.jsxs(i,{children:[e.jsx(r,{children:e.jsx(l,{children:"Acciones Rápidas"})}),e.jsxs(c,{className:"space-y-2",children:[e.jsxs(n,{onClick:()=>m.visit(route("admin.optimizacion.monitoring")),variant:"outline",className:"w-full justify-start",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Monitoreo Detallado"]}),e.jsxs(n,{onClick:()=>m.visit(route("admin.optimizacion.backups")),variant:"outline",className:"w-full justify-start",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Gestión de Backups"]})]})]})]})}),e.jsx(u,{value:"history",className:"space-y-4",children:e.jsxs(i,{children:[e.jsx(r,{children:e.jsx(l,{children:"Historial de Optimizaciones"})}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-4",children:[N.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[s.success?e.jsx(f,{className:"h-5 w-5 text-green-600"}):e.jsx(O,{className:"h-5 w-5 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.success?"Optimización exitosa":"Optimización fallida"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(s.timestamp).toLocaleString()}),s.options.length>0&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Opciones: ",s.options.join(", ")]})]})]}),e.jsxs(x,{variant:s.success?"default":"destructive",children:["Código: ",s.exit_code]})]},t)),N.length===0&&e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No hay historial de optimizaciones disponible"})]})})]})})]})]})})]})}export{Se as default};
