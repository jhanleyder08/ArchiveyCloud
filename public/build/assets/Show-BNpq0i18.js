import{r as A,j as e,a as h,L as g,H as L}from"./app-BAaRFKCE.js";import{A as R,F as H}from"./app-layout-BkZKgO0H.js";import{b as _,B as d}from"./app-logo-icon-CRu_6WDm.js";import{B as j}from"./badge-CYpmu6Aj.js";import{C as r,a as o,b as m,d as c,c as N}from"./card-CrHy-fHD.js";import{T as $,a as B,b as f,c as u}from"./tabs-BxZhJoWE.js";import{T as V,a as M,b as v,c as n,d as z,e as l}from"./table-BCtbQZAz.js";import{C as I,a as p}from"./circle-check-big-C4SeEZDM.js";import{E as q}from"./eye-Ca9RHTLD.js";import{C as F}from"./clock-B-h1W_zW.js";import{A as G}from"./arrow-left-Bo6AaNur.js";import{S as y}from"./square-pen-D0qhqqDk.js";import{T as U}from"./trash-2-DgMOpCcU.js";import{B as b,H as O}from"./hash-BdiV7mzO.js";import{U as P}from"./user-DygkRlK4.js";/* empty css            */import"./index-D2AugiGI.js";import"./index-DZ-wJQli.js";import"./index-B8KDMt0s.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],K=_("Calendar",J);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],W=_("History",Q),X={draft:{label:"Borrador",color:"bg-gray-100 text-gray-800",icon:F},active:{label:"Activa",color:"bg-green-100 text-green-800",icon:p},archived:{label:"Archivada",color:"bg-blue-100 text-blue-800",icon:q},obsolete:{label:"Obsoleta",color:"bg-red-100 text-red-800",icon:I}},Y={conservation_total:{label:"CT",color:"bg-green-100 text-green-800",description:"Conservación Total"},selection:{label:"S",color:"bg-yellow-100 text-yellow-800",description:"Selección"},elimination:{label:"E",color:"bg-red-100 text-red-800",description:"Eliminación"}};function ue({trd:s}){const[w,T]=A.useState("structure");X[s.status].icon;const C=()=>{confirm(`¿Está seguro de eliminar la TRD "${s.name}"?`)&&h.delete(`/trd/${s.id}`)},D=()=>{confirm(`¿Está seguro de aprobar la TRD "${s.name}"?`)&&h.post(`/trd/${s.id}/approve`)},S=a=>{confirm("¿Está seguro de restaurar esta versión? Se perderán los cambios actuales.")&&h.post(`/trd/${s.id}/restore-version/${a}`)},E=()=>s.sections.reduce((a,i)=>a+i.series.reduce((t,x)=>t+x.subseries.length,0),0);return e.jsxs(R,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(d,{variant:"ghost",size:"sm",onClick:()=>h.get("/trd"),children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Volver"]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Código: ",s.code," • Versión ",s.version]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[s.status==="draft"&&e.jsxs(d,{variant:"default",size:"sm",onClick:D,className:"text-white bg-green-600 hover:bg-green-700",children:[e.jsx(p,{className:"w-4 h-4 mr-2"}),"Aprobar"]}),e.jsx(g,{href:`/trd/${s.id}/edit`,children:e.jsxs(d,{variant:"outline",size:"sm",children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"Editar"]})}),e.jsxs(d,{variant:"destructive",size:"sm",onClick:C,children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Eliminar"]})]})]}),e.jsx(L,{title:`TRD - ${s.name}`}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs(r,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Total Secciones"}),e.jsx(b,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(c,{children:e.jsx("div",{className:"text-2xl font-bold",children:s.sections.length})})]}),e.jsxs(r,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Total Series"}),e.jsx(H,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(c,{children:e.jsx("div",{className:"text-2xl font-bold",children:s.sections.reduce((a,i)=>a+i.series.length,0)})})]}),e.jsxs(r,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Total Subseries"}),e.jsx(O,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(c,{children:e.jsx("div",{className:"text-2xl font-bold",children:E()})})]})]}),e.jsxs(r,{className:"mb-6",children:[e.jsx(o,{children:e.jsx(m,{children:"Información General"})}),e.jsx(c,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Entidad"}),e.jsx("p",{className:"font-medium",children:s.entity_name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.entity_code})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Creada por"}),e.jsx("p",{className:"font-medium",children:s.creator.name}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(s.created_at).toLocaleDateString()})]})]}),s.approver&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"w-4 h-4 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Aprobada por"}),e.jsx("p",{className:"font-medium",children:s.approver.name}),s.approval_date&&e.jsx("p",{className:"text-sm text-gray-500",children:new Date(s.approval_date).toLocaleDateString()})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[s.description&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Descripción"}),e.jsx("p",{className:"text-sm",children:s.description})]}),(s.effective_date||s.expiry_date)&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Vigencia"}),e.jsxs("p",{className:"text-sm",children:[s.effective_date?new Date(s.effective_date).toLocaleDateString():"N/A"," - ",s.expiry_date?new Date(s.expiry_date).toLocaleDateString():"Indefinida"]})]})]})]})]})})]}),e.jsxs($,{value:w,onValueChange:T,children:[e.jsxs(B,{className:"grid w-full grid-cols-2",children:[e.jsx(f,{value:"structure",children:"Estructura TRD"}),e.jsxs(f,{value:"versions",children:["Historial de Versiones (",s.versions.length,")"]})]}),e.jsx(u,{value:"structure",className:"space-y-6",children:s.sections.length>0?s.sections.map(a=>e.jsxs(r,{children:[e.jsxs(o,{children:[e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(j,{variant:"outline",children:a.section_code}),a.section_name]}),a.description&&e.jsx(N,{children:a.description})]}),e.jsx(c,{children:a.series.length>0?e.jsx("div",{className:"space-y-6",children:a.series.map(i=>e.jsxs("div",{className:"border-l-2 border-gray-200 pl-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(j,{variant:"secondary",children:i.series_code}),e.jsx("span",{className:"font-medium",children:i.series_name})]}),i.description&&e.jsx("p",{className:"text-sm text-gray-600",children:i.description})]}),i.subseries.length>0&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(V,{children:[e.jsx(M,{children:e.jsxs(v,{children:[e.jsx(n,{children:"Código"}),e.jsx(n,{children:"Subserie"}),e.jsx(n,{children:"Tipo Documental"}),e.jsx(n,{className:"text-center",children:"AG"}),e.jsx(n,{className:"text-center",children:"AC"}),e.jsx(n,{className:"text-center",children:"Total"}),e.jsx(n,{className:"text-center",children:"Disposición"})]})}),e.jsx(z,{children:i.subseries.map(t=>{const x=Y[t.final_disposition],k=t.retention_archive_management+t.retention_central_archive;return e.jsxs(v,{children:[e.jsx(l,{className:"font-mono text-sm",children:t.subseries_code}),e.jsx(l,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.subseries_name}),t.description&&e.jsx("div",{className:"text-sm text-gray-500",children:t.description})]})}),e.jsx(l,{children:t.document_type}),e.jsxs(l,{className:"text-center",children:[t.retention_archive_management," años"]}),e.jsxs(l,{className:"text-center",children:[t.retention_central_archive," años"]}),e.jsxs(l,{className:"text-center font-medium",children:[k," años"]}),e.jsx(l,{className:"text-center",children:e.jsx(j,{variant:"secondary",className:x.color,title:x.description,children:x.label})})]},t.id)})})]})})]},i.id))}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No hay series documentales definidas para esta sección."})})]},a.id)):e.jsx(r,{children:e.jsxs(c,{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-500 mb-4",children:"Esta TRD no tiene estructura definida aún."}),e.jsx(g,{href:`/trd/${s.id}/edit`,children:e.jsxs(d,{children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"Editar Estructura"]})})]})})}),e.jsx(u,{value:"versions",className:"space-y-4",children:s.versions.length>0?s.versions.map(a=>e.jsxs(r,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4"}),"Versión ",a.version]}),e.jsxs(N,{children:[a.creator.name," • ",new Date(a.created_at).toLocaleString()]})]}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>S(a.id),children:"Restaurar"})]})}),e.jsxs(c,{children:[a.change_notes&&e.jsx("p",{className:"text-sm mb-2",children:a.change_notes}),a.changes_summary&&e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Resumen:"})," ",a.changes_summary.summary||a.changes_summary.action]})]})]},a.id)):e.jsx(r,{children:e.jsx(c,{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"No hay versiones anteriores disponibles."})})})})]})]})})]})}export{ue as default};
