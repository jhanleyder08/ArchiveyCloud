import{r as V,j as e,H as I,L as d,b as v}from"./app-1TbR1aNv.js";import{A as H}from"./app-layout-DBvULR4o.js";import{c as E,B as i}from"./button-Bh8HL4t-.js";import{C as r,c as l,a as h,b as j,d as C}from"./card-CjIDma1Z.js";import{B as c}from"./badge-CahYhPrs.js";import{S as D}from"./separator-COG6xVkr.js";import{k as L,l as p,m as g,n as u,D as B,a as O,b as J,c as P,d as Z,e as U}from"./app-sidebar-layout-EVqXnw4l.js";import{A as G,a as K}from"./alert-a9IGCIbG.js";import{A as Q}from"./arrow-left-D4dywRtW.js";import{T,a as W}from"./toggle-right-ChKXFhDs.js";import{C as X}from"./copy-BLUnPt4a.js";import{S as k}from"./square-pen-T6F7AT2X.js";import{T as Y}from"./trash-2-CJKPg-zO.js";import{C as _}from"./circle-alert-IdL8hEBm.js";import{F as N}from"./folder-open-YGwzUevR.js";import{F as b}from"./Combination-Bg4lGtaS.js";import{C as ee}from"./calendar-CgCzJ12r.js";import{C as S}from"./folder-BrHeBlTR.js";import{C as y}from"./check-BetP237p.js";/* empty css            */import"./index-DV8Rt-0p.js";import"./index-DaDMCySO.js";import"./index-12rucE5D.js";import"./x-BA_bLoEE.js";import"./index-B37z7FM4.js";import"./app-logo-icon-D5sKSL8w.js";import"./input-B9S_DJNe.js";import"./label-CB51Zwfa.js";import"./user-Eo78Nm40.js";import"./mail-Dw8iYVcL.js";import"./users-KtdTbN4b.js";import"./triangle-alert-Csu15FGV.js";import"./search-BY4VdWrh.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M12 18v-4",key:"q1q25u"}],["path",{d:"M16 18v-6",key:"15y0np"}]],A=E("FileChartColumnIncreasing",se);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],ie=E("FileDown",ae),re=[{title:"Dashboard",href:"/dashboard"},{title:"Administración",href:"#"},{title:"Tablas de Retención Documental",href:"/admin/trd"},{title:"Detalle TRD",href:"#"}];function Ve({trd:s,versiones:n,estadisticas:o,tieneDocumentosAsociados:w}){const[R,m]=V.useState(!1),z=()=>{v.delete(`/admin/trd/${s.id}`,{onFinish:()=>m(!1)})},M=()=>{v.patch(`/admin/trd/${s.id}/vigencia`,{},{preserveScroll:!0})},F=()=>{v.post(`/admin/trd/${s.id}/duplicate`)},$=a=>{window.open(`/admin/trd/${s.id}/export?formato=${a}`,"_blank")},x=a=>new Date(a).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),f=a=>{const t={borrador:{color:"bg-gray-100 text-gray-800",icon:k},revision:{color:"bg-yellow-100 text-yellow-800",icon:S},aprobada:{color:"bg-green-100 text-green-800",icon:y},vigente:{color:"bg-blue-100 text-blue-800",icon:y},historica:{color:"bg-purple-100 text-purple-800",icon:A}}[a]||{color:"bg-gray-100 text-gray-800",icon:_},q=t.icon;return e.jsxs(c,{className:`${t.color} font-medium flex items-center gap-1`,children:[e.jsx(q,{className:"h-3 w-3"}),a.charAt(0).toUpperCase()+a.slice(1)]})};return e.jsxs(H,{breadcrumbs:re,children:[e.jsx(I,{title:`${s.nombre} - Detalle TRD`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(d,{href:"/admin/trd",children:e.jsxs(i,{variant:"outline",size:"sm",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Volver"]})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s.nombre}),f(s.estado),s.vigente&&e.jsxs(c,{className:"bg-blue-100 text-blue-800 font-medium flex items-center gap-1",children:[e.jsx(T,{className:"h-3 w-3"}),"Vigente"]})]}),e.jsxs("p",{className:"text-gray-600",children:[s.codigo," • Versión ",s.version," • ",s.identificador_unico]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(L,{children:[e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsx(i,{variant:"outline",size:"sm",onClick:()=>$("json"),children:e.jsx(ie,{className:"h-4 w-4"})})}),e.jsx(u,{children:e.jsx("p",{children:"Exportar TRD"})})]}),e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsx(i,{variant:"outline",size:"sm",onClick:F,children:e.jsx(X,{className:"h-4 w-4"})})}),e.jsx(u,{children:e.jsx("p",{children:"Duplicar TRD"})})]}),e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsx(i,{variant:"outline",size:"sm",onClick:M,disabled:s.estado!=="aprobada"&&!s.vigente,children:s.vigente?e.jsx(T,{className:"h-4 w-4 text-green-600"}):e.jsx(W,{className:"h-4 w-4"})})}),e.jsx(u,{children:e.jsx("p",{children:s.vigente?"Desmarcar vigente":"Marcar vigente"})})]}),e.jsx(d,{href:`/admin/trd/${s.id}/edit`,children:e.jsx(i,{variant:"outline",size:"sm",children:e.jsx(k,{className:"h-4 w-4"})})}),e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsx(i,{variant:"outline",size:"sm",onClick:()=>m(!0),className:"text-red-600 hover:text-red-700",children:e.jsx(Y,{className:"h-4 w-4"})})}),e.jsx(u,{children:e.jsx("p",{children:"Eliminar TRD"})})]})]})})]}),w&&e.jsxs(G,{className:"border-yellow-200 bg-yellow-50",children:[e.jsx(_,{className:"h-4 w-4"}),e.jsxs(K,{className:"text-yellow-800",children:[e.jsx("strong",{children:"Esta TRD tiene documentos asociados."})," Cualquier modificación debe considerar el impacto en los documentos existentes."]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(r,{children:e.jsx(l,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-blue-100 rounded-full p-2",children:e.jsx(N,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Series"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.series_count})]})]})})}),e.jsx(r,{children:e.jsx(l,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-green-100 rounded-full p-2",children:e.jsx(N,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Subseries"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.subseries_count})]})]})})}),e.jsx(r,{children:e.jsx(l,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-purple-100 rounded-full p-2",children:e.jsx(A,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Expedientes"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.expedientes_count})]})]})})}),e.jsx(r,{children:e.jsx(l,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-orange-100 rounded-full p-2",children:e.jsx(b,{className:"h-6 w-6 text-orange-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Documentos"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.documentos_count})]})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(r,{children:[e.jsx(h,{children:e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-5 w-5 text-[#2a3d83]"}),"Información de la TRD"]})}),e.jsxs(l,{className:"space-y-4",children:[s.descripcion&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Descripción"}),e.jsx("p",{className:"text-gray-600 leading-relaxed",children:s.descripcion})]}),s.justificacion&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Justificación"}),e.jsx("p",{className:"text-gray-600 leading-relaxed",children:s.justificacion})]}),e.jsx(D,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Formato de Archivo"}),e.jsx("p",{className:"text-gray-600",children:s.formato_archivo||"No especificado"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Estado Actual"}),e.jsx("div",{className:"flex items-center gap-2",children:f(s.estado)})]})]}),s.metadatos_asociados&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Metadatos Asociados"}),e.jsx("pre",{className:"bg-gray-50 p-3 rounded-md text-sm font-mono overflow-x-auto",children:JSON.stringify(s.metadatos_asociados,null,2)})]})]})]}),e.jsxs(r,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(N,{className:"h-5 w-5 text-[#2a3d83]"}),"Series Documentales"]}),e.jsxs(C,{children:["Series asociadas a esta TRD (",s.series?.length||0,")"]})]}),e.jsx(d,{href:`/admin/series?trd=${s.id}`,children:e.jsx(i,{variant:"outline",size:"sm",children:"Ver todas"})})]}),e.jsx(l,{children:s.series&&s.series.length>0?e.jsx("div",{className:"space-y-3",children:s.series.map(a=>e.jsxs(d,{href:`/admin/series/${a.id}`,className:"block border rounded-lg p-4 hover:bg-gray-50 hover:border-[#2a3d83] transition-all cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4 text-purple-600"}),e.jsx("h4",{className:"font-medium text-gray-900 hover:text-[#2a3d83]",children:a.nombre})]}),e.jsx(c,{variant:"outline",className:"bg-purple-50",children:a.codigo})]}),a.subseries&&a.subseries.length>0&&e.jsxs("div",{className:"ml-6 mt-2",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:["Subseries (",a.subseries.length,"):"]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.subseries.slice(0,5).map(t=>e.jsxs(c,{variant:"secondary",className:"text-xs",children:[t.codigo," - ",t.nombre]},t.id)),a.subseries.length>5&&e.jsxs(c,{variant:"secondary",className:"text-xs",children:["+",a.subseries.length-5," más"]})]})]})]},a.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(N,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No hay series asociadas a esta TRD"}),e.jsx(d,{href:"/admin/series/create",children:e.jsx(i,{variant:"outline",size:"sm",className:"mt-3",children:"Crear Serie"})})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(r,{children:[e.jsx(h,{children:e.jsx(j,{className:"text-lg",children:"Información del Sistema"})}),e.jsxs(l,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ee,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Creado"}),e.jsx("p",{className:"text-sm text-gray-600",children:x(s.created_at)}),s.creador&&e.jsxs("p",{className:"text-xs text-gray-500",children:["por ",s.creador.name]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Última Actualización"}),e.jsx("p",{className:"text-sm text-gray-600",children:x(s.fecha_actualizacion)}),s.modificador&&e.jsxs("p",{className:"text-xs text-gray-500",children:["por ",s.modificador.name]})]})]}),s.fecha_aprobacion&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{className:"h-4 w-4 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Aprobado"}),e.jsx("p",{className:"text-sm text-gray-600",children:x(s.fecha_aprobacion)})]})]}),e.jsx(D,{}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"ID Único"}),e.jsx("p",{className:"text-xs font-mono text-gray-600 bg-gray-50 px-2 py-1 rounded",children:s.identificador_unico})]})]})]}),n.length>1&&e.jsxs(r,{children:[e.jsxs(h,{children:[e.jsx(j,{className:"text-lg",children:"Historial de Versiones"}),e.jsxs(C,{children:[n.length," versiones disponibles"]})]}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-3",children:[n.slice(0,5).map(a=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded border",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:["v",a.version]}),e.jsx("p",{className:"text-xs text-gray-500",children:x(a.created_at)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[f(a.estado),a.vigente&&e.jsx(c,{variant:"secondary",className:"text-xs",children:"Vigente"})]})]},a.id)),n.length>5&&e.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["+",n.length-5," versiones más"]})]})})]})]})]}),e.jsx(B,{open:R,onOpenChange:m,children:e.jsxs(O,{children:[e.jsxs(J,{children:[e.jsx(P,{children:"Confirmar Eliminación"}),e.jsxs(Z,{children:['¿Estás seguro de que deseas eliminar la TRD "',s.nombre,'"? Esta acción no se puede deshacer.',w&&e.jsxs("div",{className:"mt-2 p-2 bg-red-50 border border-red-200 rounded",children:[e.jsx("strong",{className:"text-red-800",children:"Advertencia:"})," Esta TRD tiene documentos asociados."]})]})]}),e.jsxs(U,{children:[e.jsx(i,{type:"button",variant:"outline",onClick:()=>m(!1),children:"Cancelar"}),e.jsx(i,{type:"button",variant:"destructive",onClick:z,children:"Eliminar"})]})]})})]})]})}export{Ve as default};
