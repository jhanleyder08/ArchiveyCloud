import{j as e,H as S,L as v}from"./app-xP5nJVeF.js";import{f as E,A as D}from"./app-sidebar-layout-Bv9w89yC.js";import{B as b}from"./button-B_iUXIQd.js";import{C as c,a as i,b as l,c as t,d as H}from"./card-CWOinnut.js";import{B as n,F as L}from"./Combination-BMQq9fx8.js";import{T as k,a as B,b as m,c as h}from"./tabs-BrUZeGY9.js";import{T as I,a as U,b as w,c as d,d as q,e as o}from"./table-B_nFRheg.js";import{A as u,a as g}from"./alert-BVrZsLZW.js";import{T as j,S as x}from"./triangle-alert-3Hg381hi.js";import{C as _}from"./folder-Ck8Tq3sH.js";import{A}from"./activity-DoFW7coy.js";import{U as F}from"./user-OU0Y1c1r.js";import{G as M}from"./globe-DGACAQ_Z.js";import{M as V}from"./monitor-BAhKDlvN.js";/* empty css            */import"./index-DbDMva29.js";import"./index-D2eHBSbe.js";import"./index-Blg4NNxt.js";import"./x-CBQbsaML.js";import"./app-logo-icon-8EdVYcX9.js";import"./input-DQqwP0kM.js";import"./label-CXywCScm.js";import"./mail-C5oL3AE1.js";import"./users-DpyCPIO9.js";import"./search-eio2uEn4.js";import"./BrandingProvider-BV5yFGOU.js";function he({evento:r,eventos_relacionados:f,analisis:s}){const p=a=>{switch(a){case"bloqueado":return"destructive";case"fallido":return"destructive";case"exitoso":return"secondary";default:return"outline"}},C=a=>{switch(a){case"bloqueado":return e.jsx(j,{className:"h-5 w-5 text-red-500"});case"fallido":return e.jsx(j,{className:"h-5 w-5 text-orange-500"});case"exitoso":return e.jsx(x,{className:"h-5 w-5 text-green-500"});default:return e.jsx(x,{className:"h-5 w-5 text-gray-500"})}},y=a=>new Date(a).toLocaleString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),N=a=>a?typeof a=="string"?a:JSON.stringify(a,null,2):"N/A";return e.jsxs(E,{children:[e.jsx(S,{title:`Evento de Auditoría #${r.id}`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(v,{href:route("admin.auditoria.index"),children:e.jsxs(b,{variant:"outline",size:"sm",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Volver a Auditoría"]})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight",children:["Evento de Auditoría #",r.id]}),e.jsx("p",{className:"text-muted-foreground",children:y(r.fecha_hora)})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[C(r.resultado),e.jsx(n,{variant:p(r.resultado),className:"text-base px-3 py-1",children:r.resultado.toUpperCase()})]})]}),(r.resultado==="bloqueado"||r.resultado==="fallido")&&e.jsxs(u,{variant:"destructive",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsxs(g,{children:[e.jsx("strong",{children:"¡Evento Crítico!"})," Este evento requiere investigación inmediata debido a su alto nivel de riesgo para la seguridad del sistema."]})]}),!s.contexto_temporal.es_horario_laboral&&e.jsxs(u,{children:[e.jsx(_,{className:"h-4 w-4"}),e.jsxs(g,{children:[e.jsx("strong",{children:"Horario Inusual:"})," Este evento ocurrió fuera del horario laboral (",s.contexto_temporal.horario," del ",s.contexto_temporal.dia_semana,")."]})]}),e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(A,{className:"h-5 w-5"}),e.jsx("span",{children:"Información del Evento"})]})}),e.jsx(t,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Acción Realizada"}),e.jsx("p",{className:"text-lg font-semibold",children:r.accion.replace("_"," ")}),e.jsx("p",{className:"text-gray-600",children:r.descripcion})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Usuario"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:r.usuario?.name||"Sistema"}),e.jsx("p",{className:"text-sm text-gray-500",children:r.usuario?.email})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Modelo Afectado"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"font-medium",children:r.modelo||"N/A"})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Categoría: ",s.categoria]})]})]})})]}),e.jsxs(k,{defaultValue:"contexto",className:"space-y-4",children:[e.jsxs(B,{children:[e.jsx(m,{value:"contexto",children:"Contexto"}),e.jsx(m,{value:"tecnico",children:"Información Técnica"}),e.jsx(m,{value:"relacionados",children:"Eventos Relacionados"}),e.jsx(m,{value:"analisis",children:"Análisis"})]}),e.jsx(h,{value:"contexto",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(M,{className:"h-5 w-5"}),e.jsx("span",{children:"Contexto Geográfico"})]})}),e.jsxs(t,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Dirección IP:"}),e.jsx("span",{className:"font-mono",children:s.contexto_geografico.ip})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"País:"}),e.jsx("span",{className:"font-medium",children:s.contexto_geografico.pais})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Ciudad:"}),e.jsx("span",{className:"font-medium",children:s.contexto_geografico.ciudad})]})]})]}),e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(_,{className:"h-5 w-5"}),e.jsx("span",{children:"Contexto Temporal"})]})}),e.jsxs(t,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Fecha y Hora:"}),e.jsx("span",{className:"font-medium",children:y(r.fecha_hora)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Día de la Semana:"}),e.jsx("span",{className:"font-medium",children:s.contexto_temporal.dia_semana})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Horario Laboral:"}),e.jsx(n,{variant:s.contexto_temporal.es_horario_laboral?"secondary":"destructive",children:s.contexto_temporal.es_horario_laboral?"Sí":"No"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Eventos Similares:"}),e.jsx("span",{className:"font-medium",children:s.eventos_similares})]})]})]})]})}),e.jsxs(h,{value:"tecnico",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(V,{className:"h-5 w-5"}),e.jsx("span",{children:"Información del Dispositivo"})]})}),e.jsxs(t,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Tipo de Dispositivo:"}),e.jsx("span",{className:"font-medium",children:s.contexto_tecnico.dispositivo})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Navegador:"}),e.jsx("span",{className:"font-medium",children:s.contexto_tecnico.navegador})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"text-gray-600 block mb-2",children:"User Agent:"}),e.jsx("div",{className:"bg-gray-50 p-3 rounded text-xs font-mono break-all",children:s.contexto_tecnico.user_agent})]})]})]}),e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(x,{className:"h-5 w-5"}),e.jsx("span",{children:"Datos Técnicos"})]})}),e.jsxs(t,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Hash de Integridad:"}),e.jsxs("span",{className:"font-mono text-xs",children:[r.hash_integridad?.substring(0,16),"..."]})]}),r.contexto_adicional&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 block mb-2",children:"Contexto Adicional:"}),e.jsx("div",{className:"bg-gray-50 p-3 rounded",children:e.jsx("pre",{className:"text-xs overflow-x-auto",children:N(r.contexto_adicional)})})]})]})]})]}),r.detalles&&e.jsxs(c,{children:[e.jsx(i,{children:e.jsx(l,{children:"Detalles del Evento"})}),e.jsx(t,{children:e.jsx("div",{className:"bg-gray-50 p-4 rounded",children:e.jsx("pre",{className:"text-sm overflow-x-auto",children:N(r.detalles)})})})]}),r.metadatos_cambios&&e.jsxs(c,{children:[e.jsx(i,{children:e.jsx(l,{children:"Metadatos de Cambios"})}),e.jsx(t,{children:e.jsx("div",{className:"bg-gray-50 p-4 rounded",children:e.jsx("pre",{className:"text-sm overflow-x-auto",children:N(r.metadatos_cambios)})})})]})]}),e.jsx(h,{value:"relacionados",className:"space-y-4",children:e.jsxs(c,{children:[e.jsxs(i,{children:[e.jsx(l,{children:"Eventos Relacionados"}),e.jsx(H,{children:"Eventos del mismo usuario en un período cercano (±2 horas)"})]}),e.jsx(t,{children:f.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(I,{children:[e.jsx(U,{children:e.jsxs(w,{children:[e.jsx(d,{children:"Fecha/Hora"}),e.jsx(d,{children:"Acción"}),e.jsx(d,{children:"Descripción"}),e.jsx(d,{children:"Riesgo"}),e.jsx(d,{children:"Acciones"})]})}),e.jsx(q,{children:f.map(a=>e.jsxs(w,{children:[e.jsx(o,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{children:new Date(a.fecha_hora).toLocaleDateString()}),e.jsx("div",{className:"text-gray-500",children:new Date(a.fecha_hora).toLocaleTimeString()})]})}),e.jsx(o,{className:"font-medium",children:a.accion.replace("_"," ")}),e.jsx(o,{children:e.jsx("div",{className:"max-w-xs truncate",title:a.descripcion,children:a.descripcion})}),e.jsx(o,{children:e.jsx(n,{variant:p(a.nivel_riesgo),children:a.nivel_riesgo})}),e.jsx(o,{children:e.jsx(v,{href:route("admin.auditoria.show",a.id),children:e.jsx(b,{variant:"outline",size:"sm",children:"Ver"})})})]},a.id))})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay eventos relacionados"}),e.jsx("p",{className:"text-gray-600",children:"No se encontraron otros eventos del mismo usuario en el período cercano."})]})})]})}),e.jsx(h,{value:"analisis",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(j,{className:"h-5 w-5"}),e.jsx("span",{children:"Evaluación de Riesgo"})]})}),e.jsx(t,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Nivel de Riesgo:"}),e.jsx(n,{variant:p(s.nivel_riesgo),className:"text-base",children:s.nivel_riesgo?.toUpperCase()||"BAJO"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Categoría:"}),e.jsx("span",{className:"font-medium",children:s.categoria})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Eventos Similares (24h):"}),e.jsx(n,{variant:"outline",children:s.eventos_similares})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Horario Laboral:"}),e.jsx(n,{variant:s.contexto_temporal.es_horario_laboral?"secondary":"destructive",children:s.contexto_temporal.es_horario_laboral?"Sí":"No"})]})]})})]}),e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(x,{className:"h-5 w-5"}),e.jsx("span",{children:"Recomendaciones"})]})}),e.jsx(t,{children:s.recomendaciones.length>0?e.jsx("div",{className:"space-y-3",children:s.recomendaciones.map((a,T)=>e.jsx(u,{children:e.jsx(g,{children:a})},T))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(x,{className:"h-12 w-12 text-green-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Sin Recomendaciones"}),e.jsx("p",{className:"text-gray-600",children:"Este evento no requiere acciones adicionales en este momento."})]})})]})]})})]})]})]})}export{he as default};
