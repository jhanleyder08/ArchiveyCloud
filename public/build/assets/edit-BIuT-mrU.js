import{r as E,u as A,j as e,H as I,b as u}from"./app-b0OUUI0-.js";import{A as w}from"./app-layout-DeKj2h8p.js";import{B as v}from"./button-C5SprtSp.js";import{I as n}from"./input-DYsvI7DM.js";import{L as d}from"./label-Act4V2dc.js";import{F as L,T as g,t as _}from"./app-sidebar-layout-Du_H8so0.js";import{S as b,a as N,b as f,c as C,d as x}from"./select-B36fdiZM.js";import{C as l,a as c,b as o,c as m}from"./card-C-dhLez5.js";import{A as T,a as z}from"./alert-D1FzoLm-.js";import{A as k}from"./arrow-left-BW8JOXoF.js";import{I as V}from"./info-B9bQBmgk.js";import{T as $}from"./triangle-alert-DqEyKMhr.js";import{S as B}from"./save-zCHdMJjT.js";/* empty css            */import"./index-BEDrMoE5.js";import"./index-SQVXAgCN.js";import"./Combination-CoTaGX-7.js";import"./index-BonhS1CM.js";import"./x-DHJy9qDa.js";import"./index-DgUGDSx5.js";import"./app-logo-icon-cBcTQda_.js";import"./user-DxpkJXtI.js";import"./mail-B-2VlNI7.js";import"./users-CU3ZcRQu.js";import"./folder-BN9jgz4i.js";import"./search-C0-Sn5Ut.js";import"./index-gpDvmhMg.js";import"./check-Dr0AtvV6.js";function ue({ccd:s,opciones:h}){const[p,y]=E.useState(!1),{data:i,setData:t,put:D,processing:j,errors:r,reset:H}=A({codigo:s.codigo||"",nombre:s.nombre||"",descripcion:s.descripcion||"",entidad:s.entidad||"",dependencia:s.dependencia||"",nivel:s.nivel||1,padre_id:s.padre_id?.toString()||"",orden_jerarquico:s.orden_jerarquico||1,estado:s.estado||"borrador",activo:s.activo??!0,notas:s.notas||"",alcance:s.alcance||""}),F=[{title:"Inicio",href:"/dashboard"},{title:"Administración",href:"/admin"},{title:"CCD",href:"/admin/ccd"},{title:`Editar: ${s.codigo}`,href:`/admin/ccd/${s.id}/edit`}],q=a=>{a.preventDefault(),y(!0),D(`/admin/ccd/${s.id}`,{onSuccess:()=>{_.success("Cuadro de Clasificación Documental actualizado exitosamente"),u.visit("/admin/ccd")},onError:J=>{_.error("Error al actualizar el CCD. Revisa los campos marcados.")},onFinish:()=>{y(!1)}})},S=h.padres_disponibles?.filter(a=>a.nivel<i.nivel&&a.id!==s.id)||[];return e.jsxs(w,{breadcrumbs:F,children:[e.jsx(I,{title:`Editar CCD: ${s.codigo}`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(L,{className:"h-6 w-6 text-[#2a3d83]"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Editar Cuadro de Clasificación Documental"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Código: ",e.jsx("span",{className:"font-medium",children:s.codigo})]})]})]}),e.jsxs(v,{type:"button",variant:"outline",onClick:()=>u.visit("/admin/ccd"),className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-4 w-4"}),"Volver"]})]}),e.jsxs(T,{children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx(z,{children:"Modificando elemento del Cuadro de Clasificación Documental. Los cambios se aplicarán inmediatamente y pueden afectar la estructura jerárquica."})]}),e.jsxs("form",{onSubmit:q,className:"space-y-6",children:[e.jsxs(l,{children:[e.jsx(c,{children:e.jsx(o,{children:"Información Básica"})}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"codigo",children:"Código *"}),e.jsx(n,{id:"codigo",type:"text",value:i.codigo,onChange:a=>t("codigo",a.target.value),placeholder:"Ej: F.01, S.01.01",className:r.codigo?"border-red-500":"",required:!0}),r.codigo&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:r.codigo})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"nivel",children:"Nivel Jerárquico *"}),e.jsxs(b,{value:i.nivel.toString(),onValueChange:a=>{t("nivel",parseInt(a)),t("padre_id","")},children:[e.jsx(N,{id:"nivel",className:r.nivel?"border-red-500":"",children:e.jsx(f,{placeholder:"Seleccionar nivel"})}),e.jsx(C,{children:h.niveles.map(a=>e.jsx(x,{value:a.value,children:a.label},a.value))})]}),r.nivel&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:r.nivel})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"nombre",children:"Nombre *"}),e.jsx(n,{id:"nombre",type:"text",value:i.nombre,onChange:a=>t("nombre",a.target.value),placeholder:"Nombre descriptivo del CCD",className:r.nombre?"border-red-500":"",required:!0}),r.nombre&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:r.nombre})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"descripcion",children:"Descripción"}),e.jsx(g,{id:"descripcion",value:i.descripcion,onChange:a=>t("descripcion",a.target.value),placeholder:"Descripción detallada del elemento",rows:3,className:r.descripcion?"border-red-500":""}),r.descripcion&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:r.descripcion})]})]})]}),e.jsxs(l,{children:[e.jsx(c,{children:e.jsx(o,{children:"Información Organizacional"})}),e.jsx(m,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"entidad",children:"Entidad *"}),e.jsx(n,{id:"entidad",type:"text",value:i.entidad,onChange:a=>t("entidad",a.target.value),placeholder:"Nombre de la entidad",className:r.entidad?"border-red-500":"",required:!0}),r.entidad&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:r.entidad})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"dependencia",children:"Dependencia"}),e.jsx(n,{id:"dependencia",type:"text",value:i.dependencia,onChange:a=>t("dependencia",a.target.value),placeholder:"Dependencia responsable",className:r.dependencia?"border-red-500":""}),r.dependencia&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:r.dependencia})]})]})})]}),e.jsxs(l,{children:[e.jsx(c,{children:e.jsx(o,{children:"Estructura Jerárquica"})}),e.jsx(m,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"padre_id",children:"Elemento Padre"}),e.jsxs(b,{value:i.padre_id,onValueChange:a=>t("padre_id",a),children:[e.jsx(N,{id:"padre_id",className:r.padre_id?"border-red-500":"",children:e.jsx(f,{placeholder:"Sin elemento padre (raíz)"})}),e.jsxs(C,{children:[e.jsx(x,{value:"null",children:"Sin elemento padre (raíz)"}),S.map(a=>e.jsxs(x,{value:a.id.toString(),children:[a.codigo," - ",a.nombre]},a.id))]})]}),r.padre_id&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:r.padre_id}),i.nivel>1&&S.length===0&&e.jsxs("p",{className:"text-sm text-amber-600 mt-1",children:[e.jsx($,{className:"h-4 w-4 inline mr-1"}),"No hay elementos padre disponibles para este nivel"]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"orden_jerarquico",children:"Orden Jerárquico"}),e.jsx(n,{id:"orden_jerarquico",type:"number",min:"1",value:i.orden_jerarquico,onChange:a=>t("orden_jerarquico",parseInt(a.target.value)||1),className:r.orden_jerarquico?"border-red-500":""}),r.orden_jerarquico&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:r.orden_jerarquico})]})]})})]}),e.jsxs(l,{children:[e.jsx(c,{children:e.jsx(o,{children:"Configuración y Notas"})}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"estado",children:"Estado *"}),e.jsxs(b,{value:i.estado,onValueChange:a=>t("estado",a),children:[e.jsx(N,{id:"estado",className:r.estado?"border-red-500":"",children:e.jsx(f,{})}),e.jsx(C,{children:h.estados.map(a=>e.jsx(x,{value:a.value,children:a.label},a.value))})]}),r.estado&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:r.estado})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{id:"activo",type:"checkbox",checked:i.activo,onChange:a=>t("activo",a.target.checked),className:"rounded border-gray-300"}),e.jsx(d,{htmlFor:"activo",children:"Elemento Activo"})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"alcance",children:"Alcance"}),e.jsx(g,{id:"alcance",value:i.alcance,onChange:a=>t("alcance",a.target.value),placeholder:"Alcance y cobertura del elemento",rows:2,className:r.alcance?"border-red-500":""}),r.alcance&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:r.alcance})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"notas",children:"Notas"}),e.jsx(g,{id:"notas",value:i.notas,onChange:a=>t("notas",a.target.value),placeholder:"Notas adicionales y observaciones",rows:3,className:r.notas?"border-red-500":""}),r.notas&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:r.notas})]})]})]}),e.jsxs(l,{children:[e.jsx(c,{children:e.jsx(o,{children:"Información de Auditoría"})}),e.jsx(m,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx(d,{className:"text-gray-500",children:"Fecha de Creación"}),e.jsx("p",{children:new Date(s.created_at).toLocaleString("es-ES")})]}),e.jsxs("div",{children:[e.jsx(d,{className:"text-gray-500",children:"Última Modificación"}),e.jsx("p",{children:new Date(s.updated_at).toLocaleString("es-ES")})]})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-6",children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>u.visit("/admin/ccd"),disabled:j||p,children:"Cancelar"}),e.jsxs(v,{type:"submit",disabled:j||p,className:"bg-[#2a3d83] hover:bg-[#1e2b5f] flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),j||p?"Guardando...":"Actualizar CCD"]})]})]})]})]})}export{ue as default};
