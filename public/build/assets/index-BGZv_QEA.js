import{r as H,j as e,H as M,L as g,a as v}from"./app-B-PXR1Ni.js";import{A as P,S as f,a as C,c as U,p as z,C as F}from"./app-sidebar-layout-D9ulO2li.js";import{c as q,B as x}from"./app-logo-icon-BLsuM4IN.js";import{C as d,d as n,a as y,b,c as G}from"./card-Dmlm_cpt.js";import{I as K}from"./label-CcIhawib.js";import{S as m,a as h,b as p,c as j,d as a}from"./select-B6s0-YwG.js";import{B as w}from"./badge-CNo-IL5x.js";import{T as O,a as X,b as T,c as t,d as $,e as c}from"./table-DYV7DOqP.js";import{R as J}from"./refresh-cw-3XorCIzG.js";import{C as _}from"./circle-check-big-vwlwSDoT.js";import{C as S}from"./circle-x-D_Rev0Iw.js";import{F as Q}from"./filter-CRdJDhgp.js";/* empty css            */import"./index-DsJw0RIA.js";import"./index-DARluDlH.js";import"./index-CQZ_TJph.js";import"./check-BUuVkhmq.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],V=q("CirclePlus",W);function ve({certificados:l,estadisticas:o,usuarios:A,filtros:i}){const[Y,N]=H.useState(!1),D=s=>{switch(s){case"activo":return"default";case"vencido":return"destructive";case"revocado":return"secondary";case"suspendido":return"outline";default:return"secondary"}},B=s=>s.estado==="revocado"?e.jsx(S,{className:"h-4 w-4 text-red-500"}):s.vigente?s.proximo_a_vencer?e.jsx(F,{className:"h-4 w-4 text-yellow-500"}):e.jsx(_,{className:"h-4 w-4 text-green-500"}):e.jsx(C,{className:"h-4 w-4 text-orange-500"}),I=s=>({usuario:"Usuario",servidor:"Servidor",autoridad_certificadora:"Autoridad CA",sello_tiempo:"Sello de Tiempo"})[s]||s,u=(s,r)=>{const E=route("admin.certificados.index",{...i,[s]:r==="all"?"":r,page:1});v.get(E)},L=s=>{const r=route("admin.certificados.index",{...i,buscar:s,page:1});v.get(r)},k=(s,r)=>{N(!0),window.location.href=route("admin.certificados.descargar",{certificado:s,formato:r}),setTimeout(()=>N(!1),2e3)},R=()=>{v.reload()};return e.jsxs(P,{children:[e.jsx(M,{title:"Certificados Digitales"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Certificados Digitales"}),e.jsx("p",{className:"text-muted-foreground",children:"Gestión y administración de certificados digitales PKI"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(x,{variant:"outline",size:"sm",onClick:R,children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Actualizar"]}),e.jsx(g,{href:route("admin.certificados.create"),children:e.jsxs(x,{children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Nuevo Certificado"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(d,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(f,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Certificados"}),e.jsx("p",{className:"text-2xl font-bold",children:o.total})]})]})})}),e.jsx(d,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(_,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Activos"}),e.jsx("p",{className:"text-2xl font-bold",children:o.activos})]})]})})}),e.jsx(d,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{className:"h-8 w-8 text-orange-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Próximos a Vencer"}),e.jsx("p",{className:"text-2xl font-bold",children:o.proximos_vencer})]})]})})}),e.jsx(d,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(S,{className:"h-8 w-8 text-red-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Vencidos/Revocados"}),e.jsx("p",{className:"text-2xl font-bold",children:o.vencidos+o.revocados})]})]})})})]}),e.jsxs(d,{children:[e.jsx(y,{children:e.jsxs(b,{className:"flex items-center",children:[e.jsx(Q,{className:"h-5 w-5 mr-2"}),"Filtros de Búsqueda"]})}),e.jsx(n,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Búsqueda"}),e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(K,{placeholder:"Buscar certificados...",defaultValue:i.buscar,className:"pl-9",onChange:s=>{clearTimeout(window.searchTimeout),window.searchTimeout=setTimeout(()=>{L(s.target.value)},500)}})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Estado"}),e.jsxs(m,{value:i.estado||"all",onValueChange:s=>u("estado",s),children:[e.jsx(h,{children:e.jsx(p,{placeholder:"Todos los estados"})}),e.jsxs(j,{children:[e.jsx(a,{value:"all",children:"Todos los estados"}),e.jsx(a,{value:"activo",children:"Activo"}),e.jsx(a,{value:"vencido",children:"Vencido"}),e.jsx(a,{value:"revocado",children:"Revocado"}),e.jsx(a,{value:"suspendido",children:"Suspendido"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Tipo"}),e.jsxs(m,{value:i.tipo_certificado||"all",onValueChange:s=>u("tipo_certificado",s),children:[e.jsx(h,{children:e.jsx(p,{placeholder:"Todos los tipos"})}),e.jsxs(j,{children:[e.jsx(a,{value:"all",children:"Todos los tipos"}),e.jsx(a,{value:"usuario",children:"Usuario"}),e.jsx(a,{value:"servidor",children:"Servidor"}),e.jsx(a,{value:"autoridad_certificadora",children:"Autoridad CA"}),e.jsx(a,{value:"sello_tiempo",children:"Sello de Tiempo"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Usuario"}),e.jsxs(m,{value:i.usuario_id||"all",onValueChange:s=>u("usuario_id",s),children:[e.jsx(h,{children:e.jsx(p,{placeholder:"Todos los usuarios"})}),e.jsxs(j,{children:[e.jsx(a,{value:"all",children:"Todos los usuarios"}),A.map(s=>e.jsx(a,{value:s.id.toString(),children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Vencimiento"}),e.jsxs(m,{value:i.vencimiento||"all",onValueChange:s=>u("vencimiento",s),children:[e.jsx(h,{children:e.jsx(p,{placeholder:"Todos"})}),e.jsxs(j,{children:[e.jsx(a,{value:"all",children:"Todos"}),e.jsx(a,{value:"vigentes",children:"Vigentes"}),e.jsx(a,{value:"proximos_vencer",children:"Próximos a vencer"}),e.jsx(a,{value:"vencidos",children:"Vencidos"})]})]})]})]})})]}),e.jsxs(d,{children:[e.jsxs(y,{children:[e.jsxs(b,{children:["Certificados Digitales (",l.meta?.total||0,")"]}),e.jsxs(G,{children:["Mostrando ",l.meta?.from||0," a ",l.meta?.to||0," de ",l.meta?.total||0," certificados"]})]}),e.jsxs(n,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(O,{children:[e.jsx(X,{children:e.jsxs(T,{children:[e.jsx(t,{children:"Estado"}),e.jsx(t,{children:"Certificado"}),e.jsx(t,{children:"Usuario"}),e.jsx(t,{children:"Tipo"}),e.jsx(t,{children:"Algoritmo"}),e.jsx(t,{children:"Vencimiento"}),e.jsx(t,{children:"Acciones"})]})}),e.jsx($,{children:l.data.map(s=>e.jsxs(T,{children:[e.jsx(c,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[B(s),e.jsx(w,{variant:D(s.estado),children:s.estado})]})}),e.jsx(c,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.nombre_certificado}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Serie: ",s.numero_serie.slice(0,16),"..."]})]})}),e.jsx(c,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.usuario.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.usuario.email})]})}),e.jsx(c,{children:e.jsx(w,{variant:"outline",children:I(s.tipo_certificado)})}),e.jsx(c,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{children:s.algoritmo_firma}),e.jsxs("div",{className:"text-gray-500",children:[s.longitud_clave," bits"]})]})}),e.jsx(c,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{children:new Date(s.fecha_vencimiento).toLocaleDateString()}),s.vigente&&e.jsxs("div",{className:`text-xs ${s.proximo_a_vencer?"text-orange-600":"text-gray-500"}`,children:[s.dias_restantes," días restantes"]})]})}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{href:route("admin.certificados.show",s.id),children:e.jsx(x,{variant:"outline",size:"sm",children:"Ver"})}),e.jsxs(m,{onValueChange:r=>k(s.id,r),children:[e.jsx(h,{className:"w-auto h-8",children:e.jsx(z,{className:"h-4 w-4"})}),e.jsxs(j,{children:[e.jsx(a,{value:"pem",children:"Descargar PEM"}),e.jsx(a,{value:"der",children:"Descargar DER"}),e.jsx(a,{value:"crt",children:"Descargar CRT"})]})]})]})})]},s.id))})]})}),l.data.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(f,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay certificados"}),e.jsx("p",{className:"text-gray-600 mb-4",children:Object.keys(i).length>0?"No se encontraron certificados con los filtros aplicados":"Aún no se han creado certificados digitales"}),e.jsx(g,{href:route("admin.certificados.create"),children:e.jsxs(x,{children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Crear primer certificado"]})})]}),(l.meta?.last_page||0)>1&&e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Mostrando ",l.meta?.from||0," a ",l.meta?.to||0," de ",l.meta?.total||0," resultados"]}),e.jsx("div",{className:"flex space-x-1",children:(l.links||[]).map((s,r)=>e.jsx(x,{variant:s.active?"default":"outline",size:"sm",onClick:()=>s.url&&v.get(s.url),disabled:!s.url,dangerouslySetInnerHTML:{__html:s.label}},r))})]})]})]})]})]})}export{ve as default};
