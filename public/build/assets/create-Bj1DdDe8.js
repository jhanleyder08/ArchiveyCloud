import{r,u as X,j as e,H as Y,L as S}from"./app-DwD03BlW.js";import{A as Z,l as k,g as T,U as I,T as M}from"./app-layout-Cm-3T7Vh.js";import{B as N}from"./app-logo-icon-DeP7MEdd.js";import{L as c,I as b}from"./label-Daxx3HVK.js";import{C as g,a as _,b as y,d as D,c as C}from"./card-qnUuQUQN.js";import{A as E,a as L}from"./alert-Dc1xzqAp.js";import{B as ee}from"./badge-CPav5hDV.js";import{A as se}from"./arrow-left-QBbVsMpZ.js";import{S as U}from"./save-CRxaia_O.js";import{S as F}from"./search-DCvVDVDg.js";import{M as H}from"./map-pin-BtQZR_9y.js";import{C as l}from"./circle-check-big-CWWtWrX_.js";import{C as O}from"./calendar-DSlzs4NF.js";/* empty css            */import"./index-BafM60r2.js";import"./index-BjhMtKzi.js";function ve({expedientes:u,documentos:h,usuarios:j,errors:a}){const[m,R]=r.useState(""),[x,z]=r.useState(""),[d,B]=r.useState(""),[G,P]=r.useState([]),[J,q]=r.useState([]),[K,$]=r.useState([]),{data:t,setData:i,post:Q,processing:f,isDirty:A}=X({tipo_prestamo:"expediente",expediente_id:"",documento_id:"",solicitante_id:"",motivo:"",fecha_devolucion_esperada:"",observaciones:""});r.useEffect(()=>{if(m){const s=u.filter(o=>o.numero_expediente.toLowerCase().includes(m.toLowerCase())||o.titulo.toLowerCase().includes(m.toLowerCase())).slice(0,10);P(s)}else P(u.slice(0,10))},[m,u]),r.useEffect(()=>{if(x){const s=h.filter(o=>o.nombre.toLowerCase().includes(x.toLowerCase())||o.expediente.numero_expediente.toLowerCase().includes(x.toLowerCase())).slice(0,10);q(s)}else q(h.slice(0,10))},[x,h]),r.useEffect(()=>{if(d){const s=j.filter(o=>o.name.toLowerCase().includes(d.toLowerCase())||o.email.toLowerCase().includes(d.toLowerCase())).slice(0,10);$(s)}else $(j.slice(0,10))},[d,j]),r.useEffect(()=>{i("expediente_id",""),i("documento_id","")},[t.tipo_prestamo]);const V=s=>{s.preventDefault(),Q(route("admin.prestamos.store"))},n=u.find(s=>s.id.toString()===t.expediente_id),p=h.find(s=>s.id.toString()===t.documento_id),v=j.find(s=>s.id.toString()===t.solicitante_id),w=new Date;w.setDate(w.getDate()+1);const W=w.toISOString().split("T")[0];return e.jsxs(Z,{children:[e.jsx(Y,{title:"Crear Préstamo"}),e.jsxs("form",{onSubmit:V,className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(S,{href:route("admin.prestamos.index"),className:"text-sm text-muted-foreground hover:text-foreground",children:"Préstamos"}),e.jsx("span",{className:"text-muted-foreground",children:"/"}),e.jsx("span",{className:"font-medium",children:"Nuevo Préstamo"})]}),e.jsx("h1",{className:"text-2xl font-bold mt-1",children:"Crear Préstamo"}),e.jsx("p",{className:"text-muted-foreground",children:"Registra un nuevo préstamo de expediente o documento"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N,{type:"button",variant:"outline",asChild:!0,children:e.jsxs(S,{href:route("admin.prestamos.index"),children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Cancelar"]})}),e.jsxs(N,{type:"submit",disabled:f||!A,children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),f?"Creando...":"Crear Préstamo"]})]})]}),e.jsxs(g,{children:[e.jsxs(_,{children:[e.jsx(y,{children:"Tipo de Préstamo"}),e.jsx(D,{children:"Selecciona si prestarás un expediente o documento individual"})]}),e.jsx(C,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("button",{type:"button",onClick:()=>i("tipo_prestamo","expediente"),className:`p-4 border rounded-lg text-left transition-colors ${t.tipo_prestamo==="expediente"?"border-primary bg-primary/5":"border-border hover:border-primary/50"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(k,{className:`h-6 w-6 ${t.tipo_prestamo==="expediente"?"text-primary":"text-muted-foreground"}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Expediente Completo"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Prestar un expediente físico completo con todos sus documentos"})]})]})}),e.jsx("button",{type:"button",onClick:()=>i("tipo_prestamo","documento"),className:`p-4 border rounded-lg text-left transition-colors ${t.tipo_prestamo==="documento"?"border-primary bg-primary/5":"border-border hover:border-primary/50"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(T,{className:`h-6 w-6 ${t.tipo_prestamo==="documento"?"text-primary":"text-muted-foreground"}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Documento Individual"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Prestar un documento específico de un expediente"})]})]})})]})})]}),e.jsxs(g,{children:[e.jsxs(_,{children:[e.jsxs(y,{className:"flex items-center space-x-2",children:[t.tipo_prestamo==="expediente"?e.jsx(k,{className:"h-5 w-5"}):e.jsx(T,{className:"h-5 w-5"}),e.jsxs("span",{children:["Seleccionar ",t.tipo_prestamo==="expediente"?"Expediente":"Documento"]})]}),e.jsxs(D,{children:["Busca y selecciona el ",t.tipo_prestamo," que deseas prestar"]})]}),e.jsx(C,{className:"space-y-4",children:t.tipo_prestamo==="expediente"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"busqueda_expediente",children:"Buscar Expediente"}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground"}),e.jsx(b,{id:"busqueda_expediente",placeholder:"Buscar por código o nombre del expediente...",value:m,onChange:s=>R(s.target.value),className:"pl-10"})]})]}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:G.map(s=>e.jsx("div",{className:`p-3 border rounded-lg cursor-pointer transition-colors ${t.expediente_id===s.id.toString()?"border-primary bg-primary/5":"border-border hover:border-primary/50"}`,onClick:()=>i("expediente_id",s.id.toString()),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.numero_expediente}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.titulo}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-muted-foreground mt-1",children:[e.jsxs("span",{children:["Estado: ",s.estado_ciclo_vida]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(H,{className:"h-3 w-3 mr-1"}),s.ubicacion_fisica]})]})]}),t.expediente_id===s.id.toString()&&e.jsx(l,{className:"h-5 w-5 text-primary"})]})},s.id))}),n&&e.jsxs(E,{children:[e.jsx(l,{className:"h-4 w-4"}),e.jsxs(L,{children:[e.jsx("strong",{children:"Expediente seleccionado:"})," ",n.numero_expediente," - ",n.titulo]})]}),a.expediente_id&&e.jsx("p",{className:"text-sm text-red-500",children:a.expediente_id})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"busqueda_documento",children:"Buscar Documento"}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground"}),e.jsx(b,{id:"busqueda_documento",placeholder:"Buscar por nombre del documento...",value:x,onChange:s=>z(s.target.value),className:"pl-10"})]})]}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:J.map(s=>e.jsx("div",{className:`p-3 border rounded-lg cursor-pointer transition-colors ${t.documento_id===s.id.toString()?"border-primary bg-primary/5":"border-border hover:border-primary/50"}`,onClick:()=>i("documento_id",s.id.toString()),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.nombre}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Expediente: ",s.expediente.numero_expediente," - ",s.expediente.titulo]}),e.jsx("div",{className:"flex items-center space-x-4 text-xs text-muted-foreground mt-1",children:e.jsxs("span",{className:"flex items-center",children:[e.jsx(H,{className:"h-3 w-3 mr-1"}),s.ubicacion_fisica]})})]}),t.documento_id===s.id.toString()&&e.jsx(l,{className:"h-5 w-5 text-primary"})]})},s.id))}),p&&e.jsxs(E,{children:[e.jsx(l,{className:"h-4 w-4"}),e.jsxs(L,{children:[e.jsx("strong",{children:"Documento seleccionado:"})," ",p.nombre,e.jsx("br",{}),e.jsx("strong",{children:"Expediente:"})," ",p.expediente.numero_expediente," - ",p.expediente.titulo]})]}),a.documento_id&&e.jsx("p",{className:"text-sm text-red-500",children:a.documento_id})]})})]}),e.jsxs(g,{children:[e.jsxs(_,{children:[e.jsxs(y,{className:"flex items-center space-x-2",children:[e.jsx(I,{className:"h-5 w-5"}),e.jsx("span",{children:"Información del Préstamo"})]}),e.jsx(D,{children:"Datos del solicitante y detalles del préstamo"})]}),e.jsxs(C,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"solicitante",children:"Solicitante *"}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground"}),e.jsx(b,{placeholder:"Buscar usuario por nombre o email...",value:d,onChange:s=>B(s.target.value),className:"pl-10"})]}),d&&e.jsx("div",{className:"space-y-1 max-h-40 overflow-y-auto border rounded p-2",children:K.map(s=>e.jsxs("div",{className:`p-2 rounded cursor-pointer transition-colors ${t.solicitante_id===s.id.toString()?"bg-primary/10 border border-primary":"hover:bg-muted"}`,onClick:()=>{i("solicitante_id",s.id.toString()),B(s.name)},children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.email})]},s.id))}),v&&e.jsxs(E,{children:[e.jsx(l,{className:"h-4 w-4"}),e.jsxs(L,{children:[e.jsx("strong",{children:"Solicitante:"})," ",v.name," (",v.email,")"]})]}),a.solicitante_id&&e.jsx("p",{className:"text-sm text-red-500",children:a.solicitante_id})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"motivo",children:"Motivo del Préstamo *"}),e.jsx(M,{id:"motivo",placeholder:"Describe el motivo o propósito del préstamo...",value:t.motivo,onChange:s=>i("motivo",s.target.value),className:`min-h-[100px] ${a.motivo?"border-red-500":""}`}),a.motivo&&e.jsx("p",{className:"text-sm text-red-500",children:a.motivo})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"fecha_devolucion_esperada",className:"flex items-center space-x-2",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsx("span",{children:"Fecha de Devolución Esperada *"})]}),e.jsx(b,{id:"fecha_devolucion_esperada",type:"date",min:W,value:t.fecha_devolucion_esperada,onChange:s=>i("fecha_devolucion_esperada",s.target.value),className:a.fecha_devolucion_esperada?"border-red-500":""}),a.fecha_devolucion_esperada&&e.jsx("p",{className:"text-sm text-red-500",children:a.fecha_devolucion_esperada})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"observaciones",children:"Observaciones"}),e.jsx(M,{id:"observaciones",placeholder:"Observaciones adicionales (opcional)",value:t.observaciones,onChange:s=>i("observaciones",s.target.value),className:"min-h-[80px]"})]})]})]}),(t.expediente_id||t.documento_id)&&t.solicitante_id&&e.jsxs(g,{className:"border-green-200 bg-green-50",children:[e.jsx(_,{children:e.jsxs(y,{className:"flex items-center space-x-2",children:[e.jsx(l,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{children:"Resumen del Préstamo"})]})}),e.jsx(C,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ee,{variant:"outline",children:t.tipo_prestamo==="expediente"?"Expediente":"Documento"}),e.jsx("span",{className:"font-medium",children:n?`${n.numero_expediente} - ${n.titulo}`:p?.nombre})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:["Solicitante: ",v?.name]})]}),t.fecha_devolucion_esperada&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:["Devolución esperada: ",new Date(t.fecha_devolucion_esperada).toLocaleDateString("es-ES")]})]})]})})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(N,{type:"button",variant:"outline",asChild:!0,children:e.jsx(S,{href:route("admin.prestamos.index"),children:"Cancelar"})}),e.jsxs(N,{type:"submit",disabled:f||!A,children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),f?"Creando...":"Crear Préstamo"]})]})]})]})}export{ve as default};
