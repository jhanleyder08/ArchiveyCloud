import{r as I,j as e,H as V,L as b,b as f}from"./app-mxlkmmQb.js";import{A as H}from"./app-layout-2VxfhrU0.js";import{c as E,B as i}from"./button-CuBppPEJ.js";import{C as l,c as r,a as x,b as h,d as y}from"./card-BM_lxel5.js";import{B as n}from"./badge-Cbo6Jzs3.js";import{S as C}from"./separator-D8uk0Rv7.js";import{k as L,l as j,m as p,n as g,D as B,a as O,b as J,c as P,d as Z,e as U}from"./app-sidebar-layout-DnVBdG59.js";import{A as G,a as K}from"./alert-pfCze6Lu.js";import{A as Q}from"./arrow-left-CZhsm6b9.js";import{T as D,a as W}from"./toggle-right-BcDUsSnI.js";import{C as X}from"./copy-CV2B4nc9.js";import{S as w}from"./square-pen-lgFewOTe.js";import{T as Y}from"./trash-2-DhQs9517.js";import{C as T}from"./circle-alert-Brcl6cpo.js";import{F as _}from"./folder-open-DCWrmCG3.js";import{F as k}from"./Combination-B16eu4w9.js";import{C as ee}from"./calendar-DRCTsFYj.js";import{C as S}from"./folder-DWzUJWdQ.js";import{C as N}from"./check-CcAv2hB-.js";/* empty css            */import"./index-A-_-1i-X.js";import"./index-CO05iKuH.js";import"./index-a6Bv5C-E.js";import"./x-BnTViGZh.js";import"./index-CTg9z5dS.js";import"./app-logo-icon-D7EdAziK.js";import"./input-S0qqChsE.js";import"./label-DPJeQnqX.js";import"./user-DPNZAMhW.js";import"./mail-DuuaUg8X.js";import"./users-DyIvzvUS.js";import"./triangle-alert-Dlto6Rx4.js";import"./search-DNF_o86d.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M12 18v-4",key:"q1q25u"}],["path",{d:"M16 18v-6",key:"15y0np"}]],A=E("FileChartColumnIncreasing",se);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],ie=E("FileDown",ae),le=[{title:"Dashboard",href:"/dashboard"},{title:"Administración",href:"#"},{title:"Tablas de Retención Documental",href:"/admin/trd"},{title:"Detalle TRD",href:"#"}];function Ie({trd:s,versiones:t,estadisticas:d,tieneDocumentosAsociados:v}){const[R,o]=I.useState(!1),M=()=>{f.delete(`/admin/trd/${s.id}`,{onFinish:()=>o(!1)})},F=()=>{f.patch(`/admin/trd/${s.id}/vigencia`,{},{preserveScroll:!0})},q=()=>{f.post(`/admin/trd/${s.id}/duplicate`)},z=a=>{window.open(`/admin/trd/${s.id}/export?formato=${a}`,"_blank")},m=a=>new Date(a).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),u=a=>{const c={borrador:{color:"bg-gray-100 text-gray-800",icon:w},revision:{color:"bg-yellow-100 text-yellow-800",icon:S},aprobada:{color:"bg-green-100 text-green-800",icon:N},vigente:{color:"bg-blue-100 text-blue-800",icon:N},historica:{color:"bg-purple-100 text-purple-800",icon:A}}[a]||{color:"bg-gray-100 text-gray-800",icon:T},$=c.icon;return e.jsxs(n,{className:`${c.color} font-medium flex items-center gap-1`,children:[e.jsx($,{className:"h-3 w-3"}),a.charAt(0).toUpperCase()+a.slice(1)]})};return e.jsxs(H,{breadcrumbItems:le,children:[e.jsx(V,{title:`${s.nombre} - Detalle TRD`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(b,{href:"/admin/trd",children:e.jsxs(i,{variant:"outline",size:"sm",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Volver"]})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s.nombre}),u(s.estado),s.vigente&&e.jsxs(n,{className:"bg-blue-100 text-blue-800 font-medium flex items-center gap-1",children:[e.jsx(D,{className:"h-3 w-3"}),"Vigente"]})]}),e.jsxs("p",{className:"text-gray-600",children:[s.codigo," • Versión ",s.version," • ",s.identificador_unico]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(L,{children:[e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsx(i,{variant:"outline",size:"sm",onClick:()=>z("json"),children:e.jsx(ie,{className:"h-4 w-4"})})}),e.jsx(g,{children:e.jsx("p",{children:"Exportar TRD"})})]}),e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsx(i,{variant:"outline",size:"sm",onClick:q,children:e.jsx(X,{className:"h-4 w-4"})})}),e.jsx(g,{children:e.jsx("p",{children:"Duplicar TRD"})})]}),e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsx(i,{variant:"outline",size:"sm",onClick:F,disabled:s.estado!=="aprobada"&&!s.vigente,children:s.vigente?e.jsx(D,{className:"h-4 w-4 text-green-600"}):e.jsx(W,{className:"h-4 w-4"})})}),e.jsx(g,{children:e.jsx("p",{children:s.vigente?"Desmarcar vigente":"Marcar vigente"})})]}),e.jsx(b,{href:`/admin/trd/${s.id}/edit`,children:e.jsx(i,{variant:"outline",size:"sm",children:e.jsx(w,{className:"h-4 w-4"})})}),e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsx(i,{variant:"outline",size:"sm",onClick:()=>o(!0),className:"text-red-600 hover:text-red-700",children:e.jsx(Y,{className:"h-4 w-4"})})}),e.jsx(g,{children:e.jsx("p",{children:"Eliminar TRD"})})]})]})})]}),v&&e.jsxs(G,{className:"border-yellow-200 bg-yellow-50",children:[e.jsx(T,{className:"h-4 w-4"}),e.jsxs(K,{className:"text-yellow-800",children:[e.jsx("strong",{children:"Esta TRD tiene documentos asociados."})," Cualquier modificación debe considerar el impacto en los documentos existentes."]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(l,{children:e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-blue-100 rounded-full p-2",children:e.jsx(_,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Series"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.series_count})]})]})})}),e.jsx(l,{children:e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-green-100 rounded-full p-2",children:e.jsx(_,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Subseries"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.subseries_count})]})]})})}),e.jsx(l,{children:e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-purple-100 rounded-full p-2",children:e.jsx(A,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Expedientes"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.expedientes_count})]})]})})}),e.jsx(l,{children:e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-orange-100 rounded-full p-2",children:e.jsx(k,{className:"h-6 w-6 text-orange-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Documentos"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.documentos_count})]})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(l,{children:[e.jsx(x,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5 text-[#2a3d83]"}),"Información de la TRD"]})}),e.jsxs(r,{className:"space-y-4",children:[s.descripcion&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Descripción"}),e.jsx("p",{className:"text-gray-600 leading-relaxed",children:s.descripcion})]}),s.justificacion&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Justificación"}),e.jsx("p",{className:"text-gray-600 leading-relaxed",children:s.justificacion})]}),e.jsx(C,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Formato de Archivo"}),e.jsx("p",{className:"text-gray-600",children:s.formato_archivo||"No especificado"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Estado Actual"}),e.jsx("div",{className:"flex items-center gap-2",children:u(s.estado)})]})]}),s.metadatos_asociados&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Metadatos Asociados"}),e.jsx("pre",{className:"bg-gray-50 p-3 rounded-md text-sm font-mono overflow-x-auto",children:JSON.stringify(s.metadatos_asociados,null,2)})]})]})]}),s.series&&s.series.length>0&&e.jsxs(l,{children:[e.jsxs(x,{children:[e.jsx(h,{children:"Series Documentales"}),e.jsxs(y,{children:["Series asociadas a esta TRD (",s.series.length,")"]})]}),e.jsx(r,{children:e.jsx("div",{className:"space-y-4",children:s.series.map(a=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:a.nombre}),e.jsx(n,{variant:"outline",children:a.codigo})]}),a.subseries&&a.subseries.length>0&&e.jsxs("div",{className:"ml-4 mt-2",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:["Subseries (",a.subseries.length,"):"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:a.subseries.map(c=>e.jsx(n,{variant:"secondary",className:"text-xs",children:c.codigo},c.id))})]})]},a.id))})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(l,{children:[e.jsx(x,{children:e.jsx(h,{className:"text-lg",children:"Información del Sistema"})}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ee,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Creado"}),e.jsx("p",{className:"text-sm text-gray-600",children:m(s.created_at)}),s.creador&&e.jsxs("p",{className:"text-xs text-gray-500",children:["por ",s.creador.name]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Última Actualización"}),e.jsx("p",{className:"text-sm text-gray-600",children:m(s.fecha_actualizacion)}),s.modificador&&e.jsxs("p",{className:"text-xs text-gray-500",children:["por ",s.modificador.name]})]})]}),s.fecha_aprobacion&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(N,{className:"h-4 w-4 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Aprobado"}),e.jsx("p",{className:"text-sm text-gray-600",children:m(s.fecha_aprobacion)})]})]}),e.jsx(C,{}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"ID Único"}),e.jsx("p",{className:"text-xs font-mono text-gray-600 bg-gray-50 px-2 py-1 rounded",children:s.identificador_unico})]})]})]}),t.length>1&&e.jsxs(l,{children:[e.jsxs(x,{children:[e.jsx(h,{className:"text-lg",children:"Historial de Versiones"}),e.jsxs(y,{children:[t.length," versiones disponibles"]})]}),e.jsx(r,{children:e.jsxs("div",{className:"space-y-3",children:[t.slice(0,5).map(a=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded border",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:["v",a.version]}),e.jsx("p",{className:"text-xs text-gray-500",children:m(a.created_at)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[u(a.estado),a.vigente&&e.jsx(n,{variant:"secondary",className:"text-xs",children:"Vigente"})]})]},a.id)),t.length>5&&e.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["+",t.length-5," versiones más"]})]})})]})]})]}),e.jsx(B,{open:R,onOpenChange:o,children:e.jsxs(O,{children:[e.jsxs(J,{children:[e.jsx(P,{children:"Confirmar Eliminación"}),e.jsxs(Z,{children:['¿Estás seguro de que deseas eliminar la TRD "',s.nombre,'"? Esta acción no se puede deshacer.',v&&e.jsxs("div",{className:"mt-2 p-2 bg-red-50 border border-red-200 rounded",children:[e.jsx("strong",{className:"text-red-800",children:"Advertencia:"})," Esta TRD tiene documentos asociados."]})]})]}),e.jsxs(U,{children:[e.jsx(i,{type:"button",variant:"outline",onClick:()=>o(!1),children:"Cancelar"}),e.jsx(i,{type:"button",variant:"destructive",onClick:M,children:"Eliminar"})]})]})})]})]})}export{Ie as default};
