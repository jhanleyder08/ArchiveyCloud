import{r,j as e,H as b,a as j}from"./app-DOeYTPnE.js";import{C,a as k,b as I,d as S,c as R}from"./card-BEZSel9K.js";import{B as x}from"./button-BB3j1qH9.js";import{I as A}from"./index-C7D1JV-H.js";import{L as V}from"./label-BvABT9uR.js";import{A as E,a as M}from"./alert-Dl-auDCw.js";import{S as F,T as H,M as D}from"./triangle-alert-B7e9hRq_.js";import{R as L}from"./refresh-cw-B3OjpzJz.js";import{S as v}from"./smartphone-CUZLQekA.js";/* empty css            */function Q({method:i}){const[n,p]=r.useState(""),[c,o]=r.useState(!1),[u,t]=r.useState(null),[m,l]=r.useState(!1),[y,f]=r.useState(60);r.useEffect(()=>{if(i==="totp"){l(!1);return}const s=setInterval(()=>{f(a=>a<=1?(l(!0),clearInterval(s),0):a-1)},1e3);return()=>clearInterval(s)},[i]);const g=async()=>{if(!n||n.length!==6){t({type:"error",message:"Por favor ingresa un código de 6 dígitos"});return}o(!0),t(null);try{const s=await j.post("/two-factor/verify",{code:n});s.data.success&&(window.location.href=s.data.redirect||"/dashboard")}catch(s){t({type:"error",message:s.response?.data?.message||"Código inválido. Por favor intenta nuevamente."}),p("")}finally{o(!1)}},N=async()=>{if(!(!m||i==="totp")){o(!0),t(null);try{const s=await j.post("/two-factor/resend");if(s.data.success){t({type:"success",message:s.data.message}),l(!1),f(60);const a=setInterval(()=>{f(h=>h<=1?(l(!0),clearInterval(a),0):h-1)},1e3)}}catch(s){t({type:"error",message:s.response?.data?.message||"Error al reenviar el código"})}finally{o(!1)}}},w=s=>{s.key==="Enter"&&g()},d=(()=>{switch(i){case"totp":return{icon:e.jsx(v,{className:"h-6 w-6"}),title:"Autenticación de Dos Factores",description:"Ingresa el código de 6 dígitos de tu aplicación de autenticación",placeholder:"000000"};case"sms":return{icon:e.jsx(v,{className:"h-6 w-6"}),title:"Verificación por SMS",description:"Hemos enviado un código de verificación a tu teléfono",placeholder:"000000"};case"email":return{icon:e.jsx(D,{className:"h-6 w-6"}),title:"Verificación por Correo",description:"Hemos enviado un código de verificación a tu correo electrónico",placeholder:"000000"}}})();return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-white to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 p-4",children:[e.jsx(b,{title:"Verificación 2FA"}),e.jsxs(C,{className:"w-full max-w-md shadow-xl",children:[e.jsxs(k,{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center justify-center w-16 h-16 bg-primary/10 rounded-full mx-auto",children:e.jsx(F,{className:"h-8 w-8 text-primary"})}),e.jsxs(I,{className:"text-2xl text-center flex items-center justify-center gap-2",children:[d.icon,d.title]}),e.jsx(S,{className:"text-center text-base",children:d.description})]}),e.jsxs(R,{className:"space-y-6",children:[u&&e.jsxs(E,{variant:u.type==="error"?"destructive":"default",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx(M,{children:u.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:"code",children:"Código de Verificación"}),e.jsx(A,{id:"code",type:"text",inputMode:"numeric",pattern:"[0-9]*",value:n,onChange:s=>{const a=s.target.value.replace(/\D/g,"").slice(0,6);p(a)},onKeyPress:w,placeholder:d.placeholder,maxLength:6,autoFocus:!0,className:"text-center text-2xl tracking-widest font-mono",disabled:c}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Ingresa el código de 6 dígitos"})]}),e.jsx(x,{onClick:g,disabled:c||n.length!==6,className:"w-full",size:"lg",children:c?"Verificando...":"Verificar Código"}),i!=="totp"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:"¿No recibiste el código?"})})]}),e.jsxs(x,{onClick:N,disabled:!m||c,variant:"outline",className:"w-full",children:[e.jsx(L,{className:`h-4 w-4 mr-2 ${c?"animate-spin":""}`}),m?"Reenviar Código":`Reenviar en ${y}s`]})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-950 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("p",{className:"text-sm text-blue-900 dark:text-blue-100",children:["💡 ",e.jsx("strong",{children:"Consejo de Seguridad:"})," Nunca compartas tus códigos de verificación con nadie. El equipo de soporte nunca te pedirá este código."]})}),e.jsx("div",{className:"text-center",children:e.jsx(x,{variant:"link",onClick:()=>{window.location.href="/logout"},className:"text-sm text-muted-foreground hover:text-foreground",children:"Cancelar e iniciar sesión con otra cuenta"})})]})]})]})}export{Q as default};
