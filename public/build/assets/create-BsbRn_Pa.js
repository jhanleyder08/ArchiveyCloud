import{r as b,u as H,j as e,H as K,L as y}from"./app-B0qTBAke.js";import{A as O,K as q,S as Y,d as $}from"./app-sidebar-layout-DFKjANJB.js";import{c as J,B as _}from"./app-logo-icon-BPz3oRny.js";import{C as d,a as n,b as m,c as h,d as x}from"./card-D4UBhCKF.js";import{L as r,I as p}from"./label-CjHZv5e4.js";import{S as u,a as f,b as j,c as v,d as o}from"./select-bkkBUc_4.js";import{C as Q}from"./checkbox-vAynjuAI.js";import{T as W,a as X,b as S,c as k}from"./tabs-CT2fp8nO.js";import{A as F,a as w}from"./alert-D_YNC9Mv.js";import{A as Z}from"./arrow-left-DojSOgLu.js";import{U as A}from"./upload-CrgsxyHP.js";import{L as ee}from"./lock-DSz-zmpG.js";/* empty css            */import"./index-DDzTzhRc.js";import"./index-D-todNvr.js";import"./index-C5MwE6sO.js";import"./check-dE-FsShf.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]],ie=J("Cpu",ae);function _e({usuarios:D,tipos_certificado:M,usos_permitidos:T,algoritmos_firma:I}){const[g,L]=b.useState("generar"),[t,N]=b.useState(["firma_digital"]),{data:c,setData:s,post:V,processing:C,errors:i,reset:E}=H({usuario_id:"",nombre_certificado:"",tipo_certificado:"usuario",algoritmo_firma:"RSA",longitud_clave:2048,uso_permitido:["firma_digital"],fecha_vencimiento:"",archivo_certificado:null,archivo_clave_publica:null}),P=a=>{a.preventDefault(),s("uso_permitido",t),V(route("admin.certificados.store"),{forceFormData:!0,onSuccess:()=>{E()}})},U=(a,l)=>{N(l?[...t,a]:t.filter(G=>G!==a))},B=()=>{const a=new Date;return a.setDate(a.getDate()+1),a.toISOString().split("T")[0]},R=()=>{const a=new Date;return a.setFullYear(a.getFullYear()+10),a.toISOString().split("T")[0]},z=a=>({usuario:"Certificado para identificación y firma de usuarios individuales",servidor:"Certificado para servicios de servidor y aplicaciones",autoridad_certificadora:"Certificado de Autoridad Certificadora (CA)",sello_tiempo:"Certificado para servicios de sellado de tiempo"})[a]||"";return e.jsxs(O,{children:[e.jsx(K,{title:"Crear Certificado Digital"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(y,{href:route("admin.certificados.index"),children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Volver"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Crear Certificado Digital"}),e.jsx("p",{className:"text-muted-foreground",children:"Generar o importar un nuevo certificado digital PKI"})]})]})}),e.jsxs("form",{onSubmit:P,className:"space-y-6",children:[e.jsxs(W,{value:g,onValueChange:a=>L(a),children:[e.jsxs(X,{className:"grid w-full grid-cols-2",children:[e.jsxs(S,{value:"generar",className:"flex items-center",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Generar Certificado"]}),e.jsxs(S,{value:"importar",className:"flex items-center",children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Importar Certificado"]})]}),e.jsx(k,{value:"generar",className:"space-y-6",children:e.jsxs(F,{children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsx(w,{children:"Se generará automáticamente un nuevo par de claves RSA y el certificado correspondiente. El certificado será auto-firmado y válido para los usos seleccionados."})]})}),e.jsxs(k,{value:"importar",className:"space-y-6",children:[e.jsxs(F,{children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx(w,{children:"Importe un certificado existente en formato PEM, DER o CRT. Opcionalmente puede proporcionar la clave pública correspondiente."})]}),e.jsxs(d,{children:[e.jsxs(n,{children:[e.jsx(m,{children:"Archivos del Certificado"}),e.jsx(h,{children:"Seleccione los archivos del certificado a importar"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"archivo_certificado",children:"Archivo de Certificado *"}),e.jsx(p,{id:"archivo_certificado",type:"file",accept:".crt,.cer,.pem,.der",onChange:a=>s("archivo_certificado",a.target.files?.[0]||null),className:i.archivo_certificado?"border-red-500":""}),i.archivo_certificado&&e.jsx("p",{className:"text-sm text-red-600",children:i.archivo_certificado}),e.jsx("p",{className:"text-sm text-gray-600",children:"Formatos soportados: .crt, .cer, .pem, .der (máximo 2MB)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"archivo_clave_publica",children:"Archivo de Clave Pública (opcional)"}),e.jsx(p,{id:"archivo_clave_publica",type:"file",accept:".key,.pem",onChange:a=>s("archivo_clave_publica",a.target.files?.[0]||null),className:i.archivo_clave_publica?"border-red-500":""}),i.archivo_clave_publica&&e.jsx("p",{className:"text-sm text-red-600",children:i.archivo_clave_publica}),e.jsx("p",{className:"text-sm text-gray-600",children:"Formatos soportados: .key, .pem (máximo 2MB)"})]})]})]})]})]}),e.jsxs(d,{children:[e.jsxs(n,{children:[e.jsxs(m,{className:"flex items-center",children:[e.jsx($,{className:"h-5 w-5 mr-2"}),"Información Básica"]}),e.jsx(h,{children:"Configure la información básica del certificado"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"usuario_id",children:"Usuario Propietario *"}),e.jsxs(u,{value:c.usuario_id,onValueChange:a=>s("usuario_id",a),children:[e.jsx(f,{className:i.usuario_id?"border-red-500":"",children:e.jsx(j,{placeholder:"Seleccionar usuario"})}),e.jsx(v,{children:D.map(a=>e.jsxs(o,{value:a.id.toString(),children:[a.name," (",a.email,")"]},a.id))})]}),i.usuario_id&&e.jsx("p",{className:"text-sm text-red-600",children:i.usuario_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"nombre_certificado",children:"Nombre del Certificado *"}),e.jsx(p,{id:"nombre_certificado",value:c.nombre_certificado,onChange:a=>s("nombre_certificado",a.target.value),placeholder:"Ej: Certificado Firma Digital Juan Pérez",className:i.nombre_certificado?"border-red-500":""}),i.nombre_certificado&&e.jsx("p",{className:"text-sm text-red-600",children:i.nombre_certificado})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"tipo_certificado",children:"Tipo de Certificado *"}),e.jsxs(u,{value:c.tipo_certificado,onValueChange:a=>s("tipo_certificado",a),children:[e.jsx(f,{className:i.tipo_certificado?"border-red-500":"",children:e.jsx(j,{placeholder:"Seleccionar tipo"})}),e.jsx(v,{children:M.map(a=>e.jsx(o,{value:a.value,children:a.label},a.value))})]}),c.tipo_certificado&&e.jsx("p",{className:"text-sm text-gray-600",children:z(c.tipo_certificado)}),i.tipo_certificado&&e.jsx("p",{className:"text-sm text-red-600",children:i.tipo_certificado})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"fecha_vencimiento",children:"Fecha de Vencimiento *"}),e.jsx(p,{id:"fecha_vencimiento",type:"date",value:c.fecha_vencimiento,onChange:a=>s("fecha_vencimiento",a.target.value),min:B(),max:R(),className:i.fecha_vencimiento?"border-red-500":""}),i.fecha_vencimiento&&e.jsx("p",{className:"text-sm text-red-600",children:i.fecha_vencimiento}),e.jsx("p",{className:"text-sm text-gray-600",children:"El certificado será válido desde hoy hasta la fecha seleccionada (máximo 10 años)"})]})]})]}),g==="generar"&&e.jsxs(d,{children:[e.jsxs(n,{children:[e.jsxs(m,{className:"flex items-center",children:[e.jsx(ie,{className:"h-5 w-5 mr-2"}),"Configuración Criptográfica"]}),e.jsx(h,{children:"Configure los parámetros criptográficos del certificado"})]}),e.jsx(x,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"algoritmo_firma",children:"Algoritmo de Firma *"}),e.jsxs(u,{value:c.algoritmo_firma,onValueChange:a=>s("algoritmo_firma",a),children:[e.jsx(f,{className:i.algoritmo_firma?"border-red-500":"",children:e.jsx(j,{placeholder:"Seleccionar algoritmo"})}),e.jsx(v,{children:I.map(a=>e.jsx(o,{value:a.value,children:a.label},a.value))})]}),i.algoritmo_firma&&e.jsx("p",{className:"text-sm text-red-600",children:i.algoritmo_firma})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"longitud_clave",children:"Longitud de Clave *"}),e.jsxs(u,{value:c.longitud_clave.toString(),onValueChange:a=>s("longitud_clave",parseInt(a)),children:[e.jsx(f,{className:i.longitud_clave?"border-red-500":"",children:e.jsx(j,{placeholder:"Seleccionar longitud"})}),e.jsxs(v,{children:[e.jsx(o,{value:"1024",children:"1024 bits (Básico)"}),e.jsx(o,{value:"2048",children:"2048 bits (Recomendado)"}),e.jsx(o,{value:"4096",children:"4096 bits (Alta Seguridad)"})]})]}),i.longitud_clave&&e.jsx("p",{className:"text-sm text-red-600",children:i.longitud_clave}),e.jsx("p",{className:"text-sm text-gray-600",children:"Mayor longitud = mayor seguridad pero menor velocidad"})]})]})})]}),e.jsxs(d,{children:[e.jsxs(n,{children:[e.jsxs(m,{className:"flex items-center",children:[e.jsx(ee,{className:"h-5 w-5 mr-2"}),"Usos Permitidos"]}),e.jsx(h,{children:"Seleccione los usos autorizados para este certificado"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:T.map(a=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Q,{id:`uso_${a.value}`,checked:t.includes(a.value),onCheckedChange:l=>U(a.value,l)}),e.jsx(r,{htmlFor:`uso_${a.value}`,className:"text-sm font-medium",children:a.label})]},a.value))}),i.uso_permitido&&e.jsx("p",{className:"text-sm text-red-600 mt-2",children:i.uso_permitido}),t.length===0&&e.jsx("p",{className:"text-sm text-orange-600 mt-2",children:"Debe seleccionar al menos un uso permitido"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(y,{href:route("admin.certificados.index"),children:e.jsx(_,{type:"button",variant:"outline",children:"Cancelar"})}),e.jsx(_,{type:"submit",disabled:C||t.length===0,className:"min-w-[120px]",children:C?"Procesando...":g==="generar"?"Generar Certificado":"Importar Certificado"})]})]})]})]})}export{_e as default};
