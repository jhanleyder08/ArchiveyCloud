import{r as o,j as e,H as q,L as z,e as N}from"./app-BeC48sE8.js";import{A as B}from"./app-layout-DeIgiXKt.js";import{C as m,a as d,b as x,d as j,c as h}from"./card-BdaZ1N_g.js";import{B as u}from"./app-logo-icon-DygIE2aX.js";import{L as i,I as y}from"./label-BAQntzi8.js";import{S}from"./switch-DZY231lR.js";import{S as D,a as H,b as F,c as P,d as r}from"./select-BIll6NvB.js";import{A as T,a as V}from"./alert-RTLkFc0E.js";import{B as t}from"./badge-DhW8IdNn.js";import{S as b}from"./separator-DkD5ERRg.js";import{A as Q}from"./arrow-left-B23dOVWI.js";import{q as U,a as C,S as w,_ as W,$ as G,n as J,U as $,W as K}from"./app-sidebar-layout-B6kWAPVN.js";import{C as O}from"./circle-check-big-ZDo5qjyM.js";import{L as A}from"./loader-circle-Y3Z_bOrW.js";import{S as X}from"./save-Cm3i1Bhv.js";/* empty css            */import"./index-BynCgBR_.js";import"./index-DnPRtIrm.js";import"./check-DhgVWmR5.js";import"./index-BtdR61Tu.js";function fe({configuracion_actual:_,usuarios_admin:M}){const[a,L]=o.useState(_),[p,g]=o.useState(!1),[f,v]=o.useState(!1),[l,n]=o.useState(null),k=async()=>{g(!0),n(null);try{const s=await N.post("/admin/servicios-externos/configuracion",a);n({success:!0,message:"Configuración actualizada exitosamente"})}catch(s){n({success:!1,message:s.response?.data?.message||"Error actualizando configuración"})}finally{g(!1)}},E=async()=>{v(!0),n(null);try{const s=await N.post("/admin/servicios-externos/forzar-resumenes");n({success:!0,message:"Resúmenes enviados exitosamente a todos los usuarios administrativos"})}catch(s){n({success:!1,message:s.response?.data?.message||"Error enviando resúmenes"})}finally{v(!1)}},c=(s,R)=>{L(I=>({...I,[s]:R}))};return e.jsxs(B,{children:[e.jsx(q,{title:"Configuración - Servicios Externos - ArchiveyCloud"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(z,{href:"/admin/servicios-externos",children:e.jsxs(u,{variant:"outline",size:"sm",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Volver"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Configuración de Servicios Externos"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Configurar parámetros de email, SMS y notificaciones automáticas"})]})]}),e.jsx(U,{className:"h-8 w-8 text-blue-600"})]}),l&&e.jsx(T,{className:l.success?"border-green-200 bg-green-50":"border-red-200 bg-red-50",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[l.success?e.jsx(O,{className:"h-4 w-4 text-green-600"}):e.jsx(C,{className:"h-4 w-4 text-red-600"}),e.jsx(V,{className:l.success?"text-green-800":"text-red-800",children:l.message})]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[e.jsxs(m,{children:[e.jsxs(d,{children:[e.jsxs(x,{className:"flex items-center space-x-2",children:[e.jsx(w,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"Configuración de Servicios"})]}),e.jsx(j,{children:"Habilitar o deshabilitar servicios de notificación"})]}),e.jsxs(h,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(W,{className:"h-4 w-4 text-blue-600"}),e.jsx(i,{className:"text-sm font-medium",children:"Servicio de Email"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Notificaciones por correo electrónico"})]}),e.jsx(S,{checked:a.email_habilitado,onCheckedChange:s=>c("email_habilitado",s)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx(i,{className:"text-xs text-gray-600",children:"Driver actual"}),e.jsx(t,{variant:"outline",className:"mt-1",children:a.mail_driver})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs text-gray-600",children:"Queue"}),e.jsx(t,{variant:"outline",className:"mt-1",children:a.queue_connection})]})]})]}),e.jsx(b,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{className:"h-4 w-4 text-green-600"}),e.jsx(i,{className:"text-sm font-medium",children:"Servicio de SMS"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Mensajes de texto para alertas críticas"})]}),e.jsx(S,{checked:a.sms_habilitado,onCheckedChange:s=>c("sms_habilitado",s)})]}),e.jsxs("div",{className:"text-sm",children:[e.jsxs(t,{variant:"outline",className:"bg-orange-50 text-orange-700",children:["Ambiente: ",a.ambiente]}),a.ambiente==="local"&&e.jsx("p",{className:"text-xs text-orange-600 mt-1",children:"En desarrollo los SMS se simulan"})]})]})]})]}),e.jsxs(m,{children:[e.jsxs(d,{children:[e.jsxs(x,{className:"flex items-center space-x-2",children:[e.jsx(w,{className:"h-5 w-5 text-orange-600"}),e.jsx("span",{children:"Límites y Throttling"})]}),e.jsx(j,{children:"Controlar la frecuencia de envío de notificaciones"})]}),e.jsx(h,{className:"space-y-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"throttling-email",className:"text-sm font-medium",children:"Límite de Emails por hora (por usuario)"}),e.jsx(y,{id:"throttling-email",type:"number",min:"1",max:"20",value:a.throttling_email,onChange:s=>c("throttling_email",parseInt(s.target.value)),className:"mt-1"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Recomendado: 5 emails por hora"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"throttling-sms",className:"text-sm font-medium",children:"Límite de SMS por día (por usuario)"}),e.jsx(y,{id:"throttling-sms",type:"number",min:"1",max:"10",value:a.throttling_sms,onChange:s=>c("throttling_sms",parseInt(s.target.value)),className:"mt-1"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Recomendado: 3 SMS por día (solo críticos)"})]})]})})]}),e.jsxs(m,{children:[e.jsxs(d,{children:[e.jsxs(x,{className:"flex items-center space-x-2",children:[e.jsx(J,{className:"h-5 w-5 text-purple-600"}),e.jsx("span",{children:"Resúmenes Diarios"})]}),e.jsx(j,{children:"Configurar el envío automático de resúmenes diarios"})]}),e.jsxs(h,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"hora-resumen",className:"text-sm font-medium",children:"Hora de envío (formato 24h)"}),e.jsxs(D,{value:a.resumen_diario_hora,onValueChange:s=>c("resumen_diario_hora",s),children:[e.jsx(H,{className:"mt-1",children:e.jsx(F,{})}),e.jsxs(P,{children:[e.jsx(r,{value:"06:00",children:"06:00 AM"}),e.jsx(r,{value:"07:00",children:"07:00 AM"}),e.jsx(r,{value:"08:00",children:"08:00 AM"}),e.jsx(r,{value:"09:00",children:"09:00 AM"}),e.jsx(r,{value:"10:00",children:"10:00 AM"}),e.jsx(r,{value:"18:00",children:"06:00 PM"}),e.jsx(r,{value:"19:00",children:"07:00 PM"}),e.jsx(r,{value:"20:00",children:"08:00 PM"})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Los resúmenes se envían solo si hay actividad pendiente"})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx(i,{className:"text-sm font-medium",children:"Destinatarios automáticos"}),e.jsx("div",{className:"mt-2 space-y-2",children:M.map(s=>e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx($,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{children:s.name}),e.jsx(t,{variant:"outline",className:"text-xs",children:s.email})]},s.id))}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Solo usuarios con roles administrativos reciben resúmenes"})]}),e.jsxs(u,{onClick:E,disabled:f,className:"w-full",variant:"outline",children:[f?e.jsx(A,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(K,{className:"h-4 w-4 mr-2"}),"Enviar Resúmenes Ahora"]})]})]}),e.jsxs(m,{children:[e.jsx(d,{children:e.jsxs(x,{className:"flex items-center space-x-2",children:[e.jsx(C,{className:"h-5 w-5 text-yellow-600"}),e.jsx("span",{children:"Información del Sistema"})]})}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Cron Jobs:"}),e.jsx(t,{variant:"outline",children:"Configurado"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Queue Workers:"}),e.jsx(t,{variant:"outline",children:a.queue_connection})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Ambiente:"}),e.jsx(t,{variant:a.ambiente==="production"?"default":"secondary",children:a.ambiente})]})]}),e.jsx(b,{}),e.jsxs("div",{className:"space-y-2 text-xs text-gray-500",children:[e.jsx("p",{children:e.jsx("strong",{children:"Notas importantes:"})}),e.jsxs("ul",{className:"space-y-1 ml-4 list-disc",children:[e.jsx("li",{children:"Los cambios requieren restart del queue worker"}),e.jsx("li",{children:"SMS solo funciona en producción con API key válida"}),e.jsx("li",{children:"Los límites de throttling usan caché de Laravel"}),e.jsx("li",{children:"Los resúmenes se procesan por cron job diario"})]})]})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(u,{onClick:k,disabled:p,size:"lg",children:[p?e.jsx(A,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(X,{className:"h-4 w-4 mr-2"}),"Guardar Configuración"]})})]})]})}export{fe as default};
