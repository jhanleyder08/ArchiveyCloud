import{r as T,j as e,H as A,L as g}from"./app-B0qTBAke.js";import{A as E,S as N,F as I,a as j,d as H,K as S}from"./app-sidebar-layout-DFKjANJB.js";import{B as d}from"./app-logo-icon-BPz3oRny.js";import{C as c,a as n,b as x,c as u,d as m}from"./card-D4UBhCKF.js";import{B as i}from"./badge-BfEjTxB-.js";import{A as f,a as p}from"./alert-D_YNC9Mv.js";import{T as k,a as B,b as v,c as r,d as L,e as t}from"./table-CE6luIq3.js";import{A as z}from"./arrow-left-DojSOgLu.js";import{I as R}from"./info-LDuxxin2.js";import{C as K}from"./calendar-BhhYq1qO.js";import{C as b}from"./circle-x-DnCpljQ6.js";import{C as _}from"./circle-check-big-CLyWiRXH.js";/* empty css            */import"./index-DDzTzhRc.js";import"./label-CjHZv5e4.js";import"./index-D-todNvr.js";function ie({documento:l,verificacion:a}){const[o,y]=T.useState(!1),w=s=>{switch(s){case"valido":return e.jsx(_,{className:"h-6 w-6 text-green-500"});case"invalido":return e.jsx(b,{className:"h-6 w-6 text-red-500"});case"parcial":return e.jsx(j,{className:"h-6 w-6 text-yellow-500"});default:return e.jsx(j,{className:"h-6 w-6 text-gray-500"})}},C=s=>{switch(s){case"valido":return e.jsx(i,{className:"bg-green-100 text-green-800",children:"✓ Válido"});case"invalido":return e.jsx(i,{className:"bg-red-100 text-red-800",children:"✗ Inválido"});case"parcial":return e.jsx(i,{className:"bg-yellow-100 text-yellow-800",children:"⚠ Parcial"});default:return e.jsx(i,{className:"bg-gray-100 text-gray-800",children:"? Desconocido"})}},V=s=>s?e.jsx(_,{className:"h-4 w-4 text-green-500"}):e.jsx(b,{className:"h-4 w-4 text-red-500"}),D=s=>new Date(s).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),F=s=>new Date(s)<new Date;return e.jsxs(E,{children:[e.jsx(A,{title:`Verificar Firmas - ${l.nombre}`}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(g,{href:route("admin.firmas.dashboard"),children:e.jsxs(d,{variant:"outline",size:"sm",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Volver"]})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center",children:[e.jsx(N,{className:"h-8 w-8 mr-3 text-blue-600"}),"Verificación de Firmas Digitales"]}),e.jsx("p",{className:"text-muted-foreground",children:"Validación de autenticidad e integridad de firmas digitales"})]})]})}),e.jsxs(c,{className:"border-2",children:[e.jsxs(n,{children:[e.jsxs(x,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[w(a.estado_general),e.jsx("span",{children:"Estado General de Verificación"})]}),C(a.estado_general)]}),e.jsx(u,{children:"Resultado de la verificación integral del documento y sus firmas digitales"})]}),e.jsxs(m,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:a.total_firmas}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total de Firmas"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:a.firmas_validas}),e.jsx("div",{className:"text-sm text-gray-500",children:"Firmas Válidas"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-red-600",children:a.firmas_invalidas}),e.jsx("div",{className:"text-sm text-gray-500",children:"Firmas Inválidas"})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("h4",{className:"font-medium flex items-center mb-3",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Documento Verificado"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Nombre:"})," ",l.nombre]}),l.expediente&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Expediente:"})," ",l.expediente.codigo," - ",l.expediente.nombre]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Integridad:"}),e.jsx(i,{className:a.documento_integro?"bg-green-100 text-green-800 ml-2":"bg-red-100 text-red-800 ml-2",children:a.documento_integro?"✓ Íntegro":"✗ Alterado"})]}),l.hash_integridad&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Hash:"}),e.jsxs("span",{className:"font-mono text-xs ml-2",children:[l.hash_integridad.substring(0,16),"..."]})]})]})]})]})]}),(a.alertas?.length>0||a.recomendaciones?.length>0)&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.alertas?.length>0&&e.jsxs(f,{variant:"destructive",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsxs(p,{children:[e.jsx("strong",{children:"Alertas Detectadas:"}),e.jsx("ul",{className:"mt-2 list-disc list-inside",children:a.alertas.map((s,h)=>e.jsx("li",{children:s},h))})]})]}),a.recomendaciones?.length>0&&e.jsxs(f,{children:[e.jsx(R,{className:"h-4 w-4"}),e.jsxs(p,{children:[e.jsx("strong",{children:"Recomendaciones:"}),e.jsx("ul",{className:"mt-2 list-disc list-inside",children:a.recomendaciones.map((s,h)=>e.jsx("li",{children:s},h))})]})]})]}),e.jsxs(c,{children:[e.jsxs(n,{children:[e.jsx(x,{children:"Firmas Digitales Detectadas"}),e.jsx(u,{children:"Listado detallado de todas las firmas aplicadas al documento"})]}),e.jsx(m,{children:a.firmas.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(k,{children:[e.jsx(B,{children:e.jsxs(v,{children:[e.jsx(r,{children:"Estado"}),e.jsx(r,{children:"Firmante"}),e.jsx(r,{children:"Fecha de Firma"}),e.jsx(r,{children:"Certificado"}),e.jsx(r,{children:"Hash"})]})}),e.jsx(L,{children:a.firmas.map(s=>e.jsxs(v,{children:[e.jsx(t,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[V(s.es_valida),e.jsx(i,{variant:s.es_valida?"secondary":"destructive",children:s.es_valida?"Válida":"Inválida"})]})}),e.jsx(t,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.usuario.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.usuario.email})]})]})}),e.jsx(t,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(K,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:D(s.fecha_firma)})]})}),e.jsx(t,{children:s.certificado?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(S,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.certificado.nombre_certificado}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Serie: ",s.certificado.numero_serie]}),e.jsx("div",{className:"text-xs",children:e.jsxs(i,{variant:F(s.certificado.fecha_vencimiento)?"destructive":"outline",children:["Vence: ",new Date(s.certificado.fecha_vencimiento).toLocaleDateString()]})})]})]}):e.jsx("span",{className:"text-gray-500",children:"Sin certificado"})}),e.jsx(t,{children:e.jsxs("div",{className:"font-mono text-xs",children:[e.jsx("div",{children:s.algoritmo_hash}),e.jsxs("div",{children:[s.hash_firma.substring(0,16),"..."]})]})})]},s.id))})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(N,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay firmas digitales"}),e.jsx("p",{className:"text-gray-600",children:"Este documento no tiene firmas digitales aplicadas."})]})})]}),e.jsxs(c,{children:[e.jsx(n,{children:e.jsxs(x,{className:"flex items-center justify-between",children:["Detalles Técnicos de Verificación",e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>y(!o),children:[o?"Ocultar":"Mostrar"," Detalles"]})]})}),o&&e.jsx(m,{children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium",children:"Verificación de Integridad"}),e.jsxs("div",{className:"text-sm space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Estado:"}),e.jsx(i,{className:a.detalles_verificacion.integridad_documento?"bg-green-100 text-green-800 ml-2":"bg-red-100 text-red-800 ml-2",children:a.detalles_verificacion.integridad_documento?"Íntegro":"Alterado"})]}),a.detalles_verificacion.hash_original&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Hash Original:"}),e.jsx("div",{className:"font-mono text-xs break-all",children:a.detalles_verificacion.hash_original})]}),a.detalles_verificacion.hash_actual&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Hash Actual:"}),e.jsx("div",{className:"font-mono text-xs break-all",children:a.detalles_verificacion.hash_actual})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium",children:"Verificación de Certificados"}),e.jsxs("div",{className:"text-sm space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Certificados Válidos:"}),e.jsx("span",{className:"ml-2 text-green-600",children:a.detalles_verificacion.certificados_validos})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Certificados Vencidos:"}),e.jsx("span",{className:"ml-2 text-red-600",children:a.detalles_verificacion.certificados_vencidos})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Cadena de Confianza:"}),e.jsx(i,{className:a.detalles_verificacion.cadena_confianza?"bg-green-100 text-green-800 ml-2":"bg-red-100 text-red-800 ml-2",children:a.detalles_verificacion.cadena_confianza?"Válida":"Inválida"})]})]})]})]})})})]}),e.jsxs(c,{children:[e.jsx(n,{children:e.jsx(x,{children:"Acciones"})}),e.jsx(m,{children:e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(d,{onClick:()=>window.print(),children:"Imprimir Reporte"}),e.jsx(d,{variant:"outline",children:"Exportar Verificación"}),e.jsx(g,{href:route("admin.documentos.show",l.id),children:e.jsx(d,{variant:"outline",children:"Ver Documento"})})]})})]})]})]})}export{ie as default};
