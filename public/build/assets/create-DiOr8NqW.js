import{u as z,r as _,j as e,H as G,L}from"./app-DOeYTPnE.js";import{A as K}from"./app-layout-CKT_ksyH.js";import{C as h,a as p,b as u,c as j,d as V}from"./card-BEZSel9K.js";import{B as g}from"./button-BB3j1qH9.js";import{I as t}from"./index-C7D1JV-H.js";import{L as i}from"./label-BvABT9uR.js";import{T as S}from"./app-sidebar-layout-83PL_wom.js";import{S as v,a as b,b as f,c as N,d as c}from"./select-D2zOlv3c.js";import{S as E}from"./switch-DIpGF78c.js";import{B as k}from"./badge-BDHWk-Qv.js";import{T as J,a as Q,b as C,c as y}from"./tabs-CZodpFxR.js";import{P}from"./plus-Dfkec5yu.js";import{T as W}from"./trash-2-COYRgziV.js";import{S as X}from"./save-DHvE8w7l.js";import{A as Y}from"./arrow-left-Cvz8oF6O.js";/* empty css            */import"./index-B5i9qy2Y.js";import"./index-Cl_hWV--.js";import"./index-BuQaqXjb.js";import"./x-BHxLkKP3.js";import"./index-sj4qH-fg.js";import"./app-logo-icon-BTiqVlKS.js";import"./user-BiSWd6pJ.js";import"./triangle-alert-B7e9hRq_.js";import"./index-pqvegj4w.js";import"./check-C4IDWgVr.js";function _e({series:T,categorias:O}){const{data:a,setData:r,post:F,processing:w,errors:m}=z({nombre:"",descripcion:"",categoria:"otro",tipo_documento:"",serie_documental_id:"",subserie_documental_id:"",contenido_html:"",campos_variables:[],metadatos_predefinidos:{},configuracion_formato:{},es_publica:!1,tags:[],observaciones:""}),[q,H]=_.useState(null),[x,A]=_.useState(""),[l,o]=_.useState({nombre:"",tipo:"texto",etiqueta:"",requerido:!1,valor_defecto:"",opciones:[]}),I=s=>{s.preventDefault(),F(route("admin.plantillas.store"))},B=s=>{const n=T.find(d=>d.id.toString()===s);H(n||null),r("serie_documental_id",s),r("subserie_documental_id","")},D=()=>{x.trim()&&!a.tags.includes(x.trim())&&(r("tags",[...a.tags,x.trim()]),A(""))},M=s=>{r("tags",a.tags.filter((n,d)=>d!==s))},U=()=>{l.nombre&&l.etiqueta&&(r("campos_variables",[...a.campos_variables,{...l}]),o({nombre:"",tipo:"texto",etiqueta:"",requerido:!1,valor_defecto:"",opciones:[]}))},R=s=>{r("campos_variables",a.campos_variables.filter((n,d)=>d!==s))};return e.jsxs(K,{header:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(L,{href:route("admin.plantillas.index"),className:"text-gray-500 hover:text-gray-700",children:e.jsx(Y,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Nueva Plantilla Documental"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Crear nueva plantilla para documentos estandarizados"})]})]})}),children:[e.jsx(G,{title:"Nueva Plantilla Documental"}),e.jsx("div",{className:"py-6",children:e.jsx("div",{className:"max-w-4xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("form",{onSubmit:I,className:"space-y-6",children:[e.jsxs(J,{defaultValue:"basicos",className:"w-full",children:[e.jsxs(Q,{className:"grid w-full grid-cols-4",children:[e.jsx(C,{value:"basicos",children:"Datos Básicos"}),e.jsx(C,{value:"contenido",children:"Contenido"}),e.jsx(C,{value:"variables",children:"Variables"}),e.jsx(C,{value:"configuracion",children:"Configuración"})]}),e.jsx(y,{value:"basicos",className:"space-y-6",children:e.jsxs(h,{children:[e.jsx(p,{children:e.jsx(u,{children:"Información General"})}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"nombre",children:"Nombre de la Plantilla *"}),e.jsx(t,{id:"nombre",value:a.nombre,onChange:s=>r("nombre",s.target.value),className:m.nombre?"border-red-500":""}),m.nombre&&e.jsx("p",{className:"text-sm text-red-600",children:m.nombre})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"categoria",children:"Categoría *"}),e.jsxs(v,{value:a.categoria,onValueChange:s=>r("categoria",s),children:[e.jsx(b,{className:m.categoria?"border-red-500":"",children:e.jsx(f,{})}),e.jsx(N,{children:Object.entries(O).map(([s,n])=>e.jsx(c,{value:s,children:n},s))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"descripcion",children:"Descripción"}),e.jsx(S,{id:"descripcion",value:a.descripcion,onChange:s=>r("descripcion",s.target.value),rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"tipo_documento",children:"Tipo de Documento"}),e.jsx(t,{id:"tipo_documento",value:a.tipo_documento,onChange:s=>r("tipo_documento",s.target.value),placeholder:"Ej: Memorando interno, Oficio externo..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Serie Documental"}),e.jsxs(v,{onValueChange:B,children:[e.jsx(b,{children:e.jsx(f,{placeholder:"Seleccionar serie"})}),e.jsxs(N,{children:[e.jsx(c,{value:"null",children:"Sin serie específica"}),T.map(s=>e.jsxs(c,{value:s.id.toString(),children:[s.codigo," - ",s.nombre]},s.id))]})]})]}),q?.subseries&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Subserie Documental"}),e.jsxs(v,{onValueChange:s=>r("subserie_documental_id",s),children:[e.jsx(b,{children:e.jsx(f,{placeholder:"Seleccionar subserie"})}),e.jsxs(N,{children:[e.jsx(c,{value:"null",children:"Sin subserie"}),q.subseries.map(s=>e.jsxs(c,{value:s.id.toString(),children:[s.codigo," - ",s.nombre]},s.id))]})]})]})]})]})]})}),e.jsx(y,{value:"contenido",className:"space-y-6",children:e.jsxs(h,{children:[e.jsxs(p,{children:[e.jsx(u,{children:"Contenido HTML"}),e.jsx(V,{children:"Define el contenido base de la plantilla usando HTML"})]}),e.jsxs(j,{children:[e.jsx(S,{value:a.contenido_html,onChange:s=>r("contenido_html",s.target.value),rows:12,placeholder:"Ingresa el contenido HTML de la plantilla...",className:"font-mono text-sm"}),e.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:[e.jsxs("p",{children:["Puedes usar variables con la sintaxis: ",e.jsx("code",{children:"{{VARIABLE_NAME}}"})]}),e.jsxs("p",{children:["Variables del sistema disponibles: ",e.jsx("code",{children:"{{FECHA_ACTUAL}}, {{USUARIO_ACTUAL}}, {{CODIGO_DOCUMENTO}}"})]})]})]})]})}),e.jsx(y,{value:"variables",className:"space-y-6",children:e.jsxs(h,{children:[e.jsxs(p,{children:[e.jsx(u,{children:"Campos Variables"}),e.jsx(V,{children:"Define campos que se pueden personalizar al generar documentos"})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 border rounded-lg",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Nombre de la Variable"}),e.jsx(t,{value:l.nombre,onChange:s=>o({...l,nombre:s.target.value}),placeholder:"nombre_variable"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Etiqueta"}),e.jsx(t,{value:l.etiqueta,onChange:s=>o({...l,etiqueta:s.target.value}),placeholder:"Etiqueta visible"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Tipo"}),e.jsxs(v,{value:l.tipo,onValueChange:s=>o({...l,tipo:s}),children:[e.jsx(b,{children:e.jsx(f,{})}),e.jsxs(N,{children:[e.jsx(c,{value:"texto",children:"Texto"}),e.jsx(c,{value:"numero",children:"Número"}),e.jsx(c,{value:"fecha",children:"Fecha"}),e.jsx(c,{value:"email",children:"Email"}),e.jsx(c,{value:"textarea",children:"Texto largo"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Valor por defecto"}),e.jsx(t,{value:l.valor_defecto,onChange:s=>o({...l,valor_defecto:s.target.value}),placeholder:"Valor inicial"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{checked:l.requerido,onCheckedChange:s=>o({...l,requerido:s})}),e.jsx(i,{children:"Campo requerido"})]}),e.jsx("div",{children:e.jsxs(g,{type:"button",onClick:U,variant:"outline",children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Agregar Campo"]})})]}),a.campos_variables.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Campos definidos:"}),a.campos_variables.map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:s.etiqueta}),e.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["(",s.nombre," - ",s.tipo,")"]}),s.requerido&&e.jsx(k,{variant:"secondary",className:"ml-2",children:"Requerido"})]}),e.jsx(g,{type:"button",variant:"ghost",size:"sm",onClick:()=>R(n),children:e.jsx(W,{className:"w-4 h-4"})})]},n))]})]})]})}),e.jsx(y,{value:"configuracion",className:"space-y-6",children:e.jsxs(h,{children:[e.jsx(p,{children:e.jsx(u,{children:"Configuración Adicional"})}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{checked:a.es_publica,onCheckedChange:s=>r("es_publica",s)}),e.jsx(i,{children:"Plantilla pública (disponible para todos los usuarios)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Tags"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(t,{value:x,onChange:s=>A(s.target.value),placeholder:"Agregar tag",onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),D())}),e.jsx(g,{type:"button",onClick:D,variant:"outline",children:e.jsx(P,{className:"w-4 h-4"})})]}),a.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:a.tags.map((s,n)=>e.jsxs(k,{variant:"secondary",className:"cursor-pointer",onClick:()=>M(n),children:[s," ×"]},n))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Observaciones"}),e.jsx(S,{value:a.observaciones,onChange:s=>r("observaciones",s.target.value),rows:3,placeholder:"Notas adicionales sobre la plantilla"})]})]})]})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(L,{href:route("admin.plantillas.index"),className:"inline-flex items-center px-4 py-2 bg-gray-300 border border-transparent rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest hover:bg-gray-400",children:"Cancelar"}),e.jsxs(g,{type:"submit",disabled:w,children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),w?"Guardando...":"Crear Plantilla"]})]})]})})})]})}export{_e as default};
