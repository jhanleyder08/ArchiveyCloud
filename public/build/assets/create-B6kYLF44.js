import{r as C,u as G,j as e,H,L as y,b as K}from"./app-tMaUuF3G.js";import{f as O,A as q,K as Y}from"./app-sidebar-layout-DrvTFVRU.js";import{c as $,B as _}from"./button-b2NvRhsY.js";import{C as d,a as n,b as m,d as h,c as x}from"./card-B1dP6K0M.js";import{I as p}from"./input-BUbi3POq.js";import{L as s}from"./label-Bqu3HQD6.js";import{S as u,a as f,b as j,c as v,d as l}from"./select-CdhdgJ0w.js";import{C as J}from"./checkbox-C304e6F8.js";import{T as Q,a as W,b as S,c as k}from"./tabs-DN7fnGV-.js";import{A as F,a as w}from"./alert-DhY9P36X.js";import{U as D}from"./upload-BlXEQH5C.js";import{S as X}from"./triangle-alert-JjU49oaO.js";import{U as Z}from"./user-BK5OEaM4.js";import{L as ee}from"./lock-Cy0EuteE.js";/* empty css            */import"./index-gcMQB5yO.js";import"./Combination-CgNv0oAU.js";import"./index-BqccPZiJ.js";import"./index-DReOSayN.js";import"./x-B3QVzJhq.js";import"./app-logo-icon-DkUm7hxR.js";import"./mail-CwCHIGE1.js";import"./users-0BijOv_M.js";import"./folder-CyeXS8Xg.js";import"./search-a-c68EbR.js";import"./BrandingProvider-DUeywemA.js";import"./index-CWm8oeKh.js";import"./check-CjMGlCJz.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]],ie=$("Cpu",ae);function Te({usuarios:A,tipos_certificado:M,usos_permitidos:T,algoritmos_firma:I}){const[g,L]=C.useState("generar"),[t,N]=C.useState(["firma_digital"]),{data:r,setData:c,post:re,processing:b,errors:i,reset:U}=G({usuario_id:"",nombre_certificado:"",tipo_certificado:"usuario",algoritmo_firma:"RSA",longitud_clave:2048,uso_permitido:["firma_digital"],fecha_vencimiento:"",archivo_certificado:null,archivo_clave_publica:null}),V=a=>{a.preventDefault();const o={...r,uso_permitido:t};K.post(route("admin.certificados.store"),o,{forceFormData:!0,onSuccess:()=>{U()}})},E=(a,o)=>{N(o?[...t,a]:t.filter(z=>z!==a))},P=()=>{const a=new Date;return a.setDate(a.getDate()+1),a.toISOString().split("T")[0]},B=()=>{const a=new Date;return a.setFullYear(a.getFullYear()+10),a.toISOString().split("T")[0]},R=a=>({usuario:"Certificado para identificación y firma de usuarios individuales",servidor:"Certificado para servicios de servidor y aplicaciones",autoridad_certificadora:"Certificado de Autoridad Certificadora (CA)",sello_tiempo:"Certificado para servicios de sellado de tiempo"})[a]||"";return e.jsxs(O,{children:[e.jsx(H,{title:"Crear Certificado Digital"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(y,{href:route("admin.certificados.index"),children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Volver"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Crear Certificado Digital"}),e.jsx("p",{className:"text-muted-foreground",children:"Generar o importar un nuevo certificado digital PKI"})]})]})}),e.jsxs("form",{onSubmit:V,className:"space-y-6",children:[e.jsxs(Q,{value:g,onValueChange:a=>L(a),children:[e.jsxs(W,{className:"grid w-full grid-cols-2",children:[e.jsxs(S,{value:"generar",className:"flex items-center",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Generar Certificado"]}),e.jsxs(S,{value:"importar",className:"flex items-center",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Importar Certificado"]})]}),e.jsx(k,{value:"generar",className:"space-y-6",children:e.jsxs(F,{children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx(w,{children:"Se generará automáticamente un nuevo par de claves RSA y el certificado correspondiente. El certificado será auto-firmado y válido para los usos seleccionados."})]})}),e.jsxs(k,{value:"importar",className:"space-y-6",children:[e.jsxs(F,{children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx(w,{children:"Importe un certificado existente en formato PEM, DER o CRT. Opcionalmente puede proporcionar la clave pública correspondiente."})]}),e.jsxs(d,{children:[e.jsxs(n,{children:[e.jsx(m,{children:"Archivos del Certificado"}),e.jsx(h,{children:"Seleccione los archivos del certificado a importar"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"archivo_certificado",children:"Archivo de Certificado *"}),e.jsx(p,{id:"archivo_certificado",type:"file",accept:".crt,.cer,.pem,.der",onChange:a=>c("archivo_certificado",a.target.files?.[0]||null),className:i.archivo_certificado?"border-red-500":""}),i.archivo_certificado&&e.jsx("p",{className:"text-sm text-red-600",children:i.archivo_certificado}),e.jsx("p",{className:"text-sm text-gray-600",children:"Formatos soportados: .crt, .cer, .pem, .der (máximo 2MB)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"archivo_clave_publica",children:"Archivo de Clave Pública (opcional)"}),e.jsx(p,{id:"archivo_clave_publica",type:"file",accept:".key,.pem",onChange:a=>c("archivo_clave_publica",a.target.files?.[0]||null),className:i.archivo_clave_publica?"border-red-500":""}),i.archivo_clave_publica&&e.jsx("p",{className:"text-sm text-red-600",children:i.archivo_clave_publica}),e.jsx("p",{className:"text-sm text-gray-600",children:"Formatos soportados: .key, .pem (máximo 2MB)"})]})]})]})]})]}),e.jsxs(d,{children:[e.jsxs(n,{children:[e.jsxs(m,{className:"flex items-center",children:[e.jsx(Z,{className:"h-5 w-5 mr-2"}),"Información Básica"]}),e.jsx(h,{children:"Configure la información básica del certificado"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"usuario_id",children:"Usuario Propietario *"}),e.jsxs(u,{value:r.usuario_id,onValueChange:a=>c("usuario_id",a),children:[e.jsx(f,{className:i.usuario_id?"border-red-500":"",children:e.jsx(j,{placeholder:"Seleccionar usuario"})}),e.jsx(v,{children:A.map(a=>e.jsxs(l,{value:a.id.toString(),children:[a.name," (",a.email,")"]},a.id))})]}),i.usuario_id&&e.jsx("p",{className:"text-sm text-red-600",children:i.usuario_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"nombre_certificado",children:"Nombre del Certificado *"}),e.jsx(p,{id:"nombre_certificado",value:r.nombre_certificado,onChange:a=>c("nombre_certificado",a.target.value),placeholder:"Ej: Certificado Firma Digital Juan Pérez",className:i.nombre_certificado?"border-red-500":""}),i.nombre_certificado&&e.jsx("p",{className:"text-sm text-red-600",children:i.nombre_certificado})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"tipo_certificado",children:"Tipo de Certificado *"}),e.jsxs(u,{value:r.tipo_certificado,onValueChange:a=>c("tipo_certificado",a),children:[e.jsx(f,{className:i.tipo_certificado?"border-red-500":"",children:e.jsx(j,{placeholder:"Seleccionar tipo"})}),e.jsx(v,{children:M.map(a=>e.jsx(l,{value:a.value,children:a.label},a.value))})]}),r.tipo_certificado&&e.jsx("p",{className:"text-sm text-gray-600",children:R(r.tipo_certificado)}),i.tipo_certificado&&e.jsx("p",{className:"text-sm text-red-600",children:i.tipo_certificado})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"fecha_vencimiento",children:"Fecha de Vencimiento *"}),e.jsx(p,{id:"fecha_vencimiento",type:"date",value:r.fecha_vencimiento,onChange:a=>c("fecha_vencimiento",a.target.value),min:P(),max:B(),className:i.fecha_vencimiento?"border-red-500":""}),i.fecha_vencimiento&&e.jsx("p",{className:"text-sm text-red-600",children:i.fecha_vencimiento}),e.jsx("p",{className:"text-sm text-gray-600",children:"El certificado será válido desde hoy hasta la fecha seleccionada (máximo 10 años)"})]})]})]}),g==="generar"&&e.jsxs(d,{children:[e.jsxs(n,{children:[e.jsxs(m,{className:"flex items-center",children:[e.jsx(ie,{className:"h-5 w-5 mr-2"}),"Configuración Criptográfica"]}),e.jsx(h,{children:"Configure los parámetros criptográficos del certificado"})]}),e.jsx(x,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"algoritmo_firma",children:"Algoritmo de Firma *"}),e.jsxs(u,{value:r.algoritmo_firma,onValueChange:a=>c("algoritmo_firma",a),children:[e.jsx(f,{className:i.algoritmo_firma?"border-red-500":"",children:e.jsx(j,{placeholder:"Seleccionar algoritmo"})}),e.jsx(v,{children:I.map(a=>e.jsx(l,{value:a.value,children:a.label},a.value))})]}),i.algoritmo_firma&&e.jsx("p",{className:"text-sm text-red-600",children:i.algoritmo_firma})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"longitud_clave",children:"Longitud de Clave *"}),e.jsxs(u,{value:r.longitud_clave.toString(),onValueChange:a=>c("longitud_clave",parseInt(a)),children:[e.jsx(f,{className:i.longitud_clave?"border-red-500":"",children:e.jsx(j,{placeholder:"Seleccionar longitud"})}),e.jsxs(v,{children:[e.jsx(l,{value:"1024",children:"1024 bits (Básico)"}),e.jsx(l,{value:"2048",children:"2048 bits (Recomendado)"}),e.jsx(l,{value:"4096",children:"4096 bits (Alta Seguridad)"})]})]}),i.longitud_clave&&e.jsx("p",{className:"text-sm text-red-600",children:i.longitud_clave}),e.jsx("p",{className:"text-sm text-gray-600",children:"Mayor longitud = mayor seguridad pero menor velocidad"})]})]})})]}),e.jsxs(d,{children:[e.jsxs(n,{children:[e.jsxs(m,{className:"flex items-center",children:[e.jsx(ee,{className:"h-5 w-5 mr-2"}),"Usos Permitidos"]}),e.jsx(h,{children:"Seleccione los usos autorizados para este certificado"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:T.map(a=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(J,{id:`uso_${a.value}`,checked:t.includes(a.value),onCheckedChange:o=>E(a.value,o)}),e.jsx(s,{htmlFor:`uso_${a.value}`,className:"text-sm font-medium",children:a.label})]},a.value))}),i.uso_permitido&&e.jsx("p",{className:"text-sm text-red-600 mt-2",children:i.uso_permitido}),t.length===0&&e.jsx("p",{className:"text-sm text-orange-600 mt-2",children:"Debe seleccionar al menos un uso permitido"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(y,{href:route("admin.certificados.index"),children:e.jsx(_,{type:"button",variant:"outline",children:"Cancelar"})}),e.jsx(_,{type:"submit",disabled:b||t.length===0,className:"min-w-[120px]",children:b?"Procesando...":g==="generar"?"Generar Certificado":"Importar Certificado"})]})]})]})]})}export{Te as default};
