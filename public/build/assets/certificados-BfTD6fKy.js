import{r as N,j as e,H as X,b as n,L as G}from"./app-CjMiy3Q5.js";import{A as O}from"./app-layout-DIs-u5aB.js";import{c as Z,B as l}from"./button-A4aNvoQw.js";import{C as x,a as h,b as j,c as u,d as J}from"./card-C03h05jd.js";import{B as d}from"./badge-B0q_dRzt.js";import{I as Q}from"./input-CC_EwJIc.js";import{S as y,a as C,b as _,c as w,d as t}from"./select-CcUgcjil.js";import{T as W,a as Y,b as S,c as p,d as ee,e as o}from"./table-DtGG3vRf.js";import{D as se,a as ae,b as re,c as te,d as le,e as ie}from"./app-sidebar-layout-DpLfkLDt.js";import{A as ce,a as ne}from"./alert-DPLj5to_.js";import{U as de}from"./upload-D6wVGHUd.js";import{S as oe,T}from"./triangle-alert-CucTBQzM.js";import{F as me}from"./filter-CmcqqIm9.js";import{S as V}from"./search-BnT0cgMG.js";import{R as xe}from"./refresh-cw-CLHak5In.js";import{C as he}from"./calendar-CFh33eF0.js";import{E as je}from"./eye-Bhc80Zhl.js";import{D as R}from"./users-D9veXo2c.js";import{T as ue}from"./trash-2-CLcrBYzN.js";import{C as D}from"./circle-x-CGcj-njd.js";import{C as pe}from"./circle-check-big-orUoBWw1.js";/* empty css            */import"./index-6vFXYaqq.js";import"./index-0YfHMj78.js";import"./Combination-BH0bcfYv.js";import"./index-cKAjioWG.js";import"./check-DekjwXEH.js";import"./index-D5uAfdjI.js";import"./x-B8cNsGQP.js";import"./index-DX1_V9zL.js";import"./app-logo-icon-DTZ4vsfq.js";import"./label-BU7ButmP.js";import"./user-DtXdfUG6.js";import"./folder-BAMVIGBI.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["circle",{cx:"10",cy:"16",r:"2",key:"4ckbqe"}],["path",{d:"m16 10-4.5 4.5",key:"7p3ebg"}],["path",{d:"m15 11 1 1",key:"1bsyx3"}]],ve=Z("FileKey",ge);function Ye({certificados:r,filtros:z,usuarios:B,estadisticas:m}){const[c,k]=N.useState(z),[a,H]=N.useState(null),[I,b]=N.useState(!1),[L,A]=N.useState(!1),U=()=>{n.get(route("admin.firmas.certificados"),c,{preserveState:!0,preserveScroll:!0})},P=()=>{k({}),n.get(route("admin.firmas.certificados"))},v=(s,i)=>{const g={...c};g[s]=i,(!i||i==="all")&&delete g[s],k(g)},E=(s,i)=>{if(!i)return e.jsx(d,{variant:"destructive",children:"Vencido"});switch(s){case"activo":return e.jsx(d,{className:"bg-green-500 text-white",children:"Activo"});case"vencido":return e.jsx(d,{variant:"destructive",children:"Vencido"});case"revocado":return e.jsx(d,{className:"bg-red-600 text-white",children:"Revocado"});case"suspendido":return e.jsx(d,{className:"bg-orange-500 text-white",children:"Suspendido"});default:return e.jsx(d,{variant:"secondary",children:s})}},F=s=>{const g={usuario:{color:"bg-blue-500 text-white",label:"Usuario"},servidor:{color:"bg-purple-500 text-white",label:"Servidor"},autoridad_certificadora:{color:"bg-indigo-600 text-white",label:"AC"},sello_tiempo:{color:"bg-teal-500 text-white",label:"TSA"}}[s]||{color:"bg-gray-500 text-white",label:s};return e.jsx(d,{className:g.color,children:g.label})},q=(s,i)=>{if(!i)return e.jsx(D,{className:"w-4 h-4 text-red-600"});switch(s){case"activo":return e.jsx(pe,{className:"w-4 h-4 text-green-600"});case"vencido":return e.jsx(D,{className:"w-4 h-4 text-red-600"});case"revocado":return e.jsx(D,{className:"w-4 h-4 text-red-600"});case"suspendido":return e.jsx(T,{className:"w-4 h-4 text-orange-600"});default:return e.jsx(T,{className:"w-4 h-4 text-gray-600"})}},f=s=>new Date(s).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}),M=s=>s<0?"Vencido":s===0?"Hoy":s===1?"Ma침ana":`${s} d칤as`,K=async s=>{if(confirm(`쮼st치s seguro de revocar el certificado ${s.nombre_certificado}?`)){A(!0);try{await n.post(route("admin.firmas.certificado.revocar",s.id),{razon:"Revocaci칩n manual por administrador"})}finally{A(!1)}}},$=s=>{H(s),b(!0)};return e.jsxs(O,{children:[e.jsx(X,{title:"Certificados Digitales"}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"md:flex md:items-center md:justify-between mb-6",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate",children:"Certificados Digitales PKI 游댏"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Gesti칩n de certificados X.509 para firma electr칩nica"})]}),e.jsxs("div",{className:"mt-4 flex md:mt-0 md:ml-4 space-x-3",children:[e.jsxs(l,{onClick:()=>n.get(route("admin.firmas.certificado.crear")),children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Importar Certificado"]}),e.jsx(G,{href:route("admin.firmas.dashboard"),children:e.jsxs(l,{variant:"outline",children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Dashboard"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[e.jsxs(x,{children:[e.jsx(h,{className:"pb-2",children:e.jsx(j,{className:"text-sm font-medium",children:"Total"})}),e.jsxs(u,{children:[e.jsx("div",{className:"text-2xl font-bold",children:m.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"certificados"})]})]}),e.jsxs(x,{children:[e.jsx(h,{className:"pb-2",children:e.jsx(j,{className:"text-sm font-medium",children:"Activos"})}),e.jsxs(u,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:m.activos}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"vigentes"})]})]}),e.jsxs(x,{children:[e.jsx(h,{className:"pb-2",children:e.jsx(j,{className:"text-sm font-medium",children:"Pr칩ximos a Vencer"})}),e.jsxs(u,{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:m.proximos_vencer}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["<"," 30 d칤as"]})]})]}),e.jsxs(x,{children:[e.jsx(h,{className:"pb-2",children:e.jsx(j,{className:"text-sm font-medium",children:"Vencidos"})}),e.jsxs(u,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:m.vencidos}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"inv치lidos"})]})]}),e.jsxs(x,{children:[e.jsx(h,{className:"pb-2",children:e.jsx(j,{className:"text-sm font-medium",children:"Revocados"})}),e.jsxs(u,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-800",children:m.revocados}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"cancelados"})]})]})]}),m.proximos_vencer>0&&e.jsxs(ce,{className:"mb-6 border-orange-200 bg-orange-50",children:[e.jsx(T,{className:"h-4 w-4 text-orange-600"}),e.jsxs(ne,{className:"text-orange-800",children:["Tienes ",m.proximos_vencer," certificado(s) que vencer치n en los pr칩ximos 30 d칤as. Es recomendable renovarlos o generar nuevos certificados."]})]}),e.jsxs(x,{className:"mb-6",children:[e.jsx(h,{children:e.jsxs(j,{className:"text-lg flex items-center",children:[e.jsx(me,{className:"w-5 h-5 mr-2"}),"Filtros de B칰squeda"]})}),e.jsx(u,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Buscar"}),e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"w-4 h-4 absolute left-3 top-3 text-gray-400"}),e.jsx(Q,{placeholder:"Nombre, serie, emisor...",value:c.search||"",onChange:s=>v("search",s.target.value),className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Estado"}),e.jsxs(y,{value:c.estado||"all",onValueChange:s=>v("estado",s),children:[e.jsx(C,{children:e.jsx(_,{placeholder:"Todos los estados"})}),e.jsxs(w,{children:[e.jsx(t,{value:"all",children:"Todos los estados"}),e.jsx(t,{value:"activo",children:"Activo"}),e.jsx(t,{value:"vencido",children:"Vencido"}),e.jsx(t,{value:"revocado",children:"Revocado"}),e.jsx(t,{value:"suspendido",children:"Suspendido"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Tipo"}),e.jsxs(y,{value:c.tipo||"all",onValueChange:s=>v("tipo",s),children:[e.jsx(C,{children:e.jsx(_,{placeholder:"Todos los tipos"})}),e.jsxs(w,{children:[e.jsx(t,{value:"all",children:"Todos los tipos"}),e.jsx(t,{value:"usuario",children:"Usuario"}),e.jsx(t,{value:"servidor",children:"Servidor"}),e.jsx(t,{value:"autoridad_certificadora",children:"Autoridad Certificadora"}),e.jsx(t,{value:"sello_tiempo",children:"Sello de Tiempo"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Usuario"}),e.jsxs(y,{value:c.usuario_id?.toString()||"all",onValueChange:s=>v("usuario_id",s==="all"?null:parseInt(s)),children:[e.jsx(C,{children:e.jsx(_,{placeholder:"Todos los usuarios"})}),e.jsxs(w,{children:[e.jsx(t,{value:"all",children:"Todos los usuarios"}),B.map(s=>e.jsx(t,{value:s.id.toString(),children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"flex items-end space-x-2",children:[e.jsxs(l,{onClick:U,className:"flex-1",children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"Filtrar"]}),e.jsx(l,{onClick:P,variant:"outline",children:e.jsx(xe,{className:"w-4 h-4"})})]})]})})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(j,{children:"Certificados Digitales"}),e.jsxs(J,{children:[r.meta.total," certificado(s) encontrado(s)"]})]}),e.jsxs(u,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(W,{children:[e.jsx(Y,{children:e.jsxs(S,{children:[e.jsx(p,{children:"Estado"}),e.jsx(p,{children:"Certificado"}),e.jsx(p,{children:"Tipo"}),e.jsx(p,{children:"Usuario"}),e.jsx(p,{children:"Emisor"}),e.jsx(p,{children:"Vencimiento"}),e.jsx(p,{children:"Acciones"})]})}),e.jsx(ee,{children:r.data.length===0?e.jsx(S,{children:e.jsxs(o,{colSpan:7,className:"text-center py-8",children:[e.jsx(ve,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-500",children:"No se encontraron certificados"})]})}):r.data.map(s=>e.jsxs(S,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[q(s.estado,s.vigente),E(s.estado,s.vigente)]})}),e.jsx(o,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.nombre_certificado}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Serie: ",s.numero_serie]}),e.jsxs("div",{className:"text-xs text-gray-400",children:[s.algoritmo_firma," (",s.longitud_clave," bits)"]})]})}),e.jsx(o,{children:F(s.tipo_certificado)}),e.jsx(o,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.usuario.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.usuario.email})]})}),e.jsx(o,{children:e.jsx("div",{className:"text-sm",children:s.emisor})}),e.jsx(o,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(he,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:f(s.fecha_vencimiento)})]}),e.jsx("div",{className:`text-xs ${s.dias_restantes<30?"text-orange-600":"text-gray-500"}`,children:M(s.dias_restantes)})]})}),e.jsx(o,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(l,{size:"sm",variant:"outline",onClick:()=>$(s),children:e.jsx(je,{className:"w-4 h-4"})}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>n.get(route("admin.firmas.certificado.descargar",s.id)),children:e.jsx(R,{className:"w-4 h-4"})}),s.estado==="activo"&&e.jsx(l,{size:"sm",variant:"destructive",onClick:()=>K(s),disabled:L,children:e.jsx(ue,{className:"w-4 h-4"})})]})})]},s.id))})]})}),r.meta.last_page>1&&e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Mostrando ",r.meta.from," a ",r.meta.to," de ",r.meta.total," certificados"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[r.meta.current_page>1&&e.jsx(l,{variant:"outline",size:"sm",onClick:()=>n.get(route("admin.firmas.certificados"),{...c,page:r.meta.current_page-1}),children:"Anterior"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["P치gina ",r.meta.current_page," de ",r.meta.last_page]}),r.meta.current_page<r.meta.last_page&&e.jsx(l,{variant:"outline",size:"sm",onClick:()=>n.get(route("admin.firmas.certificados"),{...c,page:r.meta.current_page+1}),children:"Siguiente"})]})]})]})]})]})}),e.jsx(se,{open:I,onOpenChange:b,children:e.jsxs(ae,{className:"max-w-2xl",children:[e.jsxs(re,{children:[e.jsx(te,{children:"Detalles del Certificado"}),e.jsx(le,{children:"Informaci칩n completa del certificado digital"})]}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Nombre"}),e.jsx("p",{className:"text-sm",children:a.nombre_certificado})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"N칰mero de Serie"}),e.jsx("p",{className:"text-sm font-mono",children:a.numero_serie})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Estado"}),e.jsx("div",{className:"flex items-center space-x-2",children:E(a.estado,a.vigente)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Tipo"}),e.jsx("div",{children:F(a.tipo_certificado)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Algoritmo"}),e.jsx("p",{className:"text-sm",children:a.algoritmo_firma})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Longitud de Clave"}),e.jsxs("p",{className:"text-sm",children:[a.longitud_clave," bits"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Emisor"}),e.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded text-wrap",children:a.emisor})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Sujeto"}),e.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded text-wrap",children:a.sujeto})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Huella Digital (SHA-256)"}),e.jsx("p",{className:"text-xs font-mono bg-gray-50 p-2 rounded break-all",children:a.huella_digital})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Fecha de Emisi칩n"}),e.jsx("p",{className:"text-sm",children:f(a.fecha_emision)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Fecha de Vencimiento"}),e.jsx("p",{className:"text-sm",children:f(a.fecha_vencimiento)})]})]}),a.uso_permitido&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Uso Permitido"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:a.uso_permitido.map((s,i)=>e.jsx(d,{variant:"outline",className:"text-xs",children:s},i))})]}),a.revocado_en&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Revocado"}),e.jsxs("p",{className:"text-sm text-red-600",children:[f(a.revocado_en),a.razon_revocacion&&e.jsxs("span",{className:"block text-xs text-gray-500 mt-1",children:["Raz칩n: ",a.razon_revocacion]})]})]})]}),e.jsxs(ie,{children:[e.jsx(l,{variant:"outline",onClick:()=>b(!1),children:"Cerrar"}),a&&e.jsxs(l,{onClick:()=>n.get(route("admin.firmas.certificado.descargar",a.id)),children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Descargar"]})]})]})})]})}export{Ye as default};
