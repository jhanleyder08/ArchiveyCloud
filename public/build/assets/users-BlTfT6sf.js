import{e as J,r as i,b as h,j as e,H as K,L as u}from"./app-tMaUuF3G.js";import{A as W}from"./app-layout-Do2Eb3Sk.js";import{B as p}from"./button-b2NvRhsY.js";import{I as d}from"./input-BUbi3POq.js";import{S,a as E,b as F,c as D,d as c}from"./select-CdhdgJ0w.js";import{u as Y,j as Z,k as N,l as b,m as y,D as U,a as I,b as P,c as R,d as $,e as M}from"./app-sidebar-layout-DrvTFVRU.js";import{L as l}from"./label-Bqu3HQD6.js";import{C as ee}from"./checkbox-C304e6F8.js";import{I as m}from"./input-error-Beb-xIRk.js";import{A as se,a as ae}from"./alert-DhY9P36X.js";import{U as L}from"./users-0BijOv_M.js";import{S as re}from"./triangle-alert-JjU49oaO.js";import{P as te}from"./plus-bKOZofE8.js";import{C as le}from"./circle-alert-B-OTrNj1.js";import{T as V}from"./trash-2-C2WpkApr.js";import{S as ie}from"./search-a-c68EbR.js";import{E as de}from"./eye-CUHphNhr.js";import{S as ne}from"./square-pen-hyh2d0kN.js";import{U as oe}from"./user-x-DW8OHYoA.js";import{U as ce}from"./user-check-BAAtSqYx.js";/* empty css            */import"./index-gcMQB5yO.js";import"./Combination-CgNv0oAU.js";import"./index-BqccPZiJ.js";import"./index-CWm8oeKh.js";import"./check-CjMGlCJz.js";import"./index-DReOSayN.js";import"./x-B3QVzJhq.js";import"./app-logo-icon-DkUm7hxR.js";import"./user-BK5OEaM4.js";import"./mail-CwCHIGE1.js";import"./folder-CyeXS8Xg.js";import"./BrandingProvider-DUeywemA.js";const me=[{title:"Dashboard",href:"/dashboard"},{title:"Administración",href:"#"},{title:"Gestión de usuarios",href:"/admin/users"}];function Ke({users:n,stats:x,roles:k,filters:w}){const{flash:j}=J().props,O=Y(),T=i.useRef(!0),[xe,he]=i.useState(w.search||""),[g,f]=i.useState(null),[G,v]=i.useState(!1),[H,ue]=i.useState(null),[a,t]=i.useState({name:"",email:"",role_id:"",password:"",password_confirmation:"",verify_email:!1,documento_identidad:"",tipo_documento:"cedula_ciudadania",telefono:"",cargo:"",dependencia:"",fecha_ingreso:"",fecha_vencimiento_cuenta:""}),[r,A]=i.useState({}),[pe,je]=i.useState({name:"",email:"",role_id:"",active:!0,documento_identidad:"",tipo_documento:"cedula_ciudadania",telefono:"",cargo:"",dependencia:"",fecha_ingreso:"",fecha_vencimiento_cuenta:""}),[_,B]=i.useState(w.search||""),[C,q]=i.useState(w.status||"");i.useEffect(()=>{if(T.current){T.current=!1;return}const s=setTimeout(()=>{h.get("/admin/users",{search:_||void 0,status:C||void 0},{preserveState:!1,replace:!0})},500);return()=>clearTimeout(s)},[_,C]),i.useEffect(()=>{},[H]);const Q=s=>{h.patch(`/admin/users/${s.id}/toggle-status`,{},{preserveScroll:!0,onSuccess:()=>{h.reload({only:["users","stats"]})}})},z=s=>new Date(s).toLocaleDateString("es-ES"),X=s=>s.active?s.email_verified_at?{text:"Activo",color:"bg-green-100 text-green-800"}:{text:"Pendiente",color:"bg-yellow-100 text-yellow-800"}:{text:"Inactivo",color:"bg-red-100 text-red-800"};return e.jsxs(W,{breadcrumbs:me,children:[e.jsx(K,{title:"Gestión de Usuarios"}),e.jsxs("div",{className:"space-y-6",children:[j?.success&&e.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg",children:j.success}),j?.error&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:j.error}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-6 w-6 text-[#2a3d83]"}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Gestión de Usuarios"})]}),e.jsxs("div",{className:"flex gap-2",children:[O.isSuperAdmin()&&e.jsx(u,{href:"/admin/roles",children:e.jsxs(p,{variant:"outline",className:"border-[#2a3d83] text-[#2a3d83] hover:bg-blue-50",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Gestionar Roles"]})}),e.jsxs(p,{onClick:()=>v(!0),className:"flex items-center gap-2 px-4 py-2 bg-[#2a3d83] text-white rounded-lg hover:bg-[#1e2b5f] transition-colors",children:[e.jsx(te,{className:"h-4 w-4"}),"Nuevo Usuario"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Usuarios"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:x.total})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(L,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Usuarios Activos"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:x.active})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx("div",{className:"h-6 w-6 bg-[#2a3d83] rounded-full flex items-center justify-center",children:e.jsx("div",{className:"h-2 w-2 bg-white rounded-full"})})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pendientes"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:x.pending})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx("div",{className:"h-6 w-6 bg-[#2a3d83] rounded-full flex items-center justify-center",children:e.jsx("div",{className:"h-2 w-2 bg-white rounded-full"})})})]})}),x.without_role>0&&e.jsx("div",{className:"bg-white rounded-lg border border-red-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-red-600 font-medium",children:"⚠️ Sin Rol"}),e.jsx("p",{className:"text-2xl font-semibold text-red-700",children:x.without_role})]}),e.jsx("div",{className:"p-3 bg-red-100 rounded-full",children:e.jsx(le,{className:"h-6 w-6 text-red-600"})})]})}),x.deleted>0&&e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Eliminados"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-700",children:x.deleted}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Sus correos pueden reutilizarse"})]}),e.jsx("div",{className:"p-3 bg-gray-100 rounded-full",children:e.jsx(V,{className:"h-6 w-6 text-gray-600"})})]})})]}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4 w-full sm:w-auto",children:e.jsxs("div",{className:"relative flex-1 sm:w-80",children:[e.jsx(ie,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(d,{type:"text",value:_,onChange:s=>B(s.target.value),placeholder:"Buscar usuarios...",className:"pl-10"})]})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(S,{value:C||"all",onValueChange:s=>q(s==="all"?"":s),children:[e.jsx(E,{className:"w-[180px]",children:e.jsx(F,{placeholder:"Todos los estados"})}),e.jsxs(D,{children:[e.jsx(c,{value:"all",children:"Todos los estados"}),e.jsx(c,{value:"active",children:"Activos"}),e.jsx(c,{value:"inactive",children:"Inactivos"}),e.jsx(c,{value:"pending",children:"Pendientes"}),x.without_role>0&&e.jsxs(c,{value:"without_role",className:"text-red-600 font-medium",children:["⚠️ Sin Rol (",x.without_role,")"]})]})]})})]})}),e.jsx("div",{className:"bg-white rounded-lg border overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Usuario"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Email"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Rol"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Estado"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Registro"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Acciones"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:n.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-8 px-6 text-center text-gray-500",children:"No se encontraron usuarios."})}):n.data.map(s=>{const o=X(s);return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 bg-[#2a3d83] rounded-full flex items-center justify-center text-white text-sm font-medium",children:s.name.charAt(0).toUpperCase()}),e.jsx("span",{className:"font-medium text-gray-900",children:s.name})]})}),e.jsx("td",{className:"py-4 px-6 text-gray-600",children:s.email}),e.jsx("td",{className:"py-4 px-6",children:s.role?.name?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-[#2a3d83]",children:s.role.name}):e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"⚠️ Sin rol asignado"})}),e.jsx("td",{className:"py-4 px-6",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${o.color}`,children:o.text})}),e.jsx("td",{className:"py-4 px-6 text-gray-600",children:z(s.created_at)}),e.jsx("td",{className:"py-4 px-6",children:e.jsx(Z,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(N,{children:[e.jsx(b,{asChild:!0,children:e.jsx(u,{href:`/admin/users/${s.id}`,className:"p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-50 transition-colors inline-flex",children:e.jsx(de,{className:"h-4 w-4"})})}),e.jsx(y,{children:e.jsx("p",{children:"Ver detalles del usuario"})})]}),e.jsxs(N,{children:[e.jsx(b,{asChild:!0,children:e.jsx(u,{href:`/admin/users/${s.id}/edit`,className:"p-2 rounded-md text-[#2a3d83] hover:text-[#1e2b5f] hover:bg-blue-50 transition-colors inline-flex",children:e.jsx(ne,{className:"h-4 w-4"})})}),e.jsx(y,{children:e.jsx("p",{children:"Editar usuario"})})]}),e.jsxs(N,{children:[e.jsx(b,{asChild:!0,children:e.jsx("button",{onClick:()=>Q(s),className:`p-2 rounded-md transition-colors ${s.active?"text-orange-600 hover:text-orange-800 hover:bg-orange-50":"text-green-600 hover:text-green-800 hover:bg-green-50"}`,children:s.active?e.jsx(oe,{className:"h-4 w-4"}):e.jsx(ce,{className:"h-4 w-4"})})}),e.jsx(y,{children:e.jsx("p",{children:s.active?"Desactivar usuario":"Activar usuario"})})]}),e.jsxs(N,{children:[e.jsx(b,{asChild:!0,children:e.jsx("button",{onClick:()=>f(s),className:"p-2 rounded-md text-red-600 hover:text-red-800 hover:bg-red-50 transition-colors",children:e.jsx(V,{className:"h-4 w-4"})})}),e.jsx(y,{children:e.jsx("p",{children:"Eliminar usuario"})})]})]})})})]},s.id)})})]})})}),n.data.length>0&&e.jsxs("div",{className:"flex items-center justify-between bg-white border rounded-lg px-6 py-3",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",e.jsx("span",{className:"font-medium",children:n.meta?.from||n.from||0})," a"," ",e.jsx("span",{className:"font-medium",children:n.meta?.to||n.to||0})," de"," ",e.jsx("span",{className:"font-medium",children:n.meta?.total||n.total||0})," usuarios"]}),e.jsx("div",{className:"flex items-center gap-2",children:n.links.map((s,o)=>s.label.includes("Previous")?e.jsx(u,{href:s.url||"#",preserveState:!0,className:`px-3 py-2 border border-gray-300 rounded-md text-sm font-medium ${s.url?"text-gray-700 hover:bg-gray-50":"text-gray-300 cursor-not-allowed"}`,children:"Anterior"},o):s.label.includes("Next")?e.jsx(u,{href:s.url||"#",preserveState:!0,className:`px-3 py-2 border border-gray-300 rounded-md text-sm font-medium ${s.url?"text-gray-700 hover:bg-gray-50":"text-gray-300 cursor-not-allowed"}`,children:"Siguiente"},o):isNaN(Number(s.label))?null:e.jsx(u,{href:s.url||"#",preserveState:!0,className:`px-3 py-2 rounded-md text-sm font-medium ${s.active?"bg-[#2a3d83] text-white":"border border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:s.label},o))})]}),e.jsx(U,{open:G,onOpenChange:v,children:e.jsxs(I,{className:"sm:max-w-[500px]",children:[e.jsxs(P,{children:[e.jsx(R,{children:"Registrar Nuevo Usuario"}),e.jsx($,{children:"Complete los datos para crear un nuevo usuario en el sistema."})]}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),A({}),h.post("/admin/users",a,{preserveScroll:!0,onSuccess:()=>{v(!1),t({name:"",email:"",role_id:"",password:"",password_confirmation:"",verify_email:!1,documento_identidad:"",tipo_documento:"cedula_ciudadania",telefono:"",cargo:"",dependencia:"",fecha_ingreso:"",fecha_vencimiento_cuenta:""}),h.reload({only:["users","stats"]})},onError:o=>{A(o)}})},children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[Object.keys(r).length>0&&e.jsx(se,{variant:"destructive",children:e.jsx(ae,{children:Object.values(r).map((s,o)=>e.jsx("div",{children:s},o))})}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"create-name",children:"Nombre completo"}),e.jsx(d,{id:"create-name",value:a.name,onChange:s=>t({...a,name:s.target.value}),placeholder:"Nombre del usuario"}),r.name&&e.jsx(m,{message:r.name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"create-email",children:"Correo electrónico"}),e.jsx(d,{id:"create-email",type:"email",value:a.email,onChange:s=>t({...a,email:s.target.value}),placeholder:"correo@ejemplo.com"}),r.email&&e.jsx(m,{message:r.email})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"create-role",children:"Rol"}),e.jsxs(S,{value:a.role_id,onValueChange:s=>t({...a,role_id:s}),children:[e.jsx(E,{children:e.jsx(F,{placeholder:"Seleccionar rol"})}),e.jsx(D,{children:k.map(s=>e.jsx(c,{value:s.id.toString(),children:s.name},s.id))})]}),r.role_id&&e.jsx(m,{message:r.role_id})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"create-password",children:"Contraseña"}),e.jsx(d,{id:"create-password",type:"password",value:a.password,onChange:s=>t({...a,password:s.target.value}),placeholder:"••••••••"}),r.password&&e.jsx(m,{message:r.password})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"create-password-confirm",children:"Confirmar contraseña"}),e.jsx(d,{id:"create-password-confirm",type:"password",value:a.password_confirmation,onChange:s=>t({...a,password_confirmation:s.target.value}),placeholder:"••••••••"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ee,{id:"create-verify-email",checked:a.verify_email,onCheckedChange:s=>t({...a,verify_email:s})}),e.jsx(l,{htmlFor:"create-verify-email",className:"text-sm font-normal",children:"Marcar email como verificado"})]}),e.jsx("div",{className:"col-span-2 border-t pt-4 mt-2",children:e.jsx("h3",{className:"font-semibold mb-3",children:"Información Personal y Laboral"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"create-documento",children:"Documento de Identidad"}),e.jsx(d,{id:"create-documento",value:a.documento_identidad,onChange:s=>t({...a,documento_identidad:s.target.value}),placeholder:"Ej: 1234567890"}),r.documento_identidad&&e.jsx(m,{message:r.documento_identidad})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"create-tipo-documento",children:"Tipo de Documento"}),e.jsxs(S,{value:a.tipo_documento,onValueChange:s=>t({...a,tipo_documento:s}),children:[e.jsx(E,{children:e.jsx(F,{})}),e.jsxs(D,{children:[e.jsx(c,{value:"cedula_ciudadania",children:"Cédula de Ciudadanía"}),e.jsx(c,{value:"cedula_extranjeria",children:"Cédula de Extranjería"}),e.jsx(c,{value:"pasaporte",children:"Pasaporte"}),e.jsx(c,{value:"tarjeta_identidad",children:"Tarjeta de Identidad"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"create-telefono",children:"Teléfono"}),e.jsx(d,{id:"create-telefono",value:a.telefono,onChange:s=>t({...a,telefono:s.target.value}),placeholder:"Ej: 3001234567"}),r.telefono&&e.jsx(m,{message:r.telefono})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"create-cargo",children:"Cargo"}),e.jsx(d,{id:"create-cargo",value:a.cargo,onChange:s=>t({...a,cargo:s.target.value}),placeholder:"Ej: Analista"}),r.cargo&&e.jsx(m,{message:r.cargo})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"create-dependencia",children:"Dependencia"}),e.jsx(d,{id:"create-dependencia",value:a.dependencia,onChange:s=>t({...a,dependencia:s.target.value}),placeholder:"Ej: Recursos Humanos"}),r.dependencia&&e.jsx(m,{message:r.dependencia})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"create-fecha-ingreso",children:"Fecha de Ingreso"}),e.jsx(d,{id:"create-fecha-ingreso",type:"date",value:a.fecha_ingreso,onChange:s=>t({...a,fecha_ingreso:s.target.value})}),r.fecha_ingreso&&e.jsx(m,{message:r.fecha_ingreso})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"create-fecha-vencimiento",children:"Fecha de Vencimiento de Cuenta (Opcional)"}),e.jsx(d,{id:"create-fecha-vencimiento",type:"date",value:a.fecha_vencimiento_cuenta,onChange:s=>t({...a,fecha_vencimiento_cuenta:s.target.value})}),r.fecha_vencimiento_cuenta&&e.jsx(m,{message:r.fecha_vencimiento_cuenta})]})]})]}),e.jsxs(M,{children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>v(!1),children:"Cancelar"}),e.jsx(p,{type:"submit",className:"bg-[#2a3d83] hover:bg-[#1e2b5f]",children:"Crear Usuario"})]})]})]})}),e.jsx(U,{open:!!g,onOpenChange:s=>!s&&f(null),children:e.jsxs(I,{children:[e.jsxs(P,{children:[e.jsx(R,{children:"Confirmar Eliminación"}),e.jsxs($,{children:["¿Estás seguro de que deseas eliminar al usuario ",e.jsx("span",{className:"font-semibold",children:g?.name}),"? Esta acción no se puede deshacer."]})]}),e.jsxs(M,{children:[e.jsx(p,{variant:"outline",onClick:()=>f(null),children:"Cancelar"}),e.jsx(p,{variant:"destructive",onClick:()=>{g&&h.delete(`/admin/users/${g.id}`,{preserveScroll:!0,onSuccess:()=>{f(null),h.reload({only:["users","stats"]})}})},children:"Eliminar"})]})]})})]})]})}export{Ke as default};
