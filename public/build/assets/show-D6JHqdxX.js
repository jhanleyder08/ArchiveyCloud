import{j as e,H as A,L as o}from"./app-B-PXR1Ni.js";import{A as D}from"./app-layout-DJutQZnN.js";import{C as i,a as d,b as n,d as l,c as h}from"./card-Dmlm_cpt.js";import{B as m}from"./app-logo-icon-BLsuM4IN.js";import{B as t}from"./badge-CNo-IL5x.js";import{A as S,a as q}from"./alert-CjcJnkq6.js";import{A as z}from"./arrow-left-DbMIHj5m.js";import{S as E}from"./square-pen-gP4PZLVJ.js";import{R}from"./refresh-cw-3XorCIzG.js";import{a as T,K as P,d as B,C as L,S as j,b as I,e as K}from"./app-sidebar-layout-D9ulO2li.js";import{C as F}from"./calendar-CQqh5lbn.js";import{A as p}from"./activity-C6UpYrzU.js";import{N as U}from"./network-CTjrBv-E.js";import{R as u,T as f}from"./CategoricalChart-CH0D5Ee9.js";import{A as $,a as H}from"./AreaChart-CFwtnipi.js";import{C as N,X as g,Y as v}from"./CartesianChart-NCe_zQZc.js";import{B as O}from"./BarChart-BF04k3Nq.js";import{B as M}from"./barSelectors-DPP-5Sbk.js";import{f as y,e as b}from"./es-tlGrzipH.js";/* empty css            */import"./index-DsJw0RIA.js";import"./label-CcIhawib.js";import"./index-DARluDlH.js";import"./ActivePoints-guwd7fUl.js";import"./tooltipContext-A_zzaiNE.js";function ue({token:s,estadisticas:r}){const w=a=>{switch(a){case"activo":return e.jsx(t,{className:"bg-green-100 text-green-800",children:"Activo"});case"inactivo":return e.jsx(t,{variant:"secondary",children:"Inactivo"});case"expirado":return e.jsx(t,{className:"bg-red-100 text-red-800",children:"Expirado"});case"limite_alcanzado":return e.jsx(t,{className:"bg-orange-100 text-orange-800",children:"Límite alcanzado"});default:return e.jsx(t,{variant:"outline",children:a})}},_=Object.entries(r.requests_por_dia||{}).map(([a,c])=>({fecha:a,requests:c,fechaFormateada:new Date(a).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit"})})),x=Object.entries(r.rutas_mas_usadas||{}).map(([a,c])=>({ruta:a.length>30?a.substring(0,30)+"...":a,rutaCompleta:a,requests:c}));return e.jsxs(D,{children:[e.jsx(A,{title:`${s.nombre} - API Tokens - ArchiveyCloud`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(o,{href:"/admin/api-tokens",children:e.jsxs(m,{variant:"outline",size:"sm",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Volver a Tokens"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:s.nombre}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Detalles y estadísticas del token API"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(o,{href:`/admin/api-tokens/${s.id}/edit`,children:e.jsxs(m,{variant:"outline",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Editar"]})}),s.estado==="activo"&&e.jsxs(m,{variant:"outline",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Renovar"]})]})]}),(s.estado==="expirado"||s.estado==="limite_alcanzado")&&e.jsxs(S,{className:"border-orange-200 bg-orange-50",children:[e.jsx(T,{className:"h-4 w-4 text-orange-600"}),e.jsx(q,{className:"text-orange-800",children:s.estado==="expirado"?"Este token ha expirado y no puede ser usado para realizar requests":"Este token ha alcanzado su límite de usos"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(i,{children:[e.jsx(d,{children:e.jsxs(n,{className:"flex items-center",children:[e.jsx(P,{className:"h-5 w-5 mr-2"}),"Información del Token"]})}),e.jsxs(l,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Estado"}),e.jsx("div",{className:"mt-1",children:w(s.estado)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Propietario"}),e.jsxs("div",{className:"mt-1 flex items-center",children:[e.jsx(B,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsx("span",{children:s.usuario.name})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Creado"}),e.jsxs("div",{className:"mt-1 flex items-center",children:[e.jsx(F,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsx("span",{children:y(new Date(s.created_at),{addSuffix:!0,locale:b})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Último uso"}),e.jsxs("div",{className:"mt-1 flex items-center",children:[e.jsx(p,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsx("span",{children:s.ultimo_uso?y(new Date(s.ultimo_uso),{addSuffix:!0,locale:b}):"Nunca usado"})]})]})]}),s.descripcion&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Descripción"}),e.jsx("p",{className:"mt-1 text-gray-900",children:s.descripcion})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Configuración"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.fecha_expiracion&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Expira"}),e.jsxs("div",{className:"mt-1 flex items-center",children:[e.jsx(L,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsxs("span",{children:[new Date(s.fecha_expiracion).toLocaleDateString("es-ES"),s.dias_hasta_expiracion!==null&&e.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["(",s.dias_hasta_expiracion," días)"]})]})]})]}),s.limite_usos&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Límite de usos"}),e.jsxs("div",{className:"mt-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("span",{children:[s.usos_realizados," / ",s.limite_usos]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[s.porcentaje_uso,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${(s.porcentaje_uso||0)>80?"bg-red-600":(s.porcentaje_uso||0)>60?"bg-orange-600":"bg-green-600"}`,style:{width:`${s.porcentaje_uso||0}%`}})})]})]})]})]}),s.ips_permitidas&&s.ips_permitidas.length>0&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"IPs Permitidas"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:s.ips_permitidas.map(a=>e.jsxs(t,{variant:"outline",className:"flex items-center",children:[e.jsx(U,{className:"h-3 w-3 mr-1"}),a]},a))})]})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(i,{children:[e.jsx(d,{children:e.jsx(n,{className:"text-lg",children:"Resumen de Uso"})}),e.jsxs(l,{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:r.resumen.total_requests}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total requests"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:r.resumen.dias_activos}),e.jsx("p",{className:"text-sm text-gray-600",children:"Días activos"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:r.resumen.ips_diferentes}),e.jsx("p",{className:"text-sm text-gray-600",children:"IPs diferentes"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:r.resumen.promedio_requests_dia}),e.jsx("p",{className:"text-sm text-gray-600",children:"Promedio por día"})]})]})]}),e.jsxs(i,{children:[e.jsx(d,{children:e.jsxs(n,{className:"text-lg flex items-center",children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"Permisos"]})}),e.jsx(l,{children:e.jsx("div",{className:"space-y-2",children:s.permisos.map(a=>e.jsxs(t,{variant:"outline",className:"block w-full justify-start",children:[e.jsx(j,{className:"h-3 w-3 mr-2"}),a]},a))})})]})]})]}),r.resumen.total_requests>0&&e.jsxs(e.Fragment,{children:[e.jsxs(i,{children:[e.jsxs(d,{children:[e.jsxs(n,{className:"flex items-center",children:[e.jsx(I,{className:"h-5 w-5 mr-2"}),"Actividad Diaria (Últimos 30 días)"]}),e.jsx(h,{children:"Número de requests realizados por día"})]}),e.jsx(l,{children:e.jsx("div",{className:"h-80",children:e.jsx(u,{width:"100%",height:"100%",children:e.jsxs($,{data:_,children:[e.jsx(N,{strokeDasharray:"3 3"}),e.jsx(g,{dataKey:"fechaFormateada",tick:{fontSize:12}}),e.jsx(v,{tick:{fontSize:12}}),e.jsx(f,{labelFormatter:a=>`Fecha: ${a}`,formatter:(a,c)=>[a,"Requests"]}),e.jsx(H,{type:"monotone",dataKey:"requests",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.2})]})})})})]}),x.length>0&&e.jsxs(i,{children:[e.jsxs(d,{children:[e.jsxs(n,{className:"flex items-center",children:[e.jsx(K,{className:"h-5 w-5 mr-2"}),"Rutas Más Usadas"]}),e.jsx(h,{children:"Endpoints más consultados por este token"})]}),e.jsx(l,{children:e.jsx("div",{className:"h-80",children:e.jsx(u,{width:"100%",height:"100%",children:e.jsxs(O,{data:x,layout:"horizontal",children:[e.jsx(N,{strokeDasharray:"3 3"}),e.jsx(g,{type:"number",tick:{fontSize:12}}),e.jsx(v,{type:"category",dataKey:"ruta",tick:{fontSize:10},width:120}),e.jsx(f,{formatter:(a,c,C)=>[a,"Requests",C.payload.rutaCompleta]}),e.jsx(M,{dataKey:"requests",fill:"#3b82f6"})]})})})})]})]}),r.resumen.total_requests===0&&e.jsx(i,{children:e.jsx(l,{className:"pt-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(p,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Sin actividad"}),e.jsx("p",{className:"text-gray-600",children:"Este token aún no ha sido usado para realizar requests"})]})})})]})]})}export{ue as default};
