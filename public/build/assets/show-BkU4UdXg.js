import{r as R,j as e,H as z,L as j}from"./app-CcKfyaCU.js";import{A as M}from"./app-layout-C75vkcyi.js";import{c as S,B as i}from"./button-CLk8mODa.js";import{C as n,a as l,b as d,c as m,d as P}from"./card-DB_ax1hF.js";import{B as r}from"./badge-bHIPzgvw.js";import{P as W}from"./progress-CKSPUzcV.js";import{S as u}from"./separator-CCozb0r1.js";import{A as v,a as y}from"./alert-B69v_qG3.js";import{G as U,M as _,x as L}from"./app-sidebar-layout-BXlSAu8N.js";import{C as x}from"./circle-check-big-2Nty5MB_.js";import{T as q,S as H}from"./triangle-alert-VTzysZy9.js";import{F as C}from"./Combination-CUlyt3Qj.js";import{U as G}from"./user-BXzsLEON.js";import{C as I}from"./calendar-BCtatpHs.js";import{C as N}from"./folder-31vdAhi2.js";import{U as A}from"./users-2HnGrV9k.js";import{C as V}from"./circle-x-D-4J0frD.js";/* empty css            */import"./index-ll0PAeEe.js";import"./index-BntgwZbj.js";import"./index-B0t8Wn8h.js";import"./x-D64GJCvX.js";import"./index-dTY0tLa0.js";import"./app-logo-icon-C6dTzLrG.js";import"./input-Bjf7NZ4L.js";import"./label-BJXeACpA.js";import"./search-DJHS9xSC.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],J=S("ArrowRight",X);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],O=S("Ban",K);function _e({workflow:s,nivelesAprobacion:o,puedeAprobar:g,esSolicitante:B}){const[Q,D]=R.useState(!1),b=a=>({borrador:e.jsx(r,{variant:"outline",className:"text-gray-600",children:"Borrador"}),pendiente:e.jsx(r,{variant:"outline",className:"text-yellow-600",children:"Pendiente"}),en_revision:e.jsx(r,{className:"bg-blue-100 text-blue-800",children:"En Revisión"}),aprobado:e.jsx(r,{className:"bg-green-100 text-green-800",children:"Aprobado"}),rechazado:e.jsx(r,{variant:"destructive",children:"Rechazado"}),cancelado:e.jsx(r,{variant:"outline",className:"text-gray-500",children:"Cancelado"})})[a]||e.jsx(r,{variant:"outline",children:a}),T=a=>({Crítica:e.jsx(r,{variant:"destructive",children:"Crítica"}),Alta:e.jsx(r,{className:"bg-orange-100 text-orange-800",children:"Alta"}),Media:e.jsx(r,{variant:"outline",className:"text-blue-600",children:"Media"}),Baja:e.jsx(r,{variant:"outline",className:"text-gray-600",children:"Baja"})})[a]||e.jsx(r,{variant:"outline",children:a}),$=a=>{switch(a){case"Aprobado":return e.jsx(x,{className:"w-4 h-4 text-green-600"});case"Rechazado":return e.jsx(V,{className:"w-4 h-4 text-red-600"});case"Enviado a Revisión":return e.jsx(L,{className:"w-4 h-4 text-blue-600"});case"Delegado":return e.jsx(A,{className:"w-4 h-4 text-orange-600"});default:return e.jsx(N,{className:"w-4 h-4 text-gray-400"})}},t=a=>new Date(a).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),E=a=>{const c=new Date().getTime(),F=new Date(a).getTime(),f=c-F,p=Math.floor(f/(1e3*60*60*24)),h=Math.floor(f%(1e3*60*60*24)/(1e3*60*60));return p>0?`${p} día${p>1?"s":""} y ${h} hora${h>1?"s":""}`:`${h} hora${h>1?"s":""}`};return e.jsxs(M,{children:[e.jsx(z,{title:`Workflow - ${s.documento.nombre}`}),e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(U,{className:"w-8 h-8 text-blue-600"}),"Workflow #",s.id]}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[s.documento.nombre," - ",s.documento.codigo]})]}),e.jsxs("div",{className:"flex gap-3",children:[g&&e.jsx(j,{href:`/admin/workflow/${s.id}/aprobar`,children:e.jsxs(i,{className:"bg-green-600 hover:bg-green-700",children:[e.jsx(x,{className:"w-4 h-4 mr-2"}),"Revisar Documento"]})}),e.jsx(j,{href:"/admin/workflow",children:e.jsx(i,{variant:"outline",children:"Volver a Workflows"})})]})]}),s.esta_vencido&&s.estado!=="aprobado"&&s.estado!=="rechazado"&&e.jsxs(v,{className:"mb-6 border-red-200 bg-red-50",children:[e.jsx(q,{className:"h-4 w-4 text-red-600"}),e.jsxs(y,{className:"text-red-800",children:[e.jsx("strong",{children:"Workflow vencido:"})," Este documento ha excedido la fecha límite de aprobación."]})]}),g&&e.jsxs(v,{className:"mb-6 border-blue-200 bg-blue-50",children:[e.jsx(x,{className:"h-4 w-4 text-blue-600"}),e.jsxs(y,{className:"text-blue-800",children:[e.jsx("strong",{children:"Acción requerida:"})," Este documento está pendiente de tu aprobación."]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(n,{children:[e.jsx(l,{children:e.jsxs(d,{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5"}),"Información del Workflow"]}),b(s.estado)]})}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-1",children:[e.jsx(G,{className:"w-4 h-4"}),"Solicitante"]}),e.jsx("p",{className:"font-medium",children:s.solicitante.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.solicitante.email})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-1",children:[e.jsx(I,{className:"w-4 h-4"}),"Fecha de Solicitud"]}),e.jsx("p",{className:"font-medium",children:t(s.fecha_solicitud)}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Hace ",E(s.fecha_solicitud)]})]})]}),e.jsx(u,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-1",children:[e.jsx(H,{className:"w-4 h-4"}),"Prioridad"]}),T(s.prioridad)]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-1",children:[e.jsx(N,{className:"w-4 h-4"}),"Vencimiento"]}),e.jsx("p",{className:"font-medium",children:t(s.fecha_vencimiento)})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-1",children:[e.jsx(A,{className:"w-4 h-4"}),"Tipo de Aprobación"]}),e.jsx(r,{variant:"outline",children:s.requiere_unanime?"Unánime":"Secuencial"})]})]}),s.descripcion&&e.jsxs(e.Fragment,{children:[e.jsx(u,{}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2",children:[e.jsx(_,{className:"w-4 h-4"}),"Descripción de la Solicitud"]}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsx("p",{className:"text-sm",children:s.descripcion})})]})]}),s.comentarios_finales&&e.jsxs(e.Fragment,{children:[e.jsx(u,{}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2",children:[e.jsx(_,{className:"w-4 h-4"}),"Comentarios Finales"]}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsx("p",{className:"text-sm",children:s.comentarios_finales})})]})]})]})]}),e.jsxs(n,{children:[e.jsxs(l,{children:[e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5"}),"Timeline de Aprobaciones"]}),e.jsx(P,{children:"Progreso del workflow de aprobación"})]}),e.jsxs(m,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Progreso General"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[s.progreso,"%"]})]}),e.jsx(W,{value:s.progreso,className:"h-3"})]}),e.jsx("div",{className:"space-y-4",children:o.map((a,c)=>e.jsxs("div",{className:"relative",children:[c<o.length-1&&e.jsx("div",{className:"absolute left-6 top-12 w-0.5 h-8 bg-gray-200"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`
                                                    w-12 h-12 rounded-full flex items-center justify-center border-2
                                                    ${a.completado?"bg-green-100 border-green-500":a.es_actual?"bg-blue-100 border-blue-500":"bg-gray-100 border-gray-300"}
                                                `,children:a.completado?a.aprobacion?$(a.aprobacion.accion):e.jsx(x,{className:"w-5 h-5 text-green-600"}):a.es_actual?e.jsx(N,{className:"w-5 h-5 text-blue-600"}):e.jsx("span",{className:"text-sm font-medium text-gray-400",children:a.nivel+1})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:`font-medium ${a.es_actual?"text-blue-600":""}`,children:["Nivel ",a.nivel+1," - ",a.usuario?.name||"Usuario no disponible"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[a.usuario?.cargo," - ",a.usuario?.email]})]}),e.jsxs("div",{className:"text-right",children:[a.completado&&a.aprobacion&&e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:a.aprobacion.accion==="Aprobado"?"default":"destructive",className:"mb-1",children:a.aprobacion.accion}),e.jsx("p",{className:"text-xs text-gray-500",children:t(a.aprobacion.fecha)}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Tiempo: ",a.aprobacion.tiempo_respuesta,"h"]})]}),a.es_actual&&!a.completado&&e.jsx(r,{className:"bg-blue-100 text-blue-800",children:"Pendiente"})]})]}),a.aprobacion?.comentarios&&e.jsx("div",{className:"mt-2 p-3 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-700",children:a.aprobacion.comentarios})})]})]})]},a.nivel))})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(n,{children:[e.jsx(l,{children:e.jsx(d,{children:"Acciones"})}),e.jsxs(m,{className:"space-y-3",children:[g&&e.jsx(j,{href:`/admin/workflow/${s.id}/aprobar`,children:e.jsxs(i,{className:"w-full bg-green-600 hover:bg-green-700",children:[e.jsx(x,{className:"w-4 h-4 mr-2"}),"Aprobar/Rechazar"]})}),B&&s.estado!=="aprobado"&&s.estado!=="rechazado"&&s.estado!=="cancelado"&&e.jsxs(i,{variant:"outline",className:"w-full text-red-600 border-red-300 hover:bg-red-50",onClick:()=>D(!0),children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Cancelar Workflow"]}),e.jsx(j,{href:`/admin/documentos/${s.documento.id}`,children:e.jsxs(i,{variant:"outline",className:"w-full",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Ver Documento"]})})]})]}),e.jsxs(n,{children:[e.jsx(l,{children:e.jsx(d,{children:"Estado Actual"})}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Estado"}),b(s.estado)]}),s.revisor_actual&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Revisor Actual"}),e.jsx("p",{className:"font-medium",children:s.revisor_actual.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.revisor_actual.email})]}),s.aprobador_final&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Aprobador Final"}),e.jsx("p",{className:"font-medium",children:s.aprobador_final.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.aprobador_final.email})]}),s.fecha_aprobacion&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Fecha de Aprobación"}),e.jsx("p",{className:"font-medium text-green-600",children:t(s.fecha_aprobacion)})]}),s.fecha_rechazo&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Fecha de Rechazo"}),e.jsx("p",{className:"font-medium text-red-600",children:t(s.fecha_rechazo)})]})]})]}),e.jsxs(n,{children:[e.jsx(l,{children:e.jsx(d,{children:"Estadísticas"})}),e.jsxs(m,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Niveles completados:"}),e.jsxs("span",{className:"font-medium",children:[o.filter(a=>a.completado).length," / ",o.length]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Progreso:"}),e.jsxs("span",{className:"font-medium",children:[s.progreso,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Días transcurridos:"}),e.jsx("span",{className:"font-medium",children:Math.floor((new Date().getTime()-new Date(s.fecha_solicitud).getTime())/(1e3*60*60*24))})]})]})]})]})]})]})]})}export{_e as default};
