import{r as u,u as P,j as e,H as G,L as f,b as j}from"./app-DmFTQNHU.js";import{A as z}from"./app-layout-CF5PBVMg.js";import{B as c}from"./button-B9uqYTIR.js";import{C as l,c as d,a as L,b as V,d as B}from"./card-98qlzFSI.js";import{F,B as p}from"./Combination-DB4vhy5A.js";import{A as H,a as R}from"./alert--kr5pmD-.js";import{C as N}from"./checkbox-aJFP73X7.js";import{T as $,a as q,b,c as n,d as I,e as r}from"./table-EXaSuLM9.js";import{A as M,Z as _,i as O}from"./app-sidebar-layout-B4-tSBlc.js";import{T as v}from"./triangle-alert-Qv0vinvY.js";import{C as y}from"./folder-CyqBlkrb.js";import{C as g}from"./calendar-B2HHxpzZ.js";import{C as w}from"./circle-check-big-DyCuRV4E.js";import{R as Z}from"./refresh-cw-BZG3D1r5.js";import{P as J}from"./plus-B4IyCcb9.js";/* empty css            */import"./index-6lxVY5DU.js";import"./index-BBDU3XkM.js";import"./index-_200N-9v.js";import"./index-D6-3VAHV.js";import"./check-kl6Xjmwn.js";import"./x-D4OXCe6m.js";import"./app-logo-icon-B1r3bsQj.js";import"./input-CXpCTHGE.js";import"./label-CYYsus1F.js";import"./user-2vHAz8tr.js";import"./mail-i7usF0Qz.js";import"./users-CA6jkooN.js";import"./search-BECONtiU.js";import"./BrandingProvider-BKZadETt.js";const K={conservacion_permanente:"Conservación Permanente",eliminacion_controlada:"Eliminación Controlada",transferencia_historica:"Transferencia Histórica",digitalizacion:"Digitalización",microfilmacion:"Microfilmación"},Q={conservacion_permanente:"bg-emerald-100 text-emerald-800 border-emerald-200",eliminacion_controlada:"bg-red-100 text-red-800 border-red-200",transferencia_historica:"bg-blue-100 text-blue-800 border-blue-200",digitalizacion:"bg-indigo-100 text-indigo-800 border-indigo-200",microfilmacion:"bg-violet-100 text-violet-800 border-violet-200"};function Se({expedientes:t,estadisticasTRD:i,diasAnticipacion:C}){const[a,o]=u.useState([]),[m,x]=u.useState(!1),{post:U,processing:W}=P({}),T=s=>{o(h=>h.includes(s)?h.filter(E=>E!==s):[...h,s])},A=()=>{a.length===t.length?o([]):o(t.map(s=>s.id))},S=()=>{a.length!==0&&(x(!0),j.post("/admin/disposiciones/generar-automaticas",{expediente_ids:a},{onFinish:()=>{x(!1),o([])}}))},k=()=>{confirm("¿Está seguro de generar disposiciones para TODOS los expedientes vencidos? Esta acción creará disposiciones automáticas basadas en la configuración de la TRD.")&&(x(!0),j.post("/admin/disposiciones/generar-automaticas",{generar_todos_vencidos:!0},{onFinish:()=>x(!1)}))},D=s=>s?new Date(s).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A";return e.jsxs(z,{children:[e.jsx(G,{title:"Expedientes Pendientes de Disposición - TRD"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(c,{variant:"ghost",size:"sm",asChild:!0,children:e.jsxs(f,{href:"/admin/disposiciones",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Volver"]})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"Expedientes Pendientes de Disposición"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Expedientes que requieren disposición según la Tabla de Retención Documental (TRD)"})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:i.vencidos_sin_disposicion>0&&e.jsxs(c,{onClick:k,disabled:m,className:"bg-red-600 hover:bg-red-700",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),m?"Generando...":`Generar Todas Vencidas (${i.vencidos_sin_disposicion})`]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx(l,{className:i.vencidos_sin_disposicion>0?"border-red-200 bg-red-50":"",children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Vencidos"}),e.jsx("p",{className:"text-2xl font-semibold text-red-600",children:i.vencidos_sin_disposicion})]}),e.jsx(v,{className:"h-8 w-8 text-red-400"})]})})}),e.jsx(l,{children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Próximos 30 días"}),e.jsx("p",{className:"text-2xl font-semibold text-orange-600",children:i.proximos_30_dias})]}),e.jsx(y,{className:"h-8 w-8 text-orange-400"})]})})}),e.jsx(l,{children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Próximos 60 días"}),e.jsx("p",{className:"text-2xl font-semibold text-yellow-600",children:i.proximos_60_dias})]}),e.jsx(g,{className:"h-8 w-8 text-yellow-400"})]})})}),e.jsx(l,{children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Próximos 90 días"}),e.jsx("p",{className:"text-2xl font-semibold text-blue-600",children:i.proximos_90_dias})]}),e.jsx(g,{className:"h-8 w-8 text-blue-400"})]})})}),e.jsx(l,{children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Pendientes"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:i.total_pendientes})]}),e.jsx(O,{className:"h-8 w-8 text-[#2a3d83]"})]})})})]}),e.jsxs(H,{className:"border-blue-200 bg-blue-50",children:[e.jsx(F,{className:"h-4 w-4 text-[#2a3d83]"}),e.jsxs(R,{children:[e.jsx("strong",{className:"text-blue-800",children:"Generación Automática:"}),' El sistema puede crear disposiciones automáticamente basándose en la configuración de tiempos de retención y tipo de disposición definidos en la TRD para cada serie/subserie. Seleccione los expedientes y haga clic en "Generar Disposiciones" o use "Generar Todas Vencidas" para procesar todos los expedientes vencidos.']})]}),a.length>0&&e.jsxs("div",{className:"flex items-center justify-between bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{className:"h-5 w-5 text-[#2a3d83]"}),e.jsxs("span",{className:"font-medium text-[#2a3d83]",children:[a.length," expediente(s) seleccionado(s)"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{variant:"outline",onClick:()=>o([]),children:"Deseleccionar"}),e.jsxs(c,{onClick:S,disabled:m,className:"bg-[#2a3d83] hover:bg-[#1e2b5f]",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),m?"Generando...":"Generar Disposiciones"]})]})]}),e.jsxs(l,{children:[e.jsxs(L,{children:[e.jsxs(V,{className:"flex items-center justify-between",children:[e.jsxs("span",{children:["Expedientes Pendientes (",t.length,")"]}),e.jsxs(c,{variant:"ghost",size:"sm",onClick:()=>j.reload(),children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Actualizar"]})]}),e.jsx(B,{children:"Lista de expedientes que han cumplido o están por cumplir su tiempo de retención"})]}),e.jsx(d,{children:t.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(b,{children:[e.jsx(n,{className:"w-12",children:e.jsx(N,{checked:a.length===t.length,onCheckedChange:A})}),e.jsx(n,{children:"Código"}),e.jsx(n,{children:"Título"}),e.jsx(n,{children:"Serie / Subserie"}),e.jsx(n,{children:"Retención"}),e.jsx(n,{children:"Vencimiento"}),e.jsx(n,{children:"Disposición Sugerida"}),e.jsx(n,{className:"text-right",children:"Acciones"})]})}),e.jsx(I,{children:t.map(s=>e.jsxs(b,{className:`${s.ya_vencido?"bg-red-50":""} ${a.includes(s.id)?"bg-blue-50":""}`,children:[e.jsx(r,{children:e.jsx(N,{checked:a.includes(s.id),onCheckedChange:()=>T(s.id)})}),e.jsx(r,{className:"font-medium",children:s.codigo}),e.jsx(r,{className:"max-w-xs",children:e.jsx("span",{className:"line-clamp-2",children:s.titulo})}),e.jsx(r,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium",children:s.serie||"Sin serie"}),s.subserie&&e.jsx("p",{className:"text-gray-500",children:s.subserie})]})}),e.jsx(r,{children:e.jsxs("div",{className:"text-sm",children:[e.jsxs("p",{children:["AG: ",s.info_retencion?.anos_archivo_gestion||0," años"]}),e.jsxs("p",{children:["AC: ",s.info_retencion?.anos_archivo_central||0," años"]}),e.jsxs("p",{className:"text-gray-500",children:["Total: ",s.info_retencion?.anos_total_retencion||0," años"]})]})}),e.jsx(r,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:s.ya_vencido?"text-red-600 font-medium":"",children:D(s.fecha_eliminacion)})]}),s.ya_vencido?e.jsxs(p,{variant:"destructive",className:"text-xs",children:[e.jsx(v,{className:"h-3 w-3 mr-1"}),"¡Vencido!"]}):s.dias_para_disposicion<=30?e.jsxs(p,{variant:"outline",className:"text-xs border-orange-300 text-orange-700",children:[e.jsx(y,{className:"h-3 w-3 mr-1"}),"En ",s.dias_para_disposicion," días"]}):e.jsxs("span",{className:"text-xs text-gray-500",children:["En ",s.dias_para_disposicion," días"]})]})}),e.jsxs(r,{children:[s.tipo_disposicion_sugerido?e.jsx(p,{variant:"outline",className:Q[s.tipo_disposicion_sugerido]||"bg-gray-100",children:K[s.tipo_disposicion_sugerido]||s.tipo_disposicion_sugerido}):e.jsx("span",{className:"text-gray-400 text-sm",children:"Sin configurar"}),s.info_retencion?.origen_disposicion&&e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Desde: ",s.info_retencion.origen_disposicion]})]}),e.jsx(r,{className:"text-right",children:e.jsx("div",{className:"flex items-center justify-end space-x-2",children:e.jsx(c,{size:"sm",variant:"outline",className:"text-[#2a3d83]",asChild:!0,children:e.jsxs(f,{href:`/admin/disposiciones/create?expediente_id=${s.id}`,children:[e.jsx(J,{className:"h-4 w-4 mr-1"}),"Manual"]})})})})]},s.id))})]})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(w,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"¡Todo al día!"}),e.jsxs("p",{className:"text-gray-500",children:["No hay expedientes pendientes de disposición en los próximos ",C," días."]})]})})]})]})]})}export{Se as default};
