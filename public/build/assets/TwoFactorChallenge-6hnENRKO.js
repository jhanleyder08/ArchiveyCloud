import{r,j as e,H as w,a as j,b as C}from"./app-DyjZO5jj.js";import{C as k,a as S,b as I,d as R,c as A}from"./card-HvsWIqdm.js";import{B as x}from"./button-BDpOSzem.js";import{I as V}from"./input-DWIA3fpi.js";import{L as E}from"./label-CYKfv9Rz.js";import{A as M,a as F}from"./alert-bVm3dmzb.js";import{S as H,T as D}from"./triangle-alert-Py5ZhKdg.js";import{R as L}from"./refresh-cw-gYKC0oQT.js";import{M as P}from"./mail-r9sbyL42.js";import{S as v}from"./smartphone-CnZksSC5.js";/* empty css            */import"./index-BOu6Kk11.js";function X({method:i}){const[n,p]=r.useState(""),[c,o]=r.useState(!1),[u,t]=r.useState(null),[m,l]=r.useState(!1),[N,f]=r.useState(60);r.useEffect(()=>{if(i==="totp"){l(!1);return}const s=setInterval(()=>{f(a=>a<=1?(l(!0),clearInterval(s),0):a-1)},1e3);return()=>clearInterval(s)},[i]);const g=async()=>{if(!n||n.length!==6){t({type:"error",message:"Por favor ingresa un c贸digo de 6 d铆gitos"});return}o(!0),t(null);try{const s=await j.post("/two-factor/verify",{code:n});s.data.success&&C.visit(s.data.redirect||"/dashboard",{preserveState:!1,replace:!0})}catch(s){t({type:"error",message:s.response?.data?.message||"C贸digo inv谩lido. Por favor intenta nuevamente."}),p(""),o(!1)}},y=async()=>{if(!(!m||i==="totp")){o(!0),t(null);try{const s=await j.post("/two-factor/resend");if(s.data.success){t({type:"success",message:s.data.message}),l(!1),f(60);const a=setInterval(()=>{f(h=>h<=1?(l(!0),clearInterval(a),0):h-1)},1e3)}}catch(s){t({type:"error",message:s.response?.data?.message||"Error al reenviar el c贸digo"})}finally{o(!1)}}},b=s=>{s.key==="Enter"&&g()},d=(()=>{switch(i){case"totp":return{icon:e.jsx(v,{className:"h-6 w-6"}),title:"Autenticaci贸n de Dos Factores",description:"Ingresa el c贸digo de 6 d铆gitos de tu aplicaci贸n de autenticaci贸n",placeholder:"000000"};case"sms":return{icon:e.jsx(v,{className:"h-6 w-6"}),title:"Verificaci贸n por SMS",description:"Hemos enviado un c贸digo de verificaci贸n a tu tel茅fono",placeholder:"000000"};case"email":return{icon:e.jsx(P,{className:"h-6 w-6"}),title:"Verificaci贸n por Correo",description:"Hemos enviado un c贸digo de verificaci贸n a tu correo electr贸nico",placeholder:"000000"}}})();return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-white to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 p-4",children:[e.jsx(w,{title:"Verificaci贸n 2FA"}),e.jsxs(k,{className:"w-full max-w-md shadow-xl",children:[e.jsxs(S,{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center justify-center w-16 h-16 bg-primary/10 rounded-full mx-auto",children:e.jsx(H,{className:"h-8 w-8 text-primary"})}),e.jsxs(I,{className:"text-2xl text-center flex items-center justify-center gap-2",children:[d.icon,d.title]}),e.jsx(R,{className:"text-center text-base",children:d.description})]}),e.jsxs(A,{className:"space-y-6",children:[u&&e.jsxs(M,{variant:u.type==="error"?"destructive":"default",children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx(F,{children:u.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"code",children:"C贸digo de Verificaci贸n"}),e.jsx(V,{id:"code",type:"text",inputMode:"numeric",pattern:"[0-9]*",value:n,onChange:s=>{const a=s.target.value.replace(/\D/g,"").slice(0,6);p(a)},onKeyPress:b,placeholder:d.placeholder,maxLength:6,autoFocus:!0,className:"text-center text-2xl tracking-widest font-mono",disabled:c}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Ingresa el c贸digo de 6 d铆gitos"})]}),e.jsx(x,{onClick:g,disabled:c||n.length!==6,className:"w-full",size:"lg",children:c?"Verificando...":"Verificar C贸digo"}),i!=="totp"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:"驴No recibiste el c贸digo?"})})]}),e.jsxs(x,{onClick:y,disabled:!m||c,variant:"outline",className:"w-full",children:[e.jsx(L,{className:`h-4 w-4 mr-2 ${c?"animate-spin":""}`}),m?"Reenviar C贸digo":`Reenviar en ${N}s`]})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-950 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("p",{className:"text-sm text-blue-900 dark:text-blue-100",children:[" ",e.jsx("strong",{children:"Consejo de Seguridad:"})," Nunca compartas tus c贸digos de verificaci贸n con nadie. El equipo de soporte nunca te pedir谩 este c贸digo."]})}),e.jsx("div",{className:"text-center",children:e.jsx(x,{variant:"link",onClick:()=>{window.location.href="/logout"},className:"text-sm text-muted-foreground hover:text-foreground",children:"Cancelar e iniciar sesi贸n con otra cuenta"})})]})]})]})}export{X as default};
