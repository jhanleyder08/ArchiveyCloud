import{e as Z,r as l,b as g,j as e,H as ee,L as D}from"./app-BQTi1tix.js";import{A as se}from"./app-layout-DInPGpPa.js";import{B as h}from"./button-jbMTrknk.js";import{I as u}from"./input-Cc9jF3XX.js";import{S as A,a as F,b as T,c as P,d as p}from"./select-DS4SgLop.js";import{D as q,g as ae,a as I,b as L,c as M,d as $,e as k,k as re,l as O,m as R,n as V}from"./app-sidebar-layout-BqUV8IOl.js";import{L as n}from"./label-DM-KQF7g.js";import{C as te}from"./checkbox-CskAurgF.js";import{I as f}from"./input-error-C0AMGW2V.js";import{A as ie,a as le}from"./alert-BsN-LFPU.js";import{U as H}from"./users-DiCSiRim.js";import{P as oe}from"./plus-DKEZIw4E.js";import{C as ne}from"./circle-alert-D6udNDmE.js";import{S as de}from"./search-912_Z_K3.js";import{S as ce}from"./square-pen-xajiNaNG.js";import{U as me}from"./user-x-z7sNDoZ9.js";import{U as xe}from"./user-check-_s7B-Cls.js";import{T as he}from"./trash-2-YighKfZJ.js";/* empty css            */import"./index-P1psqDm4.js";import"./index-CG-EXtn0.js";import"./Combination-ChugFezL.js";import"./index-DASwZM9s.js";import"./check-CAnDB-3R.js";import"./index-GsiYYk_T.js";import"./x-BCECMJer.js";import"./index-Cr43teK3.js";import"./app-logo-icon-D5w3FSZ6.js";import"./user-DhAq0Tlb.js";import"./triangle-alert-BhoOSpsi.js";import"./folder-PlDrKnWl.js";const ue=[{title:"Dashboard",href:"/dashboard"},{title:"Administración",href:"#"},{title:"Gestión de usuarios",href:"/admin/users"}];function Xe({users:i,stats:C,roles:B,filters:S}){const{flash:v}=Z().props,[pe,je]=l.useState(S.search||""),[j,N]=l.useState(null),[Q,_]=l.useState(!1),[b,y]=l.useState(null),[a,d]=l.useState({name:"",email:"",role_id:"",password:"",password_confirmation:"",verify_email:!1}),[r,c]=l.useState({}),[o,x]=l.useState({name:"",email:"",role_id:"",active:!0}),[E,z]=l.useState(S.search||""),[U,X]=l.useState(S.status||"");l.useEffect(()=>{const s=setTimeout(()=>{g.get("/admin/users",{search:E||void 0,status:U||void 0},{preserveState:!0,replace:!0})},500);return()=>clearTimeout(s)},[E,U]);const J=s=>{g.patch(`/admin/users/${s.id}/toggle-status`,{},{preserveState:!0})},K=s=>new Date(s).toLocaleDateString("es-ES"),W=s=>s.active?s.email_verified_at?{text:"Activo",color:"bg-green-100 text-green-800"}:{text:"Pendiente",color:"bg-yellow-100 text-yellow-800"}:{text:"Inactivo",color:"bg-red-100 text-red-800"};return e.jsxs(se,{breadcrumbs:ue,children:[e.jsx(ee,{title:"Gestión de Usuarios"}),e.jsxs("div",{className:"space-y-6",children:[v?.success&&e.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg",children:v.success}),v?.error&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:v.error}),e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-6 w-6 text-[#2a3d83]"}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Gestión de Usuarios"})]}),e.jsxs(q,{open:Q,onOpenChange:_,children:[e.jsx(ae,{asChild:!0,children:e.jsxs(h,{className:"flex items-center gap-2 px-4 py-2 bg-[#2a3d83] text-white rounded-lg hover:bg-[#1e2b5f] transition-colors",children:[e.jsx(oe,{className:"h-4 w-4"}),"Nuevo Usuario"]})}),e.jsxs(I,{className:"sm:max-w-[425px]",children:[e.jsxs(L,{children:[e.jsx(M,{className:"text-xl font-semibold text-gray-900",children:"Crear Nuevo Usuario"}),e.jsx($,{className:"text-sm text-gray-600",children:"Complete los siguientes datos para crear un nuevo usuario en el sistema."})]}),Object.keys(r).length>0&&e.jsxs(ie,{variant:"destructive",className:"mb-4",children:[e.jsx(ne,{className:"h-4 w-4"}),e.jsxs(le,{children:[e.jsx("strong",{children:"Por favor corrija los siguientes errores:"}),e.jsx("ul",{className:"list-disc list-inside mt-2 space-y-1",children:Object.entries(r).map(([s,t])=>e.jsx("li",{className:"text-sm",children:t},s))})]})]}),e.jsxs("form",{onSubmit:s=>{if(s.preventDefault(),!a.name||!a.email||!a.role_id||!a.password||!a.password_confirmation){alert("Por favor complete todos los campos requeridos");return}if(a.password!==a.password_confirmation){alert("Las contraseñas no coinciden");return}const t={name:a.name.trim(),email:a.email.trim().toLowerCase(),password:a.password,password_confirmation:a.password_confirmation,role_id:a.role_id?parseInt(a.role_id):null,verify_email:!!a.verify_email};g.post("/admin/users",t,{onSuccess:()=>{_(!1),d({name:"",email:"",role_id:"",password:"",password_confirmation:"",verify_email:!1}),c({})},onError:m=>{console.error("Error al crear usuario:",m);const G={};m&&Object.keys(m).forEach(w=>{const Y=Array.isArray(m[w])?m[w][0]:m[w];G[w]=Y}),c(G)}})},className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-name",children:"Nombre Completo"}),e.jsx(u,{id:"create-name",type:"text",value:a.name,onChange:s=>{d({...a,name:s.target.value}),r.name&&c({...r,name:""})},placeholder:"Nombre completo del usuario",required:!0,className:r.name?"border-red-500":""}),e.jsx(f,{message:r.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-email",children:"Email"}),e.jsx(u,{id:"create-email",type:"email",value:a.email,onChange:s=>{d({...a,email:s.target.value}),r.email&&c({...r,email:""})},placeholder:"usuario@ejemplo.com",required:!0,className:r.email?"border-red-500":""}),e.jsx(f,{message:r.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-password",children:"Contraseña"}),e.jsx(u,{id:"create-password",type:"password",value:a.password,onChange:s=>{d({...a,password:s.target.value}),r.password&&c({...r,password:""})},placeholder:"Contraseña temporal",required:!0,minLength:8,className:r.password?"border-red-500":""}),e.jsx(f,{message:r.password})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-password-confirmation",children:"Confirmar Contraseña"}),e.jsx(u,{id:"create-password-confirmation",type:"password",value:a.password_confirmation,onChange:s=>{d({...a,password_confirmation:s.target.value}),r.password_confirmation&&c({...r,password_confirmation:""})},placeholder:"Confirmar contraseña",required:!0,minLength:8,className:r.password_confirmation?"border-red-500":""}),e.jsx(f,{message:r.password_confirmation})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-role",children:"Rol"}),e.jsxs(A,{value:a.role_id,onValueChange:s=>{d({...a,role_id:s}),r.role_id&&c({...r,role_id:""})},children:[e.jsx(F,{className:r.role_id?"border-red-500":"",children:e.jsx(T,{placeholder:"Selecciona un rol"})}),e.jsx(P,{children:B.map(s=>e.jsx(p,{value:s.id.toString(),children:s.name},s.id))})]}),e.jsx(f,{message:r.role_id})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{id:"verify-email",checked:a.verify_email,onCheckedChange:s=>d({...a,verify_email:s===!0})}),e.jsx(n,{htmlFor:"verify-email",className:"text-sm font-normal cursor-pointer",children:"Verificar email automáticamente (no enviar correo de verificación)"})]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Si no marca esta opción, se enviará un correo de verificación al usuario."}),e.jsxs(k,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>{_(!1),d({name:"",email:"",role_id:"",password:"",password_confirmation:"",verify_email:!1}),c({})},children:"Cancelar"}),e.jsx(h,{type:"submit",className:"bg-[#2a3d83] hover:bg-[#1e2b5f]",children:"Crear Usuario"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Usuarios"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:C.total})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(H,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Usuarios Activos"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:C.active})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx("div",{className:"h-6 w-6 bg-[#2a3d83] rounded-full flex items-center justify-center",children:e.jsx("div",{className:"h-2 w-2 bg-white rounded-full"})})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pendientes"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:C.pending})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx("div",{className:"h-6 w-6 bg-[#2a3d83] rounded-full flex items-center justify-center",children:e.jsx("div",{className:"h-2 w-2 bg-white rounded-full"})})})]})})]}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4 w-full sm:w-auto",children:e.jsxs("div",{className:"relative flex-1 sm:w-80",children:[e.jsx(de,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(u,{type:"text",value:E,onChange:s=>z(s.target.value),placeholder:"Buscar usuarios...",className:"pl-10"})]})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(A,{value:U||"all",onValueChange:s=>X(s==="all"?"":s),children:[e.jsx(F,{className:"w-[180px]",children:e.jsx(T,{placeholder:"Todos los estados"})}),e.jsxs(P,{children:[e.jsx(p,{value:"all",children:"Todos los estados"}),e.jsx(p,{value:"active",children:"Activos"}),e.jsx(p,{value:"inactive",children:"Inactivos"}),e.jsx(p,{value:"pending",children:"Pendientes"})]})]})})]})}),e.jsx("div",{className:"bg-white rounded-lg border overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Usuario"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Email"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Rol"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Estado"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Registro"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Acciones"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:i.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-8 px-6 text-center text-gray-500",children:"No se encontraron usuarios."})}):i.data.map(s=>{const t=W(s);return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 bg-[#2a3d83] rounded-full flex items-center justify-center text-white text-sm font-medium",children:s.name.charAt(0).toUpperCase()}),e.jsx("span",{className:"font-medium text-gray-900",children:s.name})]})}),e.jsx("td",{className:"py-4 px-6 text-gray-600",children:s.email}),e.jsx("td",{className:"py-4 px-6",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-[#2a3d83]",children:s.role?.name||"Sin rol"})}),e.jsx("td",{className:"py-4 px-6",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.color}`,children:t.text})}),e.jsx("td",{className:"py-4 px-6 text-gray-600",children:K(s.created_at)}),e.jsx("td",{className:"py-4 px-6",children:e.jsx(re,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(O,{children:[e.jsx(R,{asChild:!0,children:e.jsx("button",{onClick:()=>{x({name:s.name,email:s.email,role_id:s.role?.id?.toString()||s.role_id?.toString()||"",active:s.active!==void 0?s.active:!0}),y(s)},className:"p-2 rounded-md text-[#2a3d83] hover:text-[#1e2b5f] hover:bg-blue-50 transition-colors",children:e.jsx(ce,{className:"h-4 w-4"})})}),e.jsx(V,{children:e.jsx("p",{children:"Editar usuario"})})]}),e.jsxs(O,{children:[e.jsx(R,{asChild:!0,children:e.jsx("button",{onClick:()=>J(s),className:`p-2 rounded-md transition-colors ${s.active?"text-orange-600 hover:text-orange-800 hover:bg-orange-50":"text-green-600 hover:text-green-800 hover:bg-green-50"}`,children:s.active?e.jsx(me,{className:"h-4 w-4"}):e.jsx(xe,{className:"h-4 w-4"})})}),e.jsx(V,{children:e.jsx("p",{children:s.active?"Desactivar usuario":"Activar usuario"})})]}),e.jsxs(O,{children:[e.jsx(R,{asChild:!0,children:e.jsx("button",{onClick:()=>N(s),className:"p-2 rounded-md text-red-600 hover:text-red-800 hover:bg-red-50 transition-colors",children:e.jsx(he,{className:"h-4 w-4"})})}),e.jsx(V,{children:e.jsx("p",{children:"Eliminar usuario"})})]})]})})})]},s.id)})})]})})}),i.data.length>0&&e.jsxs("div",{className:"flex items-center justify-between bg-white border rounded-lg px-6 py-3",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",e.jsx("span",{className:"font-medium",children:i.meta?.from||i.from||0})," a"," ",e.jsx("span",{className:"font-medium",children:i.meta?.to||i.to||0})," de"," ",e.jsx("span",{className:"font-medium",children:i.meta?.total||i.total||0})," usuarios"]}),e.jsx("div",{className:"flex items-center gap-2",children:i.links.map((s,t)=>s.label.includes("Previous")?e.jsx(D,{href:s.url||"#",preserveState:!0,className:`px-3 py-2 border border-gray-300 rounded-md text-sm font-medium ${s.url?"text-gray-700 hover:bg-gray-50":"text-gray-300 cursor-not-allowed"}`,children:"Anterior"},t):s.label.includes("Next")?e.jsx(D,{href:s.url||"#",preserveState:!0,className:`px-3 py-2 border border-gray-300 rounded-md text-sm font-medium ${s.url?"text-gray-700 hover:bg-gray-50":"text-gray-300 cursor-not-allowed"}`,children:"Siguiente"},t):isNaN(Number(s.label))?null:e.jsx(D,{href:s.url||"#",preserveState:!0,className:`px-3 py-2 rounded-md text-sm font-medium ${s.active?"bg-[#2a3d83] text-white":"border border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:s.label},t))})]}),e.jsx(q,{open:!!b,onOpenChange:s=>{s||(y(null),x({name:"",email:"",role_id:"",active:!0}))},children:e.jsxs(I,{className:"sm:max-w-[425px]",children:[e.jsxs(L,{children:[e.jsx(M,{className:"text-xl font-semibold text-gray-900",children:"Editar Usuario"}),e.jsx($,{className:"text-sm text-gray-600",children:"Modifique los datos del usuario según sea necesario."})]}),e.jsxs("form",{onSubmit:s=>{if(s.preventDefault(),b){const t=o;console.log("Enviando datos:",t),console.log("Usuario a editar:",b.id),g.put(`/admin/users/${b.id}`,t,{onSuccess:()=>{console.log("Usuario actualizado exitosamente"),y(null),x({name:"",email:"",role_id:"",active:!0})},onError:m=>{console.error("Errores de validación:",m)}})}},className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"edit-name",children:"Nombre Completo"}),e.jsx(u,{id:"edit-name",type:"text",value:o.name,onChange:s=>x({...o,name:s.target.value}),placeholder:"Nombre completo del usuario",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"edit-email",children:"Email"}),e.jsx(u,{id:"edit-email",type:"email",value:o.email,onChange:s=>x({...o,email:s.target.value}),placeholder:"usuario@ejemplo.com",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"edit-role",children:"Rol"}),e.jsxs(A,{value:o.role_id,onValueChange:s=>x({...o,role_id:s}),children:[e.jsx(F,{children:e.jsx(T,{placeholder:"Selecciona un rol"})}),e.jsx(P,{children:B.map(s=>e.jsx(p,{value:s.id.toString(),children:s.name},s.id))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"edit-active",checked:o.active,onChange:s=>x({...o,active:s.target.checked}),className:"h-4 w-4 rounded border-gray-300 text-[#2a3d83] focus:ring-[#2a3d83]"}),e.jsx("label",{htmlFor:"edit-active",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Usuario Activo"})]}),e.jsxs(k,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>y(null),children:"Cancelar"}),e.jsx(h,{type:"submit",className:"bg-[#2a3d83] hover:bg-[#1e2b5f]",children:"Guardar Cambios"})]})]})]})}),e.jsx(q,{open:!!j,onOpenChange:s=>{s||N(null)},children:e.jsxs(I,{className:"sm:max-w-[425px]",children:[e.jsxs(L,{children:[e.jsx(M,{className:"text-xl font-semibold text-gray-900",children:"Eliminar Usuario"}),e.jsx($,{className:"text-sm text-gray-600",children:"Esta acción no se puede deshacer. El usuario será eliminado permanentemente del sistema."})]}),e.jsxs("div",{className:"py-4",children:[e.jsxs("p",{className:"text-gray-700",children:["¿Estás seguro de que deseas eliminar al usuario ",e.jsx("strong",{children:j?.name}),"?"]}),e.jsxs("p",{className:"text-gray-600 mt-2",children:["Email: ",e.jsx("strong",{children:j?.email})]})]}),e.jsxs(k,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>N(null),children:"Cancelar"}),e.jsx(h,{type:"button",variant:"destructive",onClick:()=>{j&&g.delete(`/admin/users/${j.id}`,{onSuccess:()=>{N(null)}})},children:"Eliminar Usuario"})]})]})})]})]})}export{Xe as default};
