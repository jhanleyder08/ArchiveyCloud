import{r as o,u as k,j as e,H as z,L as A,b as B}from"./app-1TbR1aNv.js";import{A as H}from"./app-layout-DBvULR4o.js";import{B as _}from"./button-Bh8HL4t-.js";import{I as S}from"./input-B9S_DJNe.js";import{L as l}from"./label-CB51Zwfa.js";import{T as F,t as P}from"./app-sidebar-layout-EVqXnw4l.js";import{S as u,a as h,b as x,c as m,d as j}from"./select-55yoEt5h.js";import{C as p,a as b,b as v,c as g}from"./card-CjIDma1Z.js";import{A as G}from"./arrow-left-D4dywRtW.js";import{X as R}from"./x-BA_bLoEE.js";import{S as K}from"./save-DD4v5MIX.js";/* empty css            */import"./index-DV8Rt-0p.js";import"./index-DaDMCySO.js";import"./Combination-Bg4lGtaS.js";import"./index-12rucE5D.js";import"./index-B37z7FM4.js";import"./app-logo-icon-D5sKSL8w.js";import"./user-Eo78Nm40.js";import"./mail-Dw8iYVcL.js";import"./users-KtdTbN4b.js";import"./folder-BrHeBlTR.js";import"./triangle-alert-Csu15FGV.js";import"./search-BY4VdWrh.js";import"./index-BRmIzMxm.js";import"./check-BetP237p.js";const U=[{title:"Inicio",href:"/dashboard"},{title:"Expedientes",href:"/admin/expedientes"},{title:"Editar",href:"#"}];function pe({expediente:a,opciones:t}){const[c,N]=o.useState(a.palabras_clave||[]),[f,C]=o.useState(""),[L,y]=o.useState([]),[E,I]=o.useState(!1),{data:i,setData:r,errors:d}=k({titulo:a.titulo||"",descripcion:a.descripcion||"",serie_id:a.serie_id?.toString()||"",subserie_id:a.subserie_id?.toString()||"",tipo_expediente:a.tipo_expediente||"administrativo",nivel_acceso:a.nivel_acceso||"publico",responsable_id:a.responsable_id?.toString()||"",ubicacion_fisica:a.ubicacion_fisica||"",palabras_clave:a.palabras_clave||[],notas:a.notas||""});o.useEffect(()=>{if(i.serie_id&&t?.subseries){const s=t.subseries.filter(n=>n.serie_id===parseInt(i.serie_id));y(s)}else y([])},[i.serie_id,t]);const T=s=>{s.preventDefault(),I(!0);const n={...i,codigo:a.codigo,serie_id:parseInt(i.serie_id)||null,subserie_id:i.subserie_id?parseInt(i.subserie_id):null,responsable_id:parseInt(i.responsable_id)||null};B.put("/admin/expedientes/"+a.id,n,{onSuccess:()=>P.success("Expediente actualizado"),onError:()=>P.error("Error al actualizar"),onFinish:()=>I(!1)})},w=()=>{if(f.trim()&&!c.includes(f.trim())){const s=[...c,f.trim()];N(s),r("palabras_clave",s),C("")}},V=s=>{const n=c.filter(D=>D!==s);N(n),r("palabras_clave",n)};return e.jsxs(H,{breadcrumbs:U,children:[e.jsx(z,{title:"Editar "+a.codigo}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(A,{href:"/admin/expedientes",children:e.jsx(_,{variant:"outline",size:"icon",children:e.jsx(G,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Editar Expediente"}),e.jsx("p",{className:"text-muted-foreground font-mono",children:a.codigo})]})]}),e.jsxs("form",{onSubmit:T,className:"space-y-6",children:[e.jsxs(p,{children:[e.jsx(b,{children:e.jsx(v,{children:"Informacion Basica"})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"titulo",children:"Titulo *"}),e.jsx(S,{id:"titulo",value:i.titulo,onChange:s=>r("titulo",s.target.value),className:d.titulo?"border-red-500":""}),d.titulo&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:d.titulo})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"descripcion",children:"Descripcion"}),e.jsx(F,{id:"descripcion",value:i.descripcion,onChange:s=>r("descripcion",s.target.value),rows:3})]})]})]}),e.jsxs(p,{children:[e.jsx(b,{children:e.jsx(v,{children:"Clasificacion"})}),e.jsx(g,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Serie *"}),e.jsxs(u,{value:i.serie_id,onValueChange:s=>{r("serie_id",s),r("subserie_id","")},children:[e.jsx(h,{className:d.serie_id?"border-red-500":"",children:e.jsx(x,{placeholder:"Seleccionar"})}),e.jsx(m,{children:t?.series?.map(s=>e.jsxs(j,{value:s.id.toString(),children:[s.codigo," - ",s.nombre]},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Subserie"}),e.jsxs(u,{value:i.subserie_id,onValueChange:s=>r("subserie_id",s),disabled:!i.serie_id,children:[e.jsx(h,{children:e.jsx(x,{placeholder:"Seleccionar"})}),e.jsx(m,{children:L.map(s=>e.jsxs(j,{value:s.id.toString(),children:[s.codigo," - ",s.nombre]},s.id))})]})]})]})})]}),e.jsxs(p,{children:[e.jsx(b,{children:e.jsx(v,{children:"Configuracion"})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Tipo *"}),e.jsxs(u,{value:i.tipo_expediente,onValueChange:s=>r("tipo_expediente",s),children:[e.jsx(h,{children:e.jsx(x,{})}),e.jsx(m,{children:t?.tipos_expediente?.map(s=>e.jsx(j,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Nivel Acceso *"}),e.jsxs(u,{value:i.nivel_acceso,onValueChange:s=>r("nivel_acceso",s),children:[e.jsx(h,{children:e.jsx(x,{})}),e.jsx(m,{children:t?.niveles_acceso?.map(s=>e.jsx(j,{value:s.value,children:s.label},s.value))})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Responsable *"}),e.jsxs(u,{value:i.responsable_id,onValueChange:s=>r("responsable_id",s),children:[e.jsx(h,{className:d.responsable_id?"border-red-500":"",children:e.jsx(x,{placeholder:"Seleccionar"})}),e.jsx(m,{children:t?.usuarios?.map(s=>e.jsxs(j,{value:s.id.toString(),children:[s.name," (",s.email,")"]},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Ubicacion Fisica"}),e.jsx(S,{value:i.ubicacion_fisica,onChange:s=>r("ubicacion_fisica",s.target.value)})]})]})]}),e.jsxs(p,{children:[e.jsx(b,{children:e.jsx(v,{children:"Palabras Clave"})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{value:f,onChange:s=>C(s.target.value),placeholder:"Agregar palabra",onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),w())}),e.jsx(_,{type:"button",variant:"outline",onClick:w,children:"Agregar"})]}),c.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(s=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800",children:[s,e.jsx("button",{type:"button",onClick:()=>V(s),className:"hover:text-blue-600",children:e.jsx(R,{className:"h-3 w-3"})})]},s))})]})]}),e.jsxs(p,{children:[e.jsx(b,{children:e.jsx(v,{children:"Notas"})}),e.jsx(g,{children:e.jsx(F,{value:i.notas,onChange:s=>r("notas",s.target.value),placeholder:"Notas adicionales",rows:3})})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(A,{href:"/admin/expedientes",children:e.jsx(_,{type:"button",variant:"outline",children:"Cancelar"})}),e.jsxs(_,{type:"submit",disabled:E,className:"bg-[#2a3d83] hover:bg-[#1e2b5f]",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),E?"Guardando...":"Guardar"]})]})]})]})]})}export{pe as default};
