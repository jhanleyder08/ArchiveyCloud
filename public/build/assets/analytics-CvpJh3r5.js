import{r as R,j as s,H as B,L}from"./app-DOeYTPnE.js";import{A as F,h as I,U as g,e as E}from"./app-sidebar-layout-83PL_wom.js";import{B as M}from"./button-BB3j1qH9.js";import{C as r,c as t,a as l,b as c,d}from"./card-BEZSel9K.js";import{S as k,a as H,b as K,c as V,d as m}from"./select-D2zOlv3c.js";import{T as $,a as z,b as o,c as x}from"./tabs-CZodpFxR.js";import{B as n}from"./badge-BDHWk-Qv.js";import{A as G}from"./arrow-left-Cvz8oF6O.js";import{G as f}from"./globe-BPDeuemB.js";import{T as h}from"./triangle-alert-B7e9hRq_.js";import{R as j,T as p}from"./CategoricalChart-Dajg-Im1.js";import{P as O,a as q}from"./PieChart-723s3Ajo.js";import{C as X}from"./tooltipContext-B4UnQMjc.js";import{A as Y,a as J}from"./AreaChart-WWHRVCMu.js";import{C as N,X as y,Y as _}from"./CartesianChart-D-tVo_OX.js";import{B as Q}from"./BarChart-anN5OFyv.js";import{B as W}from"./barSelectors-vhDwuTyo.js";/* empty css            */import"./index-B5i9qy2Y.js";import"./index-Cl_hWV--.js";import"./index-C7D1JV-H.js";import"./index-BuQaqXjb.js";import"./x-BHxLkKP3.js";import"./index-sj4qH-fg.js";import"./app-logo-icon-BTiqVlKS.js";import"./label-BvABT9uR.js";import"./user-BiSWd6pJ.js";import"./index-pqvegj4w.js";import"./check-C4IDWgVr.js";import"./ActivePoints-B4M48u6W.js";const b=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8"];function Ps({analisis:a,filtros:A}){const[w,Z]=R.useState(A.periodo),C=e=>{const i=new URLSearchParams;i.set("periodo",e),window.location.href=route("admin.auditoria.analytics")+"?"+i.toString()},D=a.analisis_temporal.actividad_por_hora.map(e=>({hora:`${e.hora}:00`,eventos:e.total})),S=a.analisis_temporal.actividad_por_dia_semana.map(e=>({dia:["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"][e.dia-1]||"N/A",eventos:e.total})),u=a.analisis_geografico.paises.slice(0,5).map((e,i)=>({name:e.pais,value:e.total,color:b[i%b.length]})),U=a.analisis_usuarios.mas_activos.slice(0,10),P=a.analisis_usuarios.con_mas_riesgos.slice(0,5),v=()=>{const e=a.resumen_periodo.total_eventos,i=a.analisis_riesgos.eventos_criticos+a.analisis_riesgos.eventos_alto_riesgo;return e>0?i/e*100:0},T=e=>e>20?"text-red-600":e>10?"text-orange-600":e>5?"text-yellow-600":"text-green-600";return s.jsxs(F,{children:[s.jsx(B,{title:"Analytics - Auditoría Avanzada"}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(L,{href:route("admin.auditoria.index"),children:s.jsxs(M,{variant:"outline",size:"sm",children:[s.jsx(G,{className:"h-4 w-4 mr-2"}),"Volver"]})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Analytics de Auditoría"}),s.jsx("p",{className:"text-muted-foreground",children:"Análisis avanzado de patrones y tendencias de seguridad"})]})]}),s.jsx("div",{className:"flex items-center space-x-3",children:s.jsxs(k,{value:w,onValueChange:C,children:[s.jsx(H,{className:"w-48",children:s.jsx(K,{placeholder:"Seleccionar período"})}),s.jsxs(V,{children:[s.jsx(m,{value:"7d",children:"Últimos 7 días"}),s.jsx(m,{value:"30d",children:"Últimos 30 días"}),s.jsx(m,{value:"90d",children:"Últimos 90 días"}),s.jsx(m,{value:"custom",children:"Personalizado"})]})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsx(r,{children:s.jsx(t,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(I,{className:"h-8 w-8 text-blue-600"}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Eventos"}),s.jsx("p",{className:"text-2xl font-bold",children:a.resumen_periodo.total_eventos.toLocaleString()}),s.jsxs("p",{className:"text-xs text-gray-500",children:[a.resumen_periodo.promedio_diario," eventos/día"]})]})]})})}),s.jsx(r,{children:s.jsx(t,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(g,{className:"h-8 w-8 text-green-600"}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Usuarios Activos"}),s.jsx("p",{className:"text-2xl font-bold",children:a.resumen_periodo.usuarios_activos}),s.jsx("p",{className:"text-xs text-gray-500",children:"Usuarios únicos"})]})]})})}),s.jsx(r,{children:s.jsx(t,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(f,{className:"h-8 w-8 text-purple-600"}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"IPs Diferentes"}),s.jsx("p",{className:"text-2xl font-bold",children:a.resumen_periodo.ips_diferentes}),s.jsx("p",{className:"text-xs text-gray-500",children:"Ubicaciones únicas"})]})]})})}),s.jsx(r,{children:s.jsx(t,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(h,{className:"h-8 w-8 text-red-600"}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Nivel de Riesgo"}),s.jsxs("p",{className:`text-2xl font-bold ${T(v())}`,children:[v().toFixed(1),"%"]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Eventos de riesgo"})]})]})})})]}),s.jsxs($,{defaultValue:"riesgos",className:"space-y-4",children:[s.jsxs(z,{children:[s.jsx(o,{value:"riesgos",children:"Análisis de Riesgos"}),s.jsx(o,{value:"usuarios",children:"Análisis de Usuarios"}),s.jsx(o,{value:"geografico",children:"Análisis Geográfico"}),s.jsx(o,{value:"temporal",children:"Análisis Temporal"}),s.jsx(o,{value:"anomalias",children:"Anomalías"})]}),s.jsx(x,{value:"riesgos",className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs(r,{children:[s.jsxs(l,{children:[s.jsx(c,{children:"Métricas de Seguridad"}),s.jsx(d,{children:"Eventos que requieren atención inmediata"})]}),s.jsxs(t,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(h,{className:"h-5 w-5 text-red-500"}),s.jsx("span",{className:"font-medium",children:"Eventos Críticos"})]}),s.jsx(n,{variant:"destructive",children:a.analisis_riesgos.eventos_criticos})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(h,{className:"h-5 w-5 text-orange-500"}),s.jsx("span",{className:"font-medium",children:"Alto Riesgo"})]}),s.jsx(n,{variant:"secondary",children:a.analisis_riesgos.eventos_alto_riesgo})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(E,{className:"h-5 w-5 text-yellow-500"}),s.jsx("span",{className:"font-medium",children:"Patrones Sospechosos"})]}),s.jsx(n,{variant:"outline",children:a.analisis_riesgos.patrones_sospechosos})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(g,{className:"h-5 w-5 text-blue-500"}),s.jsx("span",{className:"font-medium",children:"Fallos de Autenticación"})]}),s.jsx(n,{variant:"outline",children:a.analisis_riesgos.fallos_autenticacion})]})]})]}),s.jsxs(r,{children:[s.jsxs(l,{children:[s.jsx(c,{children:"Distribución por País"}),s.jsx(d,{children:"Origen geográfico de los eventos"})]}),s.jsx(t,{children:s.jsx(j,{width:"100%",height:250,children:s.jsxs(O,{children:[s.jsx(q,{data:u,cx:"50%",cy:"50%",labelLine:!1,label:({name:e,percent:i})=>`${e} ${(i*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:u.map((e,i)=>s.jsx(X,{fill:e.color},`cell-${i}`))}),s.jsx(p,{})]})})})]})]})}),s.jsx(x,{value:"usuarios",className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs(r,{children:[s.jsxs(l,{children:[s.jsx(c,{children:"Usuarios Más Activos"}),s.jsx(d,{children:"Top 10 usuarios por actividad"})]}),s.jsx(t,{children:s.jsx("div",{className:"space-y-3",children:U.map((e,i)=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-sm font-bold text-blue-600",children:i+1})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:e.usuario?.name||"Usuario N/A"}),s.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",e.usuario_id]})]})]}),s.jsxs(n,{variant:"outline",children:[e.actividad," eventos"]})]},e.usuario_id))})})]}),s.jsxs(r,{children:[s.jsxs(l,{children:[s.jsx(c,{children:"Usuarios de Alto Riesgo"}),s.jsx(d,{children:"Usuarios con más eventos de riesgo"})]}),s.jsx(t,{children:s.jsx("div",{className:"space-y-3",children:P.map((e,i)=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:s.jsx(h,{className:"h-4 w-4 text-red-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:e.usuario?.name||"Usuario N/A"}),s.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",e.usuario_id]})]})]}),s.jsxs(n,{variant:"destructive",children:[e.eventos_riesgo," riesgos"]})]},e.usuario_id))})})]})]})}),s.jsx(x,{value:"geografico",className:"space-y-4",children:s.jsxs(r,{children:[s.jsxs(l,{children:[s.jsx(c,{children:"IPs Más Activas"}),s.jsx(d,{children:"Direcciones IP con mayor actividad"})]}),s.jsx(t,{children:s.jsx("div",{className:"space-y-3",children:a.analisis_geografico.ips_mas_activas.slice(0,10).map((e,i)=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:s.jsx(f,{className:"h-4 w-4 text-purple-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-mono",children:e.ip_address}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Rango #",i+1]})]})]}),s.jsxs(n,{variant:"outline",children:[e.total," eventos"]})]},e.ip_address))})})]})}),s.jsx(x,{value:"temporal",className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[s.jsxs(r,{children:[s.jsxs(l,{children:[s.jsx(c,{children:"Actividad por Hora del Día"}),s.jsx(d,{children:"Distribución horaria de eventos"})]}),s.jsx(t,{children:s.jsx(j,{width:"100%",height:300,children:s.jsxs(Y,{data:D,children:[s.jsx(N,{strokeDasharray:"3 3"}),s.jsx(y,{dataKey:"hora"}),s.jsx(_,{}),s.jsx(p,{}),s.jsx(J,{type:"monotone",dataKey:"eventos",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.6})]})})})]}),s.jsxs(r,{children:[s.jsxs(l,{children:[s.jsx(c,{children:"Actividad por Día de la Semana"}),s.jsx(d,{children:"Distribución semanal de eventos"})]}),s.jsx(t,{children:s.jsx(j,{width:"100%",height:300,children:s.jsxs(Q,{data:S,children:[s.jsx(N,{strokeDasharray:"3 3"}),s.jsx(y,{dataKey:"dia"}),s.jsx(_,{}),s.jsx(p,{}),s.jsx(W,{dataKey:"eventos",fill:"#3b82f6"})]})})})]})]})}),s.jsx(x,{value:"anomalias",className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs(r,{children:[s.jsxs(l,{children:[s.jsx(c,{children:"Accesos Múltiples Simultáneos"}),s.jsx(d,{children:"Usuarios con alta concurrencia de sesiones"})]}),s.jsx(t,{children:a.anomalias_detectadas.accesos_multiples_simultaneos.length>0?s.jsx("div",{className:"space-y-3",children:a.anomalias_detectadas.accesos_multiples_simultaneos.map((e,i)=>s.jsx("div",{className:"p-3 border rounded-lg bg-yellow-50",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium",children:["Usuario ID: ",e.usuario_id]}),s.jsxs("p",{className:"text-sm text-gray-600",children:["IP: ",e.ip_address]})]}),s.jsxs(n,{variant:"secondary",children:[e.total," accesos"]})]})},i))}):s.jsx("p",{className:"text-center text-gray-500 py-8",children:"No se detectaron anomalías de accesos múltiples"})})]}),s.jsxs(r,{children:[s.jsxs(l,{children:[s.jsx(c,{children:"Cambios Masivos"}),s.jsx(d,{children:"Usuarios con alta actividad de modificación"})]}),s.jsx(t,{children:a.anomalias_detectadas.cambios_masivos.length>0?s.jsx("div",{className:"space-y-3",children:a.anomalias_detectadas.cambios_masivos.map((e,i)=>s.jsx("div",{className:"p-3 border rounded-lg bg-orange-50",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium",children:["Usuario ID: ",e.usuario_id]}),s.jsx("p",{className:"text-sm text-gray-600",children:"Alta actividad de modificación"})]}),s.jsxs(n,{variant:"secondary",children:[e.total," cambios"]})]})},i))}):s.jsx("p",{className:"text-center text-gray-500 py-8",children:"No se detectaron anomalías de cambios masivos"})})]})]})})]})]})]})}export{Ps as default};
