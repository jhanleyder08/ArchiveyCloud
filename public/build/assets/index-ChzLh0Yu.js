import{t as Y,r as m,b as w,j as e,H as we,L as V}from"./app-tMaUuF3G.js";import{A as Ce}from"./app-layout-Do2Eb3Sk.js";import{B as h}from"./button-b2NvRhsY.js";import{I as o}from"./input-BUbi3POq.js";import{L as r}from"./label-Bqu3HQD6.js";import{S as A,a as O,b as M,c as k,d as b}from"./select-CdhdgJ0w.js";import{j as de,k as v,l as f,m as N,D as $,g as De,a as q,b as B,c as P,d as L,T as J,e as G}from"./app-sidebar-layout-DrvTFVRU.js";import{F as ee}from"./Combination-CgNv0oAU.js";import{D as se}from"./users-0BijOv_M.js";import{P as Se}from"./plus-bKOZofE8.js";import{T as le,a as Ee}from"./toggle-right-CprvrHc2.js";import{S as oe}from"./square-pen-hyh2d0kN.js";import{C as Te}from"./circle-check-big-V33kOqFh.js";import{S as Fe}from"./search-a-c68EbR.js";import{E as Re}from"./eye-CUHphNhr.js";import{U as ae}from"./upload-BlXEQH5C.js";import{C as Ie}from"./copy-DCEDc1l4.js";import{T as me}from"./trash-2-C2WpkApr.js";import{F as xe}from"./file-spreadsheet-Cbc9jRUZ.js";/* empty css            */import"./index-BqccPZiJ.js";import"./index-gcMQB5yO.js";import"./index-CWm8oeKh.js";import"./check-CjMGlCJz.js";import"./index-DReOSayN.js";import"./x-B3QVzJhq.js";import"./app-logo-icon-DkUm7hxR.js";import"./user-BK5OEaM4.js";import"./mail-CwCHIGE1.js";import"./folder-CyeXS8Xg.js";import"./triangle-alert-JjU49oaO.js";import"./BrandingProvider-DUeywemA.js";const l={success:u=>{Y.success(u,{style:{background:"#10b981",color:"#ffffff",border:"none"}})},error:u=>{Y.error(u,{style:{background:"#ef4444",color:"#ffffff",border:"none"}})},info:u=>{Y.info(u,{style:{background:"#3b82f6",color:"#ffffff",border:"none"}})},warning:u=>{Y.warning(u,{style:{background:"#f59e0b",color:"#ffffff",border:"none"}})}};function ms({trds:u,stats:he,ccds:W=[],flash:j}){const z=he||{total:0,vigentes:0,borradores:0,aprobadas:0},y=u||{data:[],total:0,from:0,to:0,links:[]},[E,ge]=m.useState(""),[T,pe]=m.useState(""),[F,ue]=m.useState(""),[R,C]=m.useState(null),[je,X]=m.useState(!1),[t,I]=m.useState(null),[n,re]=m.useState(null),[U,H]=m.useState(null),[D,Q]=m.useState(null),[ie,ne]=m.useState(!1),_=m.useRef(null);m.useEffect(()=>{j?.success&&l.success(j.success),j?.error&&l.error(j.error)},[j]);const[a,x]=m.useState({codigo:"",ccd_id:"",nombre:"",descripcion:"",codigo_unidad_administrativa:"",nombre_unidad_administrativa:"",codigo_dependencia:"",nombre_dependencia:"",fecha_aprobacion:"",fecha_vigencia_inicio:"",fecha_vigencia_fin:"",observaciones_generales:"",version:1,estado:"borrador"}),[c,g]=m.useState({codigo:"",nombre:"",descripcion:"",codigo_unidad_administrativa:"",nombre_unidad_administrativa:"",codigo_dependencia:"",nombre_dependencia:"",fecha_aprobacion:"",fecha_vigencia_inicio:"",fecha_vigencia_fin:"",observaciones_generales:"",version:1,estado:"borrador"});m.useEffect(()=>{t&&g({codigo:t.codigo||"",nombre:t.nombre||"",descripcion:t.descripcion||"",codigo_unidad_administrativa:t.codigo_unidad_administrativa||"",nombre_unidad_administrativa:t.nombre_unidad_administrativa||"",codigo_dependencia:t.codigo_dependencia||"",nombre_dependencia:t.nombre_dependencia||"",fecha_aprobacion:t.fecha_aprobacion?new Date(t.fecha_aprobacion).toISOString().split("T")[0]:"",fecha_vigencia_inicio:t.fecha_vigencia_inicio?new Date(t.fecha_vigencia_inicio).toISOString().split("T")[0]:"",fecha_vigencia_fin:t.fecha_vigencia_fin?new Date(t.fecha_vigencia_fin).toISOString().split("T")[0]:"",observaciones_generales:t.observaciones_generales||"",version:t.version||1,estado:t.estado||"borrador"})},[t]);const be=[{title:"Dashboard",href:"/dashboard"},{title:"Administraci√≥n",href:"#"},{title:"Tablas de Retenci√≥n Documental",href:"/admin/trd"}],K={borrador:"Borrador",revision:"En Revisi√≥n",aprobada:"Aprobada",vigente:"Vigente",historica:"Hist√≥rica"};m.useEffect(()=>{const s=setTimeout(()=>{if(E!==""||T!==""||F!==""){const i=new URLSearchParams;E&&i.append("search",E),T&&i.append("estado",T),F&&i.append("vigencia",F),w.visit(`/admin/trd?${i.toString()}`,{preserveState:!0,preserveScroll:!0,replace:!0})}},500);return()=>clearTimeout(s)},[E,T,F]);const ve=s=>{w.delete(`/admin/trd/${s.id}`,{preserveScroll:!0,onSuccess:()=>{C(null),l.success("TRD eliminada exitosamente")},onError:i=>{const d=Object.values(i)[0];l.error(d||"Error al eliminar la TRD"),C(null)},onFinish:()=>C(null)})},fe=s=>{if(s.estado==="borrador"){l.error("No se puede activar la vigencia de una TRD en estado Borrador. Debe estar Aprobada primero.");return}if(s.estado==="revision"){l.error("No se puede activar la vigencia de una TRD en Revisi√≥n. Debe estar Aprobada primero.");return}w.patch(`/admin/trd/${s.id}/vigencia`,{},{preserveScroll:!0,onSuccess:()=>{l.success(s.estado==="vigente"?"Vigencia desactivada exitosamente":"Vigencia activada exitosamente")},onError:i=>{const d=Object.values(i)[0];l.error(d||"Error al cambiar el estado de vigencia")}})},Ne=s=>{w.post(`/admin/trd/${s.id}/duplicate`,{},{preserveScroll:!0,onSuccess:()=>{l.success("TRD duplicada exitosamente")},onError:i=>{const d=Object.values(i)[0];l.error(d||"Error al duplicar la TRD")}})},ye=s=>{if(!D){l.error("Seleccione un archivo Excel o CSV");return}ne(!0);const i=new FormData;i.append("archivo",D),w.post(`/admin/trd/${s.id}/importar`,i,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{l.success("Series importadas exitosamente"),H(null),Q(null),_.current&&(_.current.value="")},onError:d=>{const p=Object.values(d)[0];l.error(p||"Error al importar series")},onFinish:()=>{ne(!1)}})},te=()=>{window.location.href="/admin/trd/plantilla"},_e=s=>{window.location.href=`/admin/trd/${s.id}/export-pdf`},S=s=>new Date(s).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}),ce=s=>{const i=s==="vigente"?"aprobada":s,d={borrador:"bg-gray-100 text-gray-800",revision:"bg-yellow-100 text-yellow-800",aprobada:"bg-green-100 text-green-800",rechazada:"bg-red-100 text-red-800",obsoleta:"bg-red-100 text-red-800"},p=K[i]||i,Z=d[i]||"bg-gray-100 text-gray-800";return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Z}`,children:p})};return e.jsxs(Ce,{breadcrumbs:be,children:[e.jsx(we,{title:"Gesti√≥n de Tablas de Retenci√≥n Documental"}),e.jsxs("div",{className:"space-y-6",children:[j?.success&&e.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg",children:j.success}),j?.error&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:j.error}),e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-6 w-6 text-[#2a3d83]"}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Gesti√≥n de Tablas de Retenci√≥n Documental"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{children:e.jsxs(v,{children:[e.jsx(f,{asChild:!0,children:e.jsxs(h,{variant:"outline",onClick:te,className:"flex items-center gap-2 px-3 py-2 text-emerald-700 border-emerald-300 hover:bg-emerald-50",children:[e.jsx(se,{className:"h-4 w-4"}),"Plantilla Excel"]})}),e.jsx(N,{children:e.jsx("p",{children:"Descargar plantilla para importar series"})})]})}),e.jsxs($,{open:je,onOpenChange:X,children:[e.jsx(De,{asChild:!0,children:e.jsxs(h,{className:"flex items-center gap-2 px-4 py-2 bg-[#2a3d83] text-white rounded-lg hover:bg-[#1e2b5f] transition-colors",children:[e.jsx(Se,{className:"h-4 w-4"}),"Nueva TRD"]})}),e.jsxs(q,{className:"sm:max-w-[600px] max-h-[80vh] overflow-y-scroll [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:[e.jsxs(B,{children:[e.jsx(P,{className:"text-xl font-semibold text-gray-900",children:"Crear Nueva TRD"}),e.jsx(L,{className:"text-sm text-gray-600",children:"Complete los siguientes datos para crear una nueva Tabla de Retenci√≥n Documental."})]}),e.jsxs("form",{onSubmit:s=>{if(s.preventDefault(),!a.ccd_id){l.error("Debe seleccionar un CCD");return}if(!a.codigo||!a.nombre||!a.codigo_unidad_administrativa||!a.nombre_unidad_administrativa){l.error("Por favor complete todos los campos requeridos");return}const i={codigo:a.codigo.trim(),ccd_id:parseInt(a.ccd_id),nombre:a.nombre.trim(),descripcion:a.descripcion?.trim()||"",codigo_unidad_administrativa:a.codigo_unidad_administrativa.trim(),nombre_unidad_administrativa:a.nombre_unidad_administrativa.trim(),codigo_dependencia:a.codigo_dependencia?.trim()||"",nombre_dependencia:a.nombre_dependencia?.trim()||"",fecha_aprobacion:a.fecha_aprobacion||null,fecha_vigencia_inicio:a.fecha_vigencia_inicio||null,fecha_vigencia_fin:a.fecha_vigencia_fin||null,observaciones_generales:a.observaciones_generales?.trim()||null,version:String(a.version||1),estado:a.estado};console.log("Enviando datos:",i),w.post("/admin/trd",i,{preserveScroll:!0,onSuccess:()=>{X(!1),x({codigo:"",ccd_id:"",nombre:"",descripcion:"",codigo_unidad_administrativa:"",nombre_unidad_administrativa:"",codigo_dependencia:"",nombre_dependencia:"",fecha_aprobacion:"",fecha_vigencia_inicio:"",fecha_vigencia_fin:"",observaciones_generales:"",version:1,estado:"borrador"})},onError:d=>{console.error("Error al crear TRD:",d),d&&Object.keys(d).forEach(p=>{const Z=Array.isArray(d[p])?d[p][0]:d[p];l.error(`Error en ${p}: ${Z}`)})}})},className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx(r,{htmlFor:"create-ccd",className:"text-[#2a3d83] font-semibold",children:"Cuadro de Clasificaci√≥n Documental (CCD) *"}),e.jsxs(A,{value:a.ccd_id,onValueChange:s=>x({...a,ccd_id:s}),children:[e.jsx(O,{className:"bg-white",children:e.jsx(M,{placeholder:"Seleccione un CCD..."})}),e.jsx(k,{children:W.length===0?e.jsx(b,{value:"none",disabled:!0,children:"No hay CCDs disponibles"}):W.map(s=>e.jsxs(b,{value:s.id.toString(),children:[s.codigo," - ",s.nombre]},s.id))})]}),W.length===0&&e.jsx("p",{className:"text-xs text-amber-600",children:"‚ö†Ô∏è Debe crear un CCD primero"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"create-codigo",children:"C√≥digo TRD *"}),e.jsx(o,{id:"create-codigo",type:"text",value:a.codigo,onChange:s=>x({...a,codigo:s.target.value}),placeholder:"Ej: FOR-GDI-GDO-002",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"create-version",children:"Versi√≥n *"}),e.jsx(o,{id:"create-version",type:"number",min:"1",value:a.version,onChange:s=>x({...a,version:parseInt(s.target.value)||1}),placeholder:"01",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"create-nombre",children:"Nombre de la TRD *"}),e.jsx(o,{id:"create-nombre",type:"text",value:a.nombre,onChange:s=>x({...a,nombre:s.target.value}),placeholder:"Ej: TABLAS DE RETENCI√ìN DOCUMENTAL",required:!0})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border space-y-3",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"üìÅ Unidad Administrativa"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"create-codigo-unidad",children:"C√≥digo *"}),e.jsx(o,{id:"create-codigo-unidad",type:"text",value:a.codigo_unidad_administrativa,onChange:s=>x({...a,codigo_unidad_administrativa:s.target.value}),placeholder:"Ej: 110",required:!0})]}),e.jsxs("div",{className:"space-y-2 md:col-span-3",children:[e.jsx(r,{htmlFor:"create-nombre-unidad",children:"Nombre *"}),e.jsx(o,{id:"create-nombre-unidad",type:"text",value:a.nombre_unidad_administrativa,onChange:s=>x({...a,nombre_unidad_administrativa:s.target.value}),placeholder:"Ej: SUBGERENCIA DE SERVICIOS DE SALUD",required:!0})]})]})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border space-y-3",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"üè¢ Dependencia Productora"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"create-codigo-dependencia",children:"C√≥digo"}),e.jsx(o,{id:"create-codigo-dependencia",type:"text",value:a.codigo_dependencia,onChange:s=>x({...a,codigo_dependencia:s.target.value}),placeholder:"Ej: 111"})]}),e.jsxs("div",{className:"space-y-2 md:col-span-3",children:[e.jsx(r,{htmlFor:"create-nombre-dependencia",children:"Nombre"}),e.jsx(o,{id:"create-nombre-dependencia",type:"text",value:a.nombre_dependencia,onChange:s=>x({...a,nombre_dependencia:s.target.value}),placeholder:"Ej: OFICINA COORDINADORA DE URGENCIAS Y EMERGENCIAS"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"create-descripcion",children:"Descripci√≥n"}),e.jsx(J,{id:"create-descripcion",value:a.descripcion,onChange:s=>x({...a,descripcion:s.target.value}),placeholder:"Descripci√≥n de la TRD",rows:2})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"create-fecha-aprobacion",children:"Fecha de Emisi√≥n"}),e.jsx(o,{id:"create-fecha-aprobacion",type:"date",value:a.fecha_aprobacion,onChange:s=>x({...a,fecha_aprobacion:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"create-fecha-vigencia-inicio",children:"Fecha Vigencia Inicio"}),e.jsx(o,{id:"create-fecha-vigencia-inicio",type:"date",value:a.fecha_vigencia_inicio,onChange:s=>x({...a,fecha_vigencia_inicio:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"create-fecha-vigencia-fin",children:"Fecha Vigencia Fin"}),e.jsx(o,{id:"create-fecha-vigencia-fin",type:"date",value:a.fecha_vigencia_fin,onChange:s=>x({...a,fecha_vigencia_fin:s.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"create-observaciones",children:"Observaciones Generales"}),e.jsx(J,{id:"create-observaciones",value:a.observaciones_generales,onChange:s=>x({...a,observaciones_generales:s.target.value}),placeholder:"Observaciones adicionales",rows:2})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"create-estado",children:"Estado Inicial"}),e.jsxs(A,{value:a.estado,onValueChange:s=>x({...a,estado:s}),children:[e.jsx(O,{children:e.jsx(M,{placeholder:"Seleccionar estado"})}),e.jsx(k,{children:Object.entries(K).filter(([s])=>s!=="vigente").map(([s,i])=>e.jsx(b,{value:s,children:i},s))})]})]}),e.jsxs(G,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>X(!1),children:"Cancelar"}),e.jsx(h,{type:"submit",className:"bg-[#2a3d83] hover:bg-[#1e2b5f]",children:"Crear TRD"})]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total TRDs"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:z.total}),e.jsx("p",{className:"text-xs text-gray-400",children:"Tablas registradas"})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(ee,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Vigentes"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:z.vigentes}),e.jsx("p",{className:"text-xs text-gray-400",children:"En funcionamiento"})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(le,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Borradores"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:z.borradores}),e.jsx("p",{className:"text-xs text-gray-400",children:"En elaboraci√≥n"})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(oe,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Aprobadas"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:z.aprobadas}),e.jsx("p",{className:"text-xs text-gray-400",children:"Listas para uso"})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(Te,{className:"h-6 w-6 text-[#2a3d83]"})})]})})]}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4 w-full sm:w-auto",children:e.jsxs("div",{className:"relative flex-1 sm:w-80",children:[e.jsx(Fe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(o,{type:"text",value:E,onChange:s=>ge(s.target.value),placeholder:"Buscar TRDs...",className:"pl-10"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(A,{value:T||"all",onValueChange:s=>pe(s==="all"?"":s),children:[e.jsx(O,{className:"w-[180px]",children:e.jsx(M,{placeholder:"Todos los estados"})}),e.jsxs(k,{children:[e.jsx(b,{value:"all",children:"Todos los estados"}),Object.entries(K).map(([s,i])=>e.jsx(b,{value:s,children:i},s))]})]}),e.jsxs(A,{value:F||"all",onValueChange:s=>ue(s==="all"?"":s),children:[e.jsx(O,{className:"w-[180px]",children:e.jsx(M,{placeholder:"Todas las vigencias"})}),e.jsxs(k,{children:[e.jsx(b,{value:"all",children:"Todas las vigencias"}),e.jsx(b,{value:"true",children:"Vigentes"}),e.jsx(b,{value:"false",children:"No vigentes"})]})]})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg border overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"TRD"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"CCD Asociado"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Estado"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Vigencia"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Series"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Actualizaci√≥n"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Acciones"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:y.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"py-8 px-6 text-center text-gray-500",children:"No se encontraron TRDs."})}):y.data.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.nombre}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.codigo," ‚Ä¢ v",s.version]}),e.jsx("div",{className:"text-xs text-gray-400",children:s.identificador_unico})]})}),e.jsx("td",{className:"py-4 px-6",children:s.cuadro_clasificacion?e.jsxs(V,{href:`/admin/ccd/${s.cuadro_clasificacion.id}`,className:"block hover:bg-blue-50 rounded p-1 -m-1 transition-colors",children:[e.jsx("div",{className:"text-sm text-[#2a3d83] font-medium hover:underline",children:s.cuadro_clasificacion.codigo}),e.jsx("div",{className:"text-xs text-gray-500 line-clamp-1",children:s.cuadro_clasificacion.nombre})]}):e.jsx("span",{className:"text-sm text-gray-400 italic",children:"Sin CCD"})}),e.jsx("td",{className:"py-4 px-6",children:ce(s.estado)}),e.jsx("td",{className:"py-4 px-6",children:s.vigente?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Vigente"}):e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Inactiva"})}),e.jsx("td",{className:"py-4 px-6 text-gray-600",children:s.series_count||0}),e.jsx("td",{className:"py-4 px-6 text-gray-600",children:S(s.updated_at)}),e.jsx("td",{className:"py-4 px-6",children:e.jsx(de,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(v,{children:[e.jsx(f,{asChild:!0,children:e.jsx(V,{href:`/admin/trd/${s.id}`,className:"p-2 rounded-md text-[#2a3d83] hover:text-[#1e2b5f] hover:bg-blue-50 transition-colors inline-flex",children:e.jsx(Re,{className:"h-4 w-4"})})}),e.jsx(N,{children:e.jsx("p",{children:"Ver estructura y tiempos de retenci√≥n"})})]}),e.jsxs(v,{children:[e.jsx(f,{asChild:!0,children:e.jsx("button",{onClick:()=>I(s),className:"p-2 rounded-md text-[#2a3d83] hover:text-[#1e2b5f] hover:bg-blue-50 transition-colors",children:e.jsx(oe,{className:"h-4 w-4"})})}),e.jsx(N,{children:e.jsx("p",{children:"Editar TRD"})})]}),e.jsxs(v,{children:[e.jsx(f,{asChild:!0,children:e.jsx("button",{onClick:()=>H(s),className:"p-2 rounded-md text-emerald-600 hover:text-emerald-800 hover:bg-emerald-50 transition-colors",children:e.jsx(ae,{className:"h-4 w-4"})})}),e.jsx(N,{children:e.jsx("p",{children:"Importar Series (Excel/CSV)"})})]}),e.jsxs(v,{children:[e.jsx(f,{asChild:!0,children:e.jsx("button",{onClick:()=>_e(s),className:"p-2 rounded-md text-red-500 hover:text-red-700 hover:bg-red-50 transition-colors",children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsx(N,{children:e.jsx("p",{children:"Exportar PDF (Formato Oficial)"})})]}),e.jsxs(v,{children:[e.jsx(f,{asChild:!0,children:e.jsx("button",{onClick:()=>Ne(s),className:"p-2 rounded-md text-[#2a3d83] hover:text-[#1e2b5f] hover:bg-blue-50 transition-colors",children:e.jsx(Ie,{className:"h-4 w-4"})})}),e.jsx(N,{children:e.jsx("p",{children:"Duplicar TRD"})})]}),e.jsxs(v,{children:[e.jsx(f,{asChild:!0,children:e.jsx("button",{onClick:()=>fe(s),className:`p-2 rounded-md transition-colors ${s.estado==="vigente"?"text-orange-600 hover:text-orange-800 hover:bg-orange-50":"text-green-600 hover:text-green-800 hover:bg-green-50"}`,children:s.estado==="vigente"?e.jsx(Ee,{className:"h-4 w-4"}):e.jsx(le,{className:"h-4 w-4"})})}),e.jsx(N,{children:e.jsx("p",{children:s.estado==="vigente"?"Desactivar vigencia":"Activar vigencia"})})]}),e.jsxs(v,{children:[e.jsx(f,{asChild:!0,children:e.jsx("button",{onClick:()=>C(s),className:"p-2 rounded-md text-red-600 hover:text-red-800 hover:bg-red-50 transition-colors",children:e.jsx(me,{className:"h-4 w-4"})})}),e.jsx(N,{children:e.jsx("p",{children:"Eliminar TRD"})})]})]})})})]},s.id))})]})}),y.data.length>0&&e.jsxs("div",{className:"flex items-center justify-between bg-white border rounded-lg px-6 py-3",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",e.jsx("span",{className:"font-medium",children:y.from||0})," a"," ",e.jsx("span",{className:"font-medium",children:y.to||0})," de"," ",e.jsx("span",{className:"font-medium",children:y.total||0})," TRDs"]}),e.jsx("div",{className:"flex items-center gap-2",children:y.links.map((s,i)=>s.label.includes("Previous")?e.jsx(V,{href:s.url||"#",preserveState:!0,className:`px-3 py-2 border border-gray-300 rounded-md text-sm font-medium ${s.url?"text-gray-700 hover:bg-gray-50":"text-gray-300 cursor-not-allowed"}`,children:"Anterior"},i):s.label.includes("Next")?e.jsx(V,{href:s.url||"#",preserveState:!0,className:`px-3 py-2 border border-gray-300 rounded-md text-sm font-medium ${s.url?"text-gray-700 hover:bg-gray-50":"text-gray-300 cursor-not-allowed"}`,children:"Siguiente"},i):isNaN(Number(s.label))?null:e.jsx(V,{href:s.url||"#",preserveState:!0,className:`px-3 py-2 rounded-md text-sm font-medium ${s.active?"bg-[#2a3d83] text-white":"border border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:s.label},i))})]})]}),e.jsx($,{open:!!R,onOpenChange:s=>{s||C(null)},children:e.jsxs(q,{className:"sm:max-w-[425px]",children:[e.jsxs(B,{children:[e.jsx(P,{className:"text-xl font-semibold text-gray-900",children:"Eliminar TRD"}),e.jsx(L,{className:"text-sm text-gray-600",children:"Esta acci√≥n no se puede deshacer. La TRD ser√° eliminada permanentemente del sistema."})]}),e.jsxs("div",{className:"py-4",children:[e.jsxs("p",{className:"text-gray-700",children:["¬øEst√°s seguro de que deseas eliminar la TRD ",e.jsx("strong",{children:R?.nombre}),"?"]}),e.jsxs("p",{className:"text-gray-600 mt-2",children:["C√≥digo: ",e.jsx("strong",{children:R?.codigo})]})]}),e.jsxs(G,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>C(null),children:"Cancelar"}),e.jsx(h,{type:"button",variant:"destructive",onClick:()=>R&&ve(R),children:"Eliminar TRD"})]})]})}),e.jsx($,{open:!!t,onOpenChange:s=>{s||I(null)},children:e.jsxs(q,{className:"sm:max-w-[600px] max-h-[80vh] overflow-y-scroll [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:[e.jsxs(B,{children:[e.jsx(P,{className:"text-xl font-semibold text-gray-900",children:"Editar TRD"}),e.jsx(L,{className:"text-sm text-gray-600",children:"Modifique los datos de la Tabla de Retenci√≥n Documental seg√∫n sea necesario."})]}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),t&&w.put(`/admin/trd/${t.id}`,c,{onSuccess:()=>{I(null),l.success("TRD actualizada exitosamente")},onError:i=>{Object.keys(i).forEach(d=>{const p=Array.isArray(i[d])?i[d][0]:i[d];l.error(`Error en ${d}: ${p}`)})}})},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-codigo",children:"C√≥digo *"}),e.jsx(o,{id:"edit-codigo",type:"text",value:c.codigo,onChange:s=>g({...c,codigo:s.target.value}),placeholder:"Ej: TRD-001",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-entidad",children:"Entidad *"}),e.jsx(o,{id:"edit-entidad",type:"text",value:c.entidad,onChange:s=>g({...c,entidad:s.target.value}),placeholder:"Nombre de la entidad",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-nombre",children:"Nombre *"}),e.jsx(o,{id:"edit-nombre",type:"text",value:c.nombre,onChange:s=>g({...c,nombre:s.target.value}),placeholder:"Nombre de la TRD",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-descripcion",children:"Descripci√≥n *"}),e.jsx(J,{id:"edit-descripcion",value:c.descripcion,onChange:s=>g({...c,descripcion:s.target.value}),placeholder:"Descripci√≥n de la TRD",rows:3,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-dependencia",children:"Dependencia"}),e.jsx(o,{id:"edit-dependencia",type:"text",value:c.dependencia,onChange:s=>g({...c,dependencia:s.target.value}),placeholder:"Dependencia responsable"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-fecha-aprobacion",children:"Fecha de Aprobaci√≥n *"}),e.jsx(o,{id:"edit-fecha-aprobacion",type:"date",value:c.fecha_aprobacion,onChange:s=>g({...c,fecha_aprobacion:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-fecha-vigencia-inicio",children:"Fecha Vigencia Inicio *"}),e.jsx(o,{id:"edit-fecha-vigencia-inicio",type:"date",value:c.fecha_vigencia_inicio,onChange:s=>g({...c,fecha_vigencia_inicio:s.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-fecha-vigencia-fin",children:"Fecha Vigencia Fin"}),e.jsx(o,{id:"edit-fecha-vigencia-fin",type:"date",value:c.fecha_vigencia_fin,onChange:s=>g({...c,fecha_vigencia_fin:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-estado",children:"Estado *"}),e.jsxs(A,{value:c.estado,onValueChange:s=>g({...c,estado:s}),children:[e.jsx(O,{children:e.jsx(M,{placeholder:"Seleccionar estado"})}),e.jsx(k,{children:Object.entries(K).filter(([s])=>s!=="vigente").map(([s,i])=>e.jsx(b,{value:s,children:i},s))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-observaciones",children:"Observaciones Generales"}),e.jsx(J,{id:"edit-observaciones",value:c.observaciones_generales,onChange:s=>g({...c,observaciones_generales:s.target.value}),placeholder:"Observaciones adicionales",rows:2})]}),e.jsxs(G,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>I(null),children:"Cancelar"}),e.jsx(h,{type:"submit",className:"bg-[#2a3d83] hover:bg-[#1e2b5f]",children:"Actualizar TRD"})]})]})]})}),e.jsx($,{open:!!n,onOpenChange:()=>re(null),children:e.jsxs(q,{className:"sm:max-w-[800px] max-h-[80vh] overflow-y-scroll [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:[e.jsxs(B,{children:[e.jsx(P,{className:"text-xl font-semibold text-gray-900",children:"Detalles de TRD"}),e.jsx(L,{className:"text-sm text-gray-600",children:"Informaci√≥n completa de la Tabla de Retenci√≥n Documental."})]}),n&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-[#2a3d83] mb-3",children:"Informaci√≥n B√°sica"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{className:"font-medium text-gray-700",children:"C√≥digo"}),e.jsx("p",{className:"text-gray-900 bg-white p-2 rounded border",children:n.codigo})]}),e.jsxs("div",{children:[e.jsx(r,{className:"font-medium text-gray-700",children:"Estado"}),e.jsx("div",{className:"mt-1",children:ce(n.estado)})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(r,{className:"font-medium text-gray-700",children:"Nombre"}),e.jsx("p",{className:"text-gray-900 bg-white p-2 rounded border",children:n.nombre})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(r,{className:"font-medium text-gray-700",children:"Descripci√≥n"}),e.jsx("p",{className:"text-gray-900 bg-white p-3 rounded border min-h-[60px]",children:n.descripcion})]})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-[#2a3d83] mb-3",children:"Informaci√≥n Organizacional"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{className:"font-medium text-gray-700",children:"Entidad"}),e.jsx("p",{className:"text-gray-900 bg-white p-2 rounded border",children:n.entidad})]}),e.jsxs("div",{children:[e.jsx(r,{className:"font-medium text-gray-700",children:"Dependencia"}),e.jsx("p",{className:"text-gray-900 bg-white p-2 rounded border",children:n.dependencia||"No especificada"})]})]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-[#2a3d83] mb-3",children:"Versi√≥n y Vigencia"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{className:"font-medium text-gray-700",children:"Versi√≥n"}),e.jsx("p",{className:"text-gray-900 bg-white p-2 rounded border font-semibold",children:n.version})]}),e.jsxs("div",{children:[e.jsx(r,{className:"font-medium text-gray-700",children:"Fecha Aprobaci√≥n"}),e.jsx("p",{className:"text-gray-900 bg-white p-2 rounded border",children:S(n.fecha_aprobacion)})]}),e.jsxs("div",{children:[e.jsx(r,{className:"font-medium text-gray-700",children:"Estado Vigencia"}),e.jsx("div",{className:"mt-1",children:n.vigente?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Vigente"}):e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"No Vigente"})})]}),e.jsxs("div",{children:[e.jsx(r,{className:"font-medium text-gray-700",children:"Fecha Vigencia Inicio"}),e.jsx("p",{className:"text-gray-900 bg-white p-2 rounded border",children:S(n.fecha_vigencia_inicio)})]}),e.jsxs("div",{children:[e.jsx(r,{className:"font-medium text-gray-700",children:"Fecha Vigencia Fin"}),e.jsx("p",{className:"text-gray-900 bg-white p-2 rounded border",children:n.fecha_vigencia_fin?S(n.fecha_vigencia_fin):"No definida"})]}),e.jsxs("div",{children:[e.jsx(r,{className:"font-medium text-gray-700",children:"Series Documentales"}),e.jsx("p",{className:"text-gray-900 bg-white p-2 rounded border font-semibold",children:n.series_count||0})]})]})]}),n.observaciones_generales&&e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-[#2a3d83] mb-3",children:"Observaciones Generales"}),e.jsx("p",{className:"text-gray-900 bg-white p-3 rounded border whitespace-pre-wrap",children:n.observaciones_generales})]}),e.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-[#2a3d83] mb-3",children:"Informaci√≥n de Sistema"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{className:"font-medium text-gray-700",children:"Identificador √önico"}),e.jsx("p",{className:"text-gray-900 bg-white p-2 rounded border font-mono text-sm",children:n.identificador_unico||"No asignado"})]}),e.jsxs("div",{children:[e.jsx(r,{className:"font-medium text-gray-700",children:"Formato de Archivo"}),e.jsx("p",{className:"text-gray-900 bg-white p-2 rounded border",children:n.formato_archivo||"No especificado"})]}),e.jsxs("div",{children:[e.jsx(r,{className:"font-medium text-gray-700",children:"Fecha de Creaci√≥n"}),e.jsx("p",{className:"text-gray-900 bg-white p-2 rounded border",children:S(n.created_at)})]}),e.jsxs("div",{children:[e.jsx(r,{className:"font-medium text-gray-700",children:"√öltima Modificaci√≥n"}),e.jsx("p",{className:"text-gray-900 bg-white p-2 rounded border",children:S(n.updated_at)})]})]})]})]}),e.jsxs(G,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>re(null),children:"Cerrar"}),e.jsx(h,{type:"button",onClick:()=>I(n),className:"bg-[#2a3d83] hover:bg-[#1e2b5f]",children:"Editar TRD"})]})]})}),e.jsx($,{open:U!==null,onOpenChange:s=>!s&&H(null),children:e.jsxs(q,{className:"sm:max-w-[500px]",children:[e.jsxs(B,{children:[e.jsxs(P,{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(xe,{className:"h-5 w-5 text-emerald-600"}),"Importar Series Documentales"]}),e.jsxs(L,{className:"text-sm text-gray-600",children:["Importe series documentales desde un archivo Excel (.xlsx, .xls) o CSV para la TRD: ",e.jsx("strong",{children:U?.nombre})]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-emerald-400 transition-colors",children:[e.jsx("input",{ref:_,type:"file",accept:".xlsx,.xls,.csv",onChange:s=>{const i=s.target.files?.[0];if(i){if(i.size>10*1024*1024){l.error("El archivo no debe superar 10MB"),s.target.value="";return}Q(i)}},className:"hidden",id:"import-file-input"}),e.jsxs("label",{htmlFor:"import-file-input",className:"cursor-pointer",children:[e.jsx(ae,{className:"mx-auto h-12 w-12 text-gray-400 mb-3"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("span",{className:"font-semibold text-emerald-600",children:"Haga clic para seleccionar"})," o arrastre el archivo aqu√≠"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Formatos soportados: Excel (.xlsx, .xls) o CSV (m√°x. 10MB)"})]})]}),D&&e.jsxs("div",{className:"bg-emerald-50 border border-emerald-200 rounded-lg p-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-5 w-5 text-emerald-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-emerald-900",children:D.name}),e.jsxs("p",{className:"text-xs text-emerald-600",children:[(D.size/1024).toFixed(2)," KB"]})]})]}),e.jsx("button",{onClick:()=>{Q(null),_.current&&(_.current.value="")},className:"text-emerald-600 hover:text-emerald-800",children:e.jsx(me,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(se,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"¬øNecesita la plantilla?"}),e.jsx("p",{className:"text-xs text-blue-700 mb-2",children:"Descargue la plantilla Excel con el formato correcto para importar series documentales."}),e.jsxs(h,{type:"button",variant:"outline",size:"sm",onClick:te,className:"text-blue-700 border-blue-300 hover:bg-blue-100",children:[e.jsx(se,{className:"h-4 w-4 mr-1"}),"Descargar Plantilla"]})]})]})}),e.jsxs("div",{className:"text-xs text-gray-500 bg-gray-50 p-3 rounded-lg",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Columnas esperadas en el archivo:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5",children:[e.jsx("li",{children:"C√≥digo Serie, Nombre Serie (requeridos)"}),e.jsx("li",{children:"C√≥digo Subserie, Nombre Subserie (opcionales)"}),e.jsx("li",{children:"Soporte F√≠sico (F), Soporte Electr√≥nico (E)"}),e.jsx("li",{children:"Retenci√≥n Gesti√≥n, Retenci√≥n Central (a√±os)"}),e.jsx("li",{children:"Disposici√≥n Final (CT, E, D, S)"}),e.jsx("li",{children:"Procedimiento"})]})]})]}),e.jsxs(G,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>{H(null),Q(null),_.current&&(_.current.value="")},children:"Cancelar"}),e.jsx(h,{type:"button",onClick:()=>U&&ye(U),disabled:!D||ie,className:"bg-emerald-600 hover:bg-emerald-700",children:ie?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin mr-2",children:"‚è≥"}),"Importando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-4 w-4 mr-1"}),"Importar Series"]})})]})]})})]})]})}export{ms as default};
