import{r as f,u as O,j as e,H as q,L as g,b as w}from"./app-1TbR1aNv.js";import{A as P}from"./app-layout-DBvULR4o.js";import{B as u}from"./button-Bh8HL4t-.js";import{I as m}from"./input-B9S_DJNe.js";import{L as n}from"./label-CB51Zwfa.js";import{F as _,D as G,f as R,a as K,b as U,c as W,d as z,T as J,e as Q,t as S}from"./app-sidebar-layout-EVqXnw4l.js";import{B as h}from"./badge-CahYhPrs.js";import{S as E,a as $,b as F,c as T,d as x}from"./select-55yoEt5h.js";import{u as X}from"./useInertiaActions-D7gSRszt.js";import{P as Y}from"./plus-BY-Qt84n.js";import{S as Z}from"./save-DD4v5MIX.js";import{C as ee}from"./circle-check-big-C8qeYor2.js";import{C as se}from"./circle-alert-IdL8hEBm.js";import{T as ae}from"./users-KtdTbN4b.js";import{S as A}from"./search-BY4VdWrh.js";import{E as re}from"./eye-Cg57hUSN.js";import{S as te}from"./square-pen-T6F7AT2X.js";import{T as ie}from"./trash-2-CJKPg-zO.js";/* empty css            */import"./index-DV8Rt-0p.js";import"./index-DaDMCySO.js";import"./Combination-Bg4lGtaS.js";import"./index-12rucE5D.js";import"./x-BA_bLoEE.js";import"./index-B37z7FM4.js";import"./app-logo-icon-D5sKSL8w.js";import"./user-Eo78Nm40.js";import"./mail-Dw8iYVcL.js";import"./folder-BrHeBlTR.js";import"./triangle-alert-Csu15FGV.js";import"./index-BRmIzMxm.js";import"./check-BetP237p.js";function Oe({ccds:t,estadisticas:p,filters:b,opciones:B}){const N=X({only:["ccds","estadisticas"]}),[l,I]=f.useState(b?.search||""),[c,M]=f.useState(b?.estado||"all"),[V,j]=f.useState(!1),{data:i,setData:o,post:le,processing:y,errors:a,reset:C}=O({codigo:"",nombre:"",descripcion:"",version:"",fecha_vigencia_inicio:"",fecha_vigencia_fin:"",estado:"borrador"}),k=B||{estados:[{value:"borrador",label:"Borrador"},{value:"activo",label:"Activo"},{value:"inactivo",label:"Inactivo"},{value:"historico",label:"Histórico"}]},D=()=>{const s={};l.trim()&&(s.search=l.trim()),c&&c!=="all"&&(s.estado=c),w.get("/admin/ccd",s,{preserveState:!1,preserveScroll:!1,replace:!0})},H=s=>{M(s);const r={};l.trim()&&(r.search=l.trim()),s&&s!=="all"&&(r.estado=s),w.get("/admin/ccd",r,{preserveState:!1,preserveScroll:!1,replace:!0})},L=s=>({borrador:e.jsx(h,{variant:"secondary",className:"bg-gray-100 text-gray-800",children:"Borrador"}),activo:e.jsx(h,{variant:"default",className:"bg-green-100 text-green-800",children:"Activo"}),inactivo:e.jsx(h,{variant:"destructive",className:"bg-red-100 text-red-800",children:"Inactivo"}),historico:e.jsx(h,{variant:"outline",className:"bg-blue-100 text-blue-800",children:"Histórico"})})[s]||e.jsx(h,{children:s});return e.jsxs(P,{breadcrumbs:[{title:"Dashboard",href:"/dashboard"},{title:"Administración",href:"#"},{title:"Cuadros de Clasificación Documental",href:"/admin/ccd"}],children:[e.jsx(q,{title:"Cuadros de Clasificación Documental"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-6 w-6 text-[#2a3d83]"}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Gestión de Cuadros de Clasificación Documental"})]}),e.jsxs(G,{open:V,onOpenChange:j,children:[e.jsx(R,{asChild:!0,children:e.jsxs(u,{className:"flex items-center gap-2 px-4 py-2 bg-[#2a3d83] text-white rounded-lg hover:bg-[#1e2b5f] transition-colors",children:[e.jsx(Y,{className:"h-4 w-4"}),"Nuevo CCD"]})}),e.jsxs(K,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(U,{children:[e.jsx(W,{className:"text-xl font-semibold text-gray-900",children:"Crear Nuevo Cuadro de Clasificación Documental"}),e.jsx(z,{className:"text-sm text-gray-600",children:"Complete los siguientes datos para crear un nuevo CCD."})]}),e.jsxs("form",{onSubmit:s=>{if(s.preventDefault(),!i.codigo||!i.nombre){S.error("Por favor complete los campos requeridos");return}N.create("/admin/ccd",i,{successMessage:"CCD creado exitosamente",onSuccess:()=>{j(!1),C()},onError:r=>{console.error("Error al crear CCD:",r),r&&Object.keys(r).forEach(d=>{const v=Array.isArray(r[d])?r[d][0]:r[d];S.error(`Error en ${d}: ${v}`)})}})},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-codigo",children:"Código *"}),e.jsx(m,{id:"create-codigo",type:"text",value:i.codigo,onChange:s=>o("codigo",s.target.value),placeholder:"Ej: CCD-001",required:!0,className:a.codigo?"border-red-500":""}),a.codigo&&e.jsx("p",{className:"text-sm text-red-600",children:a.codigo})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-version",children:"Versión"}),e.jsx(m,{id:"create-version",type:"text",value:i.version,onChange:s=>o("version",s.target.value),placeholder:"Ej: 1.0",className:a.version?"border-red-500":""}),a.version&&e.jsx("p",{className:"text-sm text-red-600",children:a.version})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-nombre",children:"Nombre *"}),e.jsx(m,{id:"create-nombre",type:"text",value:i.nombre,onChange:s=>o("nombre",s.target.value),placeholder:"Nombre del CCD",required:!0,className:a.nombre?"border-red-500":""}),a.nombre&&e.jsx("p",{className:"text-sm text-red-600",children:a.nombre})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-descripcion",children:"Descripción"}),e.jsx(J,{id:"create-descripcion",value:i.descripcion,onChange:s=>o("descripcion",s.target.value),placeholder:"Descripción del CCD",rows:3,className:a.descripcion?"border-red-500":""}),a.descripcion&&e.jsx("p",{className:"text-sm text-red-600",children:a.descripcion})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-fecha-vigencia-inicio",children:"Fecha Vigencia Inicio"}),e.jsx(m,{id:"create-fecha-vigencia-inicio",type:"date",value:i.fecha_vigencia_inicio,onChange:s=>o("fecha_vigencia_inicio",s.target.value),className:a.fecha_vigencia_inicio?"border-red-500":""}),a.fecha_vigencia_inicio&&e.jsx("p",{className:"text-sm text-red-600",children:a.fecha_vigencia_inicio})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-fecha-vigencia-fin",children:"Fecha Vigencia Fin"}),e.jsx(m,{id:"create-fecha-vigencia-fin",type:"date",value:i.fecha_vigencia_fin,onChange:s=>o("fecha_vigencia_fin",s.target.value),className:a.fecha_vigencia_fin?"border-red-500":""}),a.fecha_vigencia_fin&&e.jsx("p",{className:"text-sm text-red-600",children:a.fecha_vigencia_fin})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-estado",children:"Estado *"}),e.jsxs(E,{value:i.estado,onValueChange:s=>o("estado",s),children:[e.jsx($,{className:a.estado?"border-red-500":"",children:e.jsx(F,{placeholder:"Seleccionar estado"})}),e.jsx(T,{children:k.estados.map(s=>e.jsx(x,{value:s.value,children:s.label},s.value))})]}),a.estado&&e.jsx("p",{className:"text-sm text-red-600",children:a.estado})]}),e.jsxs(Q,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>{j(!1),C()},children:"Cancelar"}),e.jsxs(u,{type:"submit",disabled:y,className:"bg-[#2a3d83] hover:bg-[#1e2b5f] flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4"}),y?"Guardando...":"Crear CCD"]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total CCDs"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:p?.total||0})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(_,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Activos"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:p?.activos||0})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(ee,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Borradores"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:p?.borradores||0})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(se,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Vigentes"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:p?.vigentes||0})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(ae,{className:"h-6 w-6 text-[#2a3d83]"})})]})})]}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4 w-full sm:w-auto",children:e.jsxs("div",{className:"relative flex-1 sm:w-80",children:[e.jsx(A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(m,{type:"text",placeholder:"Buscar CCDs...",value:l,onChange:s=>I(s.target.value),onKeyPress:s=>{s.key==="Enter"&&(s.preventDefault(),D())},className:"pl-10"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(E,{value:c,onValueChange:H,children:[e.jsx($,{className:"w-[180px]",children:e.jsx(F,{placeholder:"Todos los estados"})}),e.jsxs(T,{children:[e.jsx(x,{value:"all",children:"Todos los estados"}),e.jsx(x,{value:"borrador",children:"Borrador"}),e.jsx(x,{value:"activo",children:"Activo"}),e.jsx(x,{value:"inactivo",children:"Inactivo"}),e.jsx(x,{value:"historico",children:"Histórico"})]})]}),e.jsxs(u,{onClick:D,type:"button",className:"bg-[#2a3d83] hover:bg-[#1e2b5f]",children:[e.jsx(A,{className:"mr-2 h-4 w-4"}),"Buscar"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Código"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Nombre"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Estado"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Niveles"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Creado"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Acciones"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:t.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-8 px-6 text-center text-gray-500",children:"No se encontraron CCDs."})}):t.data.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"py-4 px-6 font-medium text-gray-900",children:s.codigo}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.nombre}),s.descripcion&&e.jsx("div",{className:"text-sm text-gray-500",children:s.descripcion})]})}),e.jsx("td",{className:"py-4 px-6",children:L(s.estado)}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-[#2a3d83]",children:[s.niveles_count||0," niveles"]})}),e.jsx("td",{className:"py-4 px-6 text-gray-600",children:new Date(s.created_at).toLocaleDateString("es-ES")}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{href:`/admin/ccd/${s.id}`,children:e.jsx("button",{className:"p-2 rounded-md text-[#2a3d83] hover:text-[#1e2b5f] hover:bg-blue-50 transition-colors",children:e.jsx(re,{className:"h-4 w-4"})})}),e.jsx(g,{href:`/admin/ccd/${s.id}/edit`,children:e.jsx("button",{className:"p-2 rounded-md text-[#2a3d83] hover:text-[#1e2b5f] hover:bg-blue-50 transition-colors",children:e.jsx(te,{className:"h-4 w-4"})})}),e.jsx("button",{onClick:()=>{const r=s.niveles_count||0,d=r>0?`

⚠️ ADVERTENCIA: Este CCD tiene ${r} nivel(es) asociado(s) que también serán eliminados.`:"",v=s.estado!=="borrador"?`

⚠️ Este CCD está en estado "${s.estado}". Se recomienda solo eliminar CCDs en borrador.`:"";N.destroy(`/admin/ccd/${s.id}`,{confirmMessage:`¿Está seguro de eliminar el CCD "${s.nombre}"?${d}${v}

Esta acción NO se puede deshacer.`,successMessage:r>0?`CCD y ${r} nivel(es) eliminados exitosamente`:"CCD eliminado exitosamente",errorMessage:"Error al eliminar el CCD"})},className:"p-2 rounded-md text-red-600 hover:text-red-700 hover:bg-red-50 transition-colors",title:"Eliminar CCD",children:e.jsx(ie,{className:"h-4 w-4"})})]})})]},s.id))})]})})}),t.data.length>0&&t.last_page>1&&e.jsxs("div",{className:"flex items-center justify-between bg-white border rounded-lg px-6 py-3",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",e.jsx("span",{className:"font-medium",children:(t.current_page-1)*t.per_page+1})," a"," ",e.jsx("span",{className:"font-medium",children:Math.min(t.current_page*t.per_page,t.total)})," de"," ",e.jsx("span",{className:"font-medium",children:t.total})," resultados"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.current_page>1&&e.jsx(g,{href:`/admin/ccd?page=${t.current_page-1}${l?`&search=${l}`:""}${c!=="all"?`&estado=${c}`:""}`,preserveState:!0,className:"px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Anterior"}),t.current_page<t.last_page&&e.jsx(g,{href:`/admin/ccd?page=${t.current_page+1}${l?`&search=${l}`:""}${c!=="all"?`&estado=${c}`:""}`,preserveState:!0,className:"px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Siguiente"})]})]})]})]})}export{Oe as default};
