import{r as o,u as J,b as P,j as e,H as Q,L as u}from"./app-b0OUUI0-.js";import{A as W}from"./app-layout-DeKj2h8p.js";import{B as h}from"./button-C5SprtSp.js";import{I as F}from"./input-DYsvI7DM.js";import{L as d}from"./label-Act4V2dc.js";import{x as I,D as X,f as Y,a as Z,b as k,c as ee,d as se,T as ae,e as te,t as p}from"./app-sidebar-layout-Du_H8so0.js";import{S as j,a as g,b,c as f,d as n}from"./select-B36fdiZM.js";import{P as re}from"./plus-D85iiy3h.js";import{S as le}from"./save-zCHdMJjT.js";import{C as ie}from"./circle-check-big-BLkQVwGt.js";import{C as ce}from"./circle-alert-ZRTqCItd.js";import{U as M}from"./user-DxpkJXtI.js";import{S as ne}from"./search-C0-Sn5Ut.js";import{F as oe}from"./folder-open-UxlWLN6_.js";import{E as de}from"./eye-C0N4siKW.js";import{S as me}from"./square-pen-BYbL1gsB.js";import{C as xe}from"./copy-DO8a91A5.js";/* empty css            */import"./index-BEDrMoE5.js";import"./index-SQVXAgCN.js";import"./Combination-CoTaGX-7.js";import"./index-BonhS1CM.js";import"./x-DHJy9qDa.js";import"./index-DgUGDSx5.js";import"./app-logo-icon-cBcTQda_.js";import"./mail-B-2VlNI7.js";import"./users-CU3ZcRQu.js";import"./folder-BN9jgz4i.js";import"./triangle-alert-DqEyKMhr.js";import"./index-gpDvmhMg.js";import"./check-Dr0AtvV6.js";const ue=t=>({borrador:"bg-gray-100 text-gray-800",revision:"bg-yellow-100 text-yellow-800",activa:"bg-green-100 text-green-800",archivada:"bg-blue-100 text-blue-800",obsoleta:"bg-red-100 text-red-800"})[t]||"bg-gray-100 text-gray-800",E=t=>({memorando:"",oficio:"",resolucion:"锔",acta:"",informe:"",circular:"",comunicacion:"",otro:""})[t]||"";function Ue({plantillas:t,estadisticas:m,series:T,filtros:S,categorias:_,estados:L}){const $={total:0,activas:0,borradores:0,publicas:0,por_categoria:{},mas_usadas:[]},N=m&&typeof m=="object"?{...$,...m}:$,[v,A]=o.useState(S),[x,O]=o.useState(S.buscar||""),[H,C]=o.useState(!1),[D,y]=o.useState(null),V=o.useRef(!0),{data:i,setData:c,post:z,processing:q,errors:r,reset:B}=J({nombre:"",descripcion:"",categoria:"otro",tipo_documento:"",serie_documental_id:"",subserie_documental_id:"",contenido_html:"",es_publica:!1});o.useEffect(()=>{if(V.current){V.current=!1;return}if(x===(S.buscar||""))return;const s=setTimeout(()=>{w("buscar",x)},500);return()=>clearTimeout(s)},[x]);const w=(s,a)=>{const l={...v};l[s]=a,(!a||a==="all")&&delete l[s],A(l),P.get("/admin/plantillas",l,{preserveState:!0,preserveScroll:!0})},G=()=>{A({}),O(""),P.get("/admin/plantillas")},R=s=>{P.post(`/admin/plantillas/${s}/duplicar`,{},{onSuccess:()=>{}})},U=s=>{const a=T.find(l=>l.id.toString()===s);y(a||null),c("serie_documental_id",s),c("subserie_documental_id","")};return e.jsxs(W,{breadcrumbs:[{title:"Dashboard",href:"/dashboard"},{title:"Administraci贸n",href:"#"},{title:"Plantillas Documentales",href:"/admin/plantillas"}],children:[e.jsx(Q,{title:"Plantillas Documentales"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-6 w-6 text-[#2a3d83]"}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Gesti贸n de Plantillas Documentales"})]}),e.jsxs(X,{open:H,onOpenChange:C,children:[e.jsx(Y,{asChild:!0,children:e.jsxs(h,{className:"flex items-center gap-2 px-4 py-2 bg-[#2a3d83] text-white rounded-lg hover:bg-[#1e2b5f] transition-colors",children:[e.jsx(re,{className:"h-4 w-4"}),"Nueva Plantilla"]})}),e.jsxs(Z,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(k,{children:[e.jsx(ee,{className:"text-xl font-semibold text-gray-900",children:"Crear Nueva Plantilla Documental"}),e.jsx(se,{className:"text-sm text-gray-600",children:"Complete los siguientes datos para crear una nueva plantilla."})]}),e.jsxs("form",{onSubmit:s=>{if(s.preventDefault(),!i.nombre||!i.categoria){p.error("Por favor complete los campos requeridos");return}z("/admin/plantillas",{onStart:()=>{},onProgress:()=>{},onSuccess:()=>{C(!1),B(),y(null),p.success("Plantilla creada exitosamente")},onError:a=>{a?typeof a=="object"?Object.keys(a).forEach(l=>{const K=Array.isArray(a[l])?a[l][0]:a[l];p.error(`Error en ${l}: ${K}`)}):p.error(`Error: ${a}`):p.error("Error al crear la plantilla. Por favor, verifique su conexi贸n e intente nuevamente.")},onFinish:()=>{},preserveState:!1,preserveScroll:!1,only:[]})},className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"create-nombre",children:"Nombre de la Plantilla *"}),e.jsx(F,{id:"create-nombre",value:i.nombre,onChange:s=>c("nombre",s.target.value),placeholder:"Ej: Memorando Interno",required:!0,className:r.nombre?"border-red-500":""}),r.nombre&&e.jsx("p",{className:"text-sm text-red-600",children:r.nombre})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"create-categoria",children:"Categor铆a *"}),e.jsxs(j,{value:i.categoria,onValueChange:s=>c("categoria",s),children:[e.jsx(g,{className:r.categoria?"border-red-500":"",children:e.jsx(b,{placeholder:"Seleccionar categor铆a"})}),e.jsx(f,{children:Object.entries(_).map(([s,a])=>e.jsxs(n,{value:s,children:[E(s)," ",a]},s))})]}),r.categoria&&e.jsx("p",{className:"text-sm text-red-600",children:r.categoria})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"create-tipo-documento",children:"Tipo de Documento"}),e.jsx(F,{id:"create-tipo-documento",value:i.tipo_documento,onChange:s=>c("tipo_documento",s.target.value),placeholder:"Ej: Memorando interno",className:r.tipo_documento?"border-red-500":""}),r.tipo_documento&&e.jsx("p",{className:"text-sm text-red-600",children:r.tipo_documento})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"create-descripcion",children:"Descripci贸n"}),e.jsx(ae,{id:"create-descripcion",value:i.descripcion,onChange:s=>c("descripcion",s.target.value),placeholder:"Descripci贸n de la plantilla",rows:3,className:r.descripcion?"border-red-500":""}),r.descripcion&&e.jsx("p",{className:"text-sm text-red-600",children:r.descripcion})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Serie Documental"}),e.jsxs(j,{onValueChange:U,value:i.serie_documental_id||"",children:[e.jsx(g,{children:e.jsx(b,{placeholder:"Seleccionar serie"})}),e.jsx(f,{children:T.map(s=>e.jsxs(n,{value:s.id.toString(),children:[s.codigo," - ",s.nombre]},s.id))})]})]}),D?.subseries&&D.subseries.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Subserie Documental"}),e.jsxs(j,{value:i.subserie_documental_id||"",onValueChange:s=>c("subserie_documental_id",s),children:[e.jsx(g,{children:e.jsx(b,{placeholder:"Seleccionar subserie"})}),e.jsx(f,{children:D.subseries.map(s=>e.jsxs(n,{value:s.id.toString(),children:[s.codigo," - ",s.nombre]},s.id))})]})]})]}),(i.serie_documental_id||i.subserie_documental_id)&&e.jsx("div",{className:"flex items-center justify-end",children:e.jsx(h,{type:"button",variant:"ghost",size:"sm",onClick:()=>{c("serie_documental_id",null),c("subserie_documental_id",null),y(null)},className:"text-xs",children:"Limpiar selecci贸n"})}),e.jsxs(te,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>{C(!1),B(),y(null)},children:"Cancelar"}),e.jsxs(h,{type:"submit",disabled:q,className:"bg-[#2a3d83] hover:bg-[#1e2b5f] flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4"}),q?"Guardando...":"Crear Plantilla"]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Plantillas"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:N.total})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(I,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Activas"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:N.activas})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(ie,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Borradores"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:N.borradores})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(ce,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"P煤blicas"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:N.publicas})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(M,{className:"h-6 w-6 text-[#2a3d83]"})})]})})]}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4 w-full sm:w-auto",children:e.jsxs("div",{className:"relative flex-1 sm:w-80",children:[e.jsx(ne,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(F,{placeholder:"Buscar plantillas...",value:x,onChange:s=>O(s.target.value),onKeyPress:s=>{s.key==="Enter"&&(s.preventDefault(),w("buscar",x))},className:"pl-10"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(j,{value:v.categoria||"all",onValueChange:s=>w("categoria",s),children:[e.jsx(g,{className:"w-[180px]",children:e.jsx(b,{placeholder:"Todas las categor铆as"})}),e.jsxs(f,{children:[e.jsx(n,{value:"all",children:"Todas las categor铆as"}),Object.entries(_).map(([s,a])=>e.jsxs(n,{value:s,children:[E(s)," ",a]},s))]})]}),e.jsxs(j,{value:v.estado||"all",onValueChange:s=>w("estado",s),children:[e.jsx(g,{className:"w-[180px]",children:e.jsx(b,{placeholder:"Todos los estados"})}),e.jsxs(f,{children:[e.jsx(n,{value:"all",children:"Todos los estados"}),Object.entries(L).map(([s,a])=>e.jsx(n,{value:s,children:a},s))]})]}),Object.keys(v).length>0&&e.jsx(h,{variant:"outline",onClick:G,children:"Limpiar"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Plantilla"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Categor铆a"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Estado"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Serie"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Creador"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Versi贸n"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Fecha"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Acciones"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:t.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"py-8 px-6 text-center text-gray-500",children:"No se encontraron plantillas."})}):t.data.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s.nombre}),s.es_publica&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-[#2a3d83]",children:"P煤blica"})]}),e.jsx("div",{className:"text-sm text-gray-500",children:s.codigo}),s.descripcion&&e.jsx("div",{className:"text-sm text-gray-400 max-w-xs truncate",children:s.descripcion})]})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:E(s.categoria)}),e.jsx("span",{className:"capitalize text-gray-900",children:_[s.categoria]})]})}),e.jsx("td",{className:"py-4 px-6",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${ue(s.estado)}`,children:L[s.estado]})}),e.jsx("td",{className:"py-4 px-6",children:s.serie_documental?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(oe,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.serie_documental.codigo})]}):e.jsx("span",{className:"text-gray-400 text-sm",children:"Sin serie"})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(M,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.usuario_creador.name})]})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-[#2a3d83]",children:["v",s.version]})}),e.jsx("td",{className:"py-4 px-6 text-sm text-gray-600",children:new Date(s.created_at).toLocaleDateString("es-ES")}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{href:`/admin/plantillas/${s.id}`,children:e.jsx("button",{className:"p-2 rounded-md text-[#2a3d83] hover:text-[#1e2b5f] hover:bg-blue-50 transition-colors",children:e.jsx(de,{className:"h-4 w-4"})})}),e.jsx(u,{href:`/admin/plantillas/${s.id}/edit`,children:e.jsx("button",{className:"p-2 rounded-md text-[#2a3d83] hover:text-[#1e2b5f] hover:bg-blue-50 transition-colors",children:e.jsx(me,{className:"h-4 w-4"})})}),e.jsx("button",{className:"p-2 rounded-md text-[#2a3d83] hover:text-[#1e2b5f] hover:bg-blue-50 transition-colors",onClick:()=>R(s.id),children:e.jsx(xe,{className:"h-4 w-4"})})]})})]},s.id))})]})})}),t.data.length>0&&t.links&&t.links.length>3&&e.jsxs("div",{className:"flex items-center justify-between bg-white border rounded-lg px-6 py-3",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",e.jsx("span",{className:"font-medium",children:t?.meta?.from||0})," a"," ",e.jsx("span",{className:"font-medium",children:t?.meta?.to||0})," de"," ",e.jsx("span",{className:"font-medium",children:t?.meta?.total||0})," resultados"]}),e.jsx("div",{className:"flex items-center gap-2",children:t.links.map((s,a)=>s.label.includes("Previous")?e.jsx(u,{href:s.url||"#",preserveState:!0,className:`px-3 py-2 border border-gray-300 rounded-md text-sm font-medium ${s.url?"text-gray-700 hover:bg-gray-50":"text-gray-300 cursor-not-allowed"}`,children:"Anterior"},a):s.label.includes("Next")?e.jsx(u,{href:s.url||"#",preserveState:!0,className:`px-3 py-2 border border-gray-300 rounded-md text-sm font-medium ${s.url?"text-gray-700 hover:bg-gray-50":"text-gray-300 cursor-not-allowed"}`,children:"Siguiente"},a):isNaN(Number(s.label))?null:e.jsx(u,{href:s.url||"#",preserveState:!0,className:`px-3 py-2 rounded-md text-sm font-medium ${s.active?"bg-[#2a3d83] text-white":"border border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:s.label},a))})]})]})]})}export{Ue as default};
