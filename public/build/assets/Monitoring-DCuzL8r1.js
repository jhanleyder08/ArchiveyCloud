import{r as h,j as e,H as R}from"./app-xP5nJVeF.js";import{f as D,h as q}from"./app-sidebar-layout-Bv9w89yC.js";import{C as a,a as r,b as i,c as l}from"./card-CWOinnut.js";import{B as F}from"./Combination-BMQq9fx8.js";import{B as $}from"./button-B_iUXIQd.js";import{T as z,a as U,b as j,c as p}from"./tabs-BrUZeGY9.js";import{P as O}from"./progress-C1Nx9Qlm.js";import{R as G}from"./refresh-cw-Fn0W1b7X.js";import{M as I}from"./memory-stick-cnsYaWGH.js";import{C as V}from"./folder-Ck8Tq3sH.js";import{S as A}from"./server-B83h-4H3.js";import{A as X}from"./activity-DoFW7coy.js";import{T as x}from"./triangle-alert-3Hg381hi.js";import{C as M}from"./circle-check-big-C9Zhhz8Y.js";import{R as N,T as y}from"./CategoricalChart-vZpRXHuR.js";import{L as Y}from"./LineChart-BJexv942.js";import{C as v,X as b,Y as w}from"./CartesianChart-B-QfuPcu.js";import{L as W}from"./Legend-CBeq5rmt.js";import{L}from"./Line-C4zZw3db.js";import{A as Z,a as J}from"./AreaChart-4tFcKnk-.js";import{B as Q,a as ee}from"./BarChart-hHASEXod.js";import{C as se}from"./circle-x-mSiP6KhD.js";/* empty css            */import"./index-DbDMva29.js";import"./index-D2eHBSbe.js";import"./index-Blg4NNxt.js";import"./x-CBQbsaML.js";import"./app-logo-icon-8EdVYcX9.js";import"./input-DQqwP0kM.js";import"./label-CXywCScm.js";import"./user-OU0Y1c1r.js";import"./mail-C5oL3AE1.js";import"./users-DpyCPIO9.js";import"./search-eio2uEn4.js";import"./BrandingProvider-BV5yFGOU.js";import"./tooltipContext-CkO12thj.js";import"./ActivePoints-DfhVOaML.js";function qe({healthChecks:B,performanceMetrics:k,systemInfo:n}){const[_,C]=h.useState(!1),[t,P]=h.useState(k),[d,H]=h.useState(B);h.useEffect(()=>{const s=setInterval(()=>{S()},1e4);return()=>clearInterval(s)},[]);const S=async()=>{C(!0);try{const s=await fetch(route("admin.optimizacion.system-status"));if(s.ok){const c=await s.json();P(c.performance_metrics),H(c.health_status.checks)}}catch(s){console.error("Error refreshing metrics:",s)}finally{C(!1)}},o=s=>{const c=["B","KB","MB","GB"];let f=s,g=0;for(;f>=1024&&g<c.length-1;)f/=1024,g++;return`${f.toFixed(2)} ${c[g]}`},u=s=>s<1?`${(s*1e3).toFixed(2)}ms`:`${s.toFixed(3)}s`,m=()=>t.memory_used/t.memory_limit*100,E=s=>{switch(s.toLowerCase()){case"ok":case"healthy":return e.jsx(M,{className:"h-4 w-4 text-green-600"});case"warning":return e.jsx(x,{className:"h-4 w-4 text-yellow-600"});case"error":case"failed":return e.jsx(se,{className:"h-4 w-4 text-red-600"});default:return e.jsx(x,{className:"h-4 w-4 text-gray-600"})}},T=[{time:"00:00",memory:45,cpu:23,response_time:120},{time:"00:05",memory:52,cpu:28,response_time:140},{time:"00:10",memory:48,cpu:31,response_time:135},{time:"00:15",memory:60,cpu:42,response_time:180},{time:"00:20",memory:55,cpu:38,response_time:150},{time:"00:25",memory:58,cpu:45,response_time:165}],K=d.map(s=>({name:s.name,status:s.status==="ok"?100:0,response_time:s.response_time||0}));return e.jsxs(D,{children:[e.jsx(R,{title:"Monitoreo del Sistema"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Monitoreo del Sistema"}),e.jsxs($,{onClick:S,variant:"outline",size:"sm",disabled:_,className:"flex items-center gap-2",children:[e.jsx(G,{className:`h-4 w-4 ${_?"animate-spin":""}`}),"Actualizar"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(a,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Uso de Memoria"}),e.jsx(I,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[m().toFixed(1),"%"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[o(t.memory_used)," / ",o(t.memory_limit)]}),e.jsx(O,{value:m(),className:"mt-2"})]})]}),e.jsxs(a,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Tiempo de Ejecución"}),e.jsx(V,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold",children:u(t.execution_time)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Tiempo actual de respuesta"})]})]}),e.jsxs(a,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Consultas BD"}),e.jsx(q,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.database_queries}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Consultas ejecutadas"})]})]}),e.jsxs(a,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Archivos Incluidos"}),e.jsx(A,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.included_files}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Archivos PHP cargados"})]})]})]}),e.jsxs(z,{defaultValue:"health",className:"space-y-6",children:[e.jsxs(U,{className:"grid w-full grid-cols-4",children:[e.jsx(j,{value:"health",children:"Health Checks"}),e.jsx(j,{value:"performance",children:"Performance"}),e.jsx(j,{value:"system",children:"Información del Sistema"}),e.jsx(j,{value:"charts",children:"Gráficos"})]}),e.jsx(p,{value:"health",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(a,{children:[e.jsx(r,{children:e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5"}),"Estado de Servicios"]})}),e.jsxs(l,{className:"space-y-3",children:[d.map((s,c)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[E(s.status),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),s.message&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.message}),s.response_time&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Tiempo: ",s.response_time,"ms"]})]})]}),e.jsx(F,{variant:s.status==="ok"?"default":"destructive",children:s.status})]},c)),d.length===0&&e.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No hay health checks disponibles"})]})]}),e.jsxs(a,{children:[e.jsx(r,{children:e.jsx(i,{children:"Resumen de Salud"})}),e.jsx(l,{children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-3 border rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:d.filter(s=>s.status==="ok").length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Saludables"})]}),e.jsxs("div",{className:"text-center p-3 border rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:d.filter(s=>s.status==="warning").length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Advertencias"})]}),e.jsxs("div",{className:"text-center p-3 border rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:d.filter(s=>s.status==="error"||s.status==="failed").length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Errores"})]})]})})})]})]})}),e.jsx(p,{value:"performance",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(a,{children:[e.jsx(r,{children:e.jsx(i,{children:"Métricas Detalladas"})}),e.jsx(l,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Memoria Usada:"}),e.jsx("span",{className:"font-mono text-sm",children:o(t.memory_used)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Pico de Memoria:"}),e.jsx("span",{className:"font-mono text-sm",children:o(t.memory_peak)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Límite de Memoria:"}),e.jsx("span",{className:"font-mono text-sm",children:o(t.memory_limit)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Tiempo de Ejecución:"}),e.jsx("span",{className:"font-mono text-sm",children:u(t.execution_time)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Archivos Incluidos:"}),e.jsx("span",{className:"font-mono text-sm",children:t.included_files.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Consultas BD:"}),e.jsx("span",{className:"font-mono text-sm",children:t.database_queries.toLocaleString()})]})]})})]}),e.jsxs(a,{children:[e.jsx(r,{children:e.jsx(i,{children:"Alertas de Performance"})}),e.jsxs(l,{className:"space-y-3",children:[m()>80&&e.jsxs("div",{className:"flex items-center gap-2 p-3 border border-red-300 rounded-lg bg-red-50",children:[e.jsx(x,{className:"h-4 w-4 text-red-600"}),e.jsxs("span",{className:"text-sm text-red-600",children:["Uso de memoria alto (",m().toFixed(1),"%)"]})]}),t.execution_time>2&&e.jsxs("div",{className:"flex items-center gap-2 p-3 border border-yellow-300 rounded-lg bg-yellow-50",children:[e.jsx(x,{className:"h-4 w-4 text-yellow-600"}),e.jsxs("span",{className:"text-sm text-yellow-600",children:["Tiempo de respuesta lento (",u(t.execution_time),")"]})]}),t.database_queries>50&&e.jsxs("div",{className:"flex items-center gap-2 p-3 border border-yellow-300 rounded-lg bg-yellow-50",children:[e.jsx(x,{className:"h-4 w-4 text-yellow-600"}),e.jsxs("span",{className:"text-sm text-yellow-600",children:["Muchas consultas BD (",t.database_queries,")"]})]}),m()<=80&&t.execution_time<=2&&t.database_queries<=50&&e.jsxs("div",{className:"flex items-center gap-2 p-3 border border-green-300 rounded-lg bg-green-50",children:[e.jsx(M,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm text-green-600",children:"Sistema funcionando óptimamente"})]})]})]})]})}),e.jsx(p,{value:"system",className:"space-y-4",children:e.jsxs(a,{children:[e.jsx(r,{children:e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5"}),"Información del Sistema"]})}),e.jsx(l,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Versión PHP:"}),e.jsx("span",{className:"font-mono",children:n.php_version})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Versión Laravel:"}),e.jsx("span",{className:"font-mono",children:n.laravel_version})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Sistema Operativo:"}),e.jsx("span",{className:"font-mono",children:n.os})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Arquitectura:"}),e.jsx("span",{className:"font-mono",children:n.architecture})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Servidor Web:"}),e.jsx("span",{className:"font-mono text-sm",children:n.server_software})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Zona Horaria:"}),e.jsx("span",{className:"font-mono",children:n.timezone})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Idioma:"}),e.jsx("span",{className:"font-mono",children:n.locale})]})]})]})})]})}),e.jsxs(p,{value:"charts",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(a,{children:[e.jsx(r,{children:e.jsx(i,{children:"Historial de Performance"})}),e.jsx(l,{children:e.jsx(N,{width:"100%",height:300,children:e.jsxs(Y,{data:T,children:[e.jsx(v,{strokeDasharray:"3 3"}),e.jsx(b,{dataKey:"time"}),e.jsx(w,{}),e.jsx(y,{}),e.jsx(W,{}),e.jsx(L,{type:"monotone",dataKey:"memory",stroke:"#3b82f6",name:"Memoria %"}),e.jsx(L,{type:"monotone",dataKey:"cpu",stroke:"#ef4444",name:"CPU %"})]})})})]}),e.jsxs(a,{children:[e.jsx(r,{children:e.jsx(i,{children:"Tiempo de Respuesta"})}),e.jsx(l,{children:e.jsx(N,{width:"100%",height:300,children:e.jsxs(Z,{data:T,children:[e.jsx(v,{strokeDasharray:"3 3"}),e.jsx(b,{dataKey:"time"}),e.jsx(w,{}),e.jsx(y,{formatter:s=>[`${s}ms`,"Tiempo de Respuesta"]}),e.jsx(J,{type:"monotone",dataKey:"response_time",stroke:"#10b981",fill:"#10b981",fillOpacity:.3})]})})})]})]}),e.jsxs(a,{children:[e.jsx(r,{children:e.jsx(i,{children:"Estado de Health Checks"})}),e.jsx(l,{children:e.jsx(N,{width:"100%",height:300,children:e.jsxs(Q,{data:K,children:[e.jsx(v,{strokeDasharray:"3 3"}),e.jsx(b,{dataKey:"name",angle:-45,textAnchor:"end",height:100}),e.jsx(w,{}),e.jsx(y,{formatter:s=>[s===100?"OK":"FALLO","Estado"]}),e.jsx(ee,{dataKey:"status",fill:"#10b981"})]})})})]})]})]})]})})]})}export{qe as default};
