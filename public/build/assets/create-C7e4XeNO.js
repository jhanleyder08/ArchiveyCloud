import{r as g,u as U,j as e,H as B,a as F}from"./app-BeC48sE8.js";import{A as q}from"./app-layout-DeIgiXKt.js";import{c as O,B as N}from"./app-logo-icon-DygIE2aX.js";import{L as l,I as m}from"./label-BAQntzi8.js";import{T as w,X as G,t as R}from"./app-sidebar-layout-B6kWAPVN.js";import{S as h,a as p,b as u,c as j,d as n}from"./select-BIll6NvB.js";import{C as c,a as t,b as o,c as x}from"./card-BdaZ1N_g.js";import{A as K,a as X}from"./alert-RTLkFc0E.js";import{A as Z}from"./arrow-left-B23dOVWI.js";import{I as z}from"./info-B88Pq4AG.js";import{S as J}from"./save-Cm3i1Bhv.js";/* empty css            */import"./index-BynCgBR_.js";import"./index-BtdR61Tu.js";import"./index-DnPRtIrm.js";import"./check-DhgVWmR5.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],W=O("FolderPlus",Q);function ue({opciones:d}){const[C,A]=g.useState(!1),[b,I]=g.useState([]),[_,D]=g.useState(""),[f,k]=g.useState([]),{data:a,setData:r,post:V,processing:S,errors:i,reset:Y}=U({nombre:"",descripcion:"",serie_id:"",subserie_id:"",trd_id:"",tipo_expediente:"electronico",confidencialidad:"interna",usuario_responsable_id:"",area_responsable:"",volumen_maximo:1024,ubicacion_fisica:"",ubicacion_digital:"",palabras_clave:[],acceso_publico:!1,observaciones:""}),T=[{title:"Inicio",href:"/dashboard"},{title:"Administración",href:"/admin"},{title:"Expedientes",href:"/admin/expedientes"},{title:"Crear Expediente",href:"/admin/expedientes/create"}];g.useEffect(()=>{if(a.serie_id){const s=d.subseries.filter(v=>v.serie_id===parseInt(a.serie_id));k(s)}else k([]),r("subserie_id","")},[a.serie_id]);const L=s=>{s.preventDefault(),A(!0),V("/admin/expedientes",{onSuccess:()=>{R.success("Expediente creado exitosamente"),F.visit("/admin/expedientes")},onError:v=>{R.error("Error al crear el expediente. Revisa los campos marcados.")},onFinish:()=>{A(!1)}})},P=()=>{if(_.trim()&&!b.includes(_.trim())){const s=[...b,_.trim()];I(s),r("palabras_clave",s),D("")}},H=s=>{const v=b.filter(M=>M!==s);I(v),r("palabras_clave",v)},y=d.series.find(s=>s.id===parseInt(a.serie_id)),E=f.find(s=>s.id===parseInt(a.subserie_id));return e.jsxs(q,{breadcrumbs:T,children:[e.jsx(B,{title:"Crear Expediente"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(W,{className:"h-6 w-6 text-[#2a3d83]"}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Crear Expediente Electrónico"})]}),e.jsxs(N,{type:"button",variant:"outline",onClick:()=>F.visit("/admin/expedientes"),className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4"}),"Volver"]})]}),e.jsxs(K,{children:[e.jsx(z,{className:"h-4 w-4"}),e.jsx(X,{children:"Un expediente electrónico agrupa documentos relacionados siguiendo la estructura archivística de series y subseries documentales definidas en las TRD."})]}),e.jsxs("form",{onSubmit:L,className:"space-y-6",children:[e.jsxs(c,{children:[e.jsx(t,{children:e.jsx(o,{children:"Información Básica"})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"nombre",children:"Nombre del Expediente *"}),e.jsx(m,{id:"nombre",type:"text",value:a.nombre,onChange:s=>r("nombre",s.target.value),placeholder:"Nombre descriptivo del expediente",className:i.nombre?"border-red-500":"",required:!0}),i.nombre&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:i.nombre})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"descripcion",children:"Descripción"}),e.jsx(w,{id:"descripcion",value:a.descripcion,onChange:s=>r("descripcion",s.target.value),placeholder:"Descripción detallada del expediente",rows:3,className:i.descripcion?"border-red-500":""}),i.descripcion&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:i.descripcion})]})]})]}),e.jsxs(c,{children:[e.jsx(t,{children:e.jsx(o,{children:"Clasificación Archivística"})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"serie_id",children:"Serie Documental *"}),e.jsxs(h,{value:a.serie_id,onValueChange:s=>{r("serie_id",s),r("subserie_id","")},children:[e.jsx(p,{id:"serie_id",className:i.serie_id?"border-red-500":"",children:e.jsx(u,{placeholder:"Seleccionar serie"})}),e.jsx(j,{children:d.series.map(s=>e.jsxs(n,{value:s.id.toString(),children:[s.codigo," - ",s.nombre]},s.id))})]}),i.serie_id&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:i.serie_id})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"subserie_id",children:"Subserie Documental"}),e.jsxs(h,{value:a.subserie_id,onValueChange:s=>r("subserie_id",s),disabled:!a.serie_id||f.length===0,children:[e.jsx(p,{id:"subserie_id",className:i.subserie_id?"border-red-500":"",children:e.jsx(u,{placeholder:a.serie_id?f.length===0?"No hay subseries disponibles":"Seleccionar subserie (opcional)":"Primero selecciona una serie"})}),e.jsx(j,{children:f.map(s=>e.jsxs(n,{value:s.id.toString(),children:[s.codigo," - ",s.nombre]},s.id))})]}),i.subserie_id&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:i.subserie_id})]})]}),y&&e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Serie seleccionada:"})," ",y.codigo," - ",y.nombre,E&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("strong",{children:"Subserie seleccionada:"})," ",E.codigo," - ",E.nombre]})]})}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"trd_id",children:"Tabla de Retención Documental"}),e.jsxs(h,{value:a.trd_id,onValueChange:s=>r("trd_id",s),children:[e.jsx(p,{id:"trd_id",children:e.jsx(u,{placeholder:"Seleccionar TRD (opcional)"})}),e.jsxs(j,{children:[e.jsx(n,{value:"null",children:"Sin TRD específica"}),d.trds.map(s=>e.jsxs(n,{value:s.id.toString(),children:[s.codigo," v",s.version," - ",s.nombre]},s.id))]})]})]})]})]}),e.jsxs(c,{children:[e.jsx(t,{children:e.jsx(o,{children:"Configuración del Expediente"})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"tipo_expediente",children:"Tipo de Expediente *"}),e.jsxs(h,{value:a.tipo_expediente,onValueChange:s=>r("tipo_expediente",s),children:[e.jsx(p,{id:"tipo_expediente",className:i.tipo_expediente?"border-red-500":"",children:e.jsx(u,{})}),e.jsx(j,{children:d.tipos_expediente.map(s=>e.jsx(n,{value:s.value,children:s.label},s.value))})]}),i.tipo_expediente&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:i.tipo_expediente})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"confidencialidad",children:"Confidencialidad *"}),e.jsxs(h,{value:a.confidencialidad,onValueChange:s=>r("confidencialidad",s),children:[e.jsx(p,{id:"confidencialidad",className:i.confidencialidad?"border-red-500":"",children:e.jsx(u,{})}),e.jsx(j,{children:d.confidencialidad.map(s=>e.jsx(n,{value:s.value,children:s.label},s.value))})]}),i.confidencialidad&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:i.confidencialidad})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"volumen_maximo",children:"Volumen Máximo (MB)"}),e.jsx(m,{id:"volumen_maximo",type:"number",min:"1",value:a.volumen_maximo||"",onChange:s=>r("volumen_maximo",parseInt(s.target.value)||null),placeholder:"1024"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Límite de almacenamiento para todos los documentos del expediente"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{id:"acceso_publico",type:"checkbox",checked:a.acceso_publico,onChange:s=>r("acceso_publico",s.target.checked),className:"rounded border-gray-300"}),e.jsx(l,{htmlFor:"acceso_publico",children:"Permitir acceso público"})]})]})]}),e.jsxs(c,{children:[e.jsx(t,{children:e.jsx(o,{children:"Responsabilidad"})}),e.jsx(x,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"usuario_responsable_id",children:"Usuario Responsable *"}),e.jsxs(h,{value:a.usuario_responsable_id,onValueChange:s=>r("usuario_responsable_id",s),children:[e.jsx(p,{id:"usuario_responsable_id",className:i.usuario_responsable_id?"border-red-500":"",children:e.jsx(u,{placeholder:"Seleccionar responsable"})}),e.jsx(j,{children:d.usuarios.map(s=>e.jsxs(n,{value:s.id.toString(),children:[s.name," (",s.email,")"]},s.id))})]}),i.usuario_responsable_id&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:i.usuario_responsable_id})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"area_responsable",children:"Área Responsable *"}),e.jsx(m,{id:"area_responsable",type:"text",value:a.area_responsable,onChange:s=>r("area_responsable",s.target.value),placeholder:"Ej: Secretaría General, Recursos Humanos",className:i.area_responsable?"border-red-500":"",required:!0}),i.area_responsable&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:i.area_responsable})]})]})})]}),e.jsxs(c,{children:[e.jsx(t,{children:e.jsx(o,{children:"Ubicación"})}),e.jsx(x,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"ubicacion_fisica",children:"Ubicación Física"}),e.jsx(m,{id:"ubicacion_fisica",type:"text",value:a.ubicacion_fisica,onChange:s=>r("ubicacion_fisica",s.target.value),placeholder:"Ej: Archivo Central, Estante A-1"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"ubicacion_digital",children:"Ubicación Digital"}),e.jsx(m,{id:"ubicacion_digital",type:"text",value:a.ubicacion_digital,onChange:s=>r("ubicacion_digital",s.target.value),placeholder:"Ej: Servidor/carpeta/ruta"})]})]})})]}),e.jsxs(c,{children:[e.jsx(t,{children:e.jsx(o,{children:"Palabras Clave"})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{value:_,onChange:s=>D(s.target.value),placeholder:"Agregar palabra clave",onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),P())}),e.jsx(N,{type:"button",variant:"outline",onClick:P,children:"Agregar"})]}),b.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:b.map(s=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800",children:[s,e.jsx("button",{type:"button",onClick:()=>H(s),className:"hover:text-blue-600",children:e.jsx(G,{className:"h-3 w-3"})})]},s))})]})]}),e.jsxs(c,{children:[e.jsx(t,{children:e.jsx(o,{children:"Observaciones"})}),e.jsx(x,{children:e.jsx(w,{value:a.observaciones,onChange:s=>r("observaciones",s.target.value),placeholder:"Observaciones adicionales sobre el expediente",rows:3})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-6",children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>F.visit("/admin/expedientes"),disabled:S||C,children:"Cancelar"}),e.jsxs(N,{type:"submit",disabled:S||C,className:"bg-[#2a3d83] hover:bg-[#1e2b5f] flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4"}),S||C?"Creando...":"Crear Expediente"]})]})]})]})]})}export{ue as default};
