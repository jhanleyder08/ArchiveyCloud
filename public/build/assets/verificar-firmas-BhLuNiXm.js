import{r as V,j as e,H as E,L as l}from"./app-DdzhGUu9.js";import{A,S as c,g as N,q as S,a as T,n as _}from"./app-layout-OoaY7b31.js";import{B as d}from"./app-logo-icon-DFseab02.js";import{C as i,c as r,a as n,b as m,d as I}from"./card-C75-QnNJ.js";import{B as t}from"./badge-DbP4NXaO.js";import{A as k,a as B}from"./alert-oMGywHnq.js";import{R as f}from"./refresh-cw-BiZNoB2F.js";import{A as L}from"./arrow-left-BdcuzVd_.js";import{C as p}from"./circle-check-big-DVfM45OA.js";import{C as u}from"./circle-x-mxw6VDYH.js";import{D as z}from"./download-T5OPDl81.js";import{C as $}from"./calendar-CA_F_4Az.js";/* empty css            */import"./index-BzXMePeL.js";import"./label-KKFnnNzh.js";import"./index-CZotI1gq.js";function se({documento:a,firmas:x,todasValidas:o,totalFirmas:h}){const[j,g]=V.useState(!1),b=async()=>{g(!0);try{await new Promise(s=>setTimeout(s,2e3)),window.location.reload()}catch(s){console.error("Error verificando firmas:",s)}finally{g(!1)}},y=()=>{window.location.href=route("admin.firmas.certificado",a.id)},w=s=>({sin_firmar:e.jsx(t,{variant:"outline",className:"text-gray-600",children:"Sin Firmar"}),firmado:e.jsx(t,{className:"bg-green-100 text-green-800",children:"Firmado"}),firma_invalida:e.jsx(t,{variant:"destructive",children:"Firma Inválida"})})[s]||e.jsx(t,{variant:"outline",children:s}),F=s=>s?e.jsx(p,{className:"w-5 h-5 text-green-600"}):e.jsx(u,{className:"w-5 h-5 text-red-600"});return e.jsxs(A,{children:[e.jsx(E,{title:`Verificar Firmas - ${a.nombre}`}),e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-6",children:[e.jsx(l,{href:"/admin/documentos",className:"hover:text-blue-600",children:"Documentos"}),e.jsx("span",{children:"/"}),e.jsx(l,{href:`/admin/documentos/${a.id}`,className:"hover:text-blue-600",children:a.codigo}),e.jsx("span",{children:"/"}),e.jsx("span",{className:"text-gray-900",children:"Verificar Firmas"})]}),e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(c,{className:"w-8 h-8 text-blue-600"}),"Verificación de Firmas Digitales"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Estado y validez de las firmas digitales aplicadas al documento"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(d,{variant:"outline",onClick:b,disabled:j,children:j?e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"w-4 h-4 mr-2 animate-spin"}),"Verificando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Verificar Nuevamente"]})}),e.jsx(l,{href:`/admin/documentos/${a.id}`,children:e.jsxs(d,{variant:"outline",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"Volver al Documento"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(i,{children:e.jsxs(r,{className:"p-6 text-center",children:[e.jsx(N,{className:"w-8 h-8 mx-auto text-blue-600 mb-2"}),e.jsx("div",{className:"text-2xl font-bold",children:h}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Firmas"})]})}),e.jsx(i,{children:e.jsxs(r,{className:"p-6 text-center",children:[o?e.jsx(p,{className:"w-8 h-8 mx-auto text-green-600 mb-2"}):e.jsx(u,{className:"w-8 h-8 mx-auto text-red-600 mb-2"}),e.jsx("div",{className:"text-sm font-medium",children:o?"Todas Válidas":"Algunas Inválidas"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Estado Global"})]})}),e.jsx(i,{children:e.jsxs(r,{className:"p-6 text-center",children:[w(a.estado_firma),e.jsx("div",{className:"text-sm text-gray-600 mt-2",children:"Estado Documento"})]})}),e.jsx(i,{children:e.jsxs(r,{className:"p-6 text-center",children:[e.jsxs(d,{onClick:y,variant:"outline",size:"sm",disabled:h===0,children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Certificado"]}),e.jsx("div",{className:"text-sm text-gray-600 mt-2",children:"Descargar"})]})})]}),e.jsxs(i,{className:"mb-6",children:[e.jsx(n,{children:e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5"}),"Información del Documento"]})}),e.jsx(r,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Nombre"}),e.jsx("div",{className:"font-medium",children:a.nombre})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Código"}),e.jsx("div",{className:"font-mono text-sm",children:a.codigo})]}),a.expediente&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Expediente"}),e.jsx("div",{className:"text-sm",children:a.expediente.numero_expediente})]})]})})]}),x.length>0?e.jsxs(i,{children:[e.jsxs(n,{children:[e.jsx(m,{children:"Firmas Digitales Aplicadas"}),e.jsx(I,{children:"Detalle de cada firma digital y su estado de verificación"})]}),e.jsx(r,{children:e.jsx("div",{className:"space-y-6",children:x.map((s,v)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[F(s.valida),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-lg",children:["Firma #",v+1]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(S,{className:"w-4 h-4"}),s.usuario]})]})]}),e.jsxs("div",{className:"text-right",children:[s.valida?e.jsx(t,{className:"bg-green-100 text-green-800",children:"Válida"}):e.jsx(t,{variant:"destructive",children:"Inválida"}),s.vigente!==void 0&&e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:s.vigente?"Vigente":"Expirada"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-600 flex items-center gap-1",children:[e.jsx($,{className:"w-4 h-4"}),"Fecha de Firma"]}),e.jsx("div",{className:"text-sm",children:new Date(s.fecha_firma).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Tipo de Firma"}),e.jsx("div",{className:"text-sm capitalize",children:s.tipo_firma})]})]}),s.motivo&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Motivo"}),e.jsx("div",{className:"text-sm text-gray-700",children:s.motivo})]}),s.detalles&&Object.keys(s.detalles).length>0&&e.jsxs("div",{className:"bg-gray-50 rounded p-3 mb-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-2",children:"Detalles Técnicos"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-xs",children:[s.detalles.algoritmo&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Algoritmo:"})," ",s.detalles.algoritmo]}),s.detalles.tipo_firma&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Tipo:"})," ",s.detalles.tipo_firma]})]})]}),!s.valida&&s.errores.length>0&&e.jsxs(k,{variant:"destructive",children:[e.jsx(T,{className:"h-4 w-4"}),e.jsxs(B,{children:[e.jsx("div",{className:"font-medium mb-1",children:"Errores de Validación:"}),e.jsx("ul",{className:"text-sm space-y-1",children:s.errores.map((C,D)=>e.jsxs("li",{children:["• ",C]},D))})]})]})]},s.id))})})]}):e.jsx(i,{children:e.jsxs(r,{className:"p-12 text-center",children:[e.jsx(c,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Sin Firmas Digitales"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Este documento aún no tiene firmas digitales aplicadas."}),e.jsx(l,{href:`/admin/documentos/${a.id}/firmar`,children:e.jsxs(d,{children:[e.jsx(c,{className:"w-4 h-4 mr-2"}),"Firmar Documento"]})})]})}),e.jsxs(i,{className:"mt-6",children:[e.jsx(n,{children:e.jsxs(m,{className:"text-sm flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4"}),"Información sobre Verificación"]})}),e.jsx(r,{className:"text-sm text-gray-600",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Proceso de Verificación"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"• Se verifica la integridad del documento"}),e.jsx("li",{children:"• Se valida el hash de cada firma"}),e.jsx("li",{children:"• Se confirma la identidad del firmante"}),e.jsx("li",{children:"• Se revisa la vigencia temporal"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Estados Posibles"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Válida:"})," Firma correcta y vigente"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Inválida:"})," Firma comprometida o alterada"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Expirada:"})," Firma fuera del período de validez"]})]})]})]})})]})]})]})}export{se as default};
