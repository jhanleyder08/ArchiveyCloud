import{e as M,r as v,u as $,j as e,H as z,L as G}from"./app-B_OG_Vza.js";import{A as O}from"./app-layout-DOCwYxKT.js";import{B as C}from"./button-BSbSEU_p.js";import{I as h}from"./input-Dh6-5mRd.js";import{L as t}from"./label-rVSvqjBQ.js";import{A as J,q as y,T as K}from"./app-sidebar-layout-fWJRkDcF.js";import{C as f,a as S,b as _,d as w,c as N}from"./card-cumjxZex.js";import{C as L}from"./checkbox-HGtUqf2i.js";import{S as A,a as U,b as D,c as E,d as o}from"./select-BxqyTJob.js";import{A as p,a as j}from"./alert-D93R01ev.js";import{C as Q}from"./circle-check-big-BhMkSw6G.js";import{T as F}from"./triangle-alert-3stdfBS0.js";import{U as W}from"./users-B-Ei4AUw.js";import{U as X}from"./user-Bso3zvdg.js";import{L as Y}from"./loader-circle-DuWh6owa.js";import{I as Z}from"./info-BoraNP-x.js";/* empty css            */import"./index-COOtV0Sn.js";import"./index-CmTcU35r.js";import"./Combination-C0EFkMHe.js";import"./index-CeYb-gwX.js";import"./x-Di-LOll0.js";import"./app-logo-icon-A0O4A2TN.js";import"./mail-DIqKJEVK.js";import"./folder-B9vwnN7g.js";import"./search-CCssNLWg.js";import"./BrandingProvider-BDq7LIZa.js";import"./index-DIzNZfaR.js";import"./check-B3a6KT7v.js";const ee=[{value:"general",label:"General"},{value:"sistema",label:"Sistema"},{value:"seguridad",label:"Seguridad"},{value:"expediente_vencido",label:"Expediente Vencido"},{value:"expediente_proximo_vencer",label:"Expediente Próximo a Vencer"},{value:"prestamo_vencido",label:"Préstamo Vencido"},{value:"prestamo_proximo_vencer",label:"Préstamo Próximo a Vencer"},{value:"disposicion_pendiente",label:"Disposición Pendiente"},{value:"documento_subido",label:"Documento Subido"},{value:"usuario_nuevo",label:"Usuario Nuevo"}];function De({usuarios:T}){const{flash:d}=M().props,[P,u]=v.useState(!1),[i,m]=v.useState([]),[g,V]=v.useState(""),{data:c,setData:r,post:k,processing:b,errors:a,reset:q}=$({user_ids:[],titulo:"",mensaje:"",tipo:"general",prioridad:"media",accion_url:"",programada_para:""}),x=T.filter(s=>s.name.toLowerCase().includes(g.toLowerCase())||s.email.toLowerCase().includes(g.toLowerCase())),B=s=>{if(u(s),s){const n=x.map(l=>l.id);m(n),r("user_ids",n)}else m([]),r("user_ids",[])},I=(s,n)=>{let l;n?l=[...i,s]:l=i.filter(H=>H!==s),m(l),r("user_ids",l),u(l.length===x.length)},R=s=>{s.preventDefault(),k("/admin/notificaciones",{onSuccess:()=>{q(),m([]),u(!1)}})};return e.jsxs(O,{breadcrumbs:[{title:"Dashboard",href:"/dashboard"},{title:"Administración",href:"#"},{title:"Notificaciones",href:"/admin/notificaciones"},{title:"Crear Notificación",href:"/admin/notificaciones/crear"}],children:[e.jsx(z,{title:"Crear Notificación"}),e.jsxs("div",{className:"space-y-6",children:[d?.success&&e.jsxs(p,{className:"bg-green-50 border-green-200",children:[e.jsx(Q,{className:"h-4 w-4 text-green-600"}),e.jsx(j,{className:"text-green-800",children:d.success})]}),d?.error&&e.jsxs(p,{variant:"destructive",children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx(j,{children:d.error})]}),e.jsx("div",{className:"flex items-center justify-between pt-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(C,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(G,{href:"/admin/notificaciones/admin",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Volver"]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-6 w-6 text-[#2a3d83]"}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Crear Nueva Notificación"})]})]})}),e.jsx("form",{onSubmit:R,children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs(f,{className:"bg-white border border-gray-200",children:[e.jsxs(S,{children:[e.jsx(_,{className:"text-lg font-semibold text-gray-900",children:"Contenido de la Notificación"}),e.jsx(w,{children:"Define el mensaje que recibirán los usuarios seleccionados"})]}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"titulo",children:"Título *"}),e.jsx(h,{id:"titulo",value:c.titulo,onChange:s=>r("titulo",s.target.value),placeholder:"Ej: Recordatorio de vencimiento",className:a.titulo?"border-red-500":""}),a.titulo&&e.jsx("p",{className:"text-sm text-red-500",children:a.titulo})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"mensaje",children:"Mensaje *"}),e.jsx(K,{id:"mensaje",value:c.mensaje,onChange:s=>r("mensaje",s.target.value),placeholder:"Escribe el contenido del mensaje...",rows:4,className:a.mensaje?"border-red-500":""}),a.mensaje&&e.jsx("p",{className:"text-sm text-red-500",children:a.mensaje})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"tipo",children:"Tipo de Notificación *"}),e.jsxs(A,{value:c.tipo,onValueChange:s=>r("tipo",s),children:[e.jsx(U,{children:e.jsx(D,{placeholder:"Seleccionar tipo"})}),e.jsx(E,{children:ee.map(s=>e.jsx(o,{value:s.value,children:s.label},s.value))})]}),a.tipo&&e.jsx("p",{className:"text-sm text-red-500",children:a.tipo})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"prioridad",children:"Prioridad"}),e.jsxs(A,{value:c.prioridad,onValueChange:s=>r("prioridad",s),children:[e.jsx(U,{children:e.jsx(D,{placeholder:"Seleccionar prioridad"})}),e.jsxs(E,{children:[e.jsx(o,{value:"baja",children:"Baja"}),e.jsx(o,{value:"media",children:"Media"}),e.jsx(o,{value:"alta",children:"Alta"}),e.jsx(o,{value:"critica",children:"Crítica"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"accion_url",children:"URL de Acción (opcional)"}),e.jsx(h,{id:"accion_url",value:c.accion_url,onChange:s=>r("accion_url",s.target.value),placeholder:"Ej: /admin/expedientes/123"}),e.jsx("p",{className:"text-xs text-gray-500",children:"URL a la que se redirigirá al usuario al hacer clic en la notificación"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"programada_para",children:"Programar Envío (opcional)"}),e.jsx(h,{id:"programada_para",type:"datetime-local",value:c.programada_para,onChange:s=>r("programada_para",s.target.value)}),e.jsx("p",{className:"text-xs text-gray-500",children:"Deja vacío para enviar inmediatamente"})]})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(f,{className:"bg-white border border-gray-200",children:[e.jsxs(S,{children:[e.jsxs(_,{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-[#2a3d83]"}),"Destinatarios"]}),e.jsx(w,{children:"Selecciona los usuarios que recibirán esta notificación"})]}),e.jsxs(N,{className:"space-y-4",children:[a.user_ids&&e.jsxs(p,{variant:"destructive",children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx(j,{children:a.user_ids})]}),e.jsx("div",{className:"space-y-2",children:e.jsx(h,{placeholder:"Buscar usuarios...",value:g,onChange:s=>V(s.target.value)})}),e.jsxs("div",{className:"flex items-center space-x-2 pb-2 border-b",children:[e.jsx(L,{id:"select-all",checked:P,onCheckedChange:B}),e.jsxs(t,{htmlFor:"select-all",className:"text-sm font-medium",children:["Seleccionar todos (",x.length,")"]})]}),e.jsx("div",{className:"max-h-80 overflow-y-auto space-y-2",children:x.map(s=>e.jsxs("div",{className:`flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-50 transition-colors ${i.includes(s.id)?"bg-blue-50":""}`,children:[e.jsx(L,{id:`user-${s.id}`,checked:i.includes(s.id),onCheckedChange:n=>I(s.id,n)}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 rounded-full",children:e.jsx(X,{className:"h-3 w-3 text-[#2a3d83]"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.email})]})]})]},s.id))}),i.length>0&&e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("p",{className:"text-sm text-[#2a3d83] font-medium",children:[i.length," usuario(s) seleccionado(s)"]})})]})]}),e.jsx(f,{className:"bg-white border border-gray-200",children:e.jsxs(N,{className:"pt-6",children:[e.jsx(C,{type:"submit",className:"w-full bg-[#2a3d83] hover:bg-[#1e2b5f]",disabled:b||i.length===0,children:b?e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"h-4 w-4 mr-2 animate-spin"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Enviar Notificación"]})}),i.length===0&&e.jsx("p",{className:"text-xs text-center text-gray-500 mt-2",children:"Selecciona al menos un usuario"})]})}),e.jsxs(p,{children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx(j,{children:"Las notificaciones se enviarán inmediatamente a menos que especifiques una fecha de programación."})]})]})]})})]})]})}export{De as default};
