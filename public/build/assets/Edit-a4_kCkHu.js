import{r as O,u as q,j as e,a as E,H as J}from"./app-BAaRFKCE.js";import{A as K,F as M}from"./app-layout-BkZKgO0H.js";import{B as h}from"./app-logo-icon-CRu_6WDm.js";import{I as d}from"./input-BbBpRMsa.js";import{L as p}from"./label-D08h-VMZ.js";import{T as b,S as Q}from"./textarea-CFmLlg1e.js";import{S as U,a as W,b as X,c as Y,d as f}from"./select-COydJ_1f.js";import{C as x,a as g,b as v,c as C,d as N}from"./card-CrHy-fHD.js";import{T as Z,a as I,b as z,c as A}from"./tabs-BxZhJoWE.js";import{B as ee}from"./badge-CYpmu6Aj.js";import{S as F}from"./separator-BrPQWlfD.js";import{A as se}from"./arrow-left-Bo6AaNur.js";import{P as _}from"./plus-CbTR48RT.js";import{B as ae,H as ie}from"./hash-BdiV7mzO.js";import{T as S}from"./trash-2-DgMOpCcU.js";/* empty css            */import"./index-D2AugiGI.js";import"./index-DZ-wJQli.js";import"./index-B8KDMt0s.js";import"./index-D8C8_OyU.js";function Se({trd:o}){const[k,B]=O.useState("basic"),{data:c,setData:n,put:R,processing:w,errors:j,reset:te}=q({name:o.name,description:o.description||"",entity_name:o.entity_name,entity_code:o.entity_code,effective_date:o.effective_date||"",expiry_date:o.expiry_date||"",sections:o.sections||[],change_notes:""}),V=s=>{s.preventDefault(),R(`/trd/${o.id}`)},T=()=>{const s={section_code:"",section_name:"",description:"",order_index:c.sections.length,series:[]};n("sections",[...c.sections,s])},y=(s,a,t)=>{const i=[...c.sections];i[s]={...i[s],[a]:t},n("sections",i)},H=s=>{const a=c.sections.filter((t,i)=>i!==s);n("sections",a)},L=s=>{const a={series_code:"",series_name:"",description:"",order_index:c.sections[s].series.length,subseries:[]},t=[...c.sections];t[s].series.push(a),n("sections",t)},D=(s,a,t,i)=>{const r=[...c.sections];r[s].series[a]={...r[s].series[a],[t]:i},n("sections",r)},G=(s,a)=>{const t=[...c.sections];t[s].series=t[s].series.filter((i,r)=>r!==a),n("sections",t)},P=(s,a)=>{const t={subseries_code:"",subseries_name:"",description:"",document_type:"",retention_archive_management:0,retention_central_archive:0,final_disposition:"conservation_total",access_restrictions:"",procedure:"",order_index:c.sections[s].series[a].subseries.length},i=[...c.sections];i[s].series[a].subseries.push(t),n("sections",i)},u=(s,a,t,i,r)=>{const l=[...c.sections];l[s].series[a].subseries[t]={...l[s].series[a].subseries[t],[i]:r},n("sections",l)},$=(s,a,t)=>{const i=[...c.sections];i[s].series[a].subseries=i[s].series[a].subseries.filter((r,l)=>l!==t),n("sections",i)};return e.jsxs(K,{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs(h,{variant:"ghost",size:"sm",onClick:()=>E.get(`/trd/${o.id}`),children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),"Volver"]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:["Editar TRD: ",o.name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Código: ",o.code," • Versión ",o.version]})]})]}),e.jsx(J,{title:`Editar TRD - ${o.name}`}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("form",{onSubmit:V,className:"space-y-6",children:[e.jsxs(Z,{value:k,onValueChange:B,children:[e.jsxs(I,{className:"grid w-full grid-cols-2",children:[e.jsx(z,{value:"basic",children:"Información Básica"}),e.jsx(z,{value:"structure",children:"Estructura TRD"})]}),e.jsx(A,{value:"basic",className:"space-y-6",children:e.jsxs(x,{children:[e.jsxs(g,{children:[e.jsx(v,{children:"Información General"}),e.jsx(C,{children:"Datos generales de la Tabla de Retención Documental"})]}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"name",children:"Nombre de la TRD *"}),e.jsx(d,{id:"name",type:"text",value:c.name,onChange:s=>n("name",s.target.value),className:j.name?"border-red-500":""}),j.name&&e.jsx("p",{className:"text-sm text-red-600",children:j.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"entity_name",children:"Entidad *"}),e.jsx(d,{id:"entity_name",type:"text",value:c.entity_name,onChange:s=>n("entity_name",s.target.value),className:j.entity_name?"border-red-500":""}),j.entity_name&&e.jsx("p",{className:"text-sm text-red-600",children:j.entity_name})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"description",children:"Descripción"}),e.jsx(b,{id:"description",value:c.description,onChange:s=>n("description",s.target.value),rows:3})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"effective_date",children:"Fecha de Vigencia"}),e.jsx(d,{id:"effective_date",type:"date",value:c.effective_date,onChange:s=>n("effective_date",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"expiry_date",children:"Fecha de Vencimiento"}),e.jsx(d,{id:"expiry_date",type:"date",value:c.expiry_date,onChange:s=>n("expiry_date",s.target.value)})]})]})]})]})}),e.jsx(A,{value:"structure",className:"space-y-6",children:e.jsxs(x,{children:[e.jsx(g,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(v,{children:"Estructura de la TRD"}),e.jsx(C,{children:"Configure las secciones, series y subseries documentales"})]}),e.jsxs(h,{type:"button",variant:"outline",size:"sm",onClick:T,children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Agregar Sección"]})]})}),e.jsx(N,{children:c.sections.length>0?e.jsx("div",{className:"space-y-6",children:c.sections.map((s,a)=>e.jsxs(x,{className:"border-l-4 border-blue-500",children:[e.jsx(g,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(v,{className:"flex items-center gap-2 text-lg",children:[e.jsx(ae,{className:"w-4 h-4"}),"Sección ",a+1]}),e.jsx(h,{type:"button",variant:"ghost",size:"sm",onClick:()=>H(a),className:"text-red-600",children:e.jsx(S,{className:"w-4 h-4"})})]})}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Código de la Sección"}),e.jsx(d,{value:s.section_code,onChange:t=>y(a,"section_code",t.target.value),placeholder:"Ej: 100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Nombre de la Sección"}),e.jsx(d,{value:s.section_name,onChange:t=>y(a,"section_name",t.target.value),placeholder:"Ej: Oficina de Planeación"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Descripción"}),e.jsx(b,{value:s.description,onChange:t=>y(a,"description",t.target.value),rows:2})]}),e.jsx(F,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4"}),"Series Documentales"]}),e.jsxs(h,{type:"button",variant:"outline",size:"sm",onClick:()=>L(a),children:[e.jsx(_,{className:"w-3 h-3 mr-1"}),"Serie"]})]}),s.series.map((t,i)=>e.jsxs(x,{className:"ml-4 border-l-2 border-green-400",children:[e.jsx(g,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(v,{className:"text-base",children:["Serie ",i+1]}),e.jsx(h,{type:"button",variant:"ghost",size:"sm",onClick:()=>G(a,i),className:"text-red-600",children:e.jsx(S,{className:"w-3 h-3"})})]})}),e.jsxs(N,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx(d,{value:t.series_code,onChange:r=>D(a,i,"series_code",r.target.value),placeholder:"Código serie (Ej: 100.01)"}),e.jsx(d,{value:t.series_name,onChange:r=>D(a,i,"series_name",r.target.value),placeholder:"Nombre de la serie"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium flex items-center gap-1",children:[e.jsx(ie,{className:"w-3 h-3"}),"Subseries"]}),e.jsxs(h,{type:"button",variant:"outline",size:"sm",onClick:()=>P(a,i),children:[e.jsx(_,{className:"w-3 h-3 mr-1"}),"Subserie"]})]}),t.subseries.map((r,l)=>e.jsxs("div",{className:"ml-4 p-3 border border-gray-200 rounded-lg space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(ee,{variant:"outline",children:["Subserie ",l+1]}),e.jsx(h,{type:"button",variant:"ghost",size:"sm",onClick:()=>$(a,i,l),className:"text-red-600",children:e.jsx(S,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsx(d,{value:r.subseries_code,onChange:m=>u(a,i,l,"subseries_code",m.target.value),placeholder:"Código (Ej: 100.01.01)",className:"text-sm"}),e.jsx(d,{value:r.subseries_name,onChange:m=>u(a,i,l,"subseries_name",m.target.value),placeholder:"Nombre subserie",className:"text-sm"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[e.jsx(d,{value:r.document_type,onChange:m=>u(a,i,l,"document_type",m.target.value),placeholder:"Tipo documental",className:"text-sm"}),e.jsx(d,{type:"number",value:r.retention_archive_management,onChange:m=>u(a,i,l,"retention_archive_management",parseInt(m.target.value)||0),placeholder:"AG (años)",className:"text-sm"}),e.jsx(d,{type:"number",value:r.retention_central_archive,onChange:m=>u(a,i,l,"retention_central_archive",parseInt(m.target.value)||0),placeholder:"AC (años)",className:"text-sm"})]}),e.jsxs(U,{value:r.final_disposition,onValueChange:m=>u(a,i,l,"final_disposition",m),children:[e.jsx(W,{className:"text-sm",children:e.jsx(X,{})}),e.jsxs(Y,{children:[e.jsx(f,{value:"conservation_total",children:"Conservación Total (CT)"}),e.jsx(f,{value:"selection",children:"Selección (S)"}),e.jsx(f,{value:"elimination",children:"Eliminación (E)"})]})]})]},l))]})]})]},i))]})]})]},a))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-500 mb-4",children:"No hay secciones definidas. Agregue la primera sección para comenzar."}),e.jsxs(h,{type:"button",onClick:T,children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Agregar Primera Sección"]})]})})]})})]}),e.jsxs(x,{children:[e.jsxs(g,{children:[e.jsx(v,{children:"Notas de Cambios"}),e.jsx(C,{children:"Describa los cambios realizados (opcional)"})]}),e.jsx(N,{children:e.jsx(b,{value:c.change_notes,onChange:s=>n("change_notes",s.target.value),placeholder:"Describa los cambios realizados en esta versión...",rows:3})})]}),e.jsx(F,{}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>E.get(`/trd/${o.id}`),children:"Cancelar"}),e.jsxs(h,{type:"submit",disabled:w,children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),w?"Guardando...":"Guardar Cambios"]})]})]})})})]})}export{Se as default};
