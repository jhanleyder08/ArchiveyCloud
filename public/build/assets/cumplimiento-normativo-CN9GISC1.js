import{r as $,u as K,j as e,H as O,L as N}from"./app-DOeYTPnE.js";import{A as H}from"./app-layout-CKT_ksyH.js";import{B as h}from"./button-BB3j1qH9.js";import{I as T}from"./index-C7D1JV-H.js";import{L as g}from"./label-BvABT9uR.js";import{C as i,a,b as t,c as n,d as l}from"./card-BEZSel9K.js";import{B as A}from"./badge-BDHWk-Qv.js";import{P as U}from"./progress-Dx-cP85h.js";import{T as z,a as X,b as j,c as p}from"./tabs-CZodpFxR.js";import{A as f,a as u}from"./alert-Dl-auDCw.js";import{f as Y,l as G}from"./app-sidebar-layout-83PL_wom.js";import{F as J}from"./filter-kze0nvip.js";import{S as Q,F as W}from"./index-Cl_hWV--.js";import{C as d}from"./circle-check-big-BQYxJNiA.js";import{T as S}from"./triangle-alert-B7e9hRq_.js";import{M as L}from"./map-pin-nbL0dT1p.js";import{R as V,T as R}from"./CategoricalChart-Dajg-Im1.js";import{P as Z,a as ee}from"./PieChart-723s3Ajo.js";import{C as se}from"./tooltipContext-B4UnQMjc.js";import{B as ie}from"./BarChart-anN5OFyv.js";import{C as ae,X as te,Y as ne}from"./CartesianChart-D-tVo_OX.js";import{L as re}from"./Legend-_Mp7fl-D.js";import{B}from"./barSelectors-vhDwuTyo.js";import{C as ce}from"./user-BiSWd6pJ.js";/* empty css            */import"./index-B5i9qy2Y.js";import"./index-BuQaqXjb.js";import"./x-BHxLkKP3.js";import"./index-sj4qH-fg.js";import"./app-logo-icon-BTiqVlKS.js";const v={vigente:"#22C55E",vencido:"#EF4444"};function Me({expedientesRetencion:x,documentosSinClasificar:b,expedientesSinUbicacion:w,resumenCumplimiento:r,fechaInicio:y,fechaFin:_}){const[le,de]=$.useState({fecha_inicio:y,fecha_fin:_,estado_cumplimiento:"",responsable:""}),{data:m,setData:C,get:P,processing:E}=K({fecha_inicio:y,fecha_fin:_}),k=()=>{P(route("admin.reportes.cumplimiento-normativo"),{data:{fecha_inicio:m.fecha_inicio,fecha_fin:m.fecha_fin},preserveState:!0})},q=()=>{console.log("Exportar reporte de cumplimiento normativo")},D=[{name:"Vigentes",value:r.expedientes_vigentes,color:v.vigente},{name:"Vencidos",value:r.expedientes_vencidos,color:v.vencido}],I=x.reduce((s,c)=>{const o=new Date(c.expediente.fecha_apertura).toISOString().substr(0,7);return s[o]||(s[o]={mes:o,vigentes:0,vencidos:0}),c.estado_cumplimiento==="vigente"?s[o].vigentes++:s[o].vencidos++,s},{}),M=Object.values(I).sort((s,c)=>s.mes.localeCompare(c.mes)),F=x.filter(s=>s.estado_cumplimiento==="vigente"&&s.dias_restantes<=30&&s.dias_restantes>0);return e.jsxs(H,{children:[e.jsx(O,{title:"Cumplimiento Normativo - Reportes"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N,{href:route("admin.reportes.dashboard"),className:"text-sm text-muted-foreground hover:text-foreground",children:"Reportes"}),e.jsx("span",{className:"text-muted-foreground",children:"/"}),e.jsx("span",{className:"font-medium",children:"Cumplimiento Normativo"})]}),e.jsx("h1",{className:"text-2xl font-bold mt-1",children:"Cumplimiento Normativo"}),e.jsx("p",{className:"text-muted-foreground",children:"Análisis de cumplimiento de retención documental"})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(h,{variant:"outline",onClick:q,children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Exportar"]})})]}),e.jsxs(i,{children:[e.jsx(a,{children:e.jsxs(t,{className:"flex items-center space-x-2",children:[e.jsx(J,{className:"h-5 w-5"}),e.jsx("span",{children:"Filtros"})]})}),e.jsx(n,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"fecha_inicio",children:"Fecha Inicio"}),e.jsx(T,{id:"fecha_inicio",type:"date",value:m.fecha_inicio,onChange:s=>C("fecha_inicio",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"fecha_fin",children:"Fecha Fin"}),e.jsx(T,{id:"fecha_fin",type:"date",value:m.fecha_fin,onChange:s=>C("fecha_fin",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{children:" "}),e.jsxs(h,{onClick:k,disabled:E,className:"w-full",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),E?"Aplicando...":"Aplicar Filtros"]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4",children:[e.jsxs(i,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(t,{className:"text-sm font-medium",children:"Total Expedientes"}),e.jsx(G,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(n,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r.total_expedientes}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"En el período seleccionado"})]})]}),e.jsxs(i,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(t,{className:"text-sm font-medium",children:"Cumplimiento"}),e.jsx(d,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(n,{children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[r.porcentaje_cumplimiento,"%"]}),e.jsx(U,{value:r.porcentaje_cumplimiento,className:"mt-1"})]})]}),e.jsxs(i,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(t,{className:"text-sm font-medium",children:"Expedientes Vigentes"}),e.jsx(d,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(n,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:r.expedientes_vigentes}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Dentro del período de retención"})]})]}),e.jsxs(i,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(t,{className:"text-sm font-medium",children:"Expedientes Vencidos"}),e.jsx(S,{className:"h-4 w-4 text-red-500"})]}),e.jsxs(n,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:r.expedientes_vencidos}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Requieren disposición final"})]})]}),e.jsxs(i,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(t,{className:"text-sm font-medium",children:"Sin Ubicación"}),e.jsx(L,{className:"h-4 w-4 text-yellow-500"})]}),e.jsxs(n,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:r.expedientes_sin_ubicacion}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Expedientes sin ubicación física"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(i,{children:[e.jsxs(a,{children:[e.jsx(t,{children:"Estado de Cumplimiento"}),e.jsx(l,{children:"Distribución de expedientes por estado"})]}),e.jsx(n,{children:e.jsx(V,{width:"100%",height:300,children:e.jsxs(Z,{children:[e.jsx(ee,{data:D,cx:"50%",cy:"50%",labelLine:!1,label:({name:s,percent:c})=>`${s}: ${(c*100).toFixed(1)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:D.map((s,c)=>e.jsx(se,{fill:s.color},`cell-${c}`))}),e.jsx(R,{})]})})})]}),e.jsxs(i,{children:[e.jsxs(a,{children:[e.jsx(t,{children:"Cumplimiento por Mes"}),e.jsx(l,{children:"Evolución del cumplimiento en el tiempo"})]}),e.jsx(n,{children:e.jsx(V,{width:"100%",height:300,children:e.jsxs(ie,{data:M,children:[e.jsx(ae,{strokeDasharray:"3 3"}),e.jsx(te,{dataKey:"mes"}),e.jsx(ne,{}),e.jsx(R,{}),e.jsx(re,{}),e.jsx(B,{dataKey:"vigentes",stackId:"a",fill:v.vigente,name:"Vigentes"}),e.jsx(B,{dataKey:"vencidos",stackId:"a",fill:v.vencido,name:"Vencidos"})]})})})]})]}),e.jsxs(z,{defaultValue:"proximos-vencer",className:"space-y-4",children:[e.jsxs(X,{className:"grid w-full grid-cols-4",children:[e.jsx(j,{value:"proximos-vencer",children:"Próximos a Vencer"}),e.jsx(j,{value:"vencidos",children:"Vencidos"}),e.jsx(j,{value:"sin-clasificar",children:"Sin Clasificar"}),e.jsx(j,{value:"sin-ubicacion",children:"Sin Ubicación"})]}),e.jsx(p,{value:"proximos-vencer",className:"space-y-4",children:e.jsxs(i,{children:[e.jsxs(a,{children:[e.jsxs(t,{className:"flex items-center space-x-2",children:[e.jsx(ce,{className:"h-5 w-5 text-yellow-500"}),e.jsx("span",{children:"Expedientes Próximos a Vencer (30 días)"})]}),e.jsx(l,{children:"Expedientes que vencen en los próximos 30 días"})]}),e.jsx(n,{children:F.length>0?e.jsx("div",{className:"space-y-3",children:F.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.expediente.codigo}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.expediente.nombre}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-muted-foreground mt-1",children:[e.jsxs("span",{children:["Responsable: ",s.expediente.responsable]}),e.jsxs("span",{children:["Fecha límite: ",new Date(s.fecha_limite_ag).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs(A,{variant:"outline",className:"text-yellow-600 border-yellow-600",children:[s.dias_restantes," días restantes"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Retención: ",s.tiempo_retencion," años"]})]})]},s.expediente.id))}):e.jsxs(f,{children:[e.jsx(d,{className:"h-4 w-4"}),e.jsx(u,{children:"No hay expedientes próximos a vencer en los próximos 30 días."})]})})]})}),e.jsx(p,{value:"vencidos",className:"space-y-4",children:e.jsxs(i,{children:[e.jsxs(a,{children:[e.jsxs(t,{className:"flex items-center space-x-2",children:[e.jsx(S,{className:"h-5 w-5 text-red-500"}),e.jsx("span",{children:"Expedientes Vencidos"})]}),e.jsx(l,{children:"Expedientes que han superado su período de retención"})]}),e.jsx(n,{children:x.filter(s=>s.estado_cumplimiento==="vencido").length>0?e.jsx("div",{className:"space-y-3",children:x.filter(s=>s.estado_cumplimiento==="vencido").slice(0,10).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg border-red-200",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.expediente.codigo}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.expediente.nombre}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-muted-foreground mt-1",children:[e.jsxs("span",{children:["Responsable: ",s.expediente.responsable]}),e.jsxs("span",{children:["Vencido el: ",new Date(s.fecha_limite_ag).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs(A,{variant:"destructive",children:["Vencido hace ",Math.abs(s.dias_restantes)," días"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Retención: ",s.tiempo_retencion," años"]})]})]},s.expediente.id))}):e.jsxs(f,{children:[e.jsx(d,{className:"h-4 w-4"}),e.jsx(u,{children:"No hay expedientes vencidos en el período seleccionado."})]})})]})}),e.jsx(p,{value:"sin-clasificar",className:"space-y-4",children:e.jsxs(i,{children:[e.jsxs(a,{children:[e.jsxs(t,{className:"flex items-center space-x-2",children:[e.jsx(W,{className:"h-5 w-5 text-yellow-500"}),e.jsx("span",{children:"Documentos Sin Clasificar"})]}),e.jsx(l,{children:"Documentos que no tienen serie o subserie asignada"})]}),e.jsx(n,{children:b.length>0?e.jsx("div",{className:"space-y-3",children:b.slice(0,10).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg border-yellow-200",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.nombre}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.expediente?`${s.expediente.codigo} - ${s.expediente.nombre}`:"Sin expediente"}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-muted-foreground mt-1",children:[e.jsxs("span",{children:["Tipo: ",s.tipo_documento]}),e.jsxs("span",{children:["Creado: ",new Date(s.created_at).toLocaleDateString()]})]})]}),e.jsx(h,{variant:"outline",size:"sm",asChild:!0,children:e.jsx(N,{href:route("admin.documentos.edit",s.id),children:"Clasificar"})})]},s.id))}):e.jsxs(f,{children:[e.jsx(d,{className:"h-4 w-4"}),e.jsx(u,{children:"Todos los documentos están correctamente clasificados."})]})})]})}),e.jsx(p,{value:"sin-ubicacion",className:"space-y-4",children:e.jsxs(i,{children:[e.jsxs(a,{children:[e.jsxs(t,{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"h-5 w-5 text-yellow-500"}),e.jsx("span",{children:"Expedientes Sin Ubicación"})]}),e.jsx(l,{children:"Expedientes que no tienen ubicación física definida"})]}),e.jsx(n,{children:w.length>0?e.jsx("div",{className:"space-y-3",children:w.slice(0,10).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg border-yellow-200",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.codigo}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.nombre}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-muted-foreground mt-1",children:[e.jsxs("span",{children:["Responsable: ",s.responsable]}),e.jsxs("span",{children:["Estado: ",s.estado]}),e.jsxs("span",{children:["Apertura: ",new Date(s.fecha_apertura).toLocaleDateString()]})]})]}),e.jsx(h,{variant:"outline",size:"sm",asChild:!0,children:e.jsx(N,{href:route("admin.expedientes.edit",s.id),children:"Asignar Ubicación"})})]},s.id))}):e.jsxs(f,{children:[e.jsx(d,{className:"h-4 w-4"}),e.jsx(u,{children:"Todos los expedientes tienen ubicación física definida."})]})})]})})]})]})]})}export{Me as default};
