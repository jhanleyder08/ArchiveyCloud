import{r as E,u as U,j as e,H,L as _}from"./app-DOeYTPnE.js";import{A as O}from"./app-layout-CKT_ksyH.js";import{B as b}from"./button-BB3j1qH9.js";import{I as v}from"./index-C7D1JV-H.js";import{L as l}from"./label-BvABT9uR.js";import{T,S as K}from"./app-sidebar-layout-83PL_wom.js";import{S as C}from"./switch-DIpGF78c.js";import{S as d,a as t,b as o,c as m,d as n}from"./select-D2zOlv3c.js";import{C as x,a as h,b as j,d as p,c as u}from"./card-BEZSel9K.js";import{B as M}from"./badge-BDHWk-Qv.js";import{A as $,a as z}from"./alert-Dl-auDCw.js";import{A as X}from"./arrow-left-Cvz8oF6O.js";import{S as V}from"./save-DHvE8w7l.js";import{C as J}from"./circle-alert-Diz-FkUP.js";import{F as Q}from"./index-Cl_hWV--.js";import{C as W}from"./calendar-Ce3GlXt0.js";import{U as Y}from"./user-BiSWd6pJ.js";import{S as y}from"./triangle-alert-B7e9hRq_.js";import{T as Z}from"./tag-CIPiv3d0.js";import{P as ee}from"./plus-Dfkec5yu.js";import{X as se}from"./x-BHxLkKP3.js";/* empty css            */import"./index-B5i9qy2Y.js";import"./index-BuQaqXjb.js";import"./index-sj4qH-fg.js";import"./app-logo-icon-BTiqVlKS.js";import"./index-pqvegj4w.js";import"./check-C4IDWgVr.js";function De({expediente:c,series:F,departamentos:R,responsables:q,errors:a}){const[f,A]=E.useState(""),[D,P]=E.useState([]),{data:i,setData:r,put:L,processing:N,isDirty:S}=U({nombre:c.nombre||"",descripcion:c.descripcion||"",estado:c.estado||"abierto",fecha_apertura:c.fecha_apertura?c.fecha_apertura.split("T")[0]:"",fecha_cierre:c.fecha_cierre?c.fecha_cierre.split("T")[0]:"",ubicacion_fisica:c.ubicacion_fisica||"",responsable:c.responsable||"",departamento:c.departamento||"",clasificacion_serie:c.clasificacion_serie||"",clasificacion_subserie:c.clasificacion_subserie||"",nivel_acceso:c.nivel_acceso||"publico",palabras_clave:c.palabras_clave||[],observaciones:c.observaciones||"",permite_documentos_electronicos:c.configuracion?.permite_documentos_electronicos??!0,requiere_firma_digital:c.configuracion?.requiere_firma_digital??!1,control_versiones:c.configuracion?.control_versiones??!0,notificaciones_automaticas:c.configuracion?.notificaciones_automaticas??!0});E.useEffect(()=>{if(i.clasificacion_serie){const s=F.find(w=>w.nombre===i.clasificacion_serie);P(s?.subseries||[]),s?.subseries.some(w=>w.nombre===i.clasificacion_subserie)||r("clasificacion_subserie","")}else P([]),r("clasificacion_subserie","")},[i.clasificacion_serie]);const G=s=>{s.preventDefault(),L(route("admin.expedientes.update",c.id))},k=()=>{f.trim()&&!i.palabras_clave.includes(f.trim())&&(r("palabras_clave",[...i.palabras_clave,f.trim()]),A(""))},I=s=>{r("palabras_clave",i.palabras_clave.filter(g=>g!==s))},B=s=>{s.key==="Enter"&&(s.preventDefault(),k())};return e.jsxs(O,{children:[e.jsx(H,{title:`Editar Expediente: ${c.nombre}`}),e.jsxs("form",{onSubmit:G,className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_,{href:route("admin.expedientes.index"),className:"text-sm text-muted-foreground hover:text-foreground",children:"Expedientes"}),e.jsx("span",{className:"text-muted-foreground",children:"/"}),e.jsx(_,{href:route("admin.expedientes.show",c.id),className:"text-sm text-muted-foreground hover:text-foreground",children:c.codigo}),e.jsx("span",{className:"text-muted-foreground",children:"/"}),e.jsx("span",{className:"font-medium",children:"Editar"})]}),e.jsx("h1",{className:"text-2xl font-bold mt-1",children:"Editar Expediente"}),e.jsx("p",{className:"text-muted-foreground",children:"Modifica la información del expediente"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{type:"button",variant:"outline",asChild:!0,children:e.jsxs(_,{href:route("admin.expedientes.show",c.id),children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Cancelar"]})}),e.jsxs(b,{type:"submit",disabled:N||!S,children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),N?"Guardando...":"Guardar Cambios"]})]})]}),S&&e.jsxs($,{children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx(z,{children:"Tienes cambios sin guardar. Asegúrate de guardar antes de salir."})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs(j,{className:"flex items-center space-x-2",children:[e.jsx(Q,{className:"h-5 w-5"}),e.jsx("span",{children:"Información General"})]}),e.jsx(p,{children:"Información básica del expediente"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"nombre",children:"Nombre del Expediente *"}),e.jsx(v,{id:"nombre",value:i.nombre,onChange:s=>r("nombre",s.target.value),placeholder:"Nombre del expediente",className:a.nombre?"border-red-500":""}),a.nombre&&e.jsx("p",{className:"text-sm text-red-500",children:a.nombre})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"estado",children:"Estado"}),e.jsxs(d,{value:i.estado,onValueChange:s=>r("estado",s),children:[e.jsx(t,{children:e.jsx(o,{placeholder:"Selecciona el estado"})}),e.jsxs(m,{children:[e.jsx(n,{value:"abierto",children:"Abierto"}),e.jsx(n,{value:"tramite",children:"En Trámite"}),e.jsx(n,{value:"revision",children:"En Revisión"}),e.jsx(n,{value:"cerrado",children:"Cerrado"}),e.jsx(n,{value:"archivado",children:"Archivado"})]})]}),a.estado&&e.jsx("p",{className:"text-sm text-red-500",children:a.estado})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"descripcion",children:"Descripción *"}),e.jsx(T,{id:"descripcion",value:i.descripcion,onChange:s=>r("descripcion",s.target.value),placeholder:"Describe el propósito y contenido del expediente",className:`min-h-[100px] ${a.descripcion?"border-red-500":""}`}),a.descripcion&&e.jsx("p",{className:"text-sm text-red-500",children:a.descripcion})]})]})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs(j,{className:"flex items-center space-x-2",children:[e.jsx(W,{className:"h-5 w-5"}),e.jsx("span",{children:"Fechas"})]}),e.jsx(p,{children:"Fechas de apertura y cierre del expediente"})]}),e.jsx(u,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"fecha_apertura",children:"Fecha de Apertura *"}),e.jsx(v,{id:"fecha_apertura",type:"date",value:i.fecha_apertura,onChange:s=>r("fecha_apertura",s.target.value),className:a.fecha_apertura?"border-red-500":""}),a.fecha_apertura&&e.jsx("p",{className:"text-sm text-red-500",children:a.fecha_apertura})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"fecha_cierre",children:"Fecha de Cierre"}),e.jsx(v,{id:"fecha_cierre",type:"date",value:i.fecha_cierre,onChange:s=>r("fecha_cierre",s.target.value),className:a.fecha_cierre?"border-red-500":""}),a.fecha_cierre&&e.jsx("p",{className:"text-sm text-red-500",children:a.fecha_cierre})]})]})})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(j,{children:"Clasificación Archivística"}),e.jsx(p,{children:"Serie y subserie documental según el CCD"})]}),e.jsx(u,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"clasificacion_serie",children:"Serie Documental *"}),e.jsxs(d,{value:i.clasificacion_serie,onValueChange:s=>r("clasificacion_serie",s),children:[e.jsx(t,{children:e.jsx(o,{placeholder:"Selecciona una serie"})}),e.jsx(m,{children:F.map(s=>e.jsxs(n,{value:s.nombre,children:[s.codigo," - ",s.nombre]},s.id))})]}),a.clasificacion_serie&&e.jsx("p",{className:"text-sm text-red-500",children:a.clasificacion_serie})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"clasificacion_subserie",children:"Subserie Documental"}),e.jsxs(d,{value:i.clasificacion_subserie,onValueChange:s=>r("clasificacion_subserie",s),disabled:!i.clasificacion_serie||D.length===0,children:[e.jsx(t,{children:e.jsx(o,{placeholder:"Selecciona una subserie"})}),e.jsx(m,{children:D.map(s=>e.jsxs(n,{value:s.nombre,children:[s.codigo," - ",s.nombre]},s.id))})]}),a.clasificacion_subserie&&e.jsx("p",{className:"text-sm text-red-500",children:a.clasificacion_subserie})]})]})})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs(j,{className:"flex items-center space-x-2",children:[e.jsx(K,{className:"h-5 w-5"}),e.jsx("span",{children:"Configuración"})]}),e.jsx(p,{children:"Configuración de funcionalidades del expediente"})]}),e.jsx(u,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{className:"text-base",children:"Documentos Electrónicos"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Permite agregar documentos digitales"})]}),e.jsx(C,{checked:i.permite_documentos_electronicos,onCheckedChange:s=>r("permite_documentos_electronicos",s)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{className:"text-base",children:"Firma Digital"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Requiere firma digital para documentos"})]}),e.jsx(C,{checked:i.requiere_firma_digital,onCheckedChange:s=>r("requiere_firma_digital",s)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{className:"text-base",children:"Control de Versiones"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Mantiene historial de versiones"})]}),e.jsx(C,{checked:i.control_versiones,onCheckedChange:s=>r("control_versiones",s)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{className:"text-base",children:"Notificaciones Automáticas"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Envía notificaciones sobre cambios"})]}),e.jsx(C,{checked:i.notificaciones_automaticas,onCheckedChange:s=>r("notificaciones_automaticas",s)})]})]})})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs(j,{className:"flex items-center space-x-2",children:[e.jsx(Y,{className:"h-5 w-5"}),e.jsx("span",{children:"Responsabilidad y Ubicación"})]}),e.jsx(p,{children:"Responsable y ubicación física del expediente"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"responsable",children:"Responsable *"}),e.jsxs(d,{value:i.responsable,onValueChange:s=>r("responsable",s),children:[e.jsx(t,{children:e.jsx(o,{placeholder:"Selecciona el responsable"})}),e.jsx(m,{children:q.map(s=>e.jsx(n,{value:s,children:s},s))})]}),a.responsable&&e.jsx("p",{className:"text-sm text-red-500",children:a.responsable})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"departamento",children:"Departamento *"}),e.jsxs(d,{value:i.departamento,onValueChange:s=>r("departamento",s),children:[e.jsx(t,{children:e.jsx(o,{placeholder:"Selecciona el departamento"})}),e.jsx(m,{children:R.map(s=>e.jsx(n,{value:s,children:s},s))})]}),a.departamento&&e.jsx("p",{className:"text-sm text-red-500",children:a.departamento})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"ubicacion_fisica",children:"Ubicación Física *"}),e.jsx(v,{id:"ubicacion_fisica",value:i.ubicacion_fisica,onChange:s=>r("ubicacion_fisica",s.target.value),placeholder:"Ej: Archivo Central - Estante A1 - Caja 001",className:a.ubicacion_fisica?"border-red-500":""}),a.ubicacion_fisica&&e.jsx("p",{className:"text-sm text-red-500",children:a.ubicacion_fisica})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"nivel_acceso",children:"Nivel de Acceso *"}),e.jsxs(d,{value:i.nivel_acceso,onValueChange:s=>r("nivel_acceso",s),children:[e.jsx(t,{children:e.jsx(o,{placeholder:"Selecciona el nivel de acceso"})}),e.jsxs(m,{children:[e.jsx(n,{value:"publico",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{children:"Público"})]})}),e.jsx(n,{value:"restringido",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{className:"h-4 w-4 text-yellow-600"}),e.jsx("span",{children:"Restringido"})]})}),e.jsx(n,{value:"confidencial",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{children:"Confidencial"})]})}),e.jsx(n,{value:"secreto",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{className:"h-4 w-4 text-red-800"}),e.jsx("span",{children:"Secreto"})]})})]})]}),a.nivel_acceso&&e.jsx("p",{className:"text-sm text-red-500",children:a.nivel_acceso})]})]})]})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs(j,{className:"flex items-center space-x-2",children:[e.jsx(Z,{className:"h-5 w-5"}),e.jsx("span",{children:"Palabras Clave y Observaciones"})]}),e.jsx(p,{children:"Palabras clave para búsqueda y observaciones adicionales"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Palabras Clave"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(v,{value:f,onChange:s=>A(s.target.value),onKeyPress:B,placeholder:"Escribe una palabra clave y presiona Enter",className:"flex-1"}),e.jsxs(b,{type:"button",onClick:k,disabled:!f.trim(),size:"sm",children:[e.jsx(ee,{className:"h-4 w-4"}),"Agregar"]})]}),i.palabras_clave.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:i.palabras_clave.map((s,g)=>e.jsxs(M,{variant:"secondary",className:"cursor-pointer",onClick:()=>I(s),children:[s,e.jsx(se,{className:"h-3 w-3 ml-1"})]},g))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"observaciones",children:"Observaciones"}),e.jsx(T,{id:"observaciones",value:i.observaciones,onChange:s=>r("observaciones",s.target.value),placeholder:"Observaciones adicionales sobre el expediente",className:"min-h-[100px]"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(b,{type:"button",variant:"outline",asChild:!0,children:e.jsx(_,{href:route("admin.expedientes.show",c.id),children:"Cancelar"})}),e.jsxs(b,{type:"submit",disabled:N||!S,children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),N?"Guardando...":"Guardar Cambios"]})]})]})]})}export{De as default};
