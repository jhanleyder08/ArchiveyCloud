import{r as _,j as e,H as J,L as j,b as c}from"./app-DmFTQNHU.js";import{f as K,w as Q,x as W,y as Y,z as Z,E as x,J as T}from"./app-sidebar-layout-B4-tSBlc.js";import{c as ee,B as d}from"./button-B9uqYTIR.js";import{C as i,a as E,b as F,c as n,d as se}from"./card-98qlzFSI.js";import{I}from"./input-CXpCTHGE.js";import{S,a as M,b as $,c as L,d as u}from"./select-CTcGm3Mb.js";import{F as ae,B as le}from"./Combination-DB4vhy5A.js";import{T as te,a as re,b as D,c as t,d as de,e as r}from"./table-EXaSuLM9.js";import{P as ce}from"./progress-DIu-V6Ji.js";import{D as f}from"./users-CA6jkooN.js";import{R as ie}from"./refresh-cw-BZG3D1r5.js";import{F as ne}from"./filter-DEn4yiOV.js";import{S as P}from"./search-BECONtiU.js";import{X as k}from"./x-D4OXCe6m.js";import{P as N}from"./play-DTp-URIP.js";import{C as z}from"./circle-check-big-DyCuRV4E.js";import{C as A}from"./circle-x-Cbxwk3Mf.js";import{T as oe}from"./triangle-alert-Qv0vinvY.js";import{C as q}from"./folder-CyqBlkrb.js";import{U as xe}from"./user-2vHAz8tr.js";import{E as me}from"./eye-CevU9AUM.js";import{T as he}from"./trash-2-DxjgEEuG.js";/* empty css            */import"./index-6lxVY5DU.js";import"./index-D6-3VAHV.js";import"./index-BBDU3XkM.js";import"./app-logo-icon-B1r3bsQj.js";import"./label-CYYsus1F.js";import"./mail-i7usF0Qz.js";import"./BrandingProvider-BKZadETt.js";import"./index-_200N-9v.js";import"./check-kl6Xjmwn.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],ue=ee("Ellipsis",je),B={expedientes:"ðŸ“",documentos:"ðŸ“„",series:"ðŸ“š",subseries:"ðŸ“–",usuarios:"ðŸ‘¥",trd:"ðŸ“‹",certificados:"ðŸ”",mixto:"ðŸ”„"},fe={csv:"ðŸ“Š",excel:"ðŸ“ˆ",json:"âš™ï¸",xml:"ðŸ·ï¸",sql:"ðŸ—„ï¸",zip:"ðŸ“¦"},pe={pendiente:{icon:q,color:"bg-yellow-100 text-yellow-800",label:"Pendiente"},procesando:{icon:N,color:"bg-blue-100 text-blue-800",label:"Procesando"},completada:{icon:z,color:"bg-green-100 text-green-800",label:"Completada"},fallida:{icon:A,color:"bg-red-100 text-red-800",label:"Fallida"},cancelada:{icon:oe,color:"bg-gray-100 text-gray-800",label:"Cancelada"}};function Qe({importaciones:a,filtros:g,tipos:v,estados:H}){const[b,w]=_.useState(g.buscar||""),[m,h]=_.useState(g),C=()=>{c.get("/admin/importaciones/listado",{...m,buscar:b})},R=()=>{w(""),h({}),c.get("/admin/importaciones/listado")},U=s=>{c.post(`/admin/importaciones/${s}/procesar`,{},{onSuccess:()=>{}})},V=s=>{confirm("Â¿EstÃ¡s seguro de que deseas cancelar esta importaciÃ³n?")&&c.post(`/admin/importaciones/${s}/cancelar`)},G=s=>{confirm("Â¿EstÃ¡s seguro de que deseas eliminar esta importaciÃ³n? Esta acciÃ³n no se puede deshacer.")&&c.delete(`/admin/importaciones/${s}`)},O=s=>{if(!s)return"-";if(s<60)return`${s}s`;if(s<3600){const o=Math.floor(s/60),X=s%60;return`${o}m ${X}s`}const l=Math.floor(s/3600),p=Math.floor(s%3600/60);return`${l}h ${p}m`},y=s=>new Date(s).toLocaleString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs(K,{children:[e.jsx(J,{title:"GestiÃ³n de Importaciones"}),e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:[e.jsx(f,{className:"h-8 w-8 text-blue-600"}),"GestiÃ³n de Importaciones"]}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Administra todas las importaciones de datos del sistema"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(d,{variant:"outline",onClick:()=>window.location.reload(),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Actualizar"]}),e.jsx(d,{asChild:!0,children:e.jsxs(j,{href:"/admin/importaciones/crear",children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"Nueva ImportaciÃ³n"]})})]})]}),e.jsxs(i,{children:[e.jsx(E,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-5 w-5"}),"Filtros de BÃºsqueda"]})}),e.jsxs(n,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Buscar"}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(I,{placeholder:"Nombre de importaciÃ³n...",value:b,onChange:s=>w(s.target.value),className:"pl-10",onKeyPress:s=>s.key==="Enter"&&C()})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Tipo"}),e.jsxs(S,{value:m.tipo||"_all",onValueChange:s=>h(l=>({...l,tipo:s==="_all"?void 0:s})),children:[e.jsx(M,{children:e.jsx($,{placeholder:"Todos los tipos"})}),e.jsxs(L,{children:[e.jsx(u,{value:"_all",children:"Todos los tipos"}),Object.entries(v).map(([s,l])=>e.jsxs(u,{value:s,children:[B[s]," ",l]},s))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Estado"}),e.jsxs(S,{value:m.estado||"_all",onValueChange:s=>h(l=>({...l,estado:s==="_all"?void 0:s})),children:[e.jsx(M,{children:e.jsx($,{placeholder:"Todos los estados"})}),e.jsxs(L,{children:[e.jsx(u,{value:"_all",children:"Todos los estados"}),Object.entries(H).map(([s,l])=>e.jsx(u,{value:s,children:l},s))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Fecha desde"}),e.jsx(I,{type:"date",value:m.fecha_desde||"",onChange:s=>h(l=>({...l,fecha_desde:s.target.value||void 0}))})]})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[e.jsxs(d,{onClick:C,children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Aplicar Filtros"]}),e.jsxs(d,{variant:"outline",onClick:R,children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Limpiar"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold",children:a?.meta?.total??a?.total??0})]}),e.jsx(ae,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"En Proceso"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:(a?.data??[]).filter(s=>s.estado==="procesando").length})]}),e.jsx(N,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Completadas"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:(a?.data??[]).filter(s=>s.estado==="completada").length})]}),e.jsx(z,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Fallidas"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:(a?.data??[]).filter(s=>s.estado==="fallida").length})]}),e.jsx(A,{className:"h-8 w-8 text-red-600"})]})})})]}),e.jsxs(i,{children:[e.jsxs(E,{children:[e.jsx(F,{children:"Lista de Importaciones"}),e.jsxs(se,{children:["Mostrando ",a?.meta?.from??a?.from??0," - ",a?.meta?.to??a?.to??0," de ",a?.meta?.total??a?.total??0," importaciones"]})]}),e.jsxs(n,{children:[e.jsxs("div",{className:"rounded-md border",children:[e.jsxs(te,{children:[e.jsx(re,{children:e.jsxs(D,{children:[e.jsx(t,{children:"ImportaciÃ³n"}),e.jsx(t,{children:"Tipo"}),e.jsx(t,{children:"Estado"}),e.jsx(t,{children:"Progreso"}),e.jsx(t,{children:"Resultados"}),e.jsx(t,{children:"Usuario"}),e.jsx(t,{children:"Tiempo"}),e.jsx(t,{children:"Fecha"}),e.jsx(t,{children:"Acciones"})]})}),e.jsx(de,{children:(a?.data??[]).map(s=>{const l=pe[s.estado],p=l?.icon||q;return e.jsxs(D,{children:[e.jsx(r,{children:e.jsxs("div",{children:[e.jsx(j,{href:`/admin/importaciones/${s.id}`,className:"font-medium hover:underline",children:s.nombre}),s.descripcion&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.descripcion})]})}),e.jsx(r,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:B[s.tipo]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:v[s.tipo]}),e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[fe[s.formato_origen],s.formato_origen.toUpperCase()]})]})]})}),e.jsxs(r,{children:[e.jsxs(le,{className:l?.color,children:[e.jsx(p,{className:"h-3 w-3 mr-1"}),l?.label||s.estado]}),s.mensaje_error&&e.jsxs("p",{className:"text-xs text-red-600 mt-1",children:[s.mensaje_error.substring(0,50),"..."]})]}),e.jsx(r,{children:s.estado==="procesando"?e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{children:[s.registros_procesados," / ",s.total_registros]}),e.jsxs("span",{className:"font-medium",children:[parseFloat(s.porcentaje_avance||0).toFixed(1),"%"]})]}),e.jsx(ce,{value:parseFloat(s.porcentaje_avance||0),className:"h-2"})]}):s.estado==="completada"?e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-green-600",children:"âœ“ Completada"}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.total_registros," registros"]})]}):e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.total_registros," registros"]})}),e.jsxs(r,{children:[s.estado==="completada"&&e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"text-green-600",children:["âœ“ ",s.registros_exitosos," exitosos"]}),s.registros_fallidos>0&&e.jsxs("div",{className:"text-red-600",children:["âœ— ",s.registros_fallidos," fallidos"]})]}),s.estado==="fallida"&&e.jsx("div",{className:"text-sm text-red-600",children:"Error en procesamiento"})]}),e.jsx(r,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:s.usuario?.name||"Usuario no disponible"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:s.usuario?.email||"Email no disponible"})]})]})}),e.jsx(r,{children:e.jsx("div",{className:"text-sm",children:O(s.tiempo_procesamiento)})}),e.jsx(r,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{children:y(s.created_at)}),s.fecha_finalizacion&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Fin: ",y(s.fecha_finalizacion)]})]})}),e.jsx(r,{children:e.jsxs(Q,{children:[e.jsx(W,{asChild:!0,children:e.jsx(d,{variant:"ghost",className:"h-8 w-8 p-0",children:e.jsx(ue,{className:"h-4 w-4"})})}),e.jsxs(Y,{align:"end",children:[e.jsx(Z,{children:"Acciones"}),e.jsx(x,{asChild:!0,children:e.jsxs(j,{href:`/admin/importaciones/${s.id}`,children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),"Ver detalles"]})}),s.estado==="pendiente"&&e.jsxs(x,{onClick:()=>U(s.id),children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"Procesar"]}),(s.estado==="pendiente"||s.estado==="procesando")&&e.jsxs(x,{onClick:()=>V(s.id),children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Cancelar"]}),e.jsx(T,{}),(s.archivos_generados??[]).map(o=>e.jsx(x,{asChild:!0,children:e.jsxs("a",{href:`/admin/importaciones/${s.id}/descargar/${o.tipo}`,children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),o.nombre]})},o.tipo)),(s.estado==="pendiente"||s.estado==="fallida"||s.estado==="cancelada")&&e.jsxs(e.Fragment,{children:[e.jsx(T,{}),e.jsxs(x,{onClick:()=>G(s.id),className:"text-red-600",children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"Eliminar"]})]})]})]})})]},s.id)})})]}),(a?.data??[]).length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(f,{className:"h-12 w-12 mx-auto text-muted-foreground opacity-50"}),e.jsx("h3",{className:"mt-4 text-lg font-semibold",children:"No hay importaciones"}),e.jsx("p",{className:"text-muted-foreground",children:"No se encontraron importaciones con los filtros aplicados."}),e.jsx(d,{asChild:!0,className:"mt-4",children:e.jsx(j,{href:"/admin/importaciones/crear",children:"Crear primera importaciÃ³n"})})]})]}),(a?.meta?.last_page??a?.last_page??1)>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Mostrando ",a?.meta?.from??a?.from??0," a ",a?.meta?.to??a?.to??0," de ",a?.meta?.total??a?.total??0," resultados"]}),e.jsx("div",{className:"flex items-center space-x-2",children:(a?.links??[]).map((s,l)=>e.jsx(d,{variant:s.active?"default":"outline",size:"sm",disabled:!s.url,onClick:()=>s.url&&c.get(s.url),dangerouslySetInnerHTML:{__html:s.label}},l))})]})]})]})]})]})}export{Qe as default};
