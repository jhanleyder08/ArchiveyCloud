import{r as o,u as K,j as e,H as Q,L as U}from"./app-C5ckqBIp.js";import{A as W}from"./app-layout-DGpHzsZj.js";import{B as d}from"./button-C_wizhg3.js";import{I as l}from"./input-DjB33T14.js";import{L as n}from"./label-D9bm4s2r.js";import{A as X,i as z,T as O}from"./app-sidebar-layout-B-YWzudl.js";import{C as v,a as y,b as _,d as Y,c as C}from"./card-C_VOERQk.js";import{A as x,a as u}from"./alert-DyllTe_s.js";import{F as q}from"./Combination-CIeNRLzY.js";import{S as k}from"./search-CVtN_EcY.js";import{C as I}from"./circle-check-big-BhkhaQeQ.js";import{U as ee}from"./user-2UwuEIUF.js";import{C as se}from"./calendar-DWIY_Qm5.js";import{S as ae}from"./save-C6AcJQoX.js";/* empty css            */import"./index-D_U0JQiI.js";import"./index-C72nIoIT.js";import"./index-z-hyAKzV.js";import"./x-Cc5GKSP1.js";import"./app-logo-icon-EYLFXuBA.js";import"./mail-DhzsRTCw.js";import"./users-Bu6eepbM.js";import"./folder-9RT5E6CU.js";import"./triangle-alert-c3kReHiM.js";import"./BrandingProvider-ZsHKNxl6.js";const ie=[{value:"conservacion_permanente",label:"Conservación Permanente"},{value:"eliminacion_controlada",label:"Eliminación Controlada"},{value:"transferencia_historica",label:"Transferencia Histórica"},{value:"digitalizacion",label:"Digitalización"},{value:"microfilmacion",label:"Microfilmación"}];function Fe({expedientesVencimiento:M,documentosVencimiento:H,usuarios:h,errors:r}){const j=M||[],b=H||[],[c,w]=o.useState(""),[m,S]=o.useState(""),[p,g]=o.useState(""),[E,P]=o.useState(!1),[f,A]=o.useState([]),[N,B]=o.useState([]),[$,T]=o.useState([]),{data:a,setData:i,post:J,processing:R,isDirty:V}=K({tipo_item:"expediente",expediente_id:"",documento_id:"",tipo_disposicion:"",justificacion:"",observaciones:"",fecha_propuesta:"",responsable_id:"",responsable_externo_nombre:"",responsable_externo_cargo:"",responsable_externo_entidad:"",responsable_externo_email:""});o.useEffect(()=>{if(c){const s=j.filter(t=>t.codigo.toLowerCase().includes(c.toLowerCase())||t.titulo.toLowerCase().includes(c.toLowerCase())).slice(0,10);A(s)}else A(j.slice(0,10))},[c,j]),o.useEffect(()=>{if(m){const s=b.filter(t=>t.titulo.toLowerCase().includes(m.toLowerCase())||t.expediente.codigo.toLowerCase().includes(m.toLowerCase())).slice(0,10);B(s)}else B(b.slice(0,10))},[m,b]),o.useEffect(()=>{if(p){const s=h.filter(t=>t.name.toLowerCase().includes(p.toLowerCase())||t.email.toLowerCase().includes(p.toLowerCase())).slice(0,10);T(s)}else T(h.slice(0,10))},[p,h]);const D=j.find(s=>s.id.toString()===a.expediente_id),F=b.find(s=>s.id.toString()===a.documento_id),L=h.find(s=>s.id.toString()===a.responsable_id),Z=s=>{s.preventDefault(),console.log("=== SUBMIT DISPOSICION ==="),console.log("Datos del formulario:",a),console.log("Route:",route("admin.disposiciones.store")),J(route("admin.disposiciones.store"),{onSuccess:t=>{console.log("✅ SUCCESS:",t)},onError:t=>{console.error("❌ ERRORES DE VALIDACIÓN:",t)},onFinish:()=>{console.log("⏹️ PETICIÓN FINALIZADA")}})},G=new Date().toISOString().split("T")[0];return e.jsxs(W,{children:[e.jsx(Q,{title:"Nueva Disposición Final"}),e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(d,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(U,{href:route("admin.disposiciones.index"),children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Volver"]})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"Nueva Disposición Final"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Crear una nueva propuesta de disposición final documental"})]})]})}),e.jsxs("form",{onSubmit:Z,className:"space-y-6",children:[e.jsxs(v,{children:[e.jsxs(y,{children:[e.jsx(_,{children:"Tipo de Item"}),e.jsx(Y,{children:"Selecciona si la disposición se aplicará a un expediente o documento"})]}),e.jsx(C,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("button",{type:"button",onClick:()=>i("tipo_item","expediente"),className:`p-4 border rounded-lg text-left transition-colors ${a.tipo_item==="expediente"?"border-primary bg-primary/5":"border-border hover:border-primary/50"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(z,{className:`h-6 w-6 ${a.tipo_item==="expediente"?"text-primary":"text-muted-foreground"}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Expediente Completo"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Aplicar a expediente completo"})]})]})}),e.jsx("button",{type:"button",onClick:()=>i("tipo_item","documento"),className:`p-4 border rounded-lg text-left transition-colors ${a.tipo_item==="documento"?"border-primary bg-primary/5":"border-border hover:border-primary/50"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(q,{className:`h-6 w-6 ${a.tipo_item==="documento"?"text-primary":"text-muted-foreground"}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Documento Individual"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Aplicar a documento específico"})]})]})})]})})]}),e.jsxs(v,{children:[e.jsx(y,{children:e.jsxs(_,{className:"flex items-center space-x-2",children:[a.tipo_item==="expediente"?e.jsx(z,{className:"h-5 w-5"}):e.jsx(q,{className:"h-5 w-5"}),e.jsxs("span",{children:["Seleccionar ",a.tipo_item==="expediente"?"Expediente":"Documento"]})]})}),e.jsx(C,{className:"space-y-4",children:a.tipo_item==="expediente"?e.jsxs(e.Fragment,{children:[D?e.jsxs(x,{className:"bg-primary/5 border-primary",children:[e.jsx(I,{className:"h-4 w-4 text-primary"}),e.jsxs(u,{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:D.codigo}),e.jsx("p",{className:"text-sm text-muted-foreground",children:D.titulo})]}),e.jsx(d,{type:"button",variant:"ghost",size:"sm",onClick:()=>{i("expediente_id",""),w("")},children:"Cambiar"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Buscar Expediente"}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground"}),e.jsx(l,{placeholder:"Buscar por código o nombre...",value:c,onChange:s=>w(s.target.value),className:"pl-10"})]})]}),f.length>0?e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto border rounded-lg p-2 bg-background shadow-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground px-2 py-1",children:c?`${f.length} resultados`:`Mostrando ${f.length} expedientes disponibles`}),f.map(s=>e.jsxs("div",{className:"p-3 rounded-lg cursor-pointer transition-colors hover:bg-primary/10 border border-transparent hover:border-primary",onClick:()=>{i("expediente_id",s.id.toString()),w("")},children:[e.jsx("h4",{className:"font-medium",children:s.codigo}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.titulo})]},s.id))]}):e.jsx(x,{children:e.jsx(u,{children:"No hay expedientes disponibles para disposición final."})})]}),r.expediente_id&&e.jsx("p",{className:"text-sm text-red-500",children:r.expediente_id})]}):e.jsxs(e.Fragment,{children:[F?e.jsxs(x,{className:"bg-primary/5 border-primary",children:[e.jsx(I,{className:"h-4 w-4 text-primary"}),e.jsxs(u,{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:F.titulo}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Expediente: ",F.expediente.codigo]})]}),e.jsx(d,{type:"button",variant:"ghost",size:"sm",onClick:()=>{i("documento_id",""),S("")},children:"Cambiar"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Buscar Documento"}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground"}),e.jsx(l,{placeholder:"Buscar por nombre...",value:m,onChange:s=>S(s.target.value),className:"pl-10"})]})]}),N.length>0?e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto border rounded-lg p-2 bg-background shadow-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground px-2 py-1",children:m?`${N.length} resultados`:`Mostrando ${N.length} documentos disponibles`}),N.map(s=>e.jsxs("div",{className:"p-3 rounded-lg cursor-pointer transition-colors hover:bg-primary/10 border border-transparent hover:border-primary",onClick:()=>{i("documento_id",s.id.toString()),S("")},children:[e.jsx("h4",{className:"font-medium",children:s.titulo}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Expediente: ",s.expediente.codigo]})]},s.id))]}):e.jsx(x,{children:e.jsx(u,{children:"No hay documentos disponibles para disposición final."})})]}),r.documento_id&&e.jsx("p",{className:"text-sm text-red-500",children:r.documento_id})]})})]}),e.jsxs(v,{children:[e.jsx(y,{children:e.jsx(_,{children:"Tipo de Disposición Final"})}),e.jsxs(C,{children:[e.jsx("div",{className:"space-y-3",children:ie.map(s=>e.jsx("div",{className:`p-4 border rounded-lg cursor-pointer transition-colors ${a.tipo_disposicion===s.value?"border-primary bg-primary/5":"border-border hover:border-primary/50"}`,onClick:()=>i("tipo_disposicion",s.value),children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${a.tipo_disposicion===s.value?"bg-primary border-primary":"border-gray-300"}`}),e.jsx("span",{className:"font-medium",children:s.label})]})},s.value))}),r.tipo_disposicion&&e.jsx("p",{className:"text-sm text-red-500 mt-2",children:r.tipo_disposicion})]})]}),e.jsxs(v,{children:[e.jsx(y,{children:e.jsxs(_,{className:"flex items-center space-x-2",children:[e.jsx(ee,{className:"h-5 w-5"}),e.jsx("span",{children:"Información de la Disposición"})]})}),e.jsxs(C,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{children:"Responsable *"}),e.jsx(d,{type:"button",variant:"outline",size:"sm",onClick:()=>{P(!E),i("responsable_id",""),g("")},children:E?"Usuario Registrado":"Usuario Externo"})]}),E?e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-muted/50",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Ingrese los datos del responsable externo"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Nombre Completo *"}),e.jsx(l,{placeholder:"Nombre del responsable",value:a.responsable_externo_nombre,onChange:s=>i("responsable_externo_nombre",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Cargo *"}),e.jsx(l,{placeholder:"Cargo o posición",value:a.responsable_externo_cargo,onChange:s=>i("responsable_externo_cargo",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Entidad *"}),e.jsx(l,{placeholder:"Nombre de la entidad",value:a.responsable_externo_entidad,onChange:s=>i("responsable_externo_entidad",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Email"}),e.jsx(l,{type:"email",placeholder:"correo@ejemplo.com",value:a.responsable_externo_email,onChange:s=>i("responsable_externo_email",s.target.value)})]})]})]}):e.jsxs(e.Fragment,{children:[L?e.jsxs(x,{className:"bg-primary/5 border-primary",children:[e.jsx(I,{className:"h-4 w-4 text-primary"}),e.jsxs(u,{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:L.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:L.email})]}),e.jsx(d,{type:"button",variant:"ghost",size:"sm",onClick:()=>{i("responsable_id",""),g("")},children:"Cambiar"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground"}),e.jsx(l,{placeholder:"Buscar usuario registrado...",value:p,onChange:s=>g(s.target.value),className:"pl-10"})]}),p&&$.length>0&&e.jsx("div",{className:"space-y-1 max-h-60 overflow-y-auto border rounded-lg p-2 bg-background shadow-lg",children:$.map(s=>e.jsxs("div",{className:"p-3 rounded-lg cursor-pointer transition-colors hover:bg-primary/10 border border-transparent hover:border-primary",onClick:()=>{i("responsable_id",s.id.toString()),g("")},children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.email})]},s.id))})]}),r.responsable_id&&e.jsx("p",{className:"text-sm text-red-500",children:r.responsable_id})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{className:"flex items-center space-x-2",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{children:"Fecha de Propuesta *"})]}),e.jsx(l,{type:"date",min:G,value:a.fecha_propuesta,onChange:s=>i("fecha_propuesta",s.target.value),className:r.fecha_propuesta?"border-red-500":""}),r.fecha_propuesta&&e.jsx("p",{className:"text-sm text-red-500",children:r.fecha_propuesta})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Justificación *"}),e.jsx(O,{placeholder:"Justifica la necesidad...",value:a.justificacion,onChange:s=>i("justificacion",s.target.value),className:`min-h-[100px] ${r.justificacion?"border-red-500":""}`}),r.justificacion&&e.jsx("p",{className:"text-sm text-red-500",children:r.justificacion})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Observaciones"}),e.jsx(O,{placeholder:"Observaciones adicionales (opcional)",value:a.observaciones,onChange:s=>i("observaciones",s.target.value),className:"min-h-[80px]"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(d,{type:"button",variant:"outline",asChild:!0,children:e.jsx(U,{href:route("admin.disposiciones.index"),children:"Cancelar"})}),e.jsxs(d,{type:"submit",disabled:R||!V,children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),R?"Creando...":"Crear Disposición"]})]})]})]})}export{Fe as default};
