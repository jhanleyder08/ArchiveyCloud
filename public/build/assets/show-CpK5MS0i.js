import{r as o,j as e,H as ce,L as I,a as b}from"./app-BV8yjCq7.js";import{u as le,l as de,m as B,R as me,I as xe,A as he,n as ue,a as pe,D as P,c as F,d as L,e as $,f as M,T as q,o as R,t as y}from"./app-layout-xptsXUqV.js";import{c as G,a as A,B as p}from"./app-logo-icon-BhHHxLi4.js";import{B as D}from"./badge-Choz21Ea.js";import{C as N}from"./card-DVLfGmNh.js";import{u as fe,c as je,a as S,P as ve}from"./index-C-gP6wGF.js";import{P as _,L as v,I as ge}from"./label-CN-Cuv_T.js";import{C as V}from"./checkbox-DjmyH9fn.js";import{A as be}from"./arrow-left-BR8r42OJ.js";import{C as ye}from"./circle-pause-CC7OGEOO.js";import{L as Ne}from"./lock-BC3A7QNl.js";/* empty css            */import"./index-BLDVcN3u.js";import"./index-CpeI76ZV.js";import"./check-BqPRUSNK.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]],we=G("CirclePlay",_e);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],ze=G("LockOpen",Ce);var w="Tabs",[De,Qe]=je(w,[B]),O=B(),[Se,k]=De(w),H=o.forwardRef((a,i)=>{const{__scopeTabs:t,value:n,onValueChange:d,defaultValue:h,orientation:r="horizontal",dir:m,activationMode:j="automatic",...u}=a,x=le(m),[c,l]=fe({prop:n,onChange:d,defaultProp:h??"",caller:w});return e.jsx(Se,{scope:t,baseId:de(),value:c,onValueChange:l,orientation:r,dir:x,activationMode:j,children:e.jsx(_.div,{dir:x,"data-orientation":r,...u,ref:i})})});H.displayName=w;var K="TabsList",J=o.forwardRef((a,i)=>{const{__scopeTabs:t,loop:n=!0,...d}=a,h=k(K,t),r=O(t);return e.jsx(me,{asChild:!0,...r,orientation:h.orientation,dir:h.dir,loop:n,children:e.jsx(_.div,{role:"tablist","aria-orientation":h.orientation,...d,ref:i})})});J.displayName=K;var Q="TabsTrigger",U=o.forwardRef((a,i)=>{const{__scopeTabs:t,value:n,disabled:d=!1,...h}=a,r=k(Q,t),m=O(t),j=Y(r.baseId,n),u=Z(r.baseId,n),x=n===r.value;return e.jsx(xe,{asChild:!0,...m,focusable:!d,active:x,children:e.jsx(_.button,{type:"button",role:"tab","aria-selected":x,"aria-controls":u,"data-state":x?"active":"inactive","data-disabled":d?"":void 0,disabled:d,id:j,...h,ref:i,onMouseDown:S(a.onMouseDown,c=>{!d&&c.button===0&&c.ctrlKey===!1?r.onValueChange(n):c.preventDefault()}),onKeyDown:S(a.onKeyDown,c=>{[" ","Enter"].includes(c.key)&&r.onValueChange(n)}),onFocus:S(a.onFocus,()=>{const c=r.activationMode!=="manual";!x&&!d&&c&&r.onValueChange(n)})})})});U.displayName=Q;var W="TabsContent",X=o.forwardRef((a,i)=>{const{__scopeTabs:t,value:n,forceMount:d,children:h,...r}=a,m=k(W,t),j=Y(m.baseId,n),u=Z(m.baseId,n),x=n===m.value,c=o.useRef(x);return o.useEffect(()=>{const l=requestAnimationFrame(()=>c.current=!1);return()=>cancelAnimationFrame(l)},[]),e.jsx(ve,{present:d||x,children:({present:l})=>e.jsx(_.div,{"data-state":x?"active":"inactive","data-orientation":m.orientation,role:"tabpanel","aria-labelledby":j,hidden:!l,id:u,tabIndex:0,...r,ref:i,style:{...a.style,animationDuration:c.current?"0s":void 0},children:l&&h})})});X.displayName=W;function Y(a,i){return`${a}-trigger-${i}`}function Z(a,i){return`${a}-content-${i}`}var Te=H,ee=J,ae=U,se=X;const Ee=Te,ie=o.forwardRef(({className:a,...i},t)=>e.jsx(ee,{ref:t,className:A("inline-flex h-10 items-center justify-center rounded-md bg-gray-100 p-1 text-gray-500",a),...i}));ie.displayName=ee.displayName;const T=o.forwardRef(({className:a,...i},t)=>e.jsx(ae,{ref:t,className:A("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-white transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:text-gray-950 data-[state=active]:shadow-sm",a),...i}));T.displayName=ae.displayName;const E=o.forwardRef(({className:a,...i},t)=>e.jsx(se,{ref:t,className:A("mt-2 ring-offset-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2",a),...i}));E.displayName=se.displayName;function Ue({proceso:a,diasRestantes:i,alertasActivas:t,integridadValida:n,acciones_disponibles:d,flash:h}){const[r,m]=o.useState(!1),[j,u]=o.useState(!1),[x,c]=o.useState(!1),[l,C]=o.useState({accion:"",observaciones:"",confirmacion:!1}),[f,z]=o.useState({fecha_fin_aplazamiento:"",razon_aplazamiento:"",confirmacion:!1}),[Ae,ke]=o.useState({razon_bloqueo:""}),te=s=>{switch(s){case"activo":return"bg-green-100 text-green-800";case"alerta_previa":return"bg-yellow-100 text-yellow-800";case"vencido":return"bg-red-100 text-red-800";case"en_disposicion":return"bg-blue-100 text-blue-800";case"transferido":return"bg-purple-100 text-purple-800";case"eliminado":return"bg-gray-100 text-gray-800";case"conservado":return"bg-emerald-100 text-emerald-800";case"aplazado":return"bg-orange-100 text-orange-800";case"suspendido":return"bg-gray-100 text-gray-600";default:return"bg-gray-100 text-gray-600"}},ne=s=>({activo:"Activo",alerta_previa:"Alerta Previa",vencido:"Vencido",en_disposicion:"En Disposición",transferido:"Transferido",eliminado:"Eliminado",conservado:"Conservado",aplazado:"Aplazado",suspendido:"Suspendido"})[s]||s,re=s=>{s.preventDefault(),b.post(`/admin/retencion-disposicion/${a.id}/ejecutar-disposicion`,l,{onSuccess:()=>{m(!1),y.success("Acción de disposición ejecutada correctamente")},onError:()=>{y.error("Error al ejecutar la disposición")}})},oe=s=>{s.preventDefault(),b.post(`/admin/retencion-disposicion/${a.id}/aplazar`,f,{onSuccess:()=>{u(!1),y.success("Disposición aplazada correctamente")},onError:()=>{y.error("Error al aplazar la disposición")}})};return e.jsxs(he,{children:[e.jsx(ce,{title:`Proceso ${a.codigo_proceso}`}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2",children:[e.jsx(I,{href:"/admin/retencion-disposicion",className:"hover:text-gray-900",children:"Retención y Disposición"}),e.jsx(ue,{className:"h-4 w-4"}),e.jsx("span",{className:"text-gray-900",children:a.codigo_proceso})]}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Proceso de Retención: ",a.codigo_proceso]}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:a.tipo_entidad==="documento"?`Documento: ${a.documento?.titulo||"Sin título"}`:`Expediente: ${a.expediente?.titulo||"Sin título"}`})]}),e.jsx(I,{href:"/admin/retencion-disposicion",children:e.jsxs(p,{variant:"outline",children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Volver"]})})]})]}),i<=0&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 mb-6",children:e.jsxs("div",{className:"flex",children:[e.jsx(pe,{className:"h-5 w-5 text-red-400"}),e.jsx("div",{className:"ml-3",children:e.jsxs("p",{className:"text-sm text-red-700",children:[e.jsx("strong",{children:"Atención:"})," Este proceso ha vencido y requiere disposición inmediata.",i<0&&` Vencido hace ${Math.abs(i)} días.`]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs(N,{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Información del Proceso"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Estado actual"}),e.jsx(D,{className:`${te(a.estado)} mt-1`,children:ne(a.estado)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Tipo de entidad"}),e.jsx("p",{className:"font-medium capitalize",children:a.tipo_entidad})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"TRD aplicada"}),e.jsx("p",{className:"font-medium",children:a.trd?.nombre||"No especificada"}),a.trd?.version&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Versión ",a.trd.version]})]}),a.serie_documental&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Serie documental"}),e.jsx("p",{className:"font-medium",children:a.serie_documental.nombre})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Fecha creación documento"}),e.jsx("p",{className:"font-medium",children:new Date(a.fecha_creacion_documento).toLocaleDateString("es-ES")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Vencimiento archivo gestión"}),e.jsx("p",{className:"font-medium",children:new Date(a.fecha_vencimiento_gestion).toLocaleDateString("es-ES")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Vencimiento archivo central"}),e.jsx("p",{className:"font-medium",children:new Date(a.fecha_vencimiento_central).toLocaleDateString("es-ES")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Días hasta vencimiento"}),e.jsx("p",{className:`font-bold ${i<=0?"text-red-600":i<=30?"text-yellow-600":"text-green-600"}`,children:i>0?`${i} días`:i===0?"Vence hoy":`Vencido hace ${Math.abs(i)} días`})]})]}),a.aplazado&&e.jsxs("div",{className:"mt-4 p-4 bg-orange-50 rounded-lg",children:[e.jsxs("h3",{className:"text-sm font-semibold text-orange-800 mb-2",children:[e.jsx(ye,{className:"inline h-4 w-4 mr-1"}),"Proceso Aplazado"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[a.fecha_fin_aplazamiento&&e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-600",children:"Fin del aplazamiento:"})," ",new Date(a.fecha_fin_aplazamiento).toLocaleDateString("es-ES")]}),a.razon_aplazamiento&&e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-600",children:"Razón:"})," ",a.razon_aplazamiento]})]})]})]}),e.jsx(N,{className:"p-6 mt-6",children:e.jsxs(Ee,{defaultValue:"historial",children:[e.jsxs(ie,{children:[e.jsx(T,{value:"historial",children:"Historial"}),e.jsx(T,{value:"alertas",children:"Alertas"})]}),e.jsx(E,{value:"historial",className:"mt-4",children:e.jsx("div",{className:"space-y-3",children:a.historial_acciones&&a.historial_acciones.length>0?a.historial_acciones.slice(0,5).map((s,g)=>e.jsxs("div",{className:"border-l-2 border-gray-200 pl-4 pb-3",children:[e.jsx("p",{className:"text-sm",children:s.descripcion_accion}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(s.fecha_accion).toLocaleString("es-ES")})]},g)):e.jsx("p",{className:"text-sm text-gray-500",children:"No hay historial disponible"})})}),e.jsx(E,{value:"alertas",className:"mt-4",children:e.jsx("div",{className:"space-y-3",children:a.alertas&&a.alertas.length>0?a.alertas.slice(0,5).map((s,g)=>e.jsxs("div",{className:"border rounded p-3",children:[e.jsx("h4",{className:"font-medium text-sm",children:s.titulo_alerta}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:s.mensaje_alerta})]},g)):e.jsx("p",{className:"text-sm text-gray-500",children:"No hay alertas disponibles"})})})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(N,{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Acciones Disponibles"}),e.jsxs("div",{className:"space-y-2",children:[d.map(s=>e.jsx(p,{variant:"outline",className:"w-full justify-start",onClick:()=>{s.key==="aplazar"?u(!0):(C({...l,accion:s.key}),m(!0))},children:e.jsx("span",{className:"ml-2",children:s.label})},s.key)),a.aplazado&&e.jsxs(p,{variant:"outline",className:"w-full justify-start",onClick:()=>b.post(`/admin/retencion-disposicion/${a.id}/reactivar`),children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Reactivar Proceso"]}),a.bloqueado_eliminacion?e.jsxs(p,{variant:"outline",className:"w-full justify-start",onClick:()=>b.post(`/admin/retencion-disposicion/${a.id}/desbloquear-eliminacion`),children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),"Desbloquear Eliminación"]}):e.jsxs(p,{variant:"outline",className:"w-full justify-start",onClick:()=>c(!0),children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Bloquear Eliminación"]})]})]}),e.jsxs(N,{className:"p-6",children:[e.jsx("h3",{className:"text-sm font-semibold mb-3",children:"Indicadores"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Alertas activas"}),e.jsx(D,{variant:t>0?"destructive":"secondary",children:t})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Integridad"}),e.jsx(D,{variant:n?"default":"destructive",children:n?"Válida":"Comprometida"})]})]})]})]})]})]}),e.jsx(P,{open:r,onOpenChange:m,children:e.jsxs(F,{children:[e.jsxs(L,{children:[e.jsx($,{children:"Ejecutar Disposición"}),e.jsx(M,{children:"Esta acción es irreversible. Por favor, confirme que desea proceder."})]}),e.jsxs("form",{onSubmit:re,children:[e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx(v,{children:"Observaciones"}),e.jsx(q,{value:l.observaciones,onChange:s=>C({...l,observaciones:s.target.value}),placeholder:"Ingrese observaciones adicionales..."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(V,{id:"confirmacion",checked:l.confirmacion,onCheckedChange:s=>C({...l,confirmacion:!!s})}),e.jsx(v,{htmlFor:"confirmacion",children:"Confirmo que deseo ejecutar esta acción"})]})]}),e.jsxs(R,{children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>m(!1),children:"Cancelar"}),e.jsx(p,{type:"submit",disabled:!l.confirmacion,children:"Ejecutar"})]})]})]})}),e.jsx(P,{open:j,onOpenChange:u,children:e.jsxs(F,{children:[e.jsxs(L,{children:[e.jsx($,{children:"Aplazar Disposición"}),e.jsx(M,{children:"Indique la fecha hasta la cual desea aplazar la disposición."})]}),e.jsxs("form",{onSubmit:oe,children:[e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx(v,{children:"Fecha fin de aplazamiento"}),e.jsx(ge,{type:"date",value:f.fecha_fin_aplazamiento,onChange:s=>z({...f,fecha_fin_aplazamiento:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(v,{children:"Razón del aplazamiento"}),e.jsx(q,{value:f.razon_aplazamiento,onChange:s=>z({...f,razon_aplazamiento:s.target.value}),placeholder:"Explique la razón del aplazamiento...",required:!0})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(V,{id:"confirmacion-aplazar",checked:f.confirmacion,onCheckedChange:s=>z({...f,confirmacion:!!s})}),e.jsx(v,{htmlFor:"confirmacion-aplazar",children:"Confirmo el aplazamiento"})]})]}),e.jsxs(R,{children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>u(!1),children:"Cancelar"}),e.jsx(p,{type:"submit",disabled:!f.confirmacion,children:"Aplazar"})]})]})]})})]})}export{Ue as default};
