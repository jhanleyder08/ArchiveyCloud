import{r as o,j as e,H as B,a as u,b as j}from"./app-DOeYTPnE.js";import{A}from"./app-layout-CKT_ksyH.js";import{C as g,a as f,b as C,d as N,c as v}from"./card-BEZSel9K.js";import{c as T,B as n}from"./button-BB3j1qH9.js";import{B as y}from"./badge-BDHWk-Qv.js";import{L as D}from"./label-BvABT9uR.js";import{S as M,a as V,b as E,c as L,d as l}from"./select-D2zOlv3c.js";import{A as H,a as q}from"./alert-Dl-auDCw.js";import{F as S}from"./index-Cl_hWV--.js";import{C as b}from"./user-BiSWd6pJ.js";import{C as U}from"./circle-check-BLdhJYvh.js";/* empty css            */import"./app-sidebar-layout-83PL_wom.js";import"./index-B5i9qy2Y.js";import"./index-BuQaqXjb.js";import"./index-C7D1JV-H.js";import"./x-BHxLkKP3.js";import"./index-sj4qH-fg.js";import"./app-logo-icon-BTiqVlKS.js";import"./triangle-alert-B7e9hRq_.js";import"./index-pqvegj4w.js";import"./check-C4IDWgVr.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]],d=T("Scan",$);function xe({documentos:i}){const[t,m]=o.useState([]),[p,x]=o.useState({}),[h,_]=o.useState("tesseract"),[c,r]=o.useState(null),w=async s=>{x(a=>({...a,[s]:!0})),r(null);try{const a=await u.post(`/ocr/process/${s}`,{engine:h,async:!0});r({type:"success",message:a.data.message||"OCR iniciado correctamente"}),setTimeout(()=>j.reload(),2e3)}catch(a){r({type:"error",message:a.response?.data?.message||"Error al procesar OCR"})}finally{x(a=>({...a,[s]:!1}))}},k=async()=>{if(t.length===0){r({type:"error",message:"Selecciona al menos un documento"});return}r(null);try{const s=await u.post("/ocr/batch",{documento_ids:t});r({type:"success",message:`Procesando ${t.length} documentos en lote`}),m([]),setTimeout(()=>j.reload(),2e3)}catch(s){r({type:"error",message:s.response?.data?.message||"Error en procesamiento por lote"})}},R=s=>{m(a=>a.includes(s)?a.filter(z=>z!==s):[...a,s])},P=s=>s.ocr_processed_at?e.jsxs(y,{variant:"default",className:"gap-1",children:[e.jsx(U,{className:"h-3 w-3"}),"Procesado"]}):e.jsxs(y,{variant:"secondary",className:"gap-1",children:[e.jsx(b,{className:"h-3 w-3"}),"Pendiente"]}),F=s=>s<1024?s+" B":s<1024*1024?(s/1024).toFixed(2)+" KB":(s/(1024*1024)).toFixed(2)+" MB",O=()=>["pdf","png","jpg","jpeg","tiff","bmp","gif"];return e.jsxs(A,{children:[e.jsx(B,{title:"Procesamiento OCR"}),e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Procesamiento OCR"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Reconocimiento óptico de caracteres para digitalización"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(d,{className:"h-5 w-5 text-primary"})})]}),c&&e.jsx(H,{variant:c.type==="error"?"destructive":"default",children:e.jsx(q,{children:c.message})}),e.jsxs(g,{children:[e.jsxs(f,{children:[e.jsx(C,{children:"Configuración de OCR"}),e.jsx(N,{children:"Selecciona el motor de OCR y los documentos a procesar"})]}),e.jsx(v,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{children:"Motor OCR"}),e.jsxs(M,{value:h,onValueChange:_,children:[e.jsx(V,{children:e.jsx(E,{})}),e.jsxs(L,{children:[e.jsx(l,{value:"tesseract",children:"Tesseract (Local)"}),e.jsx(l,{value:"cloud_vision",children:"Google Cloud Vision"}),e.jsx(l,{value:"azure_vision",children:"Azure Computer Vision"})]})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(n,{onClick:k,disabled:t.length===0,className:"w-full",children:[e.jsx(d,{className:"h-4 w-4 mr-2"}),"Procesar Seleccionados (",t.length,")"]})}),e.jsx("div",{className:"flex items-end",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Formatos soportados:"}),e.jsx("br",{}),O().join(", ").toUpperCase()]})})]})})]}),e.jsxs(g,{children:[e.jsxs(f,{children:[e.jsxs(C,{children:["Documentos (",i.total,")"]}),e.jsx(N,{children:"Documentos disponibles para procesamiento OCR"})]}),e.jsxs(v,{children:[e.jsx("div",{className:"space-y-3",children:i.data.map(s=>e.jsxs("div",{className:"flex items-center gap-4 p-4 border rounded-lg hover:bg-accent/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:t.includes(s.id),onChange:()=>R(s.id),className:"h-4 w-4",disabled:!!s.ocr_processed_at}),e.jsx("div",{className:"p-2 bg-primary/10 rounded",children:e.jsx(S,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold truncate",children:s.nombre}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.codigo," • ",s.formato.toUpperCase()," • ",F(s.tamanio)]}),s.ocr_confidence&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Confianza: ",s.ocr_confidence.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[P(s),!s.ocr_processed_at&&e.jsx(n,{onClick:()=>w(s.id),disabled:p[s.id],size:"sm",children:p[s.id]?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"h-4 w-4 mr-2 animate-spin"}),"Procesando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"h-4 w-4 mr-2"}),"Procesar"]})}),s.ocr_processed_at&&s.contenido_ocr&&e.jsx(n,{onClick:()=>{},size:"sm",variant:"outline",children:"Ver Texto"})]})]},s.id))}),i.data.length===0&&e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(S,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No hay documentos disponibles para OCR"})]})]})]})]})]})}export{xe as default};
