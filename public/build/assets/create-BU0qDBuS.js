import{r as x,u as W,j as e,H as Y,a as D}from"./app-D5ty85UD.js";import{A as ee}from"./app-layout-BldlUZtG.js";import{c as se,B as h}from"./app-logo-icon-CER8Okyj.js";import{L as l,I as f}from"./label-52xU_9U9.js";import{X as B,T as L,t as H,j as O,A as ae}from"./app-sidebar-layout-DA_3G3Md.js";import{S as g,a as b,b as N,c as y,d as p}from"./select-DED6Pjgm.js";import{C as c,d,a as u,b as j}from"./card-BOJsaF7N.js";import{A as re,a as ie}from"./alert-DMIjH_Xy.js";import{P as te}from"./progress-D2fvaxp4.js";import{A as le}from"./arrow-left-CBHxcoHX.js";import{I as ne}from"./info-woXHEhTs.js";import{U as oe}from"./upload-vHd8KL6z.js";import{S as ce}from"./save-DccWfho_.js";import{I as de,V as me,H as xe}from"./video-CURskCZd.js";import{M as he}from"./monitor-C70AcmpF.js";/* empty css            */import"./index-BoLQYjiW.js";import"./index-C_bZVMS5.js";import"./index-C_kE6Ds7.js";import"./check-D4Ehe9Dv.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],ue=se("FileUp",pe);function Be({opciones:v}){const[C,P]=x.useState(!1),[E,w]=x.useState(0),[U,F]=x.useState(!1),[m,k]=x.useState([]),[_,M]=x.useState(""),T=x.useRef(null),{data:a,setData:r,post:je,processing:S,errors:t,reset:ve}=W({nombre:"",descripcion:"",expediente_id:"",tipologia_id:"",tipo_documental:"",tipo_soporte:"electronico",estado:"borrador",confidencialidad:"interna",numero_folios:null,palabras_clave:[],ubicacion_fisica:"",observaciones:"",archivo:null}),R=[{title:"Inicio",href:"/dashboard"},{title:"Administración",href:"/admin"},{title:"Documentos",href:"/admin/documentos"},{title:"Crear Documento",href:"/admin/documentos/create"}],q=s=>{s.preventDefault(),P(!0);const i=new FormData;Object.entries(a).forEach(([n,A])=>{n==="palabras_clave"?m.forEach((Z,Q)=>{i.append(`palabras_clave[${Q}]`,Z)}):A!=null&&i.append(n,A)});const o=setInterval(()=>{w(n=>n>=90?(clearInterval(o),90):n+10)},200);D.post("/admin/documentos",i,{onSuccess:()=>{w(100),H.success("Documento creado exitosamente"),setTimeout(()=>{clearInterval(o),D.visit("/admin/documentos")},1e3)},onError:n=>{clearInterval(o),w(0),H.error("Error al crear el documento. Revisa los campos marcados.")},onFinish:()=>{P(!1)}})},I=s=>{s.preventDefault(),s.stopPropagation(),s.type==="dragenter"||s.type==="dragover"?F(!0):s.type==="dragleave"&&F(!1)},G=s=>{s.preventDefault(),s.stopPropagation(),F(!1),s.dataTransfer.files&&s.dataTransfer.files[0]&&V(s.dataTransfer.files[0])},V=s=>{r("archivo",s),a.nombre||r("nombre",s.name)},K=s=>{s.target.files&&s.target.files[0]&&V(s.target.files[0])},z=()=>{if(_.trim()&&!m.includes(_.trim())){const s=[...m,_.trim()];k(s),r("palabras_clave",s),M("")}},X=s=>{const i=m.filter(o=>o!==s);k(i),r("palabras_clave",i)},$=s=>{const i=s.split(".").pop()?.toLowerCase();return i?["jpg","jpeg","png","gif","bmp","svg","webp"].includes(i)?e.jsx(de,{className:"h-8 w-8 text-blue-500"}):["mp4","avi","mov","wmv","flv","webm"].includes(i)?e.jsx(me,{className:"h-8 w-8 text-purple-500"}):["mp3","wav","ogg","flac","m4a"].includes(i)?e.jsx(xe,{className:"h-8 w-8 text-green-500"}):["zip","rar","7z","tar","gz"].includes(i)?e.jsx(ae,{className:"h-8 w-8 text-orange-500"}):["xls","xlsx","ppt","pptx"].includes(i)?e.jsx(he,{className:"h-8 w-8 text-indigo-500"}):e.jsx(O,{className:"h-8 w-8 text-gray-500"}):e.jsx(O,{className:"h-8 w-8"})},J=s=>{if(s===0)return"0 Bytes";const i=1024,o=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(s)/Math.log(i));return parseFloat((s/Math.pow(i,n)).toFixed(2))+" "+o[n]};return e.jsxs(ee,{breadcrumbs:R,children:[e.jsx(Y,{title:"Crear Documento"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{className:"h-6 w-6 text-[#2a3d83]"}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Crear Documento"})]}),e.jsxs(h,{type:"button",variant:"outline",onClick:()=>D.visit("/admin/documentos"),className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4"}),"Volver"]})]}),C&&e.jsx(c,{children:e.jsx(d,{className:"pt-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Subiendo documento..."}),e.jsxs("span",{children:[E,"%"]})]}),e.jsx(te,{value:E,className:"w-full"})]})})}),e.jsxs(re,{children:[e.jsx(ne,{className:"h-4 w-4"}),e.jsx(ie,{children:"Sube documentos electrónicos al sistema siguiendo las políticas de formatos y tamaños establecidas para cada tipo de contenido."})]}),e.jsxs("form",{onSubmit:q,className:"space-y-6",children:[e.jsxs(c,{children:[e.jsx(u,{children:e.jsx(j,{children:"Archivo"})}),e.jsxs(d,{children:[e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${U?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:I,onDragLeave:I,onDragOver:I,onDrop:G,children:[a.archivo?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center",children:$(a.archivo.name)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.archivo.name}),e.jsx("p",{className:"text-sm text-gray-500",children:J(a.archivo.size)})]}),e.jsxs(h,{type:"button",variant:"outline",size:"sm",onClick:()=>r("archivo",null),children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Remover"]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(oe,{className:"h-12 w-12 text-gray-400 mx-auto"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"Arrastra tu archivo aquí o haz clic para seleccionar"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Formatos soportados: PDF, DOC, DOCX, JPG, PNG, MP4, MP3 y más"})]}),e.jsx(h,{type:"button",variant:"outline",onClick:()=>T.current?.click(),children:"Seleccionar archivo"})]}),e.jsx("input",{ref:T,type:"file",className:"hidden",onChange:K,accept:"*/*"})]}),t.archivo&&e.jsx("p",{className:"text-sm text-red-600 mt-2",children:t.archivo})]})]}),e.jsxs(c,{children:[e.jsx(u,{children:e.jsx(j,{children:"Información Básica"})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"nombre",children:"Nombre del Documento *"}),e.jsx(f,{id:"nombre",type:"text",value:a.nombre,onChange:s=>r("nombre",s.target.value),className:t.nombre?"border-red-500":"",required:!0}),t.nombre&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:t.nombre})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"expediente_id",children:"Expediente *"}),e.jsxs(g,{value:a.expediente_id,onValueChange:s=>r("expediente_id",s),children:[e.jsx(b,{id:"expediente_id",className:t.expediente_id?"border-red-500":"",children:e.jsx(N,{placeholder:"Seleccionar expediente"})}),e.jsx(y,{children:v.expedientes.map(s=>e.jsxs(p,{value:s.id.toString(),children:[s.codigo," - ",s.nombre]},s.id))})]}),t.expediente_id&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:t.expediente_id})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"descripcion",children:"Descripción"}),e.jsx(L,{id:"descripcion",value:a.descripcion,onChange:s=>r("descripcion",s.target.value),placeholder:"Descripción detallada del documento",rows:3,className:t.descripcion?"border-red-500":""}),t.descripcion&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:t.descripcion})]})]})]}),e.jsxs(c,{children:[e.jsx(u,{children:e.jsx(j,{children:"Clasificación"})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"tipologia_id",children:"Tipología Documental"}),e.jsxs(g,{value:a.tipologia_id,onValueChange:s=>r("tipologia_id",s),children:[e.jsx(b,{id:"tipologia_id",children:e.jsx(N,{placeholder:"Seleccionar tipología"})}),e.jsxs(y,{children:[e.jsx(p,{value:"null",children:"Sin tipología"}),v.tipologias.map(s=>e.jsxs(p,{value:s.id.toString(),children:[s.nombre," (",s.categoria,")"]},s.id))]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"tipo_documental",children:"Tipo Documental"}),e.jsx(f,{id:"tipo_documental",type:"text",value:a.tipo_documental,onChange:s=>r("tipo_documental",s.target.value),placeholder:"Ej: Contrato, Factura, Informe"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"tipo_soporte",children:"Tipo de Soporte *"}),e.jsxs(g,{value:a.tipo_soporte,onValueChange:s=>r("tipo_soporte",s),children:[e.jsx(b,{id:"tipo_soporte",children:e.jsx(N,{})}),e.jsx(y,{children:v.tipos_soporte.map(s=>e.jsx(p,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"numero_folios",children:"Número de Folios"}),e.jsx(f,{id:"numero_folios",type:"number",min:"1",value:a.numero_folios||"",onChange:s=>r("numero_folios",parseInt(s.target.value)||null)})]})]})]})]}),e.jsxs(c,{children:[e.jsx(u,{children:e.jsx(j,{children:"Estado y Confidencialidad"})}),e.jsx(d,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"estado",children:"Estado *"}),e.jsxs(g,{value:a.estado,onValueChange:s=>r("estado",s),children:[e.jsx(b,{id:"estado",children:e.jsx(N,{})}),e.jsx(y,{children:v.estados.map(s=>e.jsx(p,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"confidencialidad",children:"Confidencialidad *"}),e.jsxs(g,{value:a.confidencialidad,onValueChange:s=>r("confidencialidad",s),children:[e.jsx(b,{id:"confidencialidad",children:e.jsx(N,{})}),e.jsx(y,{children:v.confidencialidad.map(s=>e.jsx(p,{value:s.value,children:s.label},s.value))})]})]})]})})]}),e.jsxs(c,{children:[e.jsx(u,{children:e.jsx(j,{children:"Palabras Clave"})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{value:_,onChange:s=>M(s.target.value),placeholder:"Agregar palabra clave",onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),z())}),e.jsx(h,{type:"button",variant:"outline",onClick:z,children:"Agregar"})]}),m.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:m.map(s=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800",children:[s,e.jsx("button",{type:"button",onClick:()=>X(s),className:"hover:text-blue-600",children:e.jsx(B,{className:"h-3 w-3"})})]},s))})]})]}),e.jsxs(c,{children:[e.jsx(u,{children:e.jsx(j,{children:"Información Adicional"})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"ubicacion_fisica",children:"Ubicación Física"}),e.jsx(f,{id:"ubicacion_fisica",type:"text",value:a.ubicacion_fisica,onChange:s=>r("ubicacion_fisica",s.target.value),placeholder:"Ej: Archivo Central, Estante A-3, Caja 15"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"observaciones",children:"Observaciones"}),e.jsx(L,{id:"observaciones",value:a.observaciones,onChange:s=>r("observaciones",s.target.value),placeholder:"Observaciones adicionales",rows:3})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-6",children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>D.visit("/admin/documentos"),disabled:S||C,children:"Cancelar"}),e.jsxs(h,{type:"submit",disabled:S||C,className:"bg-[#2a3d83] hover:bg-[#1e2b5f] flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),S||C?"Guardando...":"Crear Documento"]})]})]})]})]})}export{Be as default};
