import{r as H,j as e,H as V,L as b,a as f}from"./app-BV8yjCq7.js";import{A as I,h as L,i as m,j as h,k as j,g as C,C as D,D as B,c as O,d as J,e as P,f as Z,o as U}from"./app-layout-xptsXUqV.js";import{c as u,B as i}from"./app-logo-icon-BhHHxLi4.js";import{C as l,c as t,a as p,b as g,d as w}from"./card-DVLfGmNh.js";import{B as n}from"./badge-Choz21Ea.js";import{S as k}from"./separator-CUtXxzXG.js";import{A as G,a as K}from"./alert-kfj2FB5m.js";import{A as Q}from"./arrow-left-BR8r42OJ.js";import{a as T,C as W,T as X}from"./toggle-right-BI_3dsgC.js";import{S as _}from"./square-pen-CKnbIuQ-.js";import{T as Y}from"./trash-2-C7PnUN3j.js";import{C as A}from"./circle-alert-Ctpl-Xf9.js";import{C as v}from"./check-BqPRUSNK.js";/* empty css            */import"./index-C-gP6wGF.js";import"./label-CN-Cuv_T.js";import"./index-BLDVcN3u.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],se=u("Calendar",ee);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M12 18v-4",key:"q1q25u"}],["path",{d:"M16 18v-6",key:"15y0np"}]],S=u("FileChartColumnIncreasing",ae);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],le=u("FileDown",ie);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],E=u("FolderOpen",te),ce=[{title:"Dashboard",href:"/dashboard"},{title:"Administración",href:"#"},{title:"Tablas de Retención Documental",href:"/admin/trd"},{title:"Detalle TRD",href:"#"}];function De({trd:s,versiones:c,estadisticas:d,tieneDocumentosAsociados:y}){const[M,o]=H.useState(!1),R=()=>{f.delete(`/admin/trd/${s.id}`,{onFinish:()=>o(!1)})},$=()=>{f.patch(`/admin/trd/${s.id}/vigencia`,{},{preserveScroll:!0})},q=()=>{f.post(`/admin/trd/${s.id}/duplicate`)},z=a=>{window.open(`/admin/trd/${s.id}/export?formato=${a}`,"_blank")},x=a=>new Date(a).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),N=a=>{const r={borrador:{color:"bg-gray-100 text-gray-800",icon:_},revision:{color:"bg-yellow-100 text-yellow-800",icon:D},aprobada:{color:"bg-green-100 text-green-800",icon:v},vigente:{color:"bg-blue-100 text-blue-800",icon:v},historica:{color:"bg-purple-100 text-purple-800",icon:S}}[a]||{color:"bg-gray-100 text-gray-800",icon:A},F=r.icon;return e.jsxs(n,{className:`${r.color} font-medium flex items-center gap-1`,children:[e.jsx(F,{className:"h-3 w-3"}),a.charAt(0).toUpperCase()+a.slice(1)]})};return e.jsxs(I,{breadcrumbItems:ce,children:[e.jsx(V,{title:`${s.nombre} - Detalle TRD`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(b,{href:"/admin/trd",children:e.jsxs(i,{variant:"outline",size:"sm",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Volver"]})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s.nombre}),N(s.estado),s.vigente&&e.jsxs(n,{className:"bg-blue-100 text-blue-800 font-medium flex items-center gap-1",children:[e.jsx(T,{className:"h-3 w-3"}),"Vigente"]})]}),e.jsxs("p",{className:"text-gray-600",children:[s.codigo," • Versión ",s.version," • ",s.identificador_unico]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(L,{children:[e.jsxs(m,{children:[e.jsx(h,{asChild:!0,children:e.jsx(i,{variant:"outline",size:"sm",onClick:()=>z("json"),children:e.jsx(le,{className:"h-4 w-4"})})}),e.jsx(j,{children:e.jsx("p",{children:"Exportar TRD"})})]}),e.jsxs(m,{children:[e.jsx(h,{asChild:!0,children:e.jsx(i,{variant:"outline",size:"sm",onClick:q,children:e.jsx(W,{className:"h-4 w-4"})})}),e.jsx(j,{children:e.jsx("p",{children:"Duplicar TRD"})})]}),e.jsxs(m,{children:[e.jsx(h,{asChild:!0,children:e.jsx(i,{variant:"outline",size:"sm",onClick:$,disabled:s.estado!=="aprobada"&&!s.vigente,children:s.vigente?e.jsx(T,{className:"h-4 w-4 text-green-600"}):e.jsx(X,{className:"h-4 w-4"})})}),e.jsx(j,{children:e.jsx("p",{children:s.vigente?"Desmarcar vigente":"Marcar vigente"})})]}),e.jsx(b,{href:`/admin/trd/${s.id}/edit`,children:e.jsx(i,{variant:"outline",size:"sm",children:e.jsx(_,{className:"h-4 w-4"})})}),e.jsxs(m,{children:[e.jsx(h,{asChild:!0,children:e.jsx(i,{variant:"outline",size:"sm",onClick:()=>o(!0),className:"text-red-600 hover:text-red-700",children:e.jsx(Y,{className:"h-4 w-4"})})}),e.jsx(j,{children:e.jsx("p",{children:"Eliminar TRD"})})]})]})})]}),y&&e.jsxs(G,{className:"border-yellow-200 bg-yellow-50",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsxs(K,{className:"text-yellow-800",children:[e.jsx("strong",{children:"Esta TRD tiene documentos asociados."})," Cualquier modificación debe considerar el impacto en los documentos existentes."]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(l,{children:e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-blue-100 rounded-full p-2",children:e.jsx(E,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Series"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.series_count})]})]})})}),e.jsx(l,{children:e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-green-100 rounded-full p-2",children:e.jsx(E,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Subseries"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.subseries_count})]})]})})}),e.jsx(l,{children:e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-purple-100 rounded-full p-2",children:e.jsx(S,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Expedientes"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.expedientes_count})]})]})})}),e.jsx(l,{children:e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-orange-100 rounded-full p-2",children:e.jsx(C,{className:"h-6 w-6 text-orange-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Documentos"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.documentos_count})]})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(l,{children:[e.jsx(p,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5 text-[#2a3d83]"}),"Información de la TRD"]})}),e.jsxs(t,{className:"space-y-4",children:[s.descripcion&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Descripción"}),e.jsx("p",{className:"text-gray-600 leading-relaxed",children:s.descripcion})]}),s.justificacion&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Justificación"}),e.jsx("p",{className:"text-gray-600 leading-relaxed",children:s.justificacion})]}),e.jsx(k,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Formato de Archivo"}),e.jsx("p",{className:"text-gray-600",children:s.formato_archivo||"No especificado"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Estado Actual"}),e.jsx("div",{className:"flex items-center gap-2",children:N(s.estado)})]})]}),s.metadatos_asociados&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Metadatos Asociados"}),e.jsx("pre",{className:"bg-gray-50 p-3 rounded-md text-sm font-mono overflow-x-auto",children:JSON.stringify(s.metadatos_asociados,null,2)})]})]})]}),s.series&&s.series.length>0&&e.jsxs(l,{children:[e.jsxs(p,{children:[e.jsx(g,{children:"Series Documentales"}),e.jsxs(w,{children:["Series asociadas a esta TRD (",s.series.length,")"]})]}),e.jsx(t,{children:e.jsx("div",{className:"space-y-4",children:s.series.map(a=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:a.nombre}),e.jsx(n,{variant:"outline",children:a.codigo})]}),a.subseries&&a.subseries.length>0&&e.jsxs("div",{className:"ml-4 mt-2",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:["Subseries (",a.subseries.length,"):"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:a.subseries.map(r=>e.jsx(n,{variant:"secondary",className:"text-xs",children:r.codigo},r.id))})]})]},a.id))})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(l,{children:[e.jsx(p,{children:e.jsx(g,{className:"text-lg",children:"Información del Sistema"})}),e.jsxs(t,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(se,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Creado"}),e.jsx("p",{className:"text-sm text-gray-600",children:x(s.created_at)}),s.creador&&e.jsxs("p",{className:"text-xs text-gray-500",children:["por ",s.creador.name]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(D,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Última Actualización"}),e.jsx("p",{className:"text-sm text-gray-600",children:x(s.fecha_actualizacion)}),s.modificador&&e.jsxs("p",{className:"text-xs text-gray-500",children:["por ",s.modificador.name]})]})]}),s.fecha_aprobacion&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{className:"h-4 w-4 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Aprobado"}),e.jsx("p",{className:"text-sm text-gray-600",children:x(s.fecha_aprobacion)})]})]}),e.jsx(k,{}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"ID Único"}),e.jsx("p",{className:"text-xs font-mono text-gray-600 bg-gray-50 px-2 py-1 rounded",children:s.identificador_unico})]})]})]}),c.length>1&&e.jsxs(l,{children:[e.jsxs(p,{children:[e.jsx(g,{className:"text-lg",children:"Historial de Versiones"}),e.jsxs(w,{children:[c.length," versiones disponibles"]})]}),e.jsx(t,{children:e.jsxs("div",{className:"space-y-3",children:[c.slice(0,5).map(a=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded border",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:["v",a.version]}),e.jsx("p",{className:"text-xs text-gray-500",children:x(a.created_at)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[N(a.estado),a.vigente&&e.jsx(n,{variant:"secondary",className:"text-xs",children:"Vigente"})]})]},a.id)),c.length>5&&e.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["+",c.length-5," versiones más"]})]})})]})]})]}),e.jsx(B,{open:M,onOpenChange:o,children:e.jsxs(O,{children:[e.jsxs(J,{children:[e.jsx(P,{children:"Confirmar Eliminación"}),e.jsxs(Z,{children:['¿Estás seguro de que deseas eliminar la TRD "',s.nombre,'"? Esta acción no se puede deshacer.',y&&e.jsxs("div",{className:"mt-2 p-2 bg-red-50 border border-red-200 rounded",children:[e.jsx("strong",{className:"text-red-800",children:"Advertencia:"})," Esta TRD tiene documentos asociados."]})]})]}),e.jsxs(U,{children:[e.jsx(i,{type:"button",variant:"outline",onClick:()=>o(!1),children:"Cancelar"}),e.jsx(i,{type:"button",variant:"destructive",onClick:R,children:"Eliminar"})]})]})})]})]})}export{De as default};
