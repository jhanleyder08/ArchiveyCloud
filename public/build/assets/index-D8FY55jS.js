import{u as T,j as e,H as A,L as r,b as j}from"./app-BwzY5mdP.js";import{A as D}from"./app-layout-9wS50XJ4.js";import{B as n}from"./button-BuG7hErd.js";import{I as F}from"./input-DBPsNB4E.js";import{S as f,a as g,b as N,c as b,d as i}from"./select-FIAkf9pv.js";import{A as $,a as I}from"./alert-DnH_NbhW.js";import{F as m}from"./Combination-DMdRKDdc.js";import{C as E,i as L}from"./app-sidebar-layout-V4G_4O_u.js";import{P as B}from"./plus-BOYqNwH5.js";import{C as v}from"./folder-BDmHn7zE.js";import{T as h}from"./triangle-alert-CwolSKvH.js";import{C as M}from"./calendar-CWS24Tad.js";import{S as y}from"./search-DYmQja4G.js";import{E as z}from"./eye-E-jSZuXN.js";import{C as H}from"./circle-check-big-GkZlNnbA.js";/* empty css            */import"./index-C39PKzMR.js";import"./index-DRfaZ5bA.js";import"./index-BeU68MN8.js";import"./check-BLssxijV.js";import"./index-BQN2DSxF.js";import"./x-yj7I5XB9.js";import"./app-logo-icon-CWh3FBC5.js";import"./label-COs3lnS9.js";import"./user-CGcDW0oZ.js";import"./mail-DcAASWb1.js";import"./users-Bd_tJWgh.js";import"./BrandingProvider-C7c3UgBn.js";const R={prestado:"bg-blue-100 text-blue-800",devuelto:"bg-green-100 text-green-800",cancelado:"bg-gray-100 text-gray-800"},G={prestado:e.jsx(v,{className:"h-4 w-4"}),devuelto:e.jsx(H,{className:"h-4 w-4"}),cancelado:e.jsx(h,{className:"h-4 w-4"})};function fe({prestamos:t,estadisticas:c,proximosVencer:a,filtros:d}){const{data:l,setData:o,get:U,processing:u}=T({estado:d.estado||"todos",tipo_prestamo:d.tipo_prestamo||"todos",fecha_inicio:d.fecha_inicio||"",fecha_fin:d.fecha_fin||"",solicitante:d.solicitante||""}),w=()=>{const s={...l,estado:l.estado==="todos"?"":l.estado,tipo_prestamo:l.tipo_prestamo==="todos"?"":l.tipo_prestamo};j.get("/admin/prestamos",s,{preserveState:!0,preserveScroll:!0})},_=()=>{j.visit("/admin/prestamos")},p=s=>new Date(s).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}),C=s=>s.tipo_prestamo==="expediente"&&s.expediente?`${s.expediente.codigo} - ${s.expediente.titulo}`:s.tipo_prestamo==="documento"&&s.documento?s.documento.titulo:"Item no disponible",S=s=>s.tipo_solicitante==="usuario"&&s.solicitante?s.solicitante.name:s.tipo_solicitante==="externo"&&s.datos_solicitante_externo?s.datos_solicitante_externo.nombre_completo:s.nombre_solicitante||"Solicitante no disponible",P=s=>s.tipo_solicitante==="usuario"&&s.solicitante?s.solicitante.email:s.tipo_solicitante==="externo"&&s.datos_solicitante_externo?s.datos_solicitante_externo.email:s.contacto_solicitante||"No disponible";return e.jsxs(D,{breadcrumbs:[{title:"Dashboard",href:"/dashboard"},{title:"Administraci√≥n",href:"#"},{title:"Pr√©stamos y Consultas",href:"/admin/prestamos"}],children:[e.jsx(A,{title:"Pr√©stamos y Consultas"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{className:"h-6 w-6 text-[#2a3d83]"}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Gesti√≥n de Pr√©stamos y Consultas"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(n,{variant:"outline",asChild:!0,children:e.jsxs(r,{href:"/admin/prestamos/reportes",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Reportes"]})}),e.jsx(n,{asChild:!0,children:e.jsxs(r,{href:"/admin/prestamos/create",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Nuevo Pr√©stamo"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Pr√©stamos"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:c.total_prestamos})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(m,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pr√©stamos Activos"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:c.prestamos_activos})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(v,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pr√©stamos Vencidos"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:c.prestamos_vencidos})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(h,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pr√≥ximos a Vencer"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:a?.length||0})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(M,{className:"h-6 w-6 text-[#2a3d83]"})})]})})]}),a&&a.length>0&&e.jsxs($,{className:"border-yellow-200 bg-yellow-50",children:[e.jsx(h,{className:"h-4 w-4 text-yellow-600"}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"font-medium text-yellow-800",children:[a?.length||0," pr√©stamos pr√≥ximos a vencer en los pr√≥ximos 7 d√≠as:"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:a?.slice(0,4).map(s=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:s.expediente?`${s.expediente.codigo} - ${s.expediente.titulo}`:s.documento?.nombre}),e.jsxs("span",{className:"text-yellow-700",children:[" ","- ",s.solicitante?.name||"Usuario no disponible"," (vence en ",s.dias_restantes," d√≠as)"]})]},s.id))}),a&&a.length>4&&e.jsxs("p",{className:"text-sm text-yellow-700",children:["Y ",(a?.length||0)-4," m√°s..."]})]})})]}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4 w-full sm:w-auto",children:e.jsxs("div",{className:"relative flex-1 sm:w-80",children:[e.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(F,{id:"solicitante",placeholder:"Buscar por solicitante...",value:l.solicitante,onChange:s=>o("solicitante",s.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(f,{value:l.estado,onValueChange:s=>o("estado",s),children:[e.jsx(g,{className:"w-[180px]",children:e.jsx(N,{placeholder:"Todos los estados"})}),e.jsxs(b,{children:[e.jsx(i,{value:"todos",children:"Todos los estados"}),e.jsx(i,{value:"prestado",children:"Prestado"}),e.jsx(i,{value:"devuelto",children:"Devuelto"}),e.jsx(i,{value:"cancelado",children:"Cancelado"})]})]}),e.jsxs(f,{value:l.tipo_prestamo,onValueChange:s=>o("tipo_prestamo",s),children:[e.jsx(g,{className:"w-[180px]",children:e.jsx(N,{placeholder:"Todos los tipos"})}),e.jsxs(b,{children:[e.jsx(i,{value:"todos",children:"Todos los tipos"}),e.jsx(i,{value:"expediente",children:"Expediente"}),e.jsx(i,{value:"documento",children:"Documento"})]})]}),e.jsxs(n,{onClick:w,disabled:u,className:"bg-[#2a3d83] hover:bg-[#1e2b5f]",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),u?"Aplicando...":"Aplicar Filtros"]}),e.jsx(n,{variant:"outline",onClick:_,children:"Limpiar"})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg border overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Tipo"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Item"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Solicitante"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Fecha Pr√©stamo"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Fecha Devoluci√≥n"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Estado"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"D√≠as"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Acciones"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:t?.data&&t.data.length>0?t.data.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"py-4 px-6",children:e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-[#2a3d83] capitalize",children:[s.tipo_prestamo==="expediente"?e.jsx(L,{className:"h-3 w-3 mr-1"}):e.jsx(m,{className:"h-3 w-3 mr-1"}),s.tipo_prestamo]})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:C(s)}),s.expediente?.ubicacion_fisica&&e.jsxs("p",{className:"text-xs text-gray-500",children:["üìç ",s.expediente.ubicacion_fisica]})]})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:S(s)}),e.jsx("p",{className:"text-xs text-gray-500",children:P(s)}),s.tipo_solicitante==="externo"&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-orange-100 text-orange-800 mt-1",children:"Externo"})]})}),e.jsx("td",{className:"py-4 px-6 text-sm text-gray-600",children:p(s.fecha_prestamo)}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:p(s.fecha_devolucion_esperada)}),s.estado==="prestado"&&s.esta_vencido&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 mt-1",children:"Vencido"}),s.estado==="prestado"&&!s.esta_vencido&&s.dias_restantes!==void 0&&s.dias_restantes<=3&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border-yellow-500 text-yellow-600 mt-1",children:[s.dias_restantes," d√≠as restantes"]})]})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${R[s.estado]}`,children:[G[s.estado],e.jsx("span",{className:"ml-1 capitalize",children:s.estado})]})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"text-sm text-gray-900",children:[s.fecha_devolucion_real?Math.ceil((new Date(s.fecha_devolucion_real).getTime()-new Date(s.fecha_prestamo).getTime())/(1e3*60*60*24)):Math.ceil((new Date().getTime()-new Date(s.fecha_prestamo).getTime())/(1e3*60*60*24))," d√≠as",s.renovaciones>0&&e.jsxs("p",{className:"text-xs text-gray-500",children:[s.renovaciones," renovaci√≥n(es)"]})]})}),e.jsx("td",{className:"py-4 px-6",children:e.jsx(r,{href:`/admin/prestamos/${s.id}`,children:e.jsx("button",{className:"p-2 rounded-md text-[#2a3d83] hover:text-[#1e2b5f] hover:bg-blue-50 transition-colors",children:e.jsx(z,{className:"h-4 w-4"})})})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"py-8 px-6 text-center text-gray-500",children:"No se encontraron pr√©stamos con los filtros aplicados."})})})]})}),t?.data&&t.data.length>0&&t?.last_page&&t.last_page>1&&e.jsxs("div",{className:"flex items-center justify-between bg-white border rounded-lg px-6 py-3",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",e.jsx("span",{className:"font-medium",children:t?.data?.length||0})," de"," ",e.jsx("span",{className:"font-medium",children:t?.total||0})," resultados"]}),e.jsx("div",{className:"flex items-center gap-2",children:t?.links?.map((s,x)=>s.label.includes("Previous")?e.jsx(r,{href:s.url||"#",preserveState:!0,className:`px-3 py-2 border border-gray-300 rounded-md text-sm font-medium ${s.url?"text-gray-700 hover:bg-gray-50":"text-gray-300 cursor-not-allowed"}`,children:"Anterior"},x):s.label.includes("Next")?e.jsx(r,{href:s.url||"#",preserveState:!0,className:`px-3 py-2 border border-gray-300 rounded-md text-sm font-medium ${s.url?"text-gray-700 hover:bg-gray-50":"text-gray-300 cursor-not-allowed"}`,children:"Siguiente"},x):isNaN(Number(s.label))?null:e.jsx(r,{href:s.url||"#",preserveState:!0,className:`px-3 py-2 rounded-md text-sm font-medium ${s.active?"bg-[#2a3d83] text-white":"border border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:s.label},x))})]})]})]})]})}export{fe as default};
