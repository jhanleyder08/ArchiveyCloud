import{r as i,a as g,j as e,H as F}from"./app-mxlkmmQb.js";import{C as c,a as l,b as r,c as n,d as o}from"./card-BM_lxel5.js";import{B as N}from"./button-CuBppPEJ.js";import{B as m}from"./badge-Cbo6Jzs3.js";import{S as R,a as U,b as B,c as L,d as h}from"./select-B8MLc1gU.js";import{F as M}from"./Combination-B16eu4w9.js";import{F as G,C as H}from"./folder-DWzUJWdQ.js";import{U as I,D as b,T as P}from"./users-DyIvzvUS.js";import{C as V}from"./circle-check-big-sNHEoTq6.js";import{C as z}from"./calendar-DRCTsFYj.js";import{A as K}from"./activity-UJo8dLpI.js";/* empty css            */import"./index-A-_-1i-X.js";import"./index-CO05iKuH.js";import"./index-Cee0KRWQ.js";import"./check-CcAv2hB-.js";function de(){const[x,y]=i.useState("30"),[O,u]=i.useState(!0),[w,_]=i.useState([]),[p,C]=i.useState(null),[j,S]=i.useState(null),[f,D]=i.useState([]),[k,T]=i.useState([]),[t,E]=i.useState(null);i.useEffect(()=>{A()},[x]);const A=async()=>{u(!0);try{const s=(await g.get(`/api/dashboard/executive?period=${x}`)).data;_([{label:"Total Documentos",value:s.kpis.total_documentos.toLocaleString(),change:s.kpis.documentos_change,trend:s.kpis.documentos_change>0?"up":"down",icon:M},{label:"Total Expedientes",value:s.kpis.total_expedientes.toLocaleString(),change:s.kpis.expedientes_change,trend:s.kpis.expedientes_change>0?"up":"down",icon:G},{label:"Usuarios Activos",value:s.kpis.usuarios_activos.toLocaleString(),change:s.kpis.usuarios_change,trend:s.kpis.usuarios_change>0?"up":"down",icon:I},{label:"Tasa de Cumplimiento",value:`${s.kpis.cumplimiento_rate}%`,change:s.kpis.cumplimiento_change,trend:s.kpis.cumplimiento_change>0?"up":"down",icon:V}]),C(s.charts.documents_over_time),S(s.charts.user_activity),D(s.series_distribution),T(s.recent_activity),E(s.compliance)}catch(a){console.error("Error fetching dashboard data:",a)}finally{u(!1)}},v=async a=>{try{const s=await g.post("/api/dashboard/export",{period:x,format:a},{responseType:"blob"}),$=window.URL.createObjectURL(new Blob([s.data])),d=document.createElement("a");d.href=$,d.setAttribute("download",`reporte-ejecutivo-${Date.now()}.${a==="pdf"?"pdf":"xlsx"}`),document.body.appendChild(d),d.click(),d.remove()}catch(s){console.error("Error exporting report:",s)}};return e.jsxs(e.Fragment,{children:[e.jsx(F,{title:"Dashboard Ejecutivo - Archivey Cloud"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard Ejecutivo"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Métricas y estadísticas del sistema SGDEA"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(R,{value:x,onValueChange:y,children:[e.jsxs(U,{className:"w-[180px]",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),e.jsx(B,{})]}),e.jsxs(L,{children:[e.jsx(h,{value:"7",children:"Últimos 7 días"}),e.jsx(h,{value:"30",children:"Últimos 30 días"}),e.jsx(h,{value:"90",children:"Últimos 90 días"}),e.jsx(h,{value:"365",children:"Último año"})]})]}),e.jsxs(N,{variant:"outline",onClick:()=>v("excel"),children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Excel"]}),e.jsxs(N,{variant:"outline",onClick:()=>v("pdf"),children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"PDF"]})]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:w.map((a,s)=>e.jsxs(c,{children:[e.jsxs(l,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(r,{className:"text-sm font-medium",children:a.label}),e.jsx(a.icon,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(n,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.value}),a.change!==void 0&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsxs("span",{className:`inline-flex items-center ${a.trend==="up"?"text-green-600":"text-red-600"}`,children:[e.jsx(P,{className:`h-3 w-3 mr-1 ${a.trend==="down"?"rotate-180":""}`}),Math.abs(a.change),"%"]})," ","vs período anterior"]})]})]},s))}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(c,{children:[e.jsxs(l,{children:[e.jsx(r,{children:"Documentos Capturados"}),e.jsx(o,{children:"Tendencia de captura documental"})]}),e.jsx(n,{children:p&&e.jsx("div",{className:"h-[300px] flex items-center justify-center",children:e.jsxs("p",{className:"text-muted-foreground",children:["Gráfico de línea: ",p.labels.length," puntos de datos"]})})})]}),e.jsxs(c,{children:[e.jsxs(l,{children:[e.jsx(r,{children:"Actividad de Usuarios"}),e.jsx(o,{children:"Sesiones y accesos al sistema"})]}),e.jsx(n,{children:j&&e.jsx("div",{className:"h-[300px] flex items-center justify-center",children:e.jsxs("p",{className:"text-muted-foreground",children:["Gráfico de barras: ",j.labels.length," días"]})})})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(c,{className:"md:col-span-1",children:[e.jsxs(l,{children:[e.jsx(r,{children:"Distribución por Series"}),e.jsx(o,{children:"Top 10 series documentales"})]}),e.jsx(n,{children:e.jsx("div",{className:"space-y-3",children:f.slice(0,10).map((a,s)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("p",{className:"text-sm font-medium leading-none",children:a.nombre}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("div",{className:"h-2 flex-1 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary",style:{width:`${a.count/f[0].count*100}%`}})})})]}),e.jsx(m,{variant:"secondary",className:"ml-2",children:a.count})]},s))})})]}),e.jsxs(c,{className:"md:col-span-2",children:[e.jsxs(l,{children:[e.jsx(r,{children:"Actividad Reciente"}),e.jsx(o,{children:"Últimas acciones en el sistema"})]}),e.jsx(n,{children:e.jsx("div",{className:"space-y-4",children:k.slice(0,8).map((a,s)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-primary/10",children:e.jsx(K,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("p",{className:"text-sm font-medium leading-none",children:a.descripcion}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[a.usuario," • ",a.modulo]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[e.jsx(H,{className:"h-3 w-3"}),a.tiempo_relativo]})]},s))})})]})]}),t&&e.jsxs(c,{children:[e.jsxs(l,{children:[e.jsx(r,{children:"Métricas de Cumplimiento Normativo"}),e.jsx(o,{children:"Indicadores de gestión documental"})]}),e.jsx(n,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Documentos con TRD"}),e.jsxs(m,{variant:t.trd_compliance>90?"default":"destructive",children:[t.trd_compliance,"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500",style:{width:`${t.trd_compliance}%`}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Metadatos Completos"}),e.jsxs(m,{variant:t.metadata_compliance>90?"default":"destructive",children:[t.metadata_compliance,"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500",style:{width:`${t.metadata_compliance}%`}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Documentos Firmados"}),e.jsxs(m,{variant:t.signature_compliance>70?"default":"secondary",children:[t.signature_compliance,"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-purple-500",style:{width:`${t.signature_compliance}%`}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Trazabilidad"}),e.jsxs(m,{variant:t.audit_compliance>95?"default":"destructive",children:[t.audit_compliance,"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-orange-500",style:{width:`${t.audit_compliance}%`}})})]})]})})]})]})]})}export{de as default};
