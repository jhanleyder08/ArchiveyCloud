import{r as h,j as e,H as R,L as V,b as r}from"./app-tMaUuF3G.js";import{A as q}from"./app-layout-Do2Eb3Sk.js";import{B as i}from"./button-b2NvRhsY.js";import{I as z}from"./input-BUbi3POq.js";import{B as K}from"./Combination-CgNv0oAU.js";import{S as v,a as y,b as w,c as C,d as l}from"./select-CdhdgJ0w.js";import{S as A,o as U,i as f,p as X,D as G,a as J,b as Q,c as W,d as Y}from"./app-sidebar-layout-DrvTFVRU.js";import{B as c}from"./bell-JpGPBZvl.js";import{C as p}from"./circle-check-big-V33kOqFh.js";import{T as L}from"./triangle-alert-JjU49oaO.js";import{S}from"./search-a-c68EbR.js";import{E as b}from"./eye-CUHphNhr.js";import{T as Z}from"./trash-2-C2WpkApr.js";import{C as ee}from"./chevron-left-XNOYul2x.js";import{L as se}from"./loader-circle-BMOh94KK.js";import{U as ae}from"./user-BK5OEaM4.js";import{C as _}from"./folder-CyeXS8Xg.js";import{C as k}from"./calendar-BexTjAnV.js";/* empty css            */import"./index-gcMQB5yO.js";import"./index-BqccPZiJ.js";import"./index-CWm8oeKh.js";import"./check-CjMGlCJz.js";import"./index-DReOSayN.js";import"./x-B3QVzJhq.js";import"./app-logo-icon-DkUm7hxR.js";import"./label-Bqu3HQD6.js";import"./mail-CwCHIGE1.js";import"./users-0BijOv_M.js";import"./BrandingProvider-DUeywemA.js";const T={baja:"bg-blue-100 text-blue-800 border-blue-200",media:"bg-yellow-100 text-yellow-800 border-yellow-200",alta:"bg-orange-100 text-orange-800 border-orange-200",critica:"bg-red-100 text-red-800 border-red-200"},te={pendiente:"bg-gray-100 text-gray-800 border-gray-200",leida:"bg-green-100 text-green-800 border-green-200",archivada:"bg-gray-100 text-gray-600 border-gray-200"},re={"calendar-x":k,"calendar-warning":k,"clock-x":_,"clock-warning":_,archive:f,"check-circle":p,"file-plus":f,"user-plus":ae,settings:A,"shield-alert":L,bell:c};function Be({notificaciones:a,estadisticas:m,filtros:j}){const[t,g]=h.useState({estado:j.estado||"todos",tipo:j.tipo||"todos",prioridad:j.prioridad||"todos"}),E=()=>{const s={estado:t.estado==="todos"?"":t.estado,tipo:t.tipo==="todos"?"":t.tipo,prioridad:t.prioridad==="todos"?"":t.prioridad};r.get("/admin/notificaciones",s,{preserveState:!0,preserveScroll:!0})},D=()=>{g({estado:"todos",tipo:"todos",prioridad:"todos"}),r.visit("/admin/notificaciones")},[F,n]=h.useState(!1),[P,x]=h.useState(!1),[d,B]=h.useState(null),I=s=>{s.estado==="pendiente"&&u(s.id),B(s),x(!0)},u=async s=>{n(!0);try{await fetch(`/admin/notificaciones/${s}/marcar-leida`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}}),r.reload()}catch(o){console.error("Error al marcar como leída:",o)}finally{n(!1)}},$=async()=>{n(!0);try{await fetch("/admin/notificaciones/marcar-todas-leidas",{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}}),r.reload()}catch(s){console.error("Error al marcar todas como leídas:",s)}finally{n(!1)}},M=async s=>{n(!0);try{await fetch(`/admin/notificaciones/${s}/archivar`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}}),r.reload()}catch(o){console.error("Error al archivar:",o)}finally{n(!1)}},H=s=>{confirm("¿Estás seguro de eliminar esta notificación?")&&r.delete(`/admin/notificaciones/${s}`)},N=s=>new Date(s).toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),O=s=>re[s]||c;return e.jsxs(q,{breadcrumbs:[{title:"Dashboard",href:"/dashboard"},{title:"Administración",href:"#"},{title:"Notificaciones",href:"/admin/notificaciones"}],children:[e.jsx(R,{title:"Notificaciones"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{className:"h-6 w-6 text-[#2a3d83]"}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Centro de Notificaciones"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[m.pendientes>0&&e.jsxs(i,{onClick:$,variant:"outline",children:[e.jsx(p,{className:"h-4 w-4 mr-2 text-[#2a3d83]"}),"Marcar todas como leídas"]}),e.jsx(i,{variant:"outline",asChild:!0,children:e.jsxs(V,{href:"/admin/notificaciones/admin",children:[e.jsx(A,{className:"h-4 w-4 mr-2 text-[#2a3d83]"}),"Panel Admin"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:m.total})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(c,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pendientes"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:m.pendientes})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(U,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Leídas"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:m.leidas})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(p,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Críticas"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:m.criticas})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(L,{className:"h-6 w-6 text-[#2a3d83]"})})]})})]}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4 w-full sm:w-auto",children:e.jsxs("div",{className:"relative flex-1 sm:w-80",children:[e.jsx(S,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(z,{type:"text",placeholder:"Buscar notificaciones...",className:"pl-10"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(v,{value:t.estado,onValueChange:s=>g({...t,estado:s}),children:[e.jsx(y,{className:"w-[180px]",children:e.jsx(w,{placeholder:"Todos los estados"})}),e.jsxs(C,{children:[e.jsx(l,{value:"todos",children:"Todos los estados"}),e.jsx(l,{value:"pendiente",children:"Pendientes"}),e.jsx(l,{value:"leida",children:"Leídas"}),e.jsx(l,{value:"archivada",children:"Archivadas"})]})]}),e.jsxs(v,{value:t.prioridad,onValueChange:s=>g({...t,prioridad:s}),children:[e.jsx(y,{className:"w-[180px]",children:e.jsx(w,{placeholder:"Todas las prioridades"})}),e.jsxs(C,{children:[e.jsx(l,{value:"todos",children:"Todas las prioridades"}),e.jsx(l,{value:"baja",children:"Baja"}),e.jsx(l,{value:"media",children:"Media"}),e.jsx(l,{value:"alta",children:"Alta"}),e.jsx(l,{value:"critica",children:"Crítica"})]})]}),e.jsxs(i,{onClick:E,className:"bg-[#2a3d83] hover:bg-[#1e2b5f]",children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Aplicar Filtros"]}),e.jsx(i,{variant:"outline",onClick:D,children:"Limpiar"})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg border overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Notificación"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Prioridad"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Estado"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Fecha"}),e.jsx("th",{className:"text-left py-3 px-6 text-sm font-medium text-gray-900",children:"Acciones"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:a.data.length>0?a.data.map(s=>{const o=O(s.icono);return e.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${s.estado==="pendiente"?"bg-blue-50":""}`,children:[e.jsx("td",{className:"py-4 px-6",children:e.jsx("div",{className:"p-2 rounded-lg bg-blue-100",children:e.jsx(o,{className:"h-4 w-4 text-[#2a3d83]"})})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.titulo}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:s.mensaje}),s.creado_por&&e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Por: ",s.creado_por.name]})]})}),e.jsx("td",{className:"py-4 px-6",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${T[s.prioridad]}`,children:s.prioridad.charAt(0).toUpperCase()+s.prioridad.slice(1)})}),e.jsx("td",{className:"py-4 px-6",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${te[s.estado]}`,children:s.estado==="pendiente"?"Pendiente":s.estado==="leida"?"Leída":"Archivada"})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"text-sm text-gray-600",children:[N(s.created_at),s.leida_en&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Leída: ",N(s.leida_en)]})]})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.accion_url?e.jsx("button",{onClick:()=>{s.estado==="pendiente"&&u(s.id),r.visit(s.accion_url)},className:"p-2 rounded-md text-[#2a3d83] hover:text-[#1e2b5f] hover:bg-blue-50 transition-colors",title:"Ver detalle",children:e.jsx(b,{className:"h-4 w-4"})}):e.jsx("button",{onClick:()=>I(s),className:"p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-50 transition-colors",title:"Ver mensaje",children:e.jsx(b,{className:"h-4 w-4"})}),s.estado==="pendiente"&&e.jsx("button",{onClick:()=>u(s.id),className:"p-2 rounded-md text-[#2a3d83] hover:text-[#1e2b5f] hover:bg-blue-50 transition-colors",title:"Marcar como leída",children:e.jsx(p,{className:"h-4 w-4"})}),s.estado!=="archivada"&&e.jsx("button",{onClick:()=>M(s.id),className:"p-2 rounded-md text-[#2a3d83] hover:text-[#1e2b5f] hover:bg-blue-50 transition-colors",title:"Archivar",children:e.jsx(f,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>H(s.id),className:"p-2 rounded-md text-red-500 hover:text-red-700 hover:bg-red-50 transition-colors",title:"Eliminar",children:e.jsx(Z,{className:"h-4 w-4"})})]})})]},s.id)}):e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"py-8 px-6 text-center text-gray-500",children:[e.jsx(c,{className:"h-12 w-12 text-[#2a3d83] mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay notificaciones"}),e.jsx("p",{className:"text-gray-500",children:"No tienes notificaciones que coincidan con los criterios seleccionados."})]})})})]})}),a.last_page>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t px-6 pb-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Mostrando ",(a.current_page-1)*a.per_page+1," a"," ",Math.min(a.current_page*a.per_page,a.total)," de"," ",a.total," notificaciones"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>r.visit(`/admin/notificaciones?page=${a.current_page-1}`),disabled:a.current_page===1,children:[e.jsx(ee,{className:"h-4 w-4"}),"Anterior"]}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Página ",a.current_page," de ",a.last_page]}),e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>r.visit(`/admin/notificaciones?page=${a.current_page+1}`),disabled:a.current_page===a.last_page,children:["Siguiente",e.jsx(X,{className:"h-4 w-4"})]})]})]})]}),F&&e.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-lg flex items-center gap-3",children:[e.jsx(se,{className:"h-5 w-5 animate-spin text-[#2a3d83]"}),e.jsx("span",{children:"Procesando..."})]})}),e.jsx(G,{open:P,onOpenChange:x,children:e.jsxs(J,{className:"sm:max-w-[500px] max-h-[85vh] flex flex-col",children:[e.jsxs(Q,{className:"flex-shrink-0",children:[e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100",children:e.jsx(c,{className:"h-5 w-5 text-[#2a3d83]"})}),e.jsx("span",{className:"text-[#2a3d83] line-clamp-2",children:d?.titulo})]}),e.jsx(Y,{children:e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(K,{className:T[d?.prioridad||"media"],children:d?.prioridad}),e.jsx("span",{className:"text-sm text-gray-500",children:d?.created_at&&N(d.created_at)})]})})]}),e.jsx("div",{className:"py-4 flex-1 overflow-y-auto min-h-0",children:e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border",children:e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap text-sm leading-relaxed",children:d?.mensaje})})}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t flex-shrink-0",children:[e.jsx(i,{variant:"outline",onClick:()=>x(!1),children:"Cerrar"}),d?.accion_url&&e.jsxs(i,{onClick:()=>{x(!1),r.visit(d.accion_url)},className:"bg-[#2a3d83] hover:bg-[#1e2b5f]",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Ver Detalle"]})]})]})})]})]})}export{Be as default};
