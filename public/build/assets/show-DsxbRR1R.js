import{j as e,H as S,L as b}from"./app-DOeYTPnE.js";import{A as E}from"./app-sidebar-layout-83PL_wom.js";import{B as w}from"./button-BB3j1qH9.js";import{C as c,a as i,b as l,c as t,d as D}from"./card-BEZSel9K.js";import{B as n}from"./badge-BDHWk-Qv.js";import{T as H,a as L,b as m,c as h}from"./tabs-CZodpFxR.js";import{T as k,a as I,b as _,c as d,d as B,e as o}from"./table-TW3yL78Z.js";import{A as u,a as g}from"./alert-Dl-auDCw.js";import{A as U}from"./arrow-left-Cvz8oF6O.js";import{T as j,S as x}from"./triangle-alert-B7e9hRq_.js";import{C as f,U as F}from"./user-BiSWd6pJ.js";import{A}from"./activity-BLJcHynw.js";import{F as M}from"./index-Cl_hWV--.js";import{G as V}from"./globe-BPDeuemB.js";import{M as z}from"./monitor-CPLgKuzJ.js";/* empty css            */import"./index-B5i9qy2Y.js";import"./index-BuQaqXjb.js";import"./index-C7D1JV-H.js";import"./x-BHxLkKP3.js";import"./index-sj4qH-fg.js";import"./app-logo-icon-BTiqVlKS.js";import"./label-BvABT9uR.js";function oe({evento:r,eventos_relacionados:y,analisis:s}){const p=a=>{switch(a){case"crítico":return"destructive";case"alto":return"destructive";case"medio":return"default";case"bajo":return"secondary";default:return"outline"}},C=a=>{switch(a){case"crítico":return e.jsx(j,{className:"h-5 w-5 text-red-500"});case"alto":return e.jsx(j,{className:"h-5 w-5 text-orange-500"});case"medio":return e.jsx(f,{className:"h-5 w-5 text-yellow-500"});case"bajo":return e.jsx(x,{className:"h-5 w-5 text-green-500"});default:return e.jsx(x,{className:"h-5 w-5 text-gray-500"})}},v=a=>new Date(a).toLocaleString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),N=a=>a?typeof a=="string"?a:JSON.stringify(a,null,2):"N/A";return e.jsxs(E,{children:[e.jsx(S,{title:`Evento de Auditoría #${r.id}`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(b,{href:route("admin.auditoria.index"),children:e.jsxs(w,{variant:"outline",size:"sm",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Volver a Auditoría"]})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight",children:["Evento de Auditoría #",r.id]}),e.jsx("p",{className:"text-muted-foreground",children:v(r.fecha_hora)})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[C(r.nivel_riesgo),e.jsx(n,{variant:p(r.nivel_riesgo),className:"text-base px-3 py-1",children:r.nivel_riesgo.toUpperCase()})]})]}),r.nivel_riesgo==="crítico"&&e.jsxs(u,{variant:"destructive",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsxs(g,{children:[e.jsx("strong",{children:"¡Evento Crítico!"})," Este evento requiere investigación inmediata debido a su alto nivel de riesgo para la seguridad del sistema."]})]}),!s.contexto_temporal.es_horario_laboral&&e.jsxs(u,{children:[e.jsx(f,{className:"h-4 w-4"}),e.jsxs(g,{children:[e.jsx("strong",{children:"Horario Inusual:"})," Este evento ocurrió fuera del horario laboral (",s.contexto_temporal.horario," del ",s.contexto_temporal.dia_semana,")."]})]}),e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(A,{className:"h-5 w-5"}),e.jsx("span",{children:"Información del Evento"})]})}),e.jsx(t,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Acción Realizada"}),e.jsx("p",{className:"text-lg font-semibold",children:r.accion.replace("_"," ")}),e.jsx("p",{className:"text-gray-600",children:r.descripcion})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Usuario"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:r.usuario?.name||"Sistema"}),e.jsx("p",{className:"text-sm text-gray-500",children:r.usuario?.email})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Modelo Afectado"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"font-medium",children:r.modelo||"N/A"})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Categoría: ",s.categoria]})]})]})})]}),e.jsxs(H,{defaultValue:"contexto",className:"space-y-4",children:[e.jsxs(L,{children:[e.jsx(m,{value:"contexto",children:"Contexto"}),e.jsx(m,{value:"tecnico",children:"Información Técnica"}),e.jsx(m,{value:"relacionados",children:"Eventos Relacionados"}),e.jsx(m,{value:"analisis",children:"Análisis"})]}),e.jsx(h,{value:"contexto",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(V,{className:"h-5 w-5"}),e.jsx("span",{children:"Contexto Geográfico"})]})}),e.jsxs(t,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Dirección IP:"}),e.jsx("span",{className:"font-mono",children:s.contexto_geografico.ip})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"País:"}),e.jsx("span",{className:"font-medium",children:s.contexto_geografico.pais})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Ciudad:"}),e.jsx("span",{className:"font-medium",children:s.contexto_geografico.ciudad})]})]})]}),e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(f,{className:"h-5 w-5"}),e.jsx("span",{children:"Contexto Temporal"})]})}),e.jsxs(t,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Fecha y Hora:"}),e.jsx("span",{className:"font-medium",children:v(r.fecha_hora)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Día de la Semana:"}),e.jsx("span",{className:"font-medium",children:s.contexto_temporal.dia_semana})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Horario Laboral:"}),e.jsx(n,{variant:s.contexto_temporal.es_horario_laboral?"secondary":"destructive",children:s.contexto_temporal.es_horario_laboral?"Sí":"No"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Eventos Similares:"}),e.jsx("span",{className:"font-medium",children:s.eventos_similares})]})]})]})]})}),e.jsxs(h,{value:"tecnico",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(z,{className:"h-5 w-5"}),e.jsx("span",{children:"Información del Dispositivo"})]})}),e.jsxs(t,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Tipo de Dispositivo:"}),e.jsx("span",{className:"font-medium",children:s.contexto_tecnico.dispositivo})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Navegador:"}),e.jsx("span",{className:"font-medium",children:s.contexto_tecnico.navegador})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"text-gray-600 block mb-2",children:"User Agent:"}),e.jsx("div",{className:"bg-gray-50 p-3 rounded text-xs font-mono break-all",children:s.contexto_tecnico.user_agent})]})]})]}),e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(x,{className:"h-5 w-5"}),e.jsx("span",{children:"Datos Técnicos"})]})}),e.jsxs(t,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Hash de Integridad:"}),e.jsxs("span",{className:"font-mono text-xs",children:[r.hash_integridad?.substring(0,16),"..."]})]}),r.contexto_adicional&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 block mb-2",children:"Contexto Adicional:"}),e.jsx("div",{className:"bg-gray-50 p-3 rounded",children:e.jsx("pre",{className:"text-xs overflow-x-auto",children:N(r.contexto_adicional)})})]})]})]})]}),r.detalles&&e.jsxs(c,{children:[e.jsx(i,{children:e.jsx(l,{children:"Detalles del Evento"})}),e.jsx(t,{children:e.jsx("div",{className:"bg-gray-50 p-4 rounded",children:e.jsx("pre",{className:"text-sm overflow-x-auto",children:N(r.detalles)})})})]}),r.metadatos_cambios&&e.jsxs(c,{children:[e.jsx(i,{children:e.jsx(l,{children:"Metadatos de Cambios"})}),e.jsx(t,{children:e.jsx("div",{className:"bg-gray-50 p-4 rounded",children:e.jsx("pre",{className:"text-sm overflow-x-auto",children:N(r.metadatos_cambios)})})})]})]}),e.jsx(h,{value:"relacionados",className:"space-y-4",children:e.jsxs(c,{children:[e.jsxs(i,{children:[e.jsx(l,{children:"Eventos Relacionados"}),e.jsx(D,{children:"Eventos del mismo usuario en un período cercano (±2 horas)"})]}),e.jsx(t,{children:y.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(k,{children:[e.jsx(I,{children:e.jsxs(_,{children:[e.jsx(d,{children:"Fecha/Hora"}),e.jsx(d,{children:"Acción"}),e.jsx(d,{children:"Descripción"}),e.jsx(d,{children:"Riesgo"}),e.jsx(d,{children:"Acciones"})]})}),e.jsx(B,{children:y.map(a=>e.jsxs(_,{children:[e.jsx(o,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{children:new Date(a.fecha_hora).toLocaleDateString()}),e.jsx("div",{className:"text-gray-500",children:new Date(a.fecha_hora).toLocaleTimeString()})]})}),e.jsx(o,{className:"font-medium",children:a.accion.replace("_"," ")}),e.jsx(o,{children:e.jsx("div",{className:"max-w-xs truncate",title:a.descripcion,children:a.descripcion})}),e.jsx(o,{children:e.jsx(n,{variant:p(a.nivel_riesgo),children:a.nivel_riesgo})}),e.jsx(o,{children:e.jsx(b,{href:route("admin.auditoria.show",a.id),children:e.jsx(w,{variant:"outline",size:"sm",children:"Ver"})})})]},a.id))})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay eventos relacionados"}),e.jsx("p",{className:"text-gray-600",children:"No se encontraron otros eventos del mismo usuario en el período cercano."})]})})]})}),e.jsx(h,{value:"analisis",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(j,{className:"h-5 w-5"}),e.jsx("span",{children:"Evaluación de Riesgo"})]})}),e.jsx(t,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Nivel de Riesgo:"}),e.jsx(n,{variant:p(s.nivel_riesgo),className:"text-base",children:s.nivel_riesgo.toUpperCase()})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Categoría:"}),e.jsx("span",{className:"font-medium",children:s.categoria})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Eventos Similares (24h):"}),e.jsx(n,{variant:"outline",children:s.eventos_similares})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Horario Laboral:"}),e.jsx(n,{variant:s.contexto_temporal.es_horario_laboral?"secondary":"destructive",children:s.contexto_temporal.es_horario_laboral?"Sí":"No"})]})]})})]}),e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(x,{className:"h-5 w-5"}),e.jsx("span",{children:"Recomendaciones"})]})}),e.jsx(t,{children:s.recomendaciones.length>0?e.jsx("div",{className:"space-y-3",children:s.recomendaciones.map((a,T)=>e.jsx(u,{children:e.jsx(g,{children:a})},T))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(x,{className:"h-12 w-12 text-green-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Sin Recomendaciones"}),e.jsx("p",{className:"text-gray-600",children:"Este evento no requiere acciones adicionales en este momento."})]})})]})]})})]})]})]})}export{oe as default};
