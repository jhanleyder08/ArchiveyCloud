import{r as T,u as Z,j as e,H as U,L as N,b as _}from"./app-CsGFQ9fo.js";import{A as G}from"./app-layout-DtYB-9J7.js";import{c as L,B as o}from"./button-C354X_oJ.js";import{C as x,c as h,a as D,b as z,d as J}from"./card-h5scsD_j.js";import{I as b}from"./input-Ci5QH-R5.js";import{L as c}from"./label-jEdPJl0e.js";import{S as y,a as w,b as C,c as S,d as p,e as K}from"./select-Daz1HSyo.js";import{B as n}from"./badge-CGEk1Z-h.js";import{S as Q}from"./separator-BahHQi33.js";import{A as W,a as X}from"./alert-BSLpWtkT.js";import{h as F,C as Y,j as M,p as ee,q as se,s as ae,v as k}from"./app-sidebar-layout-DRoVZ8H9.js";import{F as re}from"./filter-CMEzYGOC.js";import{S as A}from"./star-CNDsh5Il.js";import{H as te}from"./hard-drive-D5_d0os_.js";import{T as le}from"./triangle-alert-CQKwObCB.js";import{S as B}from"./search-CxAGUSSs.js";import{R as ie}from"./rotate-ccw-CdY0H5Ii.js";import{D as oe}from"./users-Csc6ExCa.js";import{F as I}from"./Combination-DpDJaHHU.js";import{R as ce}from"./refresh-cw-BJmusPXE.js";import{F as ne}from"./folder-open-DlV_SzrJ.js";import{C as de}from"./folder-BNTGtE4_.js";import{E as me}from"./eye-raWYdSr2.js";import{T as xe}from"./trash-2-CrniV93e.js";/* empty css            */import"./index-zDZkFwf-.js";import"./index-DVLoub_T.js";import"./index-DINk-cxY.js";import"./check-Syp36_sr.js";import"./index-DCumGQuK.js";import"./x-CofVFViK.js";import"./index-BJyWeQrl.js";import"./app-logo-icon-CeRHrYtQ.js";import"./user-B2EfEEQ1.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]],pe=L("FileImage",he);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],ue=L("FileSpreadsheet",je);function We({indices:i,estadisticas:d,filtros:r,opcionesFiltros:u}){const[E,V]=T.useState(!1),[m,g]=T.useState(null),{data:t,setData:l,get:q,processing:j}=Z({busqueda_texto:r.busqueda_texto||"",tipo_entidad:r.tipo_entidad||"",serie_documental:r.serie_documental||"",nivel_acceso:r.nivel_acceso||"",fecha_inicio:r.fecha_inicio||"",fecha_fin:r.fecha_fin||"",solo_vitales:r.solo_vitales||!1,solo_historicos:r.solo_historicos||!1,orden_por:r.orden_por||"fecha_indexacion",direccion:r.direccion||"desc"}),H=s=>{s.preventDefault(),q("/admin/indices",{preserveState:!0})},R=()=>{l({busqueda_texto:"",tipo_entidad:"",serie_documental:"",nivel_acceso:"",fecha_inicio:"",fecha_fin:"",solo_vitales:!1,solo_historicos:!1,orden_por:"fecha_indexacion",direccion:"desc"}),q("/admin/indices")},$=(s,a)=>{const f={publico:"bg-green-100 text-green-800",restringido:"bg-yellow-100 text-yellow-800",confidencial:"bg-orange-100 text-orange-800",secreto:"bg-red-100 text-red-800"};return e.jsx(n,{className:f[s]||"bg-gray-100 text-gray-800",children:a})},O=(s,a)=>{const f={excelente:"bg-green-100 text-green-800",bueno:"bg-blue-100 text-blue-800",regular:"bg-yellow-100 text-yellow-800",malo:"bg-orange-100 text-orange-800",critico:"bg-red-100 text-red-800"};return e.jsx(n,{className:f[s]||"bg-gray-100 text-gray-800",children:a})},v=async s=>{g(s);try{await _.post("/admin/indices/exportar",{formato:s,filtros:t},{preserveState:!0,onSuccess:()=>{},onError:a=>{console.error("Error al exportar:",a),alert("Error al exportar los índices. Por favor, inténtelo de nuevo.")},onFinish:()=>{g(null)}})}catch(a){console.error("Error al exportar:",a),alert("Error al exportar los índices. Por favor, inténtelo de nuevo."),g(null)}},P=()=>{_.post("/admin/indices/regenerar",{tipo:"todos",solo_faltantes:!1},{preserveState:!0,onSuccess:()=>{_.reload()}})};return e.jsxs(G,{children:[e.jsx(U,{title:"Índices Electrónicos"}),e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(F,{className:"w-8 h-8 text-indigo-600"}),"Índices Electrónicos"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Sistema automático de indexación y búsqueda de documentos y expedientes"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(N,{href:"/admin/indices/estadisticas/dashboard",children:e.jsxs(o,{variant:"outline",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"Estadísticas"]})}),e.jsxs(o,{onClick:()=>V(!E),variant:"outline",children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),"Filtros Avanzados"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx(x,{children:e.jsx(h,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(F,{className:"h-8 w-8 text-indigo-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Índices"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.total_indices.toLocaleString()})]})]})})}),e.jsx(x,{children:e.jsx(h,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(A,{className:"h-8 w-8 text-yellow-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Documentos Vitales"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.documentos_vitales.toLocaleString()})]})]})})}),e.jsx(x,{children:e.jsx(h,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Valor Histórico"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.documentos_historicos.toLocaleString()})]})]})})}),e.jsx(x,{children:e.jsx(h,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tamaño Total"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.tamaño_total})]})]})})})]}),d.indices_desactualizados>0&&e.jsxs(W,{className:"mb-6 border-yellow-200 bg-yellow-50",children:[e.jsx(le,{className:"h-4 w-4 text-yellow-600"}),e.jsxs(X,{className:"text-yellow-800",children:["Hay ",e.jsx("strong",{children:d.indices_desactualizados})," índices que necesitan actualización (más de 6 meses sin actualizar)."]})]}),e.jsxs(x,{className:"mb-6",children:[e.jsx(D,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5"}),"Búsqueda y Filtros"]})}),e.jsx(h,{children:e.jsxs("form",{onSubmit:H,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-3",children:[e.jsx(c,{htmlFor:"busqueda_texto",children:"Búsqueda de texto completo"}),e.jsx(b,{id:"busqueda_texto",type:"text",placeholder:"Buscar por título, descripción, palabras clave...",value:t.busqueda_texto,onChange:s=>l("busqueda_texto",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"tipo_entidad",children:"Tipo de entidad"}),e.jsxs(y,{value:t.tipo_entidad,onValueChange:s=>l("tipo_entidad",s),children:[e.jsx(w,{children:e.jsx(C,{placeholder:"Todos los tipos"})}),e.jsxs(S,{children:[e.jsx(p,{value:"all",children:"Todos los tipos"}),Object.entries(u.tipos_entidad).map(([s,a])=>e.jsx(p,{value:s,children:a},s))]})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"nivel_acceso",children:"Nivel de acceso"}),e.jsxs(y,{value:t.nivel_acceso,onValueChange:s=>l("nivel_acceso",s),children:[e.jsx(w,{children:e.jsx(C,{placeholder:"Todos los niveles"})}),e.jsxs(S,{children:[e.jsx(p,{value:"all",children:"Todos los niveles"}),Object.entries(u.niveles_acceso).map(([s,a])=>e.jsx(p,{value:s,children:a},s))]})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"serie_documental",children:"Serie documental"}),e.jsxs(y,{value:t.serie_documental,onValueChange:s=>l("serie_documental",s),children:[e.jsx(w,{children:e.jsx(C,{placeholder:"Todas las series"})}),e.jsxs(S,{children:[e.jsx(p,{value:"all",children:"Todas las series"}),u.series_documentales.map(s=>e.jsx(p,{value:s,children:s},s))]})]})]})]}),E&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"fecha_inicio",children:"Fecha inicio"}),e.jsx(b,{id:"fecha_inicio",type:"date",value:t.fecha_inicio,onChange:s=>l("fecha_inicio",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"fecha_fin",children:"Fecha fin"}),e.jsx(b,{id:"fecha_fin",type:"date",value:t.fecha_fin,onChange:s=>l("fecha_fin",s.target.value)})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-6",children:[e.jsx("input",{id:"solo_vitales",type:"checkbox",checked:t.solo_vitales,onChange:s=>l("solo_vitales",s.target.checked),className:"rounded border-gray-300"}),e.jsx(c,{htmlFor:"solo_vitales",children:"Solo información vital"})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-6",children:[e.jsx("input",{id:"solo_historicos",type:"checkbox",checked:t.solo_historicos,onChange:s=>l("solo_historicos",s.target.checked),className:"rounded border-gray-300"}),e.jsx(c,{htmlFor:"solo_historicos",children:"Solo valor histórico"})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(o,{type:"submit",disabled:j,children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),j?"Buscando...":"Buscar"]}),e.jsxs(o,{type:"button",variant:"outline",onClick:R,children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Limpiar"]})]})]})})]}),e.jsxs(x,{children:[e.jsx(D,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(z,{children:"Resultados de búsqueda"}),e.jsxs(J,{children:[i.total," índice(s) encontrado(s) - Mostrando ",i.from," a ",i.to]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(ee,{children:[e.jsx(se,{asChild:!0,children:e.jsxs(o,{variant:"outline",size:"sm",disabled:m!==null,children:[e.jsx(oe,{className:"w-4 h-4 mr-1"}),m?`Exportando ${m.toUpperCase()}...`:"Exportar",e.jsx(K,{className:"w-3 h-3 ml-1"})]})}),e.jsxs(ae,{align:"end",children:[e.jsxs(k,{onClick:()=>v("csv"),disabled:m!==null,children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Exportar CSV"]}),e.jsxs(k,{onClick:()=>v("excel"),disabled:m!==null,children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),"Exportar Excel"]}),e.jsxs(k,{onClick:()=>v("pdf"),disabled:m!==null,children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"Exportar PDF"]})]})]}),e.jsxs(o,{variant:"outline",size:"sm",onClick:P,disabled:j,children:[e.jsx(ce,{className:`w-4 h-4 mr-1 ${j?"animate-spin":""}`}),j?"Regenerando...":"Regenerar"]})]})]})}),e.jsxs(h,{children:[i.data.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(F,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No se encontraron índices con los criterios especificados"})]}):e.jsx("div",{className:"space-y-4",children:i.data.map(s=>e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.tipo_entidad==="expediente"?e.jsx(ne,{className:"w-5 h-5 text-blue-600"}):e.jsx(I,{className:"w-5 h-5 text-green-600"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:s.titulo}),s.es_reciente&&e.jsx(n,{variant:"outline",className:"text-green-600 border-green-300",children:"Nuevo"}),s.necesita_actualizacion&&e.jsxs(n,{variant:"outline",className:"text-orange-600 border-orange-300",children:[e.jsx(de,{className:"w-3 h-3 mr-1"}),"Desactualizado"]})]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("span",{className:"font-medium",children:"Código:"})," ",s.codigo_completo," |"," ",e.jsx("span",{className:"font-medium",children:"Serie:"})," ",s.serie_documental||"Sin clasificar"," |"," ",e.jsx("span",{className:"font-medium",children:"Folios:"})," ",s.cantidad_folios||"N/A"," |"," ",e.jsx("span",{className:"font-medium",children:"Tamaño:"})," ",s.tamaño_formateado]}),s.descripcion&&e.jsx("p",{className:"text-sm text-gray-700 mb-3 line-clamp-2",children:s.descripcion}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(n,{variant:"outline",className:"capitalize",children:s.tipo_entidad}),$(s.nivel_acceso,s.etiqueta_nivel_acceso),O(s.estado_conservacion,s.etiqueta_estado_conservacion),s.es_vital&&e.jsxs(n,{className:"bg-yellow-100 text-yellow-800",children:[e.jsx(A,{className:"w-3 h-3 mr-1"}),"Vital"]}),s.es_historico&&e.jsxs(n,{className:"bg-purple-100 text-purple-800",children:[e.jsx(M,{className:"w-3 h-3 mr-1"}),"Histórico"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{href:`/admin/indices/${s.id}`,children:e.jsxs(o,{variant:"outline",size:"sm",children:[e.jsx(me,{className:"w-4 h-4 mr-1"}),"Ver"]})}),e.jsx(o,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",children:e.jsx(xe,{className:"w-4 h-4"})})]})]})},s.id))}),i.last_page>1&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx("div",{className:"flex items-center space-x-2",children:Array.from({length:i.last_page},(s,a)=>a+1).map(s=>e.jsx(N,{href:`/admin/indices?page=${s}`,className:`px-3 py-1 rounded ${s===i.current_page?"bg-indigo-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:s},s))})})]})]})]})]})}export{We as default};
