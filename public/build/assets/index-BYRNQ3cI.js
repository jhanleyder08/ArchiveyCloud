import{r as H,j as e,H as M,L as f,b as p}from"./app-xP5nJVeF.js";import{f as P}from"./app-sidebar-layout-Bv9w89yC.js";import{c as U,B as x}from"./button-B_iUXIQd.js";import{C as c,c as n,a as C,b as y,d as z}from"./card-CWOinnut.js";import{I as F}from"./input-DQqwP0kM.js";import{S as h,a as j,b as g,c as u,d as a}from"./select-CeZZq-kY.js";import{B as b}from"./Combination-BMQq9fx8.js";import{T as q,a as G,b as w,c as t,d as K,e as d}from"./table-B_nFRheg.js";import{R as O}from"./refresh-cw-Fn0W1b7X.js";import{S as T,T as _}from"./triangle-alert-3Hg381hi.js";import{C as S}from"./circle-check-big-C9Zhhz8Y.js";import{C as V}from"./circle-x-mSiP6KhD.js";import{F as X}from"./filter-B4m93Jsj.js";import{S as $}from"./search-eio2uEn4.js";import{D as J}from"./users-DpyCPIO9.js";import{C as Q}from"./folder-Ck8Tq3sH.js";/* empty css            */import"./index-DbDMva29.js";import"./index-D2eHBSbe.js";import"./index-Blg4NNxt.js";import"./x-CBQbsaML.js";import"./app-logo-icon-8EdVYcX9.js";import"./label-CXywCScm.js";import"./user-OU0Y1c1r.js";import"./mail-C5oL3AE1.js";import"./BrandingProvider-BV5yFGOU.js";import"./index-B00g0JPb.js";import"./check-C5qgcy3h.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],D=U("CirclePlus",W);function Ve({certificados:l,estadisticas:o,usuarios:A,filtros:i}){const[Y,Z]=H.useState(!1),B=s=>{switch(s){case"activo":return"default";case"vencido":return"destructive";case"revocado":return"secondary";case"suspendido":return"outline";default:return"secondary"}},k=s=>s.estado==="revocado"?e.jsx(V,{className:"h-4 w-4 text-red-500"}):s.vigente?s.proximo_a_vencer?e.jsx(Q,{className:"h-4 w-4 text-yellow-500"}):e.jsx(S,{className:"h-4 w-4 text-green-500"}):e.jsx(_,{className:"h-4 w-4 text-orange-500"}),I=s=>({usuario:"Usuario",servidor:"Servidor",autoridad_certificadora:"Autoridad CA",sello_tiempo:"Sello de Tiempo"})[s]||s,v=(s,r)=>{const N=route("admin.certificados.index",{...i,[s]:r==="all"?"":r,page:1});p.get(N)},L=s=>{const r=route("admin.certificados.index",{...i,buscar:s,page:1});p.get(r)},E=(s,r)=>{const N=route("admin.certificados.descargar",{certificado:s,formato:r}),m=document.createElement("a");m.href=N,m.setAttribute("download",""),document.body.appendChild(m),m.click(),document.body.removeChild(m)},R=()=>{p.reload()};return e.jsxs(P,{children:[e.jsx(M,{title:"Certificados Digitales"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Certificados Digitales"}),e.jsx("p",{className:"text-muted-foreground",children:"Gestión y administración de certificados digitales PKI"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(x,{variant:"outline",size:"sm",onClick:R,children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Actualizar"]}),e.jsx(f,{href:route("admin.certificados.create"),children:e.jsxs(x,{children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Nuevo Certificado"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(c,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(T,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Certificados"}),e.jsx("p",{className:"text-2xl font-bold",children:o.total})]})]})})}),e.jsx(c,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(S,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Activos"}),e.jsx("p",{className:"text-2xl font-bold",children:o.activos})]})]})})}),e.jsx(c,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(_,{className:"h-8 w-8 text-orange-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Próximos a Vencer"}),e.jsx("p",{className:"text-2xl font-bold",children:o.proximos_vencer})]})]})})}),e.jsx(c,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{className:"h-8 w-8 text-red-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Vencidos/Revocados"}),e.jsx("p",{className:"text-2xl font-bold",children:o.vencidos+o.revocados})]})]})})})]}),e.jsxs(c,{children:[e.jsx(C,{children:e.jsxs(y,{className:"flex items-center",children:[e.jsx(X,{className:"h-5 w-5 mr-2"}),"Filtros de Búsqueda"]})}),e.jsx(n,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Búsqueda"}),e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(F,{placeholder:"Buscar certificados...",defaultValue:i.buscar,className:"pl-9",onChange:s=>{clearTimeout(window.searchTimeout),window.searchTimeout=setTimeout(()=>{L(s.target.value)},500)}})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Estado"}),e.jsxs(h,{value:i.estado||"all",onValueChange:s=>v("estado",s),children:[e.jsx(j,{children:e.jsx(g,{placeholder:"Todos los estados"})}),e.jsxs(u,{children:[e.jsx(a,{value:"all",children:"Todos los estados"}),e.jsx(a,{value:"activo",children:"Activo"}),e.jsx(a,{value:"vencido",children:"Vencido"}),e.jsx(a,{value:"revocado",children:"Revocado"}),e.jsx(a,{value:"suspendido",children:"Suspendido"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Tipo"}),e.jsxs(h,{value:i.tipo_certificado||"all",onValueChange:s=>v("tipo_certificado",s),children:[e.jsx(j,{children:e.jsx(g,{placeholder:"Todos los tipos"})}),e.jsxs(u,{children:[e.jsx(a,{value:"all",children:"Todos los tipos"}),e.jsx(a,{value:"usuario",children:"Usuario"}),e.jsx(a,{value:"servidor",children:"Servidor"}),e.jsx(a,{value:"autoridad_certificadora",children:"Autoridad CA"}),e.jsx(a,{value:"sello_tiempo",children:"Sello de Tiempo"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Usuario"}),e.jsxs(h,{value:i.usuario_id||"all",onValueChange:s=>v("usuario_id",s),children:[e.jsx(j,{children:e.jsx(g,{placeholder:"Todos los usuarios"})}),e.jsxs(u,{children:[e.jsx(a,{value:"all",children:"Todos los usuarios"}),A.map(s=>e.jsx(a,{value:s.id.toString(),children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Vencimiento"}),e.jsxs(h,{value:i.vencimiento||"all",onValueChange:s=>v("vencimiento",s),children:[e.jsx(j,{children:e.jsx(g,{placeholder:"Todos"})}),e.jsxs(u,{children:[e.jsx(a,{value:"all",children:"Todos"}),e.jsx(a,{value:"vigentes",children:"Vigentes"}),e.jsx(a,{value:"proximos_vencer",children:"Próximos a vencer"}),e.jsx(a,{value:"vencidos",children:"Vencidos"})]})]})]})]})})]}),e.jsxs(c,{children:[e.jsxs(C,{children:[e.jsxs(y,{children:["Certificados Digitales (",l.meta?.total||0,")"]}),e.jsxs(z,{children:["Mostrando ",l.meta?.from||0," a ",l.meta?.to||0," de ",l.meta?.total||0," certificados"]})]}),e.jsxs(n,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(q,{children:[e.jsx(G,{children:e.jsxs(w,{children:[e.jsx(t,{children:"Estado"}),e.jsx(t,{children:"Certificado"}),e.jsx(t,{children:"Usuario"}),e.jsx(t,{children:"Tipo"}),e.jsx(t,{children:"Algoritmo"}),e.jsx(t,{children:"Vencimiento"}),e.jsx(t,{children:"Acciones"})]})}),e.jsx(K,{children:l.data.map(s=>e.jsxs(w,{children:[e.jsx(d,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[k(s),e.jsx(b,{variant:B(s.estado),children:s.estado})]})}),e.jsx(d,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.nombre_certificado}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Serie: ",s.numero_serie.slice(0,16),"..."]})]})}),e.jsx(d,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.usuario.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.usuario.email})]})}),e.jsx(d,{children:e.jsx(b,{variant:"outline",children:I(s.tipo_certificado)})}),e.jsx(d,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{children:s.algoritmo_firma}),e.jsxs("div",{className:"text-gray-500",children:[s.longitud_clave," bits"]})]})}),e.jsx(d,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{children:new Date(s.fecha_vencimiento).toLocaleDateString()}),s.vigente&&e.jsxs("div",{className:`text-xs ${s.proximo_a_vencer?"text-orange-600":"text-gray-500"}`,children:[s.dias_restantes," días restantes"]})]})}),e.jsx(d,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(f,{href:route("admin.certificados.show",s.id),children:e.jsx(x,{variant:"outline",size:"sm",children:"Ver"})}),e.jsxs(h,{onValueChange:r=>E(s.id,r),children:[e.jsx(j,{className:"w-auto h-8",children:e.jsx(J,{className:"h-4 w-4"})}),e.jsxs(u,{children:[e.jsx(a,{value:"pem",children:"Descargar PEM"}),e.jsx(a,{value:"der",children:"Descargar DER"}),e.jsx(a,{value:"crt",children:"Descargar CRT"})]})]})]})})]},s.id))})]})}),l.data.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(T,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay certificados"}),e.jsx("p",{className:"text-gray-600 mb-4",children:Object.keys(i).length>0?"No se encontraron certificados con los filtros aplicados":"Aún no se han creado certificados digitales"}),e.jsx(f,{href:route("admin.certificados.create"),children:e.jsxs(x,{children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Crear primer certificado"]})})]}),(l.meta?.last_page||0)>1&&e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Mostrando ",l.meta?.from||0," a ",l.meta?.to||0," de ",l.meta?.total||0," resultados"]}),e.jsx("div",{className:"flex space-x-1",children:(l.links||[]).map((s,r)=>e.jsx(x,{variant:s.active?"default":"outline",size:"sm",onClick:()=>s.url&&p.get(s.url),disabled:!s.url,dangerouslySetInnerHTML:{__html:s.label}},r))})]})]})]})]})]})}export{Ve as default};
