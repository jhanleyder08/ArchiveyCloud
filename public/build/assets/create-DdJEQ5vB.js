import{r as g,u as T,j as e,H as V,L as y}from"./app-1TbR1aNv.js";import{A as W}from"./app-layout-DBvULR4o.js";import{B as d}from"./button-Bh8HL4t-.js";import{C as m,a as x,b as p,d as j,c as h}from"./card-CjIDma1Z.js";import{L as o}from"./label-CB51Zwfa.js";import{I as w}from"./input-B9S_DJNe.js";import{G as E,T as H}from"./app-sidebar-layout-EVqXnw4l.js";import{S as C,a as _,b as S,c as A,d as q}from"./select-55yoEt5h.js";import{C as R}from"./checkbox-BJoXUXry.js";import{B as k}from"./badge-CahYhPrs.js";import{A as U,a as z}from"./alert-a9IGCIbG.js";import{F as G}from"./Combination-Bg4lGtaS.js";import{U as M}from"./users-KtdTbN4b.js";import{X as P}from"./x-BA_bLoEE.js";import{C as X}from"./circle-alert-IdL8hEBm.js";import{C as J}from"./folder-BrHeBlTR.js";/* empty css            */import"./index-DV8Rt-0p.js";import"./index-DaDMCySO.js";import"./index-12rucE5D.js";import"./index-B37z7FM4.js";import"./app-logo-icon-D5sKSL8w.js";import"./user-Eo78Nm40.js";import"./mail-Dw8iYVcL.js";import"./triangle-alert-Csu15FGV.js";import"./search-BY4VdWrh.js";import"./index-BRmIzMxm.js";import"./check-BetP237p.js";function we({documento:t,usuariosDisponibles:u}){const[r,f]=g.useState([]),[K,D]=g.useState(!t),{data:n,setData:l,post:B,processing:b,errors:i}=T({documento_id:t?.id.toString()||"",aprobadores:[],descripcion:"",prioridad:2,requiere_unanime:!1,dias_vencimiento:7}),v=[{valor:4,etiqueta:"Crítica",color:"text-red-600"},{valor:3,etiqueta:"Alta",color:"text-orange-600"},{valor:2,etiqueta:"Media",color:"text-blue-600"},{valor:1,etiqueta:"Baja",color:"text-gray-600"}],F=s=>{s.preventDefault(),r.length!==0&&B("/admin/workflow",{...n,aprobadores:r.map(a=>a.id)})},I=s=>{if(!r.find(a=>a.id===s.id)){const a=[...r,s];f(a),l("aprobadores",a.map(c=>c.id))}},L=s=>{const a=r.filter(c=>c.id!==s);f(a),l("aprobadores",a.map(c=>c.id))},N=v.find(s=>s.valor===n.prioridad);return e.jsxs(W,{children:[e.jsx(V,{title:"Nuevo Workflow de Aprobación"}),e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(E,{className:"w-8 h-8 text-blue-600"}),"Nuevo Workflow de Aprobación"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Inicia un proceso de aprobación para un documento"})]}),e.jsx(y,{href:"/admin/workflow",children:e.jsx(d,{variant:"outline",children:"Volver a Workflows"})})]}),e.jsx("form",{onSubmit:F,className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(m,{children:[e.jsxs(x,{children:[e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5"}),"Documento a Aprobar"]}),e.jsx(j,{children:"Selecciona el documento que necesita aprobación"})]}),e.jsx(h,{children:t?e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900",children:t.nombre}),e.jsx("p",{className:"text-sm text-blue-700",children:t.codigo}),t.expediente&&e.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:["Expediente: ",t.expediente.numero," - ",t.expediente.titulo]})]}),e.jsx(d,{type:"button",variant:"outline",size:"sm",onClick:()=>D(!0),children:"Cambiar"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(o,{htmlFor:"documento_id",children:"Documento *"}),e.jsx(w,{id:"documento_id",placeholder:"Buscar documento por nombre o código...",className:i.documento_id?"border-red-500":""}),i.documento_id&&e.jsx("p",{className:"text-sm text-red-600",children:i.documento_id}),e.jsx("p",{className:"text-sm text-gray-500",children:"Nota: La búsqueda de documentos se implementará próximamente"})]})})]}),e.jsxs(m,{children:[e.jsxs(x,{children:[e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5"}),"Aprobadores"]}),e.jsx(j,{children:"Selecciona los usuarios que deben aprobar este documento"})]}),e.jsxs(h,{className:"space-y-4",children:[r.length>0&&e.jsxs("div",{children:[e.jsxs(o,{className:"text-sm font-medium",children:["Aprobadores Seleccionados (",r.length,")"]}),e.jsx("div",{className:"space-y-2 mt-2",children:r.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-sm font-medium text-blue-600",children:a+1}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.cargo})]})]}),e.jsx(d,{type:"button",variant:"ghost",size:"sm",onClick:()=>L(s.id),children:e.jsx(P,{className:"w-4 h-4"})})]},s.id))})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"nuevo_aprobador",children:"Agregar Aprobador"}),e.jsxs(C,{onValueChange:s=>{const a=u.find(c=>c.id.toString()===s);a&&I(a)},children:[e.jsx(_,{children:e.jsx(S,{placeholder:"Seleccionar usuario..."})}),e.jsx(A,{children:u.filter(s=>!r.find(a=>a.id===s.id)).map(s=>e.jsx(q,{value:s.id.toString(),children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.cargo," - ",s.email]})]})},s.id))})]})]}),r.length===0&&e.jsxs(U,{children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx(z,{children:"Debes seleccionar al menos un aprobador para continuar."})]}),r.length>1&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{id:"requiere_unanime",checked:n.requiere_unanime,onCheckedChange:s=>l("requiere_unanime",!!s)}),e.jsx(o,{htmlFor:"requiere_unanime",className:"text-sm",children:"Requiere aprobación unánime (todos deben aprobar)"})]})]})]}),e.jsxs(m,{children:[e.jsxs(x,{children:[e.jsx(p,{children:"Descripción de la Solicitud"}),e.jsx(j,{children:"Explica por qué este documento necesita aprobación"})]}),e.jsxs(h,{children:[e.jsx(H,{placeholder:"Describe el motivo de la aprobación, contexto adicional, o instrucciones específicas...",value:n.descripcion,onChange:s=>l("descripcion",s.target.value),rows:4,className:i.descripcion?"border-red-500":""}),i.descripcion&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:i.descripcion})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5"}),"Configuración"]})}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(o,{children:"Prioridad *"}),e.jsxs(C,{value:n.prioridad.toString(),onValueChange:s=>l("prioridad",parseInt(s)),children:[e.jsx(_,{children:e.jsx(S,{})}),e.jsx(A,{children:v.map(s=>e.jsx(q,{value:s.valor.toString(),children:e.jsx("span",{className:s.color,children:s.etiqueta})},s.valor))})]}),i.prioridad&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:i.prioridad})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"dias_vencimiento",children:"Días para vencer *"}),e.jsx(w,{id:"dias_vencimiento",type:"number",min:"1",max:"30",value:n.dias_vencimiento,onChange:s=>l("dias_vencimiento",parseInt(s.target.value)||7),className:i.dias_vencimiento?"border-red-500":""}),i.dias_vencimiento&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:i.dias_vencimiento}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Fecha de vencimiento: ",new Date(Date.now()+n.dias_vencimiento*24*60*60*1e3).toLocaleDateString()]})]})]})]}),e.jsxs(m,{children:[e.jsx(x,{children:e.jsx(p,{children:"Resumen"})}),e.jsxs(h,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Documento:"}),e.jsx("span",{className:"text-sm font-medium",children:t?"✓":"✗"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Aprobadores:"}),e.jsx("span",{className:"text-sm font-medium",children:r.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Prioridad:"}),e.jsx(k,{variant:"outline",className:N?.color,children:N?.etiqueta})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Vencimiento:"}),e.jsxs("span",{className:"text-sm font-medium",children:[n.dias_vencimiento," días"]})]}),n.requiere_unanime&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Tipo:"}),e.jsx(k,{variant:"outline",className:"text-orange-600",children:"Unánime"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(d,{type:"submit",className:"w-full",disabled:b||!t||r.length===0,children:b?"Creando...":"Iniciar Workflow"}),e.jsx(y,{href:"/admin/workflow",children:e.jsx(d,{variant:"outline",className:"w-full",children:"Cancelar"})})]})]})]})})]})]})}export{we as default};
