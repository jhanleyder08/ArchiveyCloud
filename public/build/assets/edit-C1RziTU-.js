import{r as d,j as e,u as Q,H as Y,L as V}from"./app-DrMHtwH1.js";import{A as Z,g as ee,T as H,S as se,U as ae,X as ce}from"./app-layout-COFKgQre.js";import{u as G,a as M,B as T}from"./app-logo-icon-DnuI3TUW.js";import{P as O,L as l,I as D}from"./label-ZEFSidbo.js";import{u as ie,c as re,a as le,b as ne}from"./index-BtFcMv-P.js";import{u as te}from"./index-Tj7VsbP3.js";import{S as N,a as _,b as C,c as y,d as t}from"./select-C3PJf4bd.js";import{C as w,a as S,b as k,d as E,c as P}from"./card-w4aTBsTl.js";import{B as de}from"./badge-DRDxymkG.js";import{A as oe,a as me}from"./alert-TDkGQitV.js";import{A as he}from"./arrow-left-Cd7BscWt.js";import{S as U}from"./save-DW_73BZB.js";import{C as xe}from"./circle-alert-sRdLjo9_.js";import{C as ue}from"./calendar-ZXSvnWkq.js";import{S as q}from"./shield-Ciiyczi4.js";import{T as pe}from"./tag-Cmx8ZVHn.js";import{P as je}from"./plus-BMjvli-P.js";/* empty css            */import"./index-CRop9Any.js";import"./check-BaKQiqL_.js";var L="Switch",[fe,Ue]=re(L),[be,ve]=fe(L),z=d.forwardRef((a,o)=>{const{__scopeSwitch:n,name:p,checked:c,defaultChecked:m,required:j,disabled:h,value:f="on",onCheckedChange:i,form:r,...A}=a,[x,b]=d.useState(null),F=G(o,u=>b(u)),v=d.useRef(!1),I=x?r||!!x.closest("form"):!0,[g,s]=ie({prop:c,defaultProp:m??!1,onChange:i,caller:L});return e.jsxs(be,{scope:n,checked:g,disabled:h,children:[e.jsx(O.button,{type:"button",role:"switch","aria-checked":g,"aria-required":j,"data-state":W(g),"data-disabled":h?"":void 0,disabled:h,value:f,...A,ref:F,onClick:le(a.onClick,u=>{s(R=>!R),I&&(v.current=u.isPropagationStopped(),v.current||u.stopPropagation())})}),I&&e.jsx(X,{control:x,bubbles:!v.current,name:p,value:f,checked:g,required:j,disabled:h,form:r,style:{transform:"translateX(-100%)"}})]})});z.displayName=L;var $="SwitchThumb",K=d.forwardRef((a,o)=>{const{__scopeSwitch:n,...p}=a,c=ve($,n);return e.jsx(O.span,{"data-state":W(c.checked),"data-disabled":c.disabled?"":void 0,...p,ref:o})});K.displayName=$;var ge="SwitchBubbleInput",X=d.forwardRef(({__scopeSwitch:a,control:o,checked:n,bubbles:p=!0,...c},m)=>{const j=d.useRef(null),h=G(j,m),f=te(n),i=ne(o);return d.useEffect(()=>{const r=j.current;if(!r)return;const A=window.HTMLInputElement.prototype,b=Object.getOwnPropertyDescriptor(A,"checked").set;if(f!==n&&b){const F=new Event("click",{bubbles:p});b.call(r,n),r.dispatchEvent(F)}},[f,n,p]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...c,tabIndex:-1,ref:h,style:{...c.style,...i,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});X.displayName=ge;function W(a){return a?"checked":"unchecked"}var J=z,Ne=K;const B=d.forwardRef(({className:a,...o},n)=>e.jsx(J,{className:M("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...o,ref:n,children:e.jsx(Ne,{className:M("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));B.displayName=J.displayName;function Ge({expediente:a,series:o,departamentos:n,responsables:p,errors:c}){const[m,j]=d.useState(""),[h,f]=d.useState([]),{data:i,setData:r,put:A,processing:x,isDirty:b}=Q({nombre:a.nombre||"",descripcion:a.descripcion||"",estado:a.estado||"abierto",fecha_apertura:a.fecha_apertura?a.fecha_apertura.split("T")[0]:"",fecha_cierre:a.fecha_cierre?a.fecha_cierre.split("T")[0]:"",ubicacion_fisica:a.ubicacion_fisica||"",responsable:a.responsable||"",departamento:a.departamento||"",clasificacion_serie:a.clasificacion_serie||"",clasificacion_subserie:a.clasificacion_subserie||"",nivel_acceso:a.nivel_acceso||"publico",palabras_clave:a.palabras_clave||[],observaciones:a.observaciones||"",permite_documentos_electronicos:a.configuracion?.permite_documentos_electronicos??!0,requiere_firma_digital:a.configuracion?.requiere_firma_digital??!1,control_versiones:a.configuracion?.control_versiones??!0,notificaciones_automaticas:a.configuracion?.notificaciones_automaticas??!0});d.useEffect(()=>{if(i.clasificacion_serie){const s=o.find(R=>R.nombre===i.clasificacion_serie);f(s?.subseries||[]),s?.subseries.some(R=>R.nombre===i.clasificacion_subserie)||r("clasificacion_subserie","")}else f([]),r("clasificacion_subserie","")},[i.clasificacion_serie]);const F=s=>{s.preventDefault(),A(route("admin.expedientes.update",a.id))},v=()=>{m.trim()&&!i.palabras_clave.includes(m.trim())&&(r("palabras_clave",[...i.palabras_clave,m.trim()]),j(""))},I=s=>{r("palabras_clave",i.palabras_clave.filter(u=>u!==s))},g=s=>{s.key==="Enter"&&(s.preventDefault(),v())};return e.jsxs(Z,{children:[e.jsx(Y,{title:`Editar Expediente: ${a.nombre}`}),e.jsxs("form",{onSubmit:F,className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(V,{href:route("admin.expedientes.index"),className:"text-sm text-muted-foreground hover:text-foreground",children:"Expedientes"}),e.jsx("span",{className:"text-muted-foreground",children:"/"}),e.jsx(V,{href:route("admin.expedientes.show",a.id),className:"text-sm text-muted-foreground hover:text-foreground",children:a.codigo}),e.jsx("span",{className:"text-muted-foreground",children:"/"}),e.jsx("span",{className:"font-medium",children:"Editar"})]}),e.jsx("h1",{className:"text-2xl font-bold mt-1",children:"Editar Expediente"}),e.jsx("p",{className:"text-muted-foreground",children:"Modifica la información del expediente"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{type:"button",variant:"outline",asChild:!0,children:e.jsxs(V,{href:route("admin.expedientes.show",a.id),children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"Cancelar"]})}),e.jsxs(T,{type:"submit",disabled:x||!b,children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),x?"Guardando...":"Guardar Cambios"]})]})]}),b&&e.jsxs(oe,{children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsx(me,{children:"Tienes cambios sin guardar. Asegúrate de guardar antes de salir."})]}),e.jsxs(w,{children:[e.jsxs(S,{children:[e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(ee,{className:"h-5 w-5"}),e.jsx("span",{children:"Información General"})]}),e.jsx(E,{children:"Información básica del expediente"})]}),e.jsxs(P,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"nombre",children:"Nombre del Expediente *"}),e.jsx(D,{id:"nombre",value:i.nombre,onChange:s=>r("nombre",s.target.value),placeholder:"Nombre del expediente",className:c.nombre?"border-red-500":""}),c.nombre&&e.jsx("p",{className:"text-sm text-red-500",children:c.nombre})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"estado",children:"Estado"}),e.jsxs(N,{value:i.estado,onValueChange:s=>r("estado",s),children:[e.jsx(_,{children:e.jsx(C,{placeholder:"Selecciona el estado"})}),e.jsxs(y,{children:[e.jsx(t,{value:"abierto",children:"Abierto"}),e.jsx(t,{value:"tramite",children:"En Trámite"}),e.jsx(t,{value:"revision",children:"En Revisión"}),e.jsx(t,{value:"cerrado",children:"Cerrado"}),e.jsx(t,{value:"archivado",children:"Archivado"})]})]}),c.estado&&e.jsx("p",{className:"text-sm text-red-500",children:c.estado})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"descripcion",children:"Descripción *"}),e.jsx(H,{id:"descripcion",value:i.descripcion,onChange:s=>r("descripcion",s.target.value),placeholder:"Describe el propósito y contenido del expediente",className:`min-h-[100px] ${c.descripcion?"border-red-500":""}`}),c.descripcion&&e.jsx("p",{className:"text-sm text-red-500",children:c.descripcion})]})]})]}),e.jsxs(w,{children:[e.jsxs(S,{children:[e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(ue,{className:"h-5 w-5"}),e.jsx("span",{children:"Fechas"})]}),e.jsx(E,{children:"Fechas de apertura y cierre del expediente"})]}),e.jsx(P,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"fecha_apertura",children:"Fecha de Apertura *"}),e.jsx(D,{id:"fecha_apertura",type:"date",value:i.fecha_apertura,onChange:s=>r("fecha_apertura",s.target.value),className:c.fecha_apertura?"border-red-500":""}),c.fecha_apertura&&e.jsx("p",{className:"text-sm text-red-500",children:c.fecha_apertura})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"fecha_cierre",children:"Fecha de Cierre"}),e.jsx(D,{id:"fecha_cierre",type:"date",value:i.fecha_cierre,onChange:s=>r("fecha_cierre",s.target.value),className:c.fecha_cierre?"border-red-500":""}),c.fecha_cierre&&e.jsx("p",{className:"text-sm text-red-500",children:c.fecha_cierre})]})]})})]}),e.jsxs(w,{children:[e.jsxs(S,{children:[e.jsx(k,{children:"Clasificación Archivística"}),e.jsx(E,{children:"Serie y subserie documental según el CCD"})]}),e.jsx(P,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"clasificacion_serie",children:"Serie Documental *"}),e.jsxs(N,{value:i.clasificacion_serie,onValueChange:s=>r("clasificacion_serie",s),children:[e.jsx(_,{children:e.jsx(C,{placeholder:"Selecciona una serie"})}),e.jsx(y,{children:o.map(s=>e.jsxs(t,{value:s.nombre,children:[s.codigo," - ",s.nombre]},s.id))})]}),c.clasificacion_serie&&e.jsx("p",{className:"text-sm text-red-500",children:c.clasificacion_serie})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"clasificacion_subserie",children:"Subserie Documental"}),e.jsxs(N,{value:i.clasificacion_subserie,onValueChange:s=>r("clasificacion_subserie",s),disabled:!i.clasificacion_serie||h.length===0,children:[e.jsx(_,{children:e.jsx(C,{placeholder:"Selecciona una subserie"})}),e.jsx(y,{children:h.map(s=>e.jsxs(t,{value:s.nombre,children:[s.codigo," - ",s.nombre]},s.id))})]}),c.clasificacion_subserie&&e.jsx("p",{className:"text-sm text-red-500",children:c.clasificacion_subserie})]})]})})]}),e.jsxs(w,{children:[e.jsxs(S,{children:[e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(se,{className:"h-5 w-5"}),e.jsx("span",{children:"Configuración"})]}),e.jsx(E,{children:"Configuración de funcionalidades del expediente"})]}),e.jsx(P,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{className:"text-base",children:"Documentos Electrónicos"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Permite agregar documentos digitales"})]}),e.jsx(B,{checked:i.permite_documentos_electronicos,onCheckedChange:s=>r("permite_documentos_electronicos",s)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{className:"text-base",children:"Firma Digital"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Requiere firma digital para documentos"})]}),e.jsx(B,{checked:i.requiere_firma_digital,onCheckedChange:s=>r("requiere_firma_digital",s)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{className:"text-base",children:"Control de Versiones"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Mantiene historial de versiones"})]}),e.jsx(B,{checked:i.control_versiones,onCheckedChange:s=>r("control_versiones",s)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{className:"text-base",children:"Notificaciones Automáticas"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Envía notificaciones sobre cambios"})]}),e.jsx(B,{checked:i.notificaciones_automaticas,onCheckedChange:s=>r("notificaciones_automaticas",s)})]})]})})]}),e.jsxs(w,{children:[e.jsxs(S,{children:[e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"h-5 w-5"}),e.jsx("span",{children:"Responsabilidad y Ubicación"})]}),e.jsx(E,{children:"Responsable y ubicación física del expediente"})]}),e.jsxs(P,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"responsable",children:"Responsable *"}),e.jsxs(N,{value:i.responsable,onValueChange:s=>r("responsable",s),children:[e.jsx(_,{children:e.jsx(C,{placeholder:"Selecciona el responsable"})}),e.jsx(y,{children:p.map(s=>e.jsx(t,{value:s,children:s},s))})]}),c.responsable&&e.jsx("p",{className:"text-sm text-red-500",children:c.responsable})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"departamento",children:"Departamento *"}),e.jsxs(N,{value:i.departamento,onValueChange:s=>r("departamento",s),children:[e.jsx(_,{children:e.jsx(C,{placeholder:"Selecciona el departamento"})}),e.jsx(y,{children:n.map(s=>e.jsx(t,{value:s,children:s},s))})]}),c.departamento&&e.jsx("p",{className:"text-sm text-red-500",children:c.departamento})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"ubicacion_fisica",children:"Ubicación Física *"}),e.jsx(D,{id:"ubicacion_fisica",value:i.ubicacion_fisica,onChange:s=>r("ubicacion_fisica",s.target.value),placeholder:"Ej: Archivo Central - Estante A1 - Caja 001",className:c.ubicacion_fisica?"border-red-500":""}),c.ubicacion_fisica&&e.jsx("p",{className:"text-sm text-red-500",children:c.ubicacion_fisica})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"nivel_acceso",children:"Nivel de Acceso *"}),e.jsxs(N,{value:i.nivel_acceso,onValueChange:s=>r("nivel_acceso",s),children:[e.jsx(_,{children:e.jsx(C,{placeholder:"Selecciona el nivel de acceso"})}),e.jsxs(y,{children:[e.jsx(t,{value:"publico",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{children:"Público"})]})}),e.jsx(t,{value:"restringido",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"h-4 w-4 text-yellow-600"}),e.jsx("span",{children:"Restringido"})]})}),e.jsx(t,{value:"confidencial",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{children:"Confidencial"})]})}),e.jsx(t,{value:"secreto",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"h-4 w-4 text-red-800"}),e.jsx("span",{children:"Secreto"})]})})]})]}),c.nivel_acceso&&e.jsx("p",{className:"text-sm text-red-500",children:c.nivel_acceso})]})]})]})]}),e.jsxs(w,{children:[e.jsxs(S,{children:[e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(pe,{className:"h-5 w-5"}),e.jsx("span",{children:"Palabras Clave y Observaciones"})]}),e.jsx(E,{children:"Palabras clave para búsqueda y observaciones adicionales"})]}),e.jsxs(P,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Palabras Clave"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(D,{value:m,onChange:s=>j(s.target.value),onKeyPress:g,placeholder:"Escribe una palabra clave y presiona Enter",className:"flex-1"}),e.jsxs(T,{type:"button",onClick:v,disabled:!m.trim(),size:"sm",children:[e.jsx(je,{className:"h-4 w-4"}),"Agregar"]})]}),i.palabras_clave.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:i.palabras_clave.map((s,u)=>e.jsxs(de,{variant:"secondary",className:"cursor-pointer",onClick:()=>I(s),children:[s,e.jsx(ce,{className:"h-3 w-3 ml-1"})]},u))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"observaciones",children:"Observaciones"}),e.jsx(H,{id:"observaciones",value:i.observaciones,onChange:s=>r("observaciones",s.target.value),placeholder:"Observaciones adicionales sobre el expediente",className:"min-h-[100px]"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(T,{type:"button",variant:"outline",asChild:!0,children:e.jsx(V,{href:route("admin.expedientes.show",a.id),children:"Cancelar"})}),e.jsxs(T,{type:"submit",disabled:x||!b,children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),x?"Guardando...":"Guardar Cambios"]})]})]})]})}export{Ge as default};
