import{r as b,j as e,H as $,L as x,b as g}from"./app-C5ckqBIp.js";import{A as z}from"./app-layout-DGpHzsZj.js";import{C as i,c,a as w,b as C,d as L}from"./card-C_VOERQk.js";import{c as G,B as r}from"./button-C_wizhg3.js";import{I as k}from"./input-DjB33T14.js";import{B as h}from"./badge-DL-k3CvS.js";import{S as _,a as S,b as A,c as E,d as o}from"./select-CBIPitLz.js";import{A as M,a as R}from"./alert-DyllTe_s.js";import{A as N}from"./activity-Kp1id3wp.js";import{P as T}from"./plus-CLL6Vylk.js";import{C as I}from"./circle-check-big-BhkhaQeQ.js";import{T as F,S as H}from"./triangle-alert-c3kReHiM.js";import{K as f}from"./app-sidebar-layout-B-YWzudl.js";import{C as K}from"./folder-9RT5E6CU.js";import{S as O}from"./search-CVtN_EcY.js";import{U as V}from"./user-2UwuEIUF.js";import{C as q}from"./calendar-DWIY_Qm5.js";import{E as X}from"./eye-Y2yRoQf8.js";import{S as J}from"./square-pen-CfCmrfhe.js";import{R as Q}from"./refresh-cw-ClyS4DOp.js";import{f as W,e as Y}from"./es-tlGrzipH.js";/* empty css            */import"./index-C72nIoIT.js";import"./Combination-CIeNRLzY.js";import"./index-D_U0JQiI.js";import"./index-C7J7UiSU.js";import"./check-R7RxhHJy.js";import"./index-z-hyAKzV.js";import"./x-Cc5GKSP1.js";import"./app-logo-icon-EYLFXuBA.js";import"./label-D9bm4s2r.js";import"./mail-DhzsRTCw.js";import"./users-Bu6eepbM.js";import"./BrandingProvider-ZsHKNxl6.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],B=G("Power",Z);function Ue({tokens:l,estadisticas:n,filtros:v,usuarios:D}){console.log("=== API TOKENS INDEX PROPS DEBUG ==="),console.log("tokens:",l),console.log("estadisticas:",n),console.log("tokens type:",typeof l),console.log("estadisticas type:",typeof n),console.log("tokens is null:",l===null),console.log("estadisticas is null:",n===null),console.log("tokens is undefined:",l===void 0),console.log("estadisticas is undefined:",n===void 0),l&&(console.log("tokens.meta:",l.meta),console.log("tokens.data length:",l.data?.length)),n&&console.log("estadisticas.total:",n?.total),console.log("=====================================");const a=l||{data:[],links:[],meta:{total:0,from:0,to:0,last_page:1}},[j,P]=b.useState(v),[d,p]=b.useState(null),u=(s,t)=>{const m={...j};m[s]=t,(!t||t==="all")&&delete m[s],P(m),g.get("/admin/api-tokens",m,{preserveState:!0})},U=s=>{switch(s.estado){case"activo":return e.jsx(h,{className:"bg-green-100 text-green-800",children:"Activo"});case"inactivo":return e.jsx(h,{variant:"secondary",children:"Inactivo"});case"expirado":return e.jsx(h,{className:"bg-red-100 text-red-800",children:"Expirado"});case"limite_alcanzado":return e.jsx(h,{className:"bg-orange-100 text-orange-800",children:"Límite alcanzado"});default:return e.jsx(h,{variant:"outline",children:s.estado})}},y=async(s,t)=>{try{await g.post(`/admin/api-tokens/${t}/${s}`,{},{onSuccess:()=>{p({success:!0,message:`Token ${s==="revocar"?"revocado":"renovado"} exitosamente`})},onError:()=>{p({success:!1,message:`Error al ${s==="revocar"?"revocar":"renovar"} el token`})}})}catch{p({success:!1,message:`Error al ${s==="revocar"?"revocar":"renovar"} el token`})}};return e.jsxs(z,{children:[e.jsx($,{title:"API Tokens - ArchiveyCloud"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"API Tokens"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gestiona tokens de autenticación para integraciones externas"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(x,{href:"/admin/api-tokens/dashboard",children:e.jsxs(r,{variant:"outline",children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"Dashboard"]})}),e.jsx(x,{href:"/admin/api-tokens/create",children:e.jsxs(r,{children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Crear Token"]})})]})]}),d&&e.jsx(M,{className:d.success?"border-green-200 bg-green-50":"border-red-200 bg-red-50",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[d.success?e.jsx(I,{className:"h-4 w-4 text-green-600"}):e.jsx(F,{className:"h-4 w-4 text-red-600"}),e.jsx(R,{className:d.success?"text-green-800":"text-red-800",children:d.message})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsx(i,{children:e.jsx(c,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(f,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Tokens"}),e.jsx("p",{className:"text-2xl font-bold",children:"DEBUG: 0"})]})]})})}),e.jsx(i,{children:e.jsx(c,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Activos"}),e.jsx("p",{className:"text-2xl font-bold",children:"DEBUG: 0"})]})]})})}),e.jsx(i,{children:e.jsx(c,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(K,{className:"h-8 w-8 text-orange-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Expirados"}),e.jsx("p",{className:"text-2xl font-bold",children:"DEBUG: 0"})]})]})})}),e.jsx(i,{children:e.jsx(c,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"h-8 w-8 text-gray-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Inactivos"}),e.jsx("p",{className:"text-2xl font-bold",children:"DEBUG: 0"})]})]})})}),e.jsx(i,{children:e.jsx(c,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(N,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Uso (mes)"}),e.jsx("p",{className:"text-2xl font-bold",children:"DEBUG: 0"})]})]})})})]}),e.jsxs(i,{children:[e.jsx(w,{children:e.jsx(C,{className:"text-lg",children:"Filtros"})}),e.jsx(c,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Buscar"}),e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(k,{type:"text",placeholder:"Nombre, descripción, usuario...",value:j.buscar||"",onChange:s=>u("buscar",s.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Estado"}),e.jsxs(_,{value:j.estado||"all",onValueChange:s=>u("estado",s),children:[e.jsx(S,{children:e.jsx(A,{})}),e.jsxs(E,{children:[e.jsx(o,{value:"all",children:"Todos"}),e.jsx(o,{value:"activo",children:"Activos"}),e.jsx(o,{value:"inactivo",children:"Inactivos"}),e.jsx(o,{value:"expirado",children:"Expirados"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Usuario"}),e.jsxs(_,{value:j.usuario_id||"all",onValueChange:s=>u("usuario_id",s),children:[e.jsx(S,{children:e.jsx(A,{})}),e.jsxs(E,{children:[e.jsx(o,{value:"all",children:"Todos"}),D.map(s=>e.jsx(o,{value:s.id.toString(),children:s.name},s.id))]})]})]})]})})]}),e.jsxs(i,{children:[e.jsxs(w,{children:[e.jsxs(C,{children:["Tokens API (",a?.meta?.total||0,")"]}),e.jsxs(L,{children:["Mostrando ",a?.meta?.from||0," a ",a?.meta?.to||0," de ",a?.meta?.total||0," tokens"]})]}),e.jsxs(c,{children:[e.jsxs("div",{className:"space-y-4",children:[(a?.data||[]).map(s=>e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(f,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:s.nombre}),s.descripcion&&e.jsx("p",{className:"text-sm text-gray-600",children:s.descripcion})]}),U(s)]}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(V,{className:"h-4 w-4 mr-1"}),s.usuario.name]}),e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(H,{className:"h-4 w-4 mr-1"}),s.permisos.length," permiso",s.permisos.length!==1?"s":""]}),e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(N,{className:"h-4 w-4 mr-1"}),s.logs_count," uso",s.logs_count!==1?"s":""]}),e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(q,{className:"h-4 w-4 mr-1"}),s.ultimo_uso?W(new Date(s.ultimo_uso),{addSuffix:!0,locale:Y}):"Nunca usado"]})]}),s.limite_usos&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[e.jsxs("span",{children:["Uso: ",s.usos_realizados,"/",s.limite_usos]}),e.jsxs("span",{children:[s.porcentaje_uso,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${(s.porcentaje_uso||0)>80?"bg-red-600":(s.porcentaje_uso||0)>60?"bg-orange-600":"bg-green-600"}`,style:{width:`${s.porcentaje_uso||0}%`}})})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(x,{href:`/admin/api-tokens/${s.id}`,children:e.jsx(r,{variant:"outline",size:"sm",children:e.jsx(X,{className:"h-4 w-4"})})}),e.jsx(x,{href:`/admin/api-tokens/${s.id}/edit`,children:e.jsx(r,{variant:"outline",size:"sm",children:e.jsx(J,{className:"h-4 w-4"})})}),s.estado==="activo"&&e.jsx(r,{variant:"outline",size:"sm",onClick:()=>y("renovar",s.id),children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>y("revocar",s.id),className:"text-red-600 hover:text-red-700",children:e.jsx(B,{className:"h-4 w-4"})})]})]})},s.id)),(a?.data?.length||0)===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(f,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay tokens"}),e.jsx("p",{className:"text-gray-600 mb-4",children:Object.keys(v).length>0?"No se encontraron tokens con los filtros aplicados":"Aún no se han creado tokens API"}),e.jsx(x,{href:"/admin/api-tokens/create",children:e.jsxs(r,{children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Crear primer token"]})})]})]}),(a?.meta?.last_page||0)>1&&e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Mostrando ",a?.meta?.from||0," a ",a?.meta?.to||0," de ",a?.meta?.total||0," resultados"]}),e.jsx("div",{className:"flex space-x-1",children:(a?.links||[]).map((s,t)=>e.jsx(r,{variant:s.active?"default":"outline",size:"sm",onClick:()=>s.url&&g.get(s.url),disabled:!s.url,dangerouslySetInnerHTML:{__html:s.label}},t))})]})]})]})]})]})}export{Ue as default};
