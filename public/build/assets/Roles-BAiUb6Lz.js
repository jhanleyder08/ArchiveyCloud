import{r as x,j as e,H as q,b as w}from"./app-DOeYTPnE.js";import{A as J,S,D as Q,i as W,a as X,b as Y,c as Z,d as I,g as K,U as D,t as c}from"./app-sidebar-layout-83PL_wom.js";import{B as o}from"./button-BB3j1qH9.js";import{C as p,a as L,b as V,c as f,d as ee}from"./card-BEZSel9K.js";import{I as h}from"./index-C7D1JV-H.js";import{L as l}from"./label-BvABT9uR.js";import{S as se}from"./switch-DIpGF78c.js";import{B as N}from"./badge-BDHWk-Qv.js";import{S as ae}from"./separator-DEXPH2Xk.js";import{A as re}from"./arrow-left-Cvz8oF6O.js";import{S as ie}from"./save-DHvE8w7l.js";import{R as ne}from"./refresh-cw-B3OjpzJz.js";import{S as te}from"./triangle-alert-B7e9hRq_.js";/* empty css            */import"./index-B5i9qy2Y.js";import"./index-Cl_hWV--.js";import"./index-BuQaqXjb.js";import"./x-BHxLkKP3.js";import"./index-sj4qH-fg.js";import"./app-logo-icon-BTiqVlKS.js";import"./user-BiSWd6pJ.js";import"./index-pqvegj4w.js";function Re({roles:b=[],configuraciones_roles:C={}}){const[r,F]=x.useState(b[0]?.id||null),[d,R]=x.useState({}),[G,A]=x.useState(!1),[H,j]=x.useState(!1),[m,v]=x.useState({clave:"",valor:"",descripcion:"",tipo:"texto"}),t=b.find(s=>s.id===r),y=C[r||0]||{},u=(s,a,i)=>{R(n=>({...n,[s]:{...n[s]||{},[a]:i}}))},z=async s=>{const a=d[s];if(!a||Object.keys(a).length===0){c.info("No hay cambios para guardar");return}A(!0);try{const i=Object.entries(a).map(([n,_])=>({clave:n,valor:_.toString(),activo:!0}));await w.put(route("admin.configuracion.roles.update",s),{configuraciones:i}),R(n=>({...n,[s]:{}})),c.success("Configuraciones de rol guardadas exitosamente")}catch(i){console.error("Error saving role configurations:",i),c.error("Error al guardar configuraciones de rol")}finally{A(!1)}},M=async()=>{if(!r||!m.clave||!m.valor){c.error("Complete todos los campos requeridos");return}try{u(r,m.clave,m.valor),v({clave:"",valor:"",descripcion:"",tipo:"texto"}),j(!1),c.success("Configuración agregada. Recuerda guardar los cambios.")}catch(s){console.error("Error adding configuration:",s),c.error("Error al agregar configuración")}},T=(s,a)=>{const i=d[s];return i&&i[a]!==void 0?i[a]:C[s]?.[a]?.valor||""},E=s=>{const a=d[s];return a&&Object.keys(a).length>0},U=s=>({"Super Administrador":[{clave:"max_documents_per_day",valor:"1000",descripcion:"Máximo documentos por día",tipo:"numero"},{clave:"can_delete_documents",valor:"true",descripcion:"Puede eliminar documentos",tipo:"boolean"},{clave:"can_modify_settings",valor:"true",descripcion:"Puede modificar configuraciones",tipo:"boolean"},{clave:"email_notifications_all",valor:"true",descripcion:"Recibir todas las notificaciones",tipo:"boolean"}],"Administrador SGDEA":[{clave:"max_documents_per_day",valor:"500",descripcion:"Máximo documentos por día",tipo:"numero"},{clave:"can_delete_documents",valor:"true",descripcion:"Puede eliminar documentos",tipo:"boolean"},{clave:"can_modify_settings",valor:"false",descripcion:"Puede modificar configuraciones",tipo:"boolean"},{clave:"email_notifications_important",valor:"true",descripcion:"Notificaciones importantes",tipo:"boolean"}],"Gestor Documental":[{clave:"max_documents_per_day",valor:"200",descripcion:"Máximo documentos por día",tipo:"numero"},{clave:"can_delete_documents",valor:"false",descripcion:"Puede eliminar documentos",tipo:"boolean"},{clave:"can_export_reports",valor:"true",descripcion:"Puede exportar reportes",tipo:"boolean"},{clave:"email_notifications_assigned",valor:"true",descripcion:"Notificaciones asignadas",tipo:"boolean"}]})[s]||[],O=async(s,a)=>{const i=U(a);if(i.length===0){c.info("No hay configuraciones predeterminadas para este rol");return}i.forEach(n=>{u(s,n.clave,n.valor)}),c.success(`${i.length} configuraciones predeterminadas cargadas`)},P=(s,a,i)=>{const n=T(s,a),_=i?.tipo||"texto",k=i?.descripcion||a.replace(/_/g," ");switch(_){case"boolean":return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{className:"text-sm font-medium",children:k}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a})]}),e.jsx(se,{checked:n==="true"||n===!0,onCheckedChange:g=>u(s,a,g?"true":"false")})]});case"numero":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"text-sm font-medium",children:k}),e.jsx(h,{type:"number",value:n,onChange:g=>u(s,a,g.target.value),placeholder:"0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a})]});default:return e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"text-sm font-medium",children:k}),e.jsx(h,{value:n,onChange:g=>u(s,a,g.target.value),placeholder:"Valor"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a})]})}},B=s=>s.includes("Super")||s.includes("Administrador")?e.jsx(te,{className:"h-4 w-4"}):e.jsx(D,{className:"h-4 w-4"}),$=s=>s.includes("Super")?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":s.includes("Administrador")?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":s.includes("Gestor")?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200";return e.jsxs(J,{title:"Configuración por Roles",children:[e.jsx(q,{title:"Configuración por Roles"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(o,{variant:"ghost",onClick:()=>w.get(route("admin.configuracion.index")),children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Volver"]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Configuración por Roles"}),e.jsx("p",{className:"text-muted-foreground",children:"Define configuraciones específicas para cada rol del sistema"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[r&&E(r)&&e.jsxs(o,{onClick:()=>z(r),disabled:G,children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Guardar Cambios"]}),e.jsxs(o,{variant:"outline",onClick:()=>w.reload(),children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),"Actualizar"]})]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:b.map(s=>e.jsxs(p,{className:`cursor-pointer transition-all ${r===s.id?"ring-2 ring-primary":"hover:bg-muted/50"}`,onClick:()=>F(s.id),children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsxs(V,{className:"text-sm font-medium flex items-center gap-2",children:[B(s.name),s.name]}),e.jsxs(N,{className:$(s.name),children:[s.users?.length||0," usuarios"]})]}),e.jsxs(f,{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:s.description}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"h-3 w-3 text-muted-foreground"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[Object.keys(C[s.id]||{}).length," configuraciones"]})]})]})]},s.id))}),r&&t&&e.jsxs(p,{children:[e.jsx(L,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[B(t.name),e.jsxs("div",{children:[e.jsxs(V,{children:["Configuración: ",t.name]}),e.jsxs(ee,{children:[t.description," • ",t.users?.length||0," usuarios asignados"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>O(r,t.name),children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),"Cargar Predeterminadas"]}),e.jsxs(Q,{open:H,onOpenChange:j,children:[e.jsx(W,{asChild:!0,children:e.jsx(o,{size:"sm",children:"Agregar Configuración"})}),e.jsxs(X,{children:[e.jsxs(Y,{children:[e.jsx(Z,{children:"Nueva Configuración"}),e.jsxs(I,{children:["Agrega una nueva configuración específica para el rol ",t.name]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Clave de configuración"}),e.jsx(h,{value:m.clave,onChange:s=>v(a=>({...a,clave:s.target.value})),placeholder:"max_documents_per_day"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Valor"}),e.jsx(h,{value:m.valor,onChange:s=>v(a=>({...a,valor:s.target.value})),placeholder:"100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Descripción"}),e.jsx(h,{value:m.descripcion,onChange:s=>v(a=>({...a,descripcion:s.target.value})),placeholder:"Descripción de la configuración"})]})]}),e.jsxs(K,{children:[e.jsx(o,{variant:"outline",onClick:()=>j(!1),children:"Cancelar"}),e.jsx(o,{onClick:M,children:"Agregar"})]})]})]})]})]})}),e.jsxs(f,{children:[t.users&&t.users.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx(l,{className:"text-sm font-medium mb-2 block",children:"Usuarios con este rol"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.users.map(s=>e.jsxs(N,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(D,{className:"h-3 w-3"}),s.name]},s.id))}),e.jsx(ae,{className:"mt-4"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{className:"text-lg font-medium",children:"Configuraciones del Rol"}),E(r)&&e.jsx(N,{variant:"outline",className:"bg-orange-50 text-orange-600 border-orange-200",children:"Cambios sin guardar"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-1 lg:grid-cols-2",children:[Object.entries(y).map(([s,a])=>e.jsx(p,{children:e.jsx(f,{className:"pt-4",children:P(r,s,a)})},s)),d[r]&&Object.entries(d[r]).filter(([s])=>!y[s]).map(([s])=>e.jsx(p,{className:"border-orange-200 bg-orange-50 dark:bg-orange-900/10",children:e.jsxs(f,{className:"pt-4",children:[e.jsx(N,{className:"mb-2",variant:"outline",children:"Nueva"}),P(r,s)]})},s))]}),Object.keys(y).length===0&&(!d[r]||Object.keys(d[r]).length===0)&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(S,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Sin configuraciones específicas"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Este rol no tiene configuraciones específicas definidas."}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx(o,{variant:"outline",onClick:()=>O(r,t.name),children:"Cargar Configuraciones Predeterminadas"}),e.jsx(o,{onClick:()=>j(!0),children:"Crear Nueva Configuración"})]})]})]})]})]}),!r&&e.jsx(p,{children:e.jsxs(f,{className:"text-center py-12",children:[e.jsx(D,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Selecciona un rol"}),e.jsx("p",{className:"text-muted-foreground",children:"Selecciona un rol de arriba para configurar sus opciones específicas."})]})})]})]})}export{Re as default};
