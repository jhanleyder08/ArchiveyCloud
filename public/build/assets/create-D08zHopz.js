import{r as u,u as re,j as e,H as oe,b as C,t as V}from"./app-BwzY5mdP.js";import{A as te}from"./app-layout-9wS50XJ4.js";import{c as ne,B as v}from"./button-BuG7hErd.js";import{I as j}from"./input-DBPsNB4E.js";import{L as t}from"./label-COs3lnS9.js";import{A as ce,T as B,i as le}from"./app-sidebar-layout-V4G_4O_u.js";import{S as _,a as y,b as A,c as w,d as g}from"./select-FIAkf9pv.js";import{C as l,c as d,a as p,b as x}from"./card-R_fDv6wV.js";import{A as H,a as U}from"./alert-DnH_NbhW.js";import{P as de}from"./progress-q2NYNI-t.js";import{S as P}from"./switch-RirdDXqj.js";import{I as q}from"./info-HBVYxcO4.js";import{X as W}from"./x-yj7I5XB9.js";import{U as me}from"./upload-DZRf0CS6.js";import{M as $}from"./monitor-D9D92Yjc.js";import{S as pe}from"./save-CeVmYB5T.js";import{F as Z}from"./Combination-DMdRKDdc.js";import{I as xe}from"./image-Bm2wMxpQ.js";import{V as he,H as ue}from"./video-o2Rt-feW.js";/* empty css            */import"./index-DRfaZ5bA.js";import"./index-C39PKzMR.js";import"./index-BQN2DSxF.js";import"./app-logo-icon-CWh3FBC5.js";import"./user-CGcDW0oZ.js";import"./mail-DcAASWb1.js";import"./users-Bd_tJWgh.js";import"./folder-BDmHn7zE.js";import"./triangle-alert-CwolSKvH.js";import"./search-DYmQja4G.js";import"./BrandingProvider-C7c3UgBn.js";import"./index-BeU68MN8.js";import"./check-BLssxijV.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],je=ne("FileUp",ve);function Ye({opciones:m}){const f={expedientes:m?.expedientes||[],tipologias:m?.tipologias||[],tipos_soporte:m?.tipos_soporte||[],confidencialidad:m?.confidencialidad||[],formatos_permitidos:m?.formatos_permitidos||{},tamaños_maximos:m?.tamaños_maximos||{},configuracion_multimedia:m?.configuracion_multimedia||{}},[b,k]=u.useState(!1),[M,D]=u.useState(0),[J,F]=u.useState(!1),[h,E]=u.useState([]),[N,T]=u.useState(""),z=u.useRef(null),{data:s,setData:r,post:ge,processing:I,errors:n,reset:fe}=re({nombre:"",descripcion:"",expediente_id:"",tipologia_id:"",tipo_documental:"",tipo_soporte:"electronico",activo:!0,confidencialidad:"interna",numero_folios:null,palabras_clave:[],ubicacion_fisica:"",observaciones:"",archivo:null,procesamiento:{ocr:!0,convertir:!0,generar_miniatura:!0}}),K=[{title:"Inicio",href:"/dashboard"},{title:"Administración",href:"/admin"},{title:"Documentos",href:"/admin/documentos"},{title:"Crear Documento",href:"/admin/documentos/create"}],X=a=>{a.preventDefault(),k(!0);const i=new FormData;i.append("nombre",s.nombre),i.append("descripcion",s.descripcion||""),i.append("expediente_id",s.expediente_id),i.append("tipo_documental",s.tipo_documental||""),i.append("tipo_soporte",s.tipo_soporte),i.append("activo",s.activo?"1":"0"),i.append("confidencialidad",s.confidencialidad),i.append("ubicacion_fisica",s.ubicacion_fisica||""),i.append("observaciones",s.observaciones||""),s.tipologia_id&&i.append("tipologia_id",s.tipologia_id),s.numero_folios&&i.append("numero_folios",s.numero_folios.toString()),h.forEach((c,ie)=>{i.append(`palabras_clave[${ie}]`,c)}),s.archivo&&i.append("archivo",s.archivo),i.append("procesamiento[ocr]",s.procesamiento.ocr?"1":"0"),i.append("procesamiento[convertir]",s.procesamiento.convertir?"1":"0"),i.append("procesamiento[generar_miniatura]",s.procesamiento.generar_miniatura?"1":"0");const o=setInterval(()=>{D(c=>c>=90?(clearInterval(o),90):c+10)},200);C.post("/admin/documentos",i,{onSuccess:()=>{D(100),V.success("Documento creado exitosamente"),setTimeout(()=>{clearInterval(o),C.visit("/admin/documentos")},1e3)},onError:c=>{clearInterval(o),D(0),V.error("Error al crear el documento. Revisa los campos marcados.")},onFinish:()=>{k(!1)}})},S=a=>{a.preventDefault(),a.stopPropagation(),a.type==="dragenter"||a.type==="dragover"?F(!0):a.type==="dragleave"&&F(!1)},Q=a=>{a.preventDefault(),a.stopPropagation(),F(!1),a.dataTransfer.files&&a.dataTransfer.files[0]&&O(a.dataTransfer.files[0])},O=a=>{r("archivo",a),s.nombre||r("nombre",a.name);const i=a.name.split(".").pop()?.toLowerCase(),o=G(i||"");V.success(`Archivo detectado: ${o} (${i?.toUpperCase()}) - ${L(a.size)}`)},G=a=>({pdf:"Documento PDF",doc:"Documento Word",docx:"Documento Word",txt:"Archivo de Texto",rtf:"Texto Enriquecido",odt:"Documento OpenOffice",jpg:"Imagen JPEG",jpeg:"Imagen JPEG",png:"Imagen PNG",gif:"Imagen GIF",bmp:"Imagen BMP",tiff:"Imagen TIFF",svg:"Imagen Vectorial",webp:"Imagen WebP",xls:"Hoja de Cálculo Excel",xlsx:"Hoja de Cálculo Excel",csv:"Archivo CSV",ods:"Hoja de Cálculo OpenOffice",ppt:"Presentación PowerPoint",pptx:"Presentación PowerPoint",odp:"Presentación OpenOffice",mp3:"Audio MP3",wav:"Audio WAV",ogg:"Audio OGG",flac:"Audio FLAC",m4a:"Audio M4A",aac:"Audio AAC",mp4:"Video MP4",avi:"Video AVI",mov:"Video MOV",wmv:"Video WMV",flv:"Video FLV",webm:"Video WebM",mkv:"Video MKV",zip:"Archivo ZIP",rar:"Archivo RAR","7z":"Archivo 7-Zip",tar:"Archivo TAR",gz:"Archivo GZIP"})[a]||"Archivo Desconocido",L=a=>{if(a===0)return"0 Bytes";const i=1024,o=["Bytes","KB","MB","GB"],c=Math.floor(Math.log(a)/Math.log(i));return parseFloat((a/Math.pow(i,c)).toFixed(2))+" "+o[c]},Y=a=>{a.target.files&&a.target.files[0]&&O(a.target.files[0])},R=()=>{if(N.trim()&&!h.includes(N.trim())){const a=[...h,N.trim()];E(a),r("palabras_clave",a),T("")}},ee=a=>{const i=h.filter(o=>o!==a);E(i),r("palabras_clave",i)},ae=a=>{const i=a.split(".").pop()?.toLowerCase();return i?["jpg","jpeg","png","gif","bmp","svg","webp"].includes(i)?e.jsx(xe,{className:"h-8 w-8 text-blue-500"}):["mp4","avi","mov","wmv","flv","webm"].includes(i)?e.jsx(he,{className:"h-8 w-8 text-purple-500"}):["mp3","wav","ogg","flac","m4a"].includes(i)?e.jsx(ue,{className:"h-8 w-8 text-green-500"}):["zip","rar","7z","tar","gz"].includes(i)?e.jsx(le,{className:"h-8 w-8 text-orange-500"}):["xls","xlsx","ppt","pptx"].includes(i)?e.jsx($,{className:"h-8 w-8 text-indigo-500"}):e.jsx(Z,{className:"h-8 w-8 text-gray-500"}):e.jsx(Z,{className:"h-8 w-8"})},se=a=>{const i=a.split(".").pop()?.toLowerCase(),o=[];return i?(["jpg","jpeg","png","gif","bmp","tiff","pdf"].includes(i)&&o.push("✓ OCR (Reconocimiento de texto)"),["jpg","jpeg","png","gif","bmp","tiff","mp4","avi","mov","wmv","pdf"].includes(i)&&o.push("✓ Generación de miniatura"),["pdf","doc","docx","jpg","jpeg","png","mp4","mp3"].includes(i)&&o.push("✓ Conversión automática"),o.push("✓ Extracción de metadatos"),o.push("✓ Verificación de integridad"),o.length>0?o.join(", "):"Procesamiento básico disponible"):"No se puede determinar el tipo de archivo"};return e.jsxs(te,{breadcrumbs:K,children:[e.jsx(oe,{title:"Crear Documento"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(je,{className:"h-6 w-6 text-[#2a3d83]"}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Crear Documento"})]}),e.jsxs(v,{type:"button",variant:"outline",onClick:()=>C.visit("/admin/documentos"),className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),"Volver"]})]}),b&&e.jsx(l,{children:e.jsx(d,{className:"pt-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Subiendo documento..."}),e.jsxs("span",{children:[M,"%"]})]}),e.jsx(de,{value:M,className:"w-full"})]})})}),e.jsxs(H,{children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx(U,{children:"Sube documentos electrónicos al sistema siguiendo las políticas de formatos y tamaños establecidas para cada tipo de contenido."})]}),e.jsxs("form",{onSubmit:X,className:"space-y-6",children:[e.jsxs(l,{children:[e.jsx(p,{children:e.jsx(x,{children:"Archivo"})}),e.jsxs(d,{children:[e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${J?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:S,onDragLeave:S,onDragOver:S,onDrop:Q,children:[s.archivo?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center",children:ae(s.archivo.name)}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium",children:s.archivo.name}),e.jsx("p",{className:"text-sm text-blue-600 font-medium",children:G(s.archivo.name.split(".").pop()?.toLowerCase()||"")}),e.jsx("p",{className:"text-sm text-gray-500",children:L(s.archivo.size)})]}),e.jsxs(v,{type:"button",variant:"outline",size:"sm",onClick:()=>r("archivo",null),children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Remover"]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(me,{className:"h-12 w-12 text-gray-400 mx-auto"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"Arrastra tu archivo aquí o haz clic para seleccionar"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Formatos soportados: PDF, DOC, DOCX, JPG, PNG, MP4, MP3 y más"})]}),e.jsx(v,{type:"button",variant:"outline",onClick:()=>z.current?.click(),children:"Seleccionar archivo"})]}),e.jsx("input",{ref:z,type:"file",className:"hidden",onChange:Y,accept:"*/*"})]}),n.archivo&&e.jsx("p",{className:"text-sm text-red-600 mt-2",children:n.archivo})]})]}),e.jsxs(l,{children:[e.jsx(p,{children:e.jsx(x,{children:"Información Básica"})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"nombre",children:"Nombre del Documento *"}),e.jsx(j,{id:"nombre",type:"text",value:s.nombre,onChange:a=>r("nombre",a.target.value),className:n.nombre?"border-red-500":"",required:!0}),n.nombre&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:n.nombre})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"expediente_id",children:"Expediente *"}),e.jsxs(_,{value:s.expediente_id,onValueChange:a=>r("expediente_id",a),children:[e.jsx(y,{id:"expediente_id",className:n.expediente_id?"border-red-500":"",children:e.jsx(A,{placeholder:"Seleccionar expediente"})}),e.jsx(w,{children:f.expedientes.map(a=>e.jsxs(g,{value:a.id.toString(),children:[a.codigo," - ",a.titulo]},a.id))})]}),n.expediente_id&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:n.expediente_id})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"descripcion",children:"Descripción"}),e.jsx(B,{id:"descripcion",value:s.descripcion,onChange:a=>r("descripcion",a.target.value),placeholder:"Descripción detallada del documento",rows:3,className:n.descripcion?"border-red-500":""}),n.descripcion&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:n.descripcion})]})]})]}),e.jsxs(l,{children:[e.jsx(p,{children:e.jsx(x,{children:"Clasificación"})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"tipologia_id",children:"Tipología Documental"}),e.jsxs(_,{value:s.tipologia_id,onValueChange:a=>r("tipologia_id",a),children:[e.jsx(y,{id:"tipologia_id",children:e.jsx(A,{placeholder:"Seleccionar tipología"})}),e.jsxs(w,{children:[e.jsx(g,{value:"null",children:"Sin tipología"}),f.tipologias.map(a=>e.jsxs(g,{value:a.id.toString(),children:[a.nombre," (",a.categoria,")"]},a.id))]})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"tipo_documental",children:"Tipo Documental"}),e.jsx(j,{id:"tipo_documental",type:"text",value:s.tipo_documental,onChange:a=>r("tipo_documental",a.target.value),placeholder:"Ej: Contrato, Factura, Informe"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"tipo_soporte",children:"Tipo de Soporte *"}),e.jsxs(_,{value:s.tipo_soporte,onValueChange:a=>r("tipo_soporte",a),children:[e.jsx(y,{id:"tipo_soporte",children:e.jsx(A,{})}),e.jsx(w,{children:f.tipos_soporte.map(a=>e.jsx(g,{value:a.value,children:a.label},a.value))})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"numero_folios",children:"Número de Folios"}),e.jsx(j,{id:"numero_folios",type:"number",min:"1",value:s.numero_folios||"",onChange:a=>r("numero_folios",parseInt(a.target.value)||null)})]})]})]})]}),e.jsxs(l,{children:[e.jsx(p,{children:e.jsx(x,{children:"Estado y Confidencialidad"})}),e.jsx(d,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{id:"activo",checked:s.activo,onCheckedChange:a=>r("activo",a)}),e.jsx(t,{htmlFor:"activo",className:"cursor-pointer",children:"Documento Activo"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"confidencialidad",children:"Confidencialidad *"}),e.jsxs(_,{value:s.confidencialidad,onValueChange:a=>r("confidencialidad",a),children:[e.jsx(y,{id:"confidencialidad",children:e.jsx(A,{})}),e.jsx(w,{children:f.confidencialidad.map(a=>e.jsx(g,{value:a.value,children:a.label},a.value))})]})]})]})})]}),e.jsxs(l,{children:[e.jsx(p,{children:e.jsx(x,{children:"Palabras Clave"})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{value:N,onChange:a=>T(a.target.value),placeholder:"Agregar palabra clave",onKeyPress:a=>a.key==="Enter"&&(a.preventDefault(),R())}),e.jsx(v,{type:"button",variant:"outline",onClick:R,children:"Agregar"})]}),h.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:h.map(a=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800",children:[a,e.jsx("button",{type:"button",onClick:()=>ee(a),className:"hover:text-blue-600",children:e.jsx(W,{className:"h-3 w-3"})})]},a))})]})]}),e.jsxs(l,{children:[e.jsx(p,{children:e.jsx(x,{children:"Información Adicional"})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"ubicacion_fisica",children:"Ubicación Física"}),e.jsx(j,{id:"ubicacion_fisica",type:"text",value:s.ubicacion_fisica,onChange:a=>r("ubicacion_fisica",a.target.value),placeholder:"Ej: Archivo Central, Estante A-3, Caja 15"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"observaciones",children:"Observaciones"}),e.jsx(B,{id:"observaciones",value:s.observaciones,onChange:a=>r("observaciones",a.target.value),placeholder:"Observaciones adicionales",rows:3})]})]})]}),e.jsxs(l,{children:[e.jsx(p,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-5 w-5"}),"Procesamiento Avanzado"]})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs(H,{children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx(U,{children:"Configura las opciones de procesamiento automático que se aplicarán al documento."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"flex items-center justify-between space-x-2 p-4 border rounded-lg",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(t,{htmlFor:"ocr",children:"Reconocimiento OCR"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Extraer texto de imágenes y documentos escaneados"})]}),e.jsx(P,{id:"ocr",checked:s.procesamiento.ocr,onCheckedChange:a=>r("procesamiento",{...s.procesamiento,ocr:a})})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 p-4 border rounded-lg",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(t,{htmlFor:"convertir",children:"Conversión Automática"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Convertir a formatos optimizados para archivo"})]}),e.jsx(P,{id:"convertir",checked:s.procesamiento.convertir,onCheckedChange:a=>r("procesamiento",{...s.procesamiento,convertir:a})})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 p-4 border rounded-lg",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(t,{htmlFor:"miniatura",children:"Generar Miniatura"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Crear vista previa para imágenes y videos"})]}),e.jsx(P,{id:"miniatura",checked:s.procesamiento.generar_miniatura,onCheckedChange:a=>r("procesamiento",{...s.procesamiento,generar_miniatura:a})})]})]}),s.archivo&&e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Procesamiento disponible para este archivo:"}),e.jsx("div",{className:"text-sm text-blue-700",children:se(s.archivo.name)})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-6",children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>C.visit("/admin/documentos"),disabled:I||b,children:"Cancelar"}),e.jsxs(v,{type:"submit",disabled:I||b,className:"bg-[#2a3d83] hover:bg-[#1e2b5f] flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),I||b?"Guardando...":"Crear Documento"]})]})]})]})]})}export{Ye as default};
