import{r as t,j as e,H as q,L as Q,a as u}from"./app-BV8yjCq7.js";import{A as G,C as w,g as _,h as j,i as p,j as g,k as v,S as K,a as J,t as S}from"./app-layout-xptsXUqV.js";import{c as E,B as d}from"./app-logo-icon-BhHHxLi4.js";import{I as O}from"./label-CN-Cuv_T.js";import{S as n,a as c,b as o,c as x,d as a}from"./select-BvsuM6Q9.js";import{B as U}from"./badge-Choz21Ea.js";import{S as W}from"./search-cyxc9Suk.js";import{F as X}from"./filter-BW4oTdhU.js";import{A as C}from"./archive-qhJAaFzl.js";import{C as A}from"./circle-pause-CC7OGEOO.js";import{L as T}from"./lock-BC3A7QNl.js";import{E as Y}from"./eye-Bn8wmVe0.js";import{T as Z}from"./trash-2-C7PnUN3j.js";import{C as ee}from"./circle-alert-Ctpl-Xf9.js";import{C as se}from"./circle-check-big-BIxi_L2y.js";/* empty css            */import"./index-C-gP6wGF.js";import"./index-BLDVcN3u.js";import"./index-CpeI76ZV.js";import"./check-BqPRUSNK.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],te=E("Bell",ae);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],re=E("RefreshCw",ie),le=[{title:"Dashboard",href:"/dashboard"},{title:"Administración",href:"#"},{title:"Retención y Disposición",href:"/admin/retencion-disposicion"}];function ze({procesos:i,stats:m,filtros:r,trdOptions:F,flash:de}){const[f,D]=t.useState(r.search||""),[z,ne]=t.useState(r.estado||"all"),[V,ce]=t.useState(r.tipo_entidad||"all"),[P,oe]=t.useState(r.prioridad||"all"),[k,xe]=t.useState(r.trd_id||"all"),[h,N]=t.useState(!1),[b,M]=t.useState(!1),l=(s,y)=>{const H={...r,[s]:y||void 0,page:1};u.get("/admin/retencion-disposicion",H,{preserveState:!0})},R=s=>{switch(s){case"activo":return"bg-green-100 text-green-800";case"alerta_previa":return"bg-yellow-100 text-yellow-800";case"vencido":return"bg-red-100 text-red-800";case"en_disposicion":return"bg-blue-100 text-blue-800";case"transferido":return"bg-purple-100 text-purple-800";case"eliminado":return"bg-gray-100 text-gray-800";case"conservado":return"bg-emerald-100 text-emerald-800";case"aplazado":return"bg-orange-100 text-orange-800";case"suspendido":return"bg-gray-100 text-gray-600";default:return"bg-gray-100 text-gray-600"}},B=s=>{switch(s){case"activo":return e.jsx(se,{className:"h-4 w-4"});case"alerta_previa":return e.jsx(ee,{className:"h-4 w-4"});case"vencido":return e.jsx(J,{className:"h-4 w-4"});case"en_disposicion":return e.jsx(w,{className:"h-4 w-4"});case"transferido":return e.jsx(K,{className:"h-4 w-4"});case"eliminado":return e.jsx(Z,{className:"h-4 w-4"});case"conservado":return e.jsx(C,{className:"h-4 w-4"});case"aplazado":return e.jsx(A,{className:"h-4 w-4"});case"suspendido":return e.jsx(T,{className:"h-4 w-4"});default:return null}},L=s=>({activo:"Activo",alerta_previa:"Alerta Previa",vencido:"Vencido",en_disposicion:"En Disposición",transferido:"Transferido",eliminado:"Eliminado",conservado:"Conservado",aplazado:"Aplazado",suspendido:"Suspendido"})[s]||s,I=s=>s<=0?"text-red-600 font-bold":s<=7?"text-orange-600 font-semibold":s<=30?"text-yellow-600":"text-gray-600",$=async()=>{N(!0);try{await u.post("/admin/retencion-disposicion/procesar-masivo",{},{onSuccess:s=>{S.success("Actualizaciones procesadas correctamente")},onError:s=>{S.error("Error al procesar actualizaciones")}})}finally{N(!1)}};return e.jsxs(G,{breadcrumbs:le,children:[e.jsx(q,{title:"Retención y Disposición"}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-6 w-6 text-[#2a3d83]"}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Retención y Disposición"})]}),e.jsxs(d,{onClick:$,className:"flex items-center gap-2 px-4 py-2 bg-[#2a3d83] text-white rounded-lg hover:bg-[#1e2b5f] transition-colors",disabled:h,children:[e.jsx(re,{className:`h-4 w-4 ${h?"animate-spin":""}`}),h?"Procesando...":"Actualizar Procesos"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Procesos"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:m.total})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(_,{className:"h-6 w-6 text-[#2a3d83]"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Procesos Activos"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:m.activos})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx("div",{className:"h-6 w-6 bg-[#2a3d83] rounded-full flex items-center justify-center",children:e.jsx("div",{className:"h-2 w-2 bg-white rounded-full"})})})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Vencidos"}),e.jsx("p",{className:"text-2xl font-semibold text-[#2a3d83]",children:m.vencidos})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx("div",{className:"h-6 w-6 bg-[#2a3d83] rounded-full flex items-center justify-center",children:e.jsx("div",{className:"h-2 w-2 bg-white rounded-full"})})})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4 w-full sm:w-auto",children:e.jsxs("div",{className:"relative flex-1 sm:w-80",children:[e.jsx(W,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(O,{type:"text",value:f,onChange:s=>D(s.target.value),onKeyPress:s=>s.key==="Enter"&&l("search",f),placeholder:"Buscar procesos...",className:"pl-10"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(n,{value:z,onValueChange:s=>l("estado",s),children:[e.jsx(c,{className:"w-[180px]",children:e.jsx(o,{placeholder:"Filtro por estado"})}),e.jsxs(x,{children:[e.jsx(a,{value:"all",children:"Todos los estados"}),e.jsx(a,{value:"activo",children:"Activo"}),e.jsx(a,{value:"alerta_previa",children:"Alerta Previa"}),e.jsx(a,{value:"vencido",children:"Vencido"}),e.jsx(a,{value:"en_disposicion",children:"En Disposición"})]})]}),e.jsx(d,{variant:"outline",size:"icon",onClick:()=>M(!b),children:e.jsx(X,{className:"h-4 w-4"})})]})]}),b&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(n,{value:V,onValueChange:s=>l("tipo_entidad",s),children:[e.jsx(c,{children:e.jsx(o,{placeholder:"Tipo de Entidad"})}),e.jsxs(x,{children:[e.jsx(a,{value:"all",children:"Todos los tipos"}),e.jsx(a,{value:"documento",children:"Documento"}),e.jsx(a,{value:"expediente",children:"Expediente"})]})]}),e.jsxs(n,{value:P,onValueChange:s=>l("prioridad",s),children:[e.jsx(c,{children:e.jsx(o,{placeholder:"Prioridad"})}),e.jsxs(x,{children:[e.jsx(a,{value:"all",children:"Todas las prioridades"}),e.jsx(a,{value:"critico",children:"Crítico"}),e.jsx(a,{value:"alto",children:"Alto"}),e.jsx(a,{value:"medio",children:"Medio"}),e.jsx(a,{value:"bajo",children:"Bajo"})]})]}),e.jsxs(n,{value:k,onValueChange:s=>l("trd_id",s),children:[e.jsx(c,{children:e.jsx(o,{placeholder:"TRD"})}),e.jsxs(x,{children:[e.jsx(a,{value:"all",children:"Todas las TRD"}),F.map(s=>e.jsxs(a,{value:s.id.toString(),children:[s.codigo," - ",s.nombre]},s.id))]})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg border overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 font-medium text-sm text-gray-900",children:"Código / Entidad"}),e.jsx("th",{className:"text-left p-4 font-medium text-sm text-gray-900",children:"TRD / Serie"}),e.jsx("th",{className:"text-left p-4 font-medium text-sm text-gray-900",children:"Estado"}),e.jsx("th",{className:"text-left p-4 font-medium text-sm text-gray-900",children:"Vencimiento"}),e.jsx("th",{className:"text-left p-4 font-medium text-sm text-gray-900",children:"Días Restantes"}),e.jsx("th",{className:"text-left p-4 font-medium text-sm text-gray-900",children:"Indicadores"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{children:i.data.map(s=>e.jsxs("tr",{className:"border-b hover:bg-gray-50/50",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.codigo_proceso}),e.jsx("div",{className:"text-sm text-gray-500",children:s.tipo_entidad==="documento"?e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"inline h-3 w-3 mr-1"}),s.documento?.titulo||"Sin título"]}):e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"inline h-3 w-3 mr-1"}),s.expediente?.titulo||"Sin título"]})})]})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.trd.nombre}),s.serie_documental&&e.jsx("div",{className:"text-xs text-gray-500",children:s.serie_documental.nombre})]})}),e.jsx("td",{className:"p-4",children:e.jsx(U,{className:R(s.estado),children:e.jsxs("span",{className:"flex items-center gap-1",children:[B(s.estado),L(s.estado)]})})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-900",children:new Date(s.fecha_vencimiento_gestion).toLocaleDateString("es-ES")}),e.jsx("div",{className:"text-xs text-gray-500",children:"Archivo Gestión"})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:I(s.dias_hasta_vencimiento),children:s.dias_hasta_vencimiento>0?`${s.dias_hasta_vencimiento} días`:s.dias_hasta_vencimiento===0?"Vence hoy":`Vencido hace ${Math.abs(s.dias_hasta_vencimiento)} días`})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex gap-1",children:[s.aplazado&&e.jsx(j,{children:e.jsxs(p,{children:[e.jsx(g,{children:e.jsx(A,{className:"h-4 w-4 text-orange-500"})}),e.jsx(v,{children:e.jsx("p",{children:"Aplazado"})})]})}),s.bloqueado_eliminacion&&e.jsx(j,{children:e.jsxs(p,{children:[e.jsx(g,{children:e.jsx(T,{className:"h-4 w-4 text-red-500"})}),e.jsx(v,{children:e.jsx("p",{children:"Eliminación bloqueada"})})]})}),s.alertas_activas&&e.jsx(j,{children:e.jsxs(p,{children:[e.jsx(g,{children:e.jsx(te,{className:"h-4 w-4 text-yellow-500"})}),e.jsx(v,{children:e.jsx("p",{children:"Alertas activas"})})]})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx(Q,{href:`/admin/retencion-disposicion/${s.id}`,children:e.jsxs(d,{variant:"ghost",size:"sm",children:[e.jsx(Y,{className:"h-4 w-4 mr-1"}),"Ver detalle"]})})})]},s.id))})]})}),i.last_page>1&&e.jsxs("div",{className:"mt-6 flex items-center justify-between px-6 pb-6",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Mostrando ",e.jsx("span",{className:"font-medium",children:i.from||0})," a"," ",e.jsx("span",{className:"font-medium",children:i.to||0})," de"," ",e.jsx("span",{className:"font-medium",children:i.total})," procesos"]}),e.jsx("div",{className:"flex gap-2",children:i.links.map(s=>e.jsx(d,{variant:s.active?"default":"outline",size:"sm",onClick:()=>s.url&&u.get(s.url),disabled:!s.url,className:s.active?"bg-[#2a3d83] hover:bg-[#1e2b5f]":"",dangerouslySetInnerHTML:{__html:s.label}},s.label))})]})]})]})]})}export{ze as default};
