import{r as E,u as H,j as e,H as O,L as _}from"./app-B-PXR1Ni.js";import{A as U}from"./app-layout-DJutQZnN.js";import{B as b}from"./app-logo-icon-BLsuM4IN.js";import{L as l,I as v}from"./label-CcIhawib.js";import{F as K,T,r as M,d as $,S as C,X as z}from"./app-sidebar-layout-D9ulO2li.js";import{S as y}from"./switch-CfV8eshZ.js";import{S as d,a as t,b as o,c as m,d as n}from"./select-B6s0-YwG.js";import{C as x,a as h,b as j,c as p,d as u}from"./card-Dmlm_cpt.js";import{B as X}from"./badge-CNo-IL5x.js";import{A as J,a as Q}from"./alert-CjcJnkq6.js";import{A as W}from"./arrow-left-DbMIHj5m.js";import{S as V}from"./save-CZYiVBmQ.js";import{C as Y}from"./circle-alert-DQvq-mpa.js";import{C as Z}from"./calendar-CQqh5lbn.js";import{T as ee}from"./tag-B9-Em-af.js";import{P as se}from"./plus-DmrOjBIx.js";/* empty css            */import"./index-DsJw0RIA.js";import"./index-DARluDlH.js";import"./index-CQZ_TJph.js";import"./check-BUuVkhmq.js";function Ce({expediente:i,series:F,departamentos:R,responsables:q,errors:a}){const[f,A]=E.useState(""),[D,P]=E.useState([]),{data:c,setData:r,put:L,processing:N,isDirty:S}=H({nombre:i.nombre||"",descripcion:i.descripcion||"",estado:i.estado||"abierto",fecha_apertura:i.fecha_apertura?i.fecha_apertura.split("T")[0]:"",fecha_cierre:i.fecha_cierre?i.fecha_cierre.split("T")[0]:"",ubicacion_fisica:i.ubicacion_fisica||"",responsable:i.responsable||"",departamento:i.departamento||"",clasificacion_serie:i.clasificacion_serie||"",clasificacion_subserie:i.clasificacion_subserie||"",nivel_acceso:i.nivel_acceso||"publico",palabras_clave:i.palabras_clave||[],observaciones:i.observaciones||"",permite_documentos_electronicos:i.configuracion?.permite_documentos_electronicos??!0,requiere_firma_digital:i.configuracion?.requiere_firma_digital??!1,control_versiones:i.configuracion?.control_versiones??!0,notificaciones_automaticas:i.configuracion?.notificaciones_automaticas??!0});E.useEffect(()=>{if(c.clasificacion_serie){const s=F.find(w=>w.nombre===c.clasificacion_serie);P(s?.subseries||[]),s?.subseries.some(w=>w.nombre===c.clasificacion_subserie)||r("clasificacion_subserie","")}else P([]),r("clasificacion_subserie","")},[c.clasificacion_serie]);const G=s=>{s.preventDefault(),L(route("admin.expedientes.update",i.id))},k=()=>{f.trim()&&!c.palabras_clave.includes(f.trim())&&(r("palabras_clave",[...c.palabras_clave,f.trim()]),A(""))},I=s=>{r("palabras_clave",c.palabras_clave.filter(g=>g!==s))},B=s=>{s.key==="Enter"&&(s.preventDefault(),k())};return e.jsxs(U,{children:[e.jsx(O,{title:`Editar Expediente: ${i.nombre}`}),e.jsxs("form",{onSubmit:G,className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_,{href:route("admin.expedientes.index"),className:"text-sm text-muted-foreground hover:text-foreground",children:"Expedientes"}),e.jsx("span",{className:"text-muted-foreground",children:"/"}),e.jsx(_,{href:route("admin.expedientes.show",i.id),className:"text-sm text-muted-foreground hover:text-foreground",children:i.codigo}),e.jsx("span",{className:"text-muted-foreground",children:"/"}),e.jsx("span",{className:"font-medium",children:"Editar"})]}),e.jsx("h1",{className:"text-2xl font-bold mt-1",children:"Editar Expediente"}),e.jsx("p",{className:"text-muted-foreground",children:"Modifica la información del expediente"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{type:"button",variant:"outline",asChild:!0,children:e.jsxs(_,{href:route("admin.expedientes.show",i.id),children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Cancelar"]})}),e.jsxs(b,{type:"submit",disabled:N||!S,children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),N?"Guardando...":"Guardar Cambios"]})]})]}),S&&e.jsxs(J,{children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsx(Q,{children:"Tienes cambios sin guardar. Asegúrate de guardar antes de salir."})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs(j,{className:"flex items-center space-x-2",children:[e.jsx(K,{className:"h-5 w-5"}),e.jsx("span",{children:"Información General"})]}),e.jsx(p,{children:"Información básica del expediente"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"nombre",children:"Nombre del Expediente *"}),e.jsx(v,{id:"nombre",value:c.nombre,onChange:s=>r("nombre",s.target.value),placeholder:"Nombre del expediente",className:a.nombre?"border-red-500":""}),a.nombre&&e.jsx("p",{className:"text-sm text-red-500",children:a.nombre})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"estado",children:"Estado"}),e.jsxs(d,{value:c.estado,onValueChange:s=>r("estado",s),children:[e.jsx(t,{children:e.jsx(o,{placeholder:"Selecciona el estado"})}),e.jsxs(m,{children:[e.jsx(n,{value:"abierto",children:"Abierto"}),e.jsx(n,{value:"tramite",children:"En Trámite"}),e.jsx(n,{value:"revision",children:"En Revisión"}),e.jsx(n,{value:"cerrado",children:"Cerrado"}),e.jsx(n,{value:"archivado",children:"Archivado"})]})]}),a.estado&&e.jsx("p",{className:"text-sm text-red-500",children:a.estado})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"descripcion",children:"Descripción *"}),e.jsx(T,{id:"descripcion",value:c.descripcion,onChange:s=>r("descripcion",s.target.value),placeholder:"Describe el propósito y contenido del expediente",className:`min-h-[100px] ${a.descripcion?"border-red-500":""}`}),a.descripcion&&e.jsx("p",{className:"text-sm text-red-500",children:a.descripcion})]})]})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs(j,{className:"flex items-center space-x-2",children:[e.jsx(Z,{className:"h-5 w-5"}),e.jsx("span",{children:"Fechas"})]}),e.jsx(p,{children:"Fechas de apertura y cierre del expediente"})]}),e.jsx(u,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"fecha_apertura",children:"Fecha de Apertura *"}),e.jsx(v,{id:"fecha_apertura",type:"date",value:c.fecha_apertura,onChange:s=>r("fecha_apertura",s.target.value),className:a.fecha_apertura?"border-red-500":""}),a.fecha_apertura&&e.jsx("p",{className:"text-sm text-red-500",children:a.fecha_apertura})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"fecha_cierre",children:"Fecha de Cierre"}),e.jsx(v,{id:"fecha_cierre",type:"date",value:c.fecha_cierre,onChange:s=>r("fecha_cierre",s.target.value),className:a.fecha_cierre?"border-red-500":""}),a.fecha_cierre&&e.jsx("p",{className:"text-sm text-red-500",children:a.fecha_cierre})]})]})})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(j,{children:"Clasificación Archivística"}),e.jsx(p,{children:"Serie y subserie documental según el CCD"})]}),e.jsx(u,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"clasificacion_serie",children:"Serie Documental *"}),e.jsxs(d,{value:c.clasificacion_serie,onValueChange:s=>r("clasificacion_serie",s),children:[e.jsx(t,{children:e.jsx(o,{placeholder:"Selecciona una serie"})}),e.jsx(m,{children:F.map(s=>e.jsxs(n,{value:s.nombre,children:[s.codigo," - ",s.nombre]},s.id))})]}),a.clasificacion_serie&&e.jsx("p",{className:"text-sm text-red-500",children:a.clasificacion_serie})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"clasificacion_subserie",children:"Subserie Documental"}),e.jsxs(d,{value:c.clasificacion_subserie,onValueChange:s=>r("clasificacion_subserie",s),disabled:!c.clasificacion_serie||D.length===0,children:[e.jsx(t,{children:e.jsx(o,{placeholder:"Selecciona una subserie"})}),e.jsx(m,{children:D.map(s=>e.jsxs(n,{value:s.nombre,children:[s.codigo," - ",s.nombre]},s.id))})]}),a.clasificacion_subserie&&e.jsx("p",{className:"text-sm text-red-500",children:a.clasificacion_subserie})]})]})})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs(j,{className:"flex items-center space-x-2",children:[e.jsx(M,{className:"h-5 w-5"}),e.jsx("span",{children:"Configuración"})]}),e.jsx(p,{children:"Configuración de funcionalidades del expediente"})]}),e.jsx(u,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{className:"text-base",children:"Documentos Electrónicos"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Permite agregar documentos digitales"})]}),e.jsx(y,{checked:c.permite_documentos_electronicos,onCheckedChange:s=>r("permite_documentos_electronicos",s)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{className:"text-base",children:"Firma Digital"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Requiere firma digital para documentos"})]}),e.jsx(y,{checked:c.requiere_firma_digital,onCheckedChange:s=>r("requiere_firma_digital",s)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{className:"text-base",children:"Control de Versiones"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Mantiene historial de versiones"})]}),e.jsx(y,{checked:c.control_versiones,onCheckedChange:s=>r("control_versiones",s)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{className:"text-base",children:"Notificaciones Automáticas"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Envía notificaciones sobre cambios"})]}),e.jsx(y,{checked:c.notificaciones_automaticas,onCheckedChange:s=>r("notificaciones_automaticas",s)})]})]})})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs(j,{className:"flex items-center space-x-2",children:[e.jsx($,{className:"h-5 w-5"}),e.jsx("span",{children:"Responsabilidad y Ubicación"})]}),e.jsx(p,{children:"Responsable y ubicación física del expediente"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"responsable",children:"Responsable *"}),e.jsxs(d,{value:c.responsable,onValueChange:s=>r("responsable",s),children:[e.jsx(t,{children:e.jsx(o,{placeholder:"Selecciona el responsable"})}),e.jsx(m,{children:q.map(s=>e.jsx(n,{value:s,children:s},s))})]}),a.responsable&&e.jsx("p",{className:"text-sm text-red-500",children:a.responsable})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"departamento",children:"Departamento *"}),e.jsxs(d,{value:c.departamento,onValueChange:s=>r("departamento",s),children:[e.jsx(t,{children:e.jsx(o,{placeholder:"Selecciona el departamento"})}),e.jsx(m,{children:R.map(s=>e.jsx(n,{value:s,children:s},s))})]}),a.departamento&&e.jsx("p",{className:"text-sm text-red-500",children:a.departamento})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"ubicacion_fisica",children:"Ubicación Física *"}),e.jsx(v,{id:"ubicacion_fisica",value:c.ubicacion_fisica,onChange:s=>r("ubicacion_fisica",s.target.value),placeholder:"Ej: Archivo Central - Estante A1 - Caja 001",className:a.ubicacion_fisica?"border-red-500":""}),a.ubicacion_fisica&&e.jsx("p",{className:"text-sm text-red-500",children:a.ubicacion_fisica})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"nivel_acceso",children:"Nivel de Acceso *"}),e.jsxs(d,{value:c.nivel_acceso,onValueChange:s=>r("nivel_acceso",s),children:[e.jsx(t,{children:e.jsx(o,{placeholder:"Selecciona el nivel de acceso"})}),e.jsxs(m,{children:[e.jsx(n,{value:"publico",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(C,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{children:"Público"})]})}),e.jsx(n,{value:"restringido",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(C,{className:"h-4 w-4 text-yellow-600"}),e.jsx("span",{children:"Restringido"})]})}),e.jsx(n,{value:"confidencial",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(C,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{children:"Confidencial"})]})}),e.jsx(n,{value:"secreto",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(C,{className:"h-4 w-4 text-red-800"}),e.jsx("span",{children:"Secreto"})]})})]})]}),a.nivel_acceso&&e.jsx("p",{className:"text-sm text-red-500",children:a.nivel_acceso})]})]})]})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs(j,{className:"flex items-center space-x-2",children:[e.jsx(ee,{className:"h-5 w-5"}),e.jsx("span",{children:"Palabras Clave y Observaciones"})]}),e.jsx(p,{children:"Palabras clave para búsqueda y observaciones adicionales"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Palabras Clave"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(v,{value:f,onChange:s=>A(s.target.value),onKeyPress:B,placeholder:"Escribe una palabra clave y presiona Enter",className:"flex-1"}),e.jsxs(b,{type:"button",onClick:k,disabled:!f.trim(),size:"sm",children:[e.jsx(se,{className:"h-4 w-4"}),"Agregar"]})]}),c.palabras_clave.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:c.palabras_clave.map((s,g)=>e.jsxs(X,{variant:"secondary",className:"cursor-pointer",onClick:()=>I(s),children:[s,e.jsx(z,{className:"h-3 w-3 ml-1"})]},g))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"observaciones",children:"Observaciones"}),e.jsx(T,{id:"observaciones",value:c.observaciones,onChange:s=>r("observaciones",s.target.value),placeholder:"Observaciones adicionales sobre el expediente",className:"min-h-[100px]"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(b,{type:"button",variant:"outline",asChild:!0,children:e.jsx(_,{href:route("admin.expedientes.show",i.id),children:"Cancelar"})}),e.jsxs(b,{type:"submit",disabled:N||!S,children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),N?"Guardando...":"Guardar Cambios"]})]})]})]})}export{Ce as default};
