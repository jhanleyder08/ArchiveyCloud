import{r as h,u as ae,j as e,H as ie,b as w}from"./app-BcZLevcf.js";import{A as re}from"./app-layout-DasvXX5m.js";import{c as te,B as u}from"./button-BsM685ds.js";import{I as g}from"./input-CjLt5s7n.js";import{L as o}from"./label-C1ipmG6c.js";import{T as R,t as B,j as oe}from"./app-sidebar-layout-7SHWFfjl.js";import{S as f,a as b,b as N,c as y,d as j}from"./select-Ca3I3wDS.js";import{C as l,c as d,a as m,b as p}from"./card-BqVwVAoc.js";import{A as L,a as O}from"./alert-oAPGg03b.js";import{P as ne}from"./progress-noSIwNJk.js";import{S as P}from"./switch-BcDfDkcc.js";import{A as ce}from"./arrow-left-BW6z9yy8.js";import{I as G}from"./info-BpkFcz9m.js";import{X as H}from"./x-BL4iRsR5.js";import{U as le}from"./upload-CC_qekDj.js";import{M as U}from"./monitor-D9Pcb_4Y.js";import{S as de}from"./save-C9wvRV-6.js";import{F as q}from"./Combination-CLJ78jdy.js";import{I as me}from"./image-B8Bj2Lo7.js";import{V as pe,H as xe}from"./video-CSAXMljj.js";/* empty css            */import"./index-CNi2YxxG.js";import"./index-BVTixdOX.js";import"./index-CIYEUQm3.js";import"./index-5AsEmbjk.js";import"./app-logo-icon-Bh6iRABb.js";import"./user-BKj-bQyT.js";import"./mail-J2AKm0cb.js";import"./users-Bv3mV0mG.js";import"./folder-DShUzZue.js";import"./triangle-alert-CQqqJdBk.js";import"./search-D5mRg5FV.js";import"./index-C7TXKFBF.js";import"./check-BxIsgHBf.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],ue=te("FileUp",he);function We({opciones:v}){const[C,A]=h.useState(!1),[k,F]=h.useState(0),[K,S]=h.useState(!1),[x,E]=h.useState([]),[_,M]=h.useState(""),T=h.useRef(null),{data:a,setData:r,post:je,processing:D,errors:n,reset:ve}=ae({nombre:"",descripcion:"",expediente_id:"",tipologia_id:"",tipo_documental:"",tipo_soporte:"electronico",estado:"borrador",confidencialidad:"interna",numero_folios:null,palabras_clave:[],ubicacion_fisica:"",observaciones:"",archivo:null,procesamiento:{ocr:!0,convertir:!0,generar_miniatura:!0}}),X=[{title:"Inicio",href:"/dashboard"},{title:"Administración",href:"/admin"},{title:"Documentos",href:"/admin/documentos"},{title:"Crear Documento",href:"/admin/documentos/create"}],$=s=>{s.preventDefault(),A(!0);const i=new FormData;i.append("nombre",a.nombre),i.append("descripcion",a.descripcion||""),i.append("expediente_id",a.expediente_id),i.append("tipo_documental",a.tipo_documental||""),i.append("tipo_soporte",a.tipo_soporte),i.append("estado",a.estado),i.append("confidencialidad",a.confidencialidad),i.append("ubicacion_fisica",a.ubicacion_fisica||""),i.append("observaciones",a.observaciones||""),a.tipologia_id&&i.append("tipologia_id",a.tipologia_id),a.numero_folios&&i.append("numero_folios",a.numero_folios.toString()),x.forEach((c,se)=>{i.append(`palabras_clave[${se}]`,c)}),a.archivo&&i.append("archivo",a.archivo),i.append("procesamiento[ocr]",a.procesamiento.ocr?"1":"0"),i.append("procesamiento[convertir]",a.procesamiento.convertir?"1":"0"),i.append("procesamiento[generar_miniatura]",a.procesamiento.generar_miniatura?"1":"0");const t=setInterval(()=>{F(c=>c>=90?(clearInterval(t),90):c+10)},200);w.post("/admin/documentos",i,{onSuccess:()=>{F(100),B.success("Documento creado exitosamente"),setTimeout(()=>{clearInterval(t),w.visit("/admin/documentos")},1e3)},onError:c=>{clearInterval(t),F(0),B.error("Error al crear el documento. Revisa los campos marcados.")},onFinish:()=>{A(!1)}})},I=s=>{s.preventDefault(),s.stopPropagation(),s.type==="dragenter"||s.type==="dragover"?S(!0):s.type==="dragleave"&&S(!1)},J=s=>{s.preventDefault(),s.stopPropagation(),S(!1),s.dataTransfer.files&&s.dataTransfer.files[0]&&z(s.dataTransfer.files[0])},z=s=>{r("archivo",s),a.nombre||r("nombre",s.name)},Z=s=>{s.target.files&&s.target.files[0]&&z(s.target.files[0])},V=()=>{if(_.trim()&&!x.includes(_.trim())){const s=[...x,_.trim()];E(s),r("palabras_clave",s),M("")}},Q=s=>{const i=x.filter(t=>t!==s);E(i),r("palabras_clave",i)},W=s=>{const i=s.split(".").pop()?.toLowerCase();return i?["jpg","jpeg","png","gif","bmp","svg","webp"].includes(i)?e.jsx(me,{className:"h-8 w-8 text-blue-500"}):["mp4","avi","mov","wmv","flv","webm"].includes(i)?e.jsx(pe,{className:"h-8 w-8 text-purple-500"}):["mp3","wav","ogg","flac","m4a"].includes(i)?e.jsx(xe,{className:"h-8 w-8 text-green-500"}):["zip","rar","7z","tar","gz"].includes(i)?e.jsx(oe,{className:"h-8 w-8 text-orange-500"}):["xls","xlsx","ppt","pptx"].includes(i)?e.jsx(U,{className:"h-8 w-8 text-indigo-500"}):e.jsx(q,{className:"h-8 w-8 text-gray-500"}):e.jsx(q,{className:"h-8 w-8"})},Y=s=>{if(s===0)return"0 Bytes";const i=1024,t=["Bytes","KB","MB","GB"],c=Math.floor(Math.log(s)/Math.log(i));return parseFloat((s/Math.pow(i,c)).toFixed(2))+" "+t[c]},ee=s=>{const i=s.split(".").pop()?.toLowerCase(),t=[];return i?(["jpg","jpeg","png","gif","bmp","tiff","pdf"].includes(i)&&t.push("✓ OCR (Reconocimiento de texto)"),["jpg","jpeg","png","gif","bmp","tiff","mp4","avi","mov","wmv","pdf"].includes(i)&&t.push("✓ Generación de miniatura"),["pdf","doc","docx","jpg","jpeg","png","mp4","mp3"].includes(i)&&t.push("✓ Conversión automática"),t.push("✓ Extracción de metadatos"),t.push("✓ Verificación de integridad"),t.length>0?t.join(", "):"Procesamiento básico disponible"):"No se puede determinar el tipo de archivo"};return e.jsxs(re,{breadcrumbs:X,children:[e.jsx(ie,{title:"Crear Documento"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{className:"h-6 w-6 text-[#2a3d83]"}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Crear Documento"})]}),e.jsxs(u,{type:"button",variant:"outline",onClick:()=>w.visit("/admin/documentos"),className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),"Volver"]})]}),C&&e.jsx(l,{children:e.jsx(d,{className:"pt-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Subiendo documento..."}),e.jsxs("span",{children:[k,"%"]})]}),e.jsx(ne,{value:k,className:"w-full"})]})})}),e.jsxs(L,{children:[e.jsx(G,{className:"h-4 w-4"}),e.jsx(O,{children:"Sube documentos electrónicos al sistema siguiendo las políticas de formatos y tamaños establecidas para cada tipo de contenido."})]}),e.jsxs("form",{onSubmit:$,className:"space-y-6",children:[e.jsxs(l,{children:[e.jsx(m,{children:e.jsx(p,{children:"Archivo"})}),e.jsxs(d,{children:[e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${K?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:I,onDragLeave:I,onDragOver:I,onDrop:J,children:[a.archivo?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center",children:W(a.archivo.name)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.archivo.name}),e.jsx("p",{className:"text-sm text-gray-500",children:Y(a.archivo.size)})]}),e.jsxs(u,{type:"button",variant:"outline",size:"sm",onClick:()=>r("archivo",null),children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Remover"]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(le,{className:"h-12 w-12 text-gray-400 mx-auto"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"Arrastra tu archivo aquí o haz clic para seleccionar"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Formatos soportados: PDF, DOC, DOCX, JPG, PNG, MP4, MP3 y más"})]}),e.jsx(u,{type:"button",variant:"outline",onClick:()=>T.current?.click(),children:"Seleccionar archivo"})]}),e.jsx("input",{ref:T,type:"file",className:"hidden",onChange:Z,accept:"*/*"})]}),n.archivo&&e.jsx("p",{className:"text-sm text-red-600 mt-2",children:n.archivo})]})]}),e.jsxs(l,{children:[e.jsx(m,{children:e.jsx(p,{children:"Información Básica"})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"nombre",children:"Nombre del Documento *"}),e.jsx(g,{id:"nombre",type:"text",value:a.nombre,onChange:s=>r("nombre",s.target.value),className:n.nombre?"border-red-500":"",required:!0}),n.nombre&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:n.nombre})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"expediente_id",children:"Expediente *"}),e.jsxs(f,{value:a.expediente_id,onValueChange:s=>r("expediente_id",s),children:[e.jsx(b,{id:"expediente_id",className:n.expediente_id?"border-red-500":"",children:e.jsx(N,{placeholder:"Seleccionar expediente"})}),e.jsx(y,{children:v.expedientes.map(s=>e.jsxs(j,{value:s.id.toString(),children:[s.codigo," - ",s.titulo]},s.id))})]}),n.expediente_id&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:n.expediente_id})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"descripcion",children:"Descripción"}),e.jsx(R,{id:"descripcion",value:a.descripcion,onChange:s=>r("descripcion",s.target.value),placeholder:"Descripción detallada del documento",rows:3,className:n.descripcion?"border-red-500":""}),n.descripcion&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:n.descripcion})]})]})]}),e.jsxs(l,{children:[e.jsx(m,{children:e.jsx(p,{children:"Clasificación"})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"tipologia_id",children:"Tipología Documental"}),e.jsxs(f,{value:a.tipologia_id,onValueChange:s=>r("tipologia_id",s),children:[e.jsx(b,{id:"tipologia_id",children:e.jsx(N,{placeholder:"Seleccionar tipología"})}),e.jsxs(y,{children:[e.jsx(j,{value:"null",children:"Sin tipología"}),v.tipologias.map(s=>e.jsxs(j,{value:s.id.toString(),children:[s.nombre," (",s.categoria,")"]},s.id))]})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"tipo_documental",children:"Tipo Documental"}),e.jsx(g,{id:"tipo_documental",type:"text",value:a.tipo_documental,onChange:s=>r("tipo_documental",s.target.value),placeholder:"Ej: Contrato, Factura, Informe"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"tipo_soporte",children:"Tipo de Soporte *"}),e.jsxs(f,{value:a.tipo_soporte,onValueChange:s=>r("tipo_soporte",s),children:[e.jsx(b,{id:"tipo_soporte",children:e.jsx(N,{})}),e.jsx(y,{children:v.tipos_soporte.map(s=>e.jsx(j,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"numero_folios",children:"Número de Folios"}),e.jsx(g,{id:"numero_folios",type:"number",min:"1",value:a.numero_folios||"",onChange:s=>r("numero_folios",parseInt(s.target.value)||null)})]})]})]})]}),e.jsxs(l,{children:[e.jsx(m,{children:e.jsx(p,{children:"Estado y Confidencialidad"})}),e.jsx(d,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"estado",children:"Estado *"}),e.jsxs(f,{value:a.estado,onValueChange:s=>r("estado",s),children:[e.jsx(b,{id:"estado",children:e.jsx(N,{})}),e.jsx(y,{children:v.estados.map(s=>e.jsx(j,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"confidencialidad",children:"Confidencialidad *"}),e.jsxs(f,{value:a.confidencialidad,onValueChange:s=>r("confidencialidad",s),children:[e.jsx(b,{id:"confidencialidad",children:e.jsx(N,{})}),e.jsx(y,{children:v.confidencialidad.map(s=>e.jsx(j,{value:s.value,children:s.label},s.value))})]})]})]})})]}),e.jsxs(l,{children:[e.jsx(m,{children:e.jsx(p,{children:"Palabras Clave"})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{value:_,onChange:s=>M(s.target.value),placeholder:"Agregar palabra clave",onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),V())}),e.jsx(u,{type:"button",variant:"outline",onClick:V,children:"Agregar"})]}),x.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:x.map(s=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800",children:[s,e.jsx("button",{type:"button",onClick:()=>Q(s),className:"hover:text-blue-600",children:e.jsx(H,{className:"h-3 w-3"})})]},s))})]})]}),e.jsxs(l,{children:[e.jsx(m,{children:e.jsx(p,{children:"Información Adicional"})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"ubicacion_fisica",children:"Ubicación Física"}),e.jsx(g,{id:"ubicacion_fisica",type:"text",value:a.ubicacion_fisica,onChange:s=>r("ubicacion_fisica",s.target.value),placeholder:"Ej: Archivo Central, Estante A-3, Caja 15"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"observaciones",children:"Observaciones"}),e.jsx(R,{id:"observaciones",value:a.observaciones,onChange:s=>r("observaciones",s.target.value),placeholder:"Observaciones adicionales",rows:3})]})]})]}),e.jsxs(l,{children:[e.jsx(m,{children:e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5"}),"Procesamiento Avanzado"]})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs(L,{children:[e.jsx(G,{className:"h-4 w-4"}),e.jsx(O,{children:"Configura las opciones de procesamiento automático que se aplicarán al documento."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"flex items-center justify-between space-x-2 p-4 border rounded-lg",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{htmlFor:"ocr",children:"Reconocimiento OCR"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Extraer texto de imágenes y documentos escaneados"})]}),e.jsx(P,{id:"ocr",checked:a.procesamiento.ocr,onCheckedChange:s=>r("procesamiento",{...a.procesamiento,ocr:s})})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 p-4 border rounded-lg",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{htmlFor:"convertir",children:"Conversión Automática"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Convertir a formatos optimizados para archivo"})]}),e.jsx(P,{id:"convertir",checked:a.procesamiento.convertir,onCheckedChange:s=>r("procesamiento",{...a.procesamiento,convertir:s})})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 p-4 border rounded-lg",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{htmlFor:"miniatura",children:"Generar Miniatura"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Crear vista previa para imágenes y videos"})]}),e.jsx(P,{id:"miniatura",checked:a.procesamiento.generar_miniatura,onCheckedChange:s=>r("procesamiento",{...a.procesamiento,generar_miniatura:s})})]})]}),a.archivo&&e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Procesamiento disponible para este archivo:"}),e.jsx("div",{className:"text-sm text-blue-700",children:ee(a.archivo.name)})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-6",children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>w.visit("/admin/documentos"),disabled:D||C,children:"Cancelar"}),e.jsxs(u,{type:"submit",disabled:D||C,className:"bg-[#2a3d83] hover:bg-[#1e2b5f] flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),D||C?"Guardando...":"Crear Documento"]})]})]})]})]})}export{We as default};
