import{r as l,j as e,u as ae,H as re,L as E}from"./app-DmFTQNHU.js";import{A as oe}from"./app-layout-CF5PBVMg.js";import{u as z,a as M,B as g}from"./button-B9uqYTIR.js";import{C as y,a as R,b as C,d as te,c as A}from"./card-98qlzFSI.js";import{L as N}from"./label-CYYsus1F.js";import{v as q,R as ie,I as ce,L as ne,G as F,T as de,q as le,M as me,D as xe,a as ue,b as pe,c as he,d as je,e as fe}from"./app-sidebar-layout-B4-tSBlc.js";import{a as ve,c as L,b as I,d as ge}from"./index-6lxVY5DU.js";import{P as S}from"./index-BBDU3XkM.js";import{u as be,F as w,B as b}from"./Combination-DB4vhy5A.js";import{u as Ne}from"./index-_200N-9v.js";import{P as ye}from"./index-D6-3VAHV.js";import{S as P}from"./separator-B7PE0nT-.js";import{A as Re,a as Ce}from"./alert--kr5pmD-.js";import{T as Ae,S as De}from"./triangle-alert-Qv0vinvY.js";import{C as D}from"./circle-check-big-DyCuRV4E.js";import{C as B}from"./circle-x-Cbxwk3Mf.js";import{U as Se}from"./user-2vHAz8tr.js";import{C as _e}from"./calendar-B2HHxpzZ.js";import{C as Ee}from"./folder-CyqBlkrb.js";/* empty css            */import"./x-D4OXCe6m.js";import"./app-logo-icon-B1r3bsQj.js";import"./input-CXpCTHGE.js";import"./mail-i7usF0Qz.js";import"./users-CA6jkooN.js";import"./search-BECONtiU.js";import"./BrandingProvider-BKZadETt.js";var k="Radio",[we,T]=L(k),[Pe,Ie]=we(k),O=l.forwardRef((s,c)=>{const{__scopeRadio:r,name:a,checked:t=!1,required:n,disabled:i,value:m="on",onCheck:p,form:h,...j}=s,[x,u]=l.useState(null),o=z(c,v=>u(v)),d=l.useRef(!1),f=x?h||!!x.closest("form"):!0;return e.jsxs(Pe,{scope:r,checked:t,disabled:i,children:[e.jsx(S.button,{type:"button",role:"radio","aria-checked":t,"data-state":H(t),"data-disabled":i?"":void 0,disabled:i,value:m,...j,ref:o,onClick:I(s.onClick,v=>{t||p?.(),f&&(d.current=v.isPropagationStopped(),d.current||v.stopPropagation())})}),f&&e.jsx(U,{control:x,bubbles:!d.current,name:a,value:m,checked:t,required:n,disabled:i,form:h,style:{transform:"translateX(-100%)"}})]})});O.displayName=k;var V="RadioIndicator",$=l.forwardRef((s,c)=>{const{__scopeRadio:r,forceMount:a,...t}=s,n=Ie(V,r);return e.jsx(ye,{present:a||n.checked,children:e.jsx(S.span,{"data-state":H(n.checked),"data-disabled":n.disabled?"":void 0,...t,ref:c})})});$.displayName=V;var Ge="RadioBubbleInput",U=l.forwardRef(({__scopeRadio:s,control:c,checked:r,bubbles:a=!0,...t},n)=>{const i=l.useRef(null),m=z(i,n),p=Ne(r),h=ge(c);return l.useEffect(()=>{const j=i.current;if(!j)return;const x=window.HTMLInputElement.prototype,o=Object.getOwnPropertyDescriptor(x,"checked").set;if(p!==r&&o){const d=new Event("click",{bubbles:a});o.call(j,r),j.dispatchEvent(d)}},[p,r,a]),e.jsx(S.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...t,tabIndex:-1,ref:m,style:{...t.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});U.displayName=Ge;function H(s){return s?"checked":"unchecked"}var ze=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],_="RadioGroup",[ke,us]=L(_,[q,T]),K=q(),W=T(),[Fe,Be]=ke(_),X=l.forwardRef((s,c)=>{const{__scopeRadioGroup:r,name:a,defaultValue:t,value:n,required:i=!1,disabled:m=!1,orientation:p,dir:h,loop:j=!0,onValueChange:x,...u}=s,o=K(r),d=be(h),[f,v]=ve({prop:n,defaultProp:t??null,onChange:x,caller:_});return e.jsx(Fe,{scope:r,name:a,required:i,disabled:m,value:f,onValueChange:v,children:e.jsx(ie,{asChild:!0,...o,orientation:p,dir:d,loop:j,children:e.jsx(S.div,{role:"radiogroup","aria-required":i,"aria-orientation":p,"data-disabled":m?"":void 0,dir:d,...u,ref:c})})})});X.displayName=_;var Y="RadioGroupItem",J=l.forwardRef((s,c)=>{const{__scopeRadioGroup:r,disabled:a,...t}=s,n=Be(Y,r),i=n.disabled||a,m=K(r),p=W(r),h=l.useRef(null),j=z(c,h),x=n.value===t.value,u=l.useRef(!1);return l.useEffect(()=>{const o=f=>{ze.includes(f.key)&&(u.current=!0)},d=()=>u.current=!1;return document.addEventListener("keydown",o),document.addEventListener("keyup",d),()=>{document.removeEventListener("keydown",o),document.removeEventListener("keyup",d)}},[]),e.jsx(ce,{asChild:!0,...m,focusable:!i,active:x,children:e.jsx(O,{disabled:i,required:n.required,checked:x,...p,...t,name:n.name,ref:j,onCheck:()=>n.onValueChange(t.value),onKeyDown:I(o=>{o.key==="Enter"&&o.preventDefault()}),onFocus:I(t.onFocus,()=>{u.current&&h.current?.click()})})})});J.displayName=Y;var Me="RadioGroupIndicator",Q=l.forwardRef((s,c)=>{const{__scopeRadioGroup:r,...a}=s,t=W(r);return e.jsx($,{...t,...a,ref:c})});Q.displayName=Me;var Z=X,ee=J,qe=Q;const se=l.forwardRef(({className:s,...c},r)=>e.jsx(Z,{className:M("grid gap-2",s),...c,ref:r}));se.displayName=Z.displayName;const G=l.forwardRef(({className:s,...c},r)=>e.jsx(ee,{ref:r,className:M("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),...c,children:e.jsx(qe,{className:"flex items-center justify-center",children:e.jsx(ne,{className:"h-2.5 w-2.5 fill-current text-current"})})}));G.displayName=ee.displayName;function ps({workflow:s}){const[c,r]=l.useState(!1),{data:a,setData:t,post:n,processing:i,errors:m}=ae({accion:"",comentarios:"",archivos_adjuntos:[]}),p=o=>{o.preventDefault(),a.accion&&(a.accion==="rechazado"&&!a.comentarios.trim()||r(!0))},h=()=>{n(`/admin/workflow/${s.id}/procesar`,{onSuccess:()=>{r(!1)},onError:()=>{r(!1)}})},j=o=>({CrÃ­tica:e.jsx(b,{variant:"destructive",children:"CrÃ­tica"}),Alta:e.jsx(b,{className:"bg-orange-100 text-orange-800",children:"Alta"}),Media:e.jsx(b,{variant:"outline",className:"text-blue-600",children:"Media"}),Baja:e.jsx(b,{variant:"outline",className:"text-gray-600",children:"Baja"})})[o]||e.jsx(b,{variant:"outline",children:o}),x=o=>new Date(o).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),u=new Date(s.fecha_vencimiento)<new Date;return e.jsxs(oe,{children:[e.jsx(re,{title:`Aprobar Workflow - ${s.documento.nombre}`}),e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(F,{className:"w-8 h-8 text-blue-600"}),"Aprobar Documento"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Revisa y toma una decisiÃ³n sobre este documento"})]}),e.jsx(E,{href:`/admin/workflow/${s.id}`,children:e.jsx(g,{variant:"outline",children:"Volver a Detalles"})})]}),u&&e.jsxs(Re,{className:"mb-6 border-red-200 bg-red-50",children:[e.jsx(Ae,{className:"h-4 w-4 text-red-600"}),e.jsxs(Ce,{className:"text-red-800",children:[e.jsx("strong",{children:"Â¡Documento vencido!"})," Este workflow ha excedido su fecha lÃ­mite de aprobaciÃ³n."]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(y,{children:[e.jsxs(R,{children:[e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5 text-green-600"}),"DecisiÃ³n de AprobaciÃ³n"]}),e.jsx(te,{children:"Selecciona tu decisiÃ³n y proporciona comentarios sobre el documento"})]}),e.jsx(A,{children:e.jsxs("form",{onSubmit:p,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{className:"text-base font-medium",children:"Â¿CuÃ¡l es tu decisiÃ³n? *"}),e.jsxs(se,{value:a.accion,onValueChange:o=>t("accion",o),className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 border rounded-lg p-4 hover:bg-green-50 hover:border-green-300 transition-colors",children:[e.jsx(G,{value:"aprobado",id:"aprobado"}),e.jsxs(N,{htmlFor:"aprobado",className:"flex items-center gap-2 cursor-pointer flex-1",children:[e.jsx(D,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-green-700",children:"Aprobar Documento"}),e.jsx("div",{className:"text-sm text-green-600",children:"El documento cumple con los requisitos"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 border rounded-lg p-4 hover:bg-red-50 hover:border-red-300 transition-colors",children:[e.jsx(G,{value:"rechazado",id:"rechazado"}),e.jsxs(N,{htmlFor:"rechazado",className:"flex items-center gap-2 cursor-pointer flex-1",children:[e.jsx(B,{className:"w-5 h-5 text-red-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-red-700",children:"Rechazar Documento"}),e.jsx("div",{className:"text-sm text-red-600",children:"El documento requiere correcciones"})]})]})]})]}),m.accion&&e.jsx("p",{className:"text-sm text-red-600",children:m.accion})]}),e.jsx(P,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(N,{htmlFor:"comentarios",className:"text-base font-medium",children:["Comentarios ",a.accion==="rechazado"&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(de,{id:"comentarios",placeholder:a.accion==="aprobado"?"Comentarios adicionales sobre la aprobaciÃ³n (opcional)...":a.accion==="rechazado"?"Explica los motivos del rechazo y quÃ© correcciones son necesarias...":"Proporciona tu retroalimentaciÃ³n sobre el documento...",value:a.comentarios,onChange:o=>t("comentarios",o.target.value),rows:6,className:m.comentarios?"border-red-500":""}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-500",children:[e.jsx("span",{children:a.accion==="rechazado"?"Requerido para rechazos":"Opcional pero recomendado"}),e.jsxs("span",{children:[a.comentarios.length,"/1000"]})]})]}),m.comentarios&&e.jsx("p",{className:"text-sm text-red-600",children:m.comentarios})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{className:"text-base font-medium",children:"Archivos Adjuntos (Opcional)"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx(w,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Arrastra archivos aquÃ­ o haz clic para seleccionar"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Documentos de soporte, correcciones sugeridas, etc."}),e.jsx("input",{type:"file",multiple:!0,className:"hidden",onChange:o=>{const d=Array.from(o.target.files||[]);t("archivos_adjuntos",d)}})]}),a.archivos_adjuntos.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Archivos seleccionados:"}),a.archivos_adjuntos.map((o,d)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(w,{className:"w-4 h-4"}),e.jsx("span",{children:o.name}),e.jsxs("span",{className:"text-gray-500",children:["(",(o.size/1024/1024).toFixed(2)," MB)"]})]},d))]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsxs(g,{type:"submit",disabled:!a.accion||a.accion==="rechazado"&&!a.comentarios.trim()||i,className:a.accion==="aprobado"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700",children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),i?"Procesando...":a.accion==="aprobado"?"Aprobar Documento":"Rechazar Documento"]}),e.jsx(E,{href:`/admin/workflow/${s.id}`,children:e.jsx(g,{variant:"outline",children:"Cancelar"})})]})]})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(y,{children:[e.jsx(R,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-5 h-5"}),"Documento"]})}),e.jsxs(A,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Nombre"}),e.jsx("p",{className:"font-medium",children:s.documento.nombre})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"CÃ³digo"}),e.jsx("p",{className:"font-medium",children:s.documento.codigo})]}),e.jsx(P,{}),e.jsx(E,{href:`/admin/documentos/${s.documento.id}`,children:e.jsx(g,{variant:"outline",size:"sm",className:"w-full",children:"Ver Documento Completo"})})]})]}),e.jsxs(y,{children:[e.jsx(R,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-5 h-5"}),"Workflow"]})}),e.jsxs(A,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-1",children:[e.jsx(Se,{className:"w-4 h-4"}),"Solicitante"]}),e.jsx("p",{className:"font-medium",children:s.solicitante})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-1",children:[e.jsx(De,{className:"w-4 h-4"}),"Prioridad"]}),j(s.prioridad)]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-1",children:[e.jsx(_e,{className:"w-4 h-4"}),"Solicitud"]}),e.jsx("p",{className:"font-medium",children:x(s.fecha_solicitud)})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-1",children:[e.jsx(Ee,{className:"w-4 h-4"}),"Vencimiento"]}),e.jsx("p",{className:`font-medium ${u?"text-red-600":""}`,children:x(s.fecha_vencimiento)}),u&&e.jsx(b,{variant:"destructive",className:"mt-1 text-xs",children:"Vencido"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-1",children:[e.jsx(D,{className:"w-4 h-4"}),"Progreso"]}),e.jsxs("p",{className:"font-medium",children:["Nivel ",s.nivel_actual," de ",s.total_niveles]})]}),s.descripcion&&e.jsxs(e.Fragment,{children:[e.jsx(P,{}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2",children:[e.jsx(me,{className:"w-4 h-4"}),"DescripciÃ³n"]}),e.jsx("div",{className:"bg-gray-50 p-3 rounded-lg",children:e.jsx("p",{className:"text-sm",children:s.descripcion})})]})]})]})]}),e.jsxs(y,{className:"border-blue-200 bg-blue-50",children:[e.jsx(R,{children:e.jsx(C,{className:"text-blue-800",children:"ðŸ’¡ Consejos"})}),e.jsxs(A,{className:"text-sm text-blue-700 space-y-2",children:[e.jsxs("p",{children:["â€¢ ",e.jsx("strong",{children:"AprobaciÃ³n:"})," El documento pasarÃ¡ al siguiente nivel o se completarÃ¡ el workflow."]}),e.jsxs("p",{children:["â€¢ ",e.jsx("strong",{children:"Rechazo:"})," El documento serÃ¡ devuelto al solicitante con tus comentarios."]}),e.jsxs("p",{children:["â€¢ ",e.jsx("strong",{children:"Comentarios:"})," Son obligatorios para rechazos y muy recomendados para aprobaciones."]}),e.jsxs("p",{children:["â€¢ ",e.jsx("strong",{children:"Archivos:"})," Puedes adjuntar documentos de soporte o correcciones sugeridas."]})]})]})]})]}),e.jsx(xe,{open:c,onOpenChange:r,children:e.jsxs(ue,{className:"sm:max-w-md",children:[e.jsxs(pe,{children:[e.jsxs(he,{className:"flex items-center gap-3",children:[a.accion==="aprobado"?e.jsx(D,{className:"w-6 h-6 text-green-600"}):e.jsx(B,{className:"w-6 h-6 text-red-600"}),"Confirmar ",a.accion==="aprobado"?"AprobaciÃ³n":"Rechazo"]}),e.jsxs(je,{children:["Â¿EstÃ¡s seguro de que deseas ",a.accion==="aprobado"?"aprobar":"rechazar"," este documento?",a.accion==="aprobado"&&s.nivel_actual===s.total_niveles&&" Esta acciÃ³n completarÃ¡ el workflow de aprobaciÃ³n."]})]}),e.jsxs(fe,{className:"gap-2 sm:gap-0",children:[e.jsx(g,{onClick:h,disabled:i,className:a.accion==="aprobado"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700",children:i?"Procesando...":"Confirmar"}),e.jsx(g,{variant:"outline",onClick:()=>r(!1),disabled:i,children:"Cancelar"})]})]})})]})]})}export{ps as default};
