import{r as x,u as Y,b as w,j as e,H as Z,L as k}from"./app-D4GZ5_BN.js";import{A as ee}from"./app-layout-C0pe_Q4p.js";import{C as m,a as h,b as u,c as j}from"./card-C-prwqPv.js";import{B as T}from"./badge-DV1A3GyS.js";import{B as i}from"./button-BTibKt1x.js";import{I as L}from"./input-BSK7rI2j.js";import{L as p}from"./label-DTRv4hCu.js";import{x as G,D as se,g as ae,a as te,b as re,c as le,d as ce,T as ie,e as ne,t as M}from"./app-sidebar-layout-D73gahHo.js";import{S as f,a as b,b as v,c as y,d as c}from"./select-ClhCZ_uJ.js";import{P as oe}from"./plus-Dc25PZN3.js";import{S as de}from"./save-CNrAnnfo.js";import{U as R}from"./user-C-3W2SEY.js";import{C as xe}from"./circle-alert-D-Ve_RvD.js";import{T as me}from"./users-DdWouAjO.js";import{F as he}from"./Combination-Cc6zq9Ha.js";import{F as ue}from"./folder-open-D7qnTdzS.js";import{E as je}from"./eye-DZqpyomB.js";import{S as pe}from"./square-pen-DEyoHH9_.js";import{C as ge}from"./copy-DNfGnUHi.js";/* empty css            */import"./index-xx5AbYnB.js";import"./index--rnI4uNm.js";import"./index-BgI2bKQV.js";import"./x-xc6RNAkn.js";import"./index-3E51dxvM.js";import"./app-logo-icon-DqwPtB3B.js";import"./triangle-alert-Cy9y7oXu.js";import"./folder-RY31nqh7.js";import"./search-CdHDbSsK.js";import"./index-Bp8N7tky.js";import"./check-BjzzhBQS.js";const Ne=t=>({borrador:"bg-gray-100 text-gray-800",revision:"bg-yellow-100 text-yellow-800",activa:"bg-green-100 text-green-800",archivada:"bg-blue-100 text-blue-800",obsoleta:"bg-red-100 text-red-800"})[t]||"bg-gray-100 text-gray-800",B=t=>({memorando:"游닇",oficio:"游늯",resolucion:"丘뒲잺",acta:"游늶",informe:"游늵",circular:"游댃",comunicacion:"游눫",otro:"游늹"})[t]||"游늹";function We({plantillas:t,estadisticas:g,series:I,filtros:_,categorias:D,estados:O}){const V={total:0,activas:0,borradores:0,publicas:0,por_categoria:{},mas_usadas:[]},d=g&&typeof g=="object"?{...V,...g}:V,[C,z]=x.useState(_),[N,A]=x.useState(_.buscar||""),[$,P]=x.useState(!1),[F,E]=x.useState(null),q=x.useRef(!0),{data:n,setData:o,post:K,processing:H,errors:r,reset:U}=Y({nombre:"",descripcion:"",categoria:"otro",tipo_documento:"",serie_documental_id:"",subserie_documental_id:"",contenido_html:"",es_publica:!1});x.useEffect(()=>{if(q.current){q.current=!1;return}if(N===(_.buscar||""))return;const s=setTimeout(()=>{S("buscar",N)},500);return()=>clearTimeout(s)},[N]);const S=(s,a)=>{const l={...C};l[s]=a,(!a||a==="all")&&delete l[s],z(l),w.get(route("admin.plantillas.index"),l,{preserveState:!0,preserveScroll:!0})},J=()=>{z({}),A(""),w.get(route("admin.plantillas.index"))},Q=s=>{w.post(route("admin.plantillas.duplicar",s),{},{onSuccess:()=>{}})},W=s=>{const a=I.find(l=>l.id.toString()===s);E(a||null),o("serie_documental_id",s),o("subserie_documental_id","")};return e.jsxs(ee,{children:[e.jsx(Z,{title:"Plantillas Documentales"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(G,{className:"h-6 w-6 text-[#2a3d83]"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Plantillas Documentales"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Gesti칩n y creaci칩n de plantillas para documentos estandarizados"})]})]}),e.jsxs(se,{open:$,onOpenChange:P,children:[e.jsx(ae,{asChild:!0,children:e.jsxs(i,{className:"bg-[#2a3d83] hover:bg-[#1e2b5f] flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),"Nueva Plantilla"]})}),e.jsxs(te,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(re,{children:[e.jsx(le,{className:"text-xl font-semibold text-gray-900",children:"Crear Nueva Plantilla Documental"}),e.jsx(ce,{className:"text-sm text-gray-600",children:"Complete los siguientes datos para crear una nueva plantilla."})]}),e.jsxs("form",{onSubmit:s=>{if(s.preventDefault(),!n.nombre||!n.categoria){M.error("Por favor complete los campos requeridos");return}K(route("admin.plantillas.store"),{onSuccess:()=>{P(!1),U(),E(null),M.success("Plantilla creada exitosamente")},onError:a=>{console.error("Error al crear plantilla:",a),a&&Object.keys(a).forEach(l=>{const X=Array.isArray(a[l])?a[l][0]:a[l];M.error(`Error en ${l}: ${X}`)})}})},className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"create-nombre",children:"Nombre de la Plantilla *"}),e.jsx(L,{id:"create-nombre",value:n.nombre,onChange:s=>o("nombre",s.target.value),placeholder:"Ej: Memorando Interno",required:!0,className:r.nombre?"border-red-500":""}),r.nombre&&e.jsx("p",{className:"text-sm text-red-600",children:r.nombre})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"create-categoria",children:"Categor칤a *"}),e.jsxs(f,{value:n.categoria,onValueChange:s=>o("categoria",s),children:[e.jsx(b,{className:r.categoria?"border-red-500":"",children:e.jsx(v,{placeholder:"Seleccionar categor칤a"})}),e.jsx(y,{children:Object.entries(D).map(([s,a])=>e.jsxs(c,{value:s,children:[B(s)," ",a]},s))})]}),r.categoria&&e.jsx("p",{className:"text-sm text-red-600",children:r.categoria})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"create-tipo-documento",children:"Tipo de Documento"}),e.jsx(L,{id:"create-tipo-documento",value:n.tipo_documento,onChange:s=>o("tipo_documento",s.target.value),placeholder:"Ej: Memorando interno",className:r.tipo_documento?"border-red-500":""}),r.tipo_documento&&e.jsx("p",{className:"text-sm text-red-600",children:r.tipo_documento})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"create-descripcion",children:"Descripci칩n"}),e.jsx(ie,{id:"create-descripcion",value:n.descripcion,onChange:s=>o("descripcion",s.target.value),placeholder:"Descripci칩n de la plantilla",rows:3,className:r.descripcion?"border-red-500":""}),r.descripcion&&e.jsx("p",{className:"text-sm text-red-600",children:r.descripcion})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Serie Documental"}),e.jsxs(f,{onValueChange:W,children:[e.jsx(b,{children:e.jsx(v,{placeholder:"Seleccionar serie"})}),e.jsxs(y,{children:[e.jsx(c,{value:"",children:"Sin serie espec칤fica"}),I.map(s=>e.jsxs(c,{value:s.id.toString(),children:[s.codigo," - ",s.nombre]},s.id))]})]})]}),F?.subseries&&F.subseries.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Subserie Documental"}),e.jsxs(f,{value:n.subserie_documental_id,onValueChange:s=>o("subserie_documental_id",s),children:[e.jsx(b,{children:e.jsx(v,{placeholder:"Seleccionar subserie"})}),e.jsxs(y,{children:[e.jsx(c,{value:"",children:"Sin subserie"}),F.subseries.map(s=>e.jsxs(c,{value:s.id.toString(),children:[s.codigo," - ",s.nombre]},s.id))]})]})]})]}),e.jsxs(ne,{children:[e.jsx(i,{type:"button",variant:"outline",onClick:()=>{P(!1),U(),E(null)},children:"Cancelar"}),e.jsxs(i,{type:"submit",disabled:H,className:"bg-[#2a3d83] hover:bg-[#1e2b5f] flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),H?"Guardando...":"Crear Plantilla"]})]})]})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(m,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Total Plantillas"}),e.jsx(G,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d.total}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[d.activas," activas"]})]})]}),e.jsxs(m,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Plantillas P칰blicas"}),e.jsx(R,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d.publicas}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Disponibles para todos"})]})]}),e.jsxs(m,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"En Desarrollo"}),e.jsx(xe,{className:"h-4 w-4 text-yellow-600"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d.borradores}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Borradores pendientes"})]})]}),e.jsxs(m,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"M치s Usada"}),e.jsx(me,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d.mas_usadas[0]?.documentos_generados_count||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:d.mas_usadas[0]?.nombre||"Sin uso"})]})]})]}),e.jsxs(m,{children:[e.jsx(h,{children:e.jsx(u,{children:"Filtros"})}),e.jsx(j,{children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(L,{placeholder:"Buscar por nombre, c칩digo o descripci칩n...",value:N,onChange:s=>A(s.target.value),onKeyPress:s=>{s.key==="Enter"&&(s.preventDefault(),S("buscar",N))}})}),e.jsxs(f,{value:C.categoria||"all",onValueChange:s=>S("categoria",s),children:[e.jsx(b,{className:"w-48",children:e.jsx(v,{placeholder:"Categor칤a"})}),e.jsxs(y,{children:[e.jsx(c,{value:"all",children:"Todas las categor칤as"}),Object.entries(D).map(([s,a])=>e.jsxs(c,{value:s,children:[B(s)," ",a]},s))]})]}),e.jsxs(f,{value:C.estado||"all",onValueChange:s=>S("estado",s),children:[e.jsx(b,{className:"w-48",children:e.jsx(v,{placeholder:"Estado"})}),e.jsxs(y,{children:[e.jsx(c,{value:"all",children:"Todos los estados"}),Object.entries(O).map(([s,a])=>e.jsx(c,{value:s,children:a},s))]})]}),Object.keys(C).length>0&&e.jsx(i,{variant:"outline",onClick:J,children:"Limpiar"})]})})]}),e.jsxs(m,{children:[e.jsx(h,{children:e.jsx(u,{children:"Lista de Plantillas"})}),e.jsx(j,{children:t.data.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(he,{className:"mx-auto h-12 w-12 text-muted-foreground"}),e.jsx("h3",{className:"mt-2 text-sm font-semibold text-gray-900",children:"No hay plantillas"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"No se encontraron plantillas documentales."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-3 px-4",children:"Plantilla"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Categor칤a"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Estado"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Serie"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Creador"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Versi칩n"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Fecha"}),e.jsx("th",{className:"text-right py-3 px-4",children:"Acciones"})]})}),e.jsx("tbody",{children:t.data.map(s=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:s.nombre}),s.es_publica&&e.jsx(T,{variant:"secondary",className:"text-xs",children:"P칰blica"})]}),e.jsx("div",{className:"text-sm text-gray-500",children:s.codigo}),s.descripcion&&e.jsx("div",{className:"text-sm text-gray-400 max-w-xs truncate",children:s.descripcion})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:B(s.categoria)}),e.jsx("span",{className:"capitalize",children:D[s.categoria]})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx(T,{className:Ne(s.estado),children:O[s.estado]})}),e.jsx("td",{className:"py-3 px-4",children:s.serie_documental?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ue,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:s.serie_documental.codigo})]}):e.jsx("span",{className:"text-gray-400 text-sm",children:"Sin serie"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(R,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:s.usuario_creador.name})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs(T,{variant:"outline",children:["v",s.version]})}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-500",children:new Date(s.created_at).toLocaleDateString("es-ES")}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(k,{href:route("admin.plantillas.show",s.id),children:e.jsx(i,{variant:"outline",size:"sm",children:e.jsx(je,{className:"h-4 w-4"})})}),e.jsx(k,{href:route("admin.plantillas.edit",s.id),children:e.jsx(i,{variant:"outline",size:"sm",children:e.jsx(pe,{className:"h-4 w-4"})})}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>Q(s.id),children:e.jsx(ge,{className:"h-4 w-4"})})]})})]},s.id))})]})})})]}),t.links&&t.links.length>3&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Mostrando ",t?.meta?.from||0," a ",t?.meta?.to||0," de ",t?.meta?.total||0," resultados"]}),e.jsx("div",{className:"flex gap-2",children:t.links.map((s,a)=>e.jsx(i,{variant:s.active?"default":"outline",size:"sm",disabled:!s.url,onClick:()=>s.url&&w.get(s.url),dangerouslySetInnerHTML:{__html:s.label}},a))})]})]})]})}export{We as default};
